module.exports=function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=22)}([function(e,t){e.exports=require("vscode")},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(4),a=i(3),c=i(21);function l(e){return e&&o.isWin&&r.isAbsolute(e)&&e.charAt(0)===e.charAt(0).toLowerCase()&&(e=e.substr(0,1).toUpperCase()+e.substr(1)),e}function u(e,t){return s(this,void 0,void 0,(function*(){if(!n.existsSync(e))return[];var i;return(yield(i=e,new Promise((e,t)=>n.readdir(i,{withFileTypes:!0},(i,s)=>{i?t(i):e(s)})))).filter(e=>e.isDirectory()).filter(e=>"bin"!==e.name||t&&t.allowBin).filter(e=>"cache"!==e.name||t&&t.allowCache).map(t=>r.join(e,t.name))}))}function d(e){return s(this,void 0,void 0,(function*(){return yield g(r.join(e,"pubspec.yaml"))}))}function h(e){return s(this,void 0,void 0,(function*(){return yield g(r.join(e,o.FLUTTER_CREATE_PROJECT_TRIGGER_FILE))}))}function p(e){return s(this,void 0,void 0,(function*(){return(yield g(r.join(e,"bin/flutter")))&&(yield g(r.join(e,"bin/cache/dart-sdk")))}))}function g(e){return s(this,void 0,void 0,(function*(){try{return yield n.promises.access(e),!0}catch(e){return!1}}))}t.fsPath=function(e){return l("string"==typeof e?e:e.fsPath)},t.forceWindowsDriveLetterToUppercase=l,t.isWithinPath=function(e,t){const i=r.relative(t,e);return!!i&&!i.startsWith("..")&&!r.isAbsolute(i)},t.getChildFolders=u,t.hasPackagesFile=function(e){return n.existsSync(r.join(e,".packages"))},t.hasPubspec=function(e){return n.existsSync(r.join(e,"pubspec.yaml"))},t.hasPubspecAsync=d,t.hasCreateTriggerFileAsync=h,t.isFlutterRepoAsync=p,t.findProjectFolders=function(e,t={}){return s(this,void 0,void 0,(function*(){const i=yield a.flatMapAsync(e,u),n=yield a.flatMapAsync(i,u),r=e.concat(i).concat(n).map(e=>s(this,void 0,void 0,(function*(){return{exists:t&&t.requirePubspec?yield d(e):(yield d(e))||(yield h(e))||(yield p(e)),folder:e}}))),o=(yield Promise.all(r)).filter(e=>e.exists).map(e=>e.folder);return t&&t.sort?c.sortBy(o,e=>e.toLowerCase()):o}))},t.tryDeleteFile=function(e){if(n.existsSync(e))try{n.unlinkSync(e)}catch(e){console.warn("Failed to delete file $path.")}},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},t.mkDirRecursive=function e(t){const i=r.dirname(t);n.existsSync(i)||e(i),n.existsSync(t)||n.mkdirSync(t)},t.areSameFolder=function(e,t){return(e=e.replace(/[\\/]+$/,""))===(t=t.replace(/[\\/]+$/,""))}},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(115),a=i(4);t.uniq=function(e){return e.filter((t,i)=>e.indexOf(t)===i)},t.flatMap=function(e,t){return e.reduce((e,i)=>e.concat(t(i)),[])},t.flatMapAsync=function(e,t){return s(this,void 0,void 0,(function*(){let i=[];for(const s of e)i=i.concat(yield t(s));return i}))},t.filenameSafe=function(e){return e.replace(/[^a-z0-9]+/gi,"_").toLowerCase()},t.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};function c(e,t){return o.gte(e,t)}t.PromiseCompleter=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}},t.findFile=function(e,t){let i,s=t;for(;s&&s.length>1&&s!==i;){const t=r.join(s,e);if(n.existsSync(t))return t;i=s,s=r.dirname(s)}},t.uriToFilePath=function(e,t=a.isWin){let i=e;return e.startsWith("file://")?i=decodeURI(e.substring(7)):e.startsWith("file:")&&(i=decodeURI(e.substring(5))),t?(i=i.replace(/\//g,"\\"),"\\"===i[0]&&(i=i.substring(1))):"/"!==i[0]&&(i="/"+i),i},t.isDartSdkFromFlutter=function(e){const t=r.join(r.dirname(r.dirname(r.dirname(e))),"bin");return n.existsSync(r.join(t,a.flutterExecutableName))},t.versionIsAtLeast=c,t.pubVersionIsAtLeast=function(e,t){return!!o.gt(e,t)||!o.lt(e,t)&&(-1!==e.indexOf("+")&&-1===t.indexOf("+")||(-1!==e.indexOf("+")||-1===t.indexOf("+"))&&c(e=e.replace("+",-1===e.indexOf("-")?"-":"."),t=t.replace("+",-1===t.indexOf("-")?"-":".")))},t.isStableSdk=function(e){return!(!e||o.prerelease(e))},t.usingCustomScript=function(e,t,i){if(null==i?void 0:i.customScript){e=i.customScript;const s=void 0!==i.customScriptReplacesNumArgs?i.customScriptReplacesNumArgs:1;t=t.slice(s)}return{binPath:e,binArgs:t}},t.errorString=function(e){return e?e instanceof Error?e.message+(e.stack?"\n"+e.stack:""):"string"==typeof e?e:e.message||"<empty error message>":"<empty error>"};function l(e){return Math.round(e).toString(16).padStart(2,"0")}function u(e,t,i){return Math.min(Math.max(t,e),i)}t.BufferedLogger=class{constructor(){this.buffer=[]}info(e,t){this.buffer.push({type:"info",message:e,category:t})}warn(e,t){this.buffer.push({type:"warn",message:e,category:t})}error(e,t){this.buffer.push({type:"error",message:e,category:t})}flushTo(e){if(this.buffer.length){e.info("Flushing log messages...");for(const t of this.buffer)switch(t.type){case"info":e.info(t.message,t.category);break;case"warn":e.warn(t.message,t.category);break;case"error":e.error(t.message,t.category)}e.info("Done flushing log messages...")}}},t.notUndefined=function(e){return void 0!==e},t.asHexColor=function({r:e,g:t,b:i,a:s}){return e=u(e,0,255),t=u(t,0,255),i=u(i,0,255),`${l(s=u(s,0,255))}${l(e)}${l(t)}${l(i)}`.toLowerCase()},t.asHex=l,t.clamp=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7);t.dartCodeExtensionIdentifier="Dart-Code.dart-code",t.flutterExtensionIdentifier="Dart-Code.flutter",t.isWin=/^win/.test(process.platform),t.isMac="darwin"===process.platform,t.isLinux=!t.isWin&&!t.isMac,t.isChromeOS=t.isLinux&&s.existsSync("/dev/.cros_milestone"),t.dartPlatformName=t.isWin?"win":t.isMac?"mac":"linux",t.platformDisplayName=t.isWin?"win":t.isMac?"mac":t.isChromeOS?"chromeos":"linux",t.platformEol=t.isWin?"\r\n":"\n",t.dartExecutableName=t.isWin?"dart.exe":"dart",t.pubExecutableName=t.isWin?"pub.bat":"pub",t.flutterExecutableName=t.isWin?"flutter.bat":"flutter",t.androidStudioExecutableNames=t.isWin?["studio64.exe"]:["studio.sh","studio"],t.dartVMPath="bin/"+t.dartExecutableName,t.pubPath="bin/"+t.pubExecutableName,t.pubSnapshotPath="bin/snapshots/pub.dart.snapshot",t.analyzerSnapshotPath="bin/snapshots/analysis_server.dart.snapshot",t.flutterPath="bin/"+t.flutterExecutableName,t.androidStudioPaths=t.androidStudioExecutableNames.map(e=>"bin/"+e),t.DART_DOWNLOAD_URL="https://dart.dev/get-dart",t.FLUTTER_DOWNLOAD_URL="https://flutter.io/setup/",t.IS_LSP_CONTEXT="dart-code:isLsp",t.DART_TEST_SUITE_NODE_CONTEXT="dart-code:testSuiteNode",t.DART_TEST_GROUP_NODE_CONTEXT="dart-code:testGroupNode",t.DART_TEST_TEST_NODE_CONTEXT="dart-code:testTestNode",t.DART_DEP_PROJECT_NODE_CONTEXT="dart-code:depProjectNode",t.DART_DEP_PACKAGE_NODE_CONTEXT="dart-code:depPackageNode",t.DART_DEP_FOLDER_NODE_CONTEXT="dart-code:depFolderNode",t.DART_DEP_FILE_NODE_CONTEXT="dart-code:depFileNode",t.DART_IS_CAPTURING_LOGS_CONTEXT="dart-code:isCapturingLogs",t.PUB_OUTDATED_SUPPORTED_CONTEXT="dart-code:pubOutdatedSupported",t.IS_RUNNING_LOCALLY_CONTEXT="dart-code:isRunningLocally",t.stopLoggingAction="Stop Logging",t.showLogAction="Show Log",t.restartReasonManual="manual",t.restartReasonSave="save",t.pubGlobalDocsUrl="https://www.dartlang.org/tools/pub/cmd/pub-global",t.stagehandInstallationInstructionsUrl="https://github.com/dart-lang/stagehand#installation",t.wantToTryDevToolsPrompt="Dart DevTools includes additional tools for debugging and profiling Flutter apps, including a Widget Inspector. Try it?",t.openDevToolsAction="Open",t.alwaysOpenAction="Always Open",t.notTodayAction="Not Now",t.doNotAskAgainAction="Never Ask",t.flutterSurveyDataUrl="https://flutter.dev/f/flutter-survey-metadata.json",t.flutterSurveyAnalyticsText="By clicking on this link you agree to share feature usage along with the survey responses.",t.takeSurveyAction="Take Survey",t.skipThisSurveyAction="Skip This Survey",t.fiveMinutesInMs=3e5,t.tenMinutesInMs=6e5,t.twentyMinutesInMs=12e5,t.twoHoursInMs=72e5,t.twentyHoursInMs=72e6,t.fortyHoursInMs=144e6,t.noRepeatPromptThreshold=t.twentyHoursInMs,t.longRepeatPromptThreshold=t.fortyHoursInMs,t.pleaseReportBug="Please raise a bug against the Dart extension for VS Code.",t.CHROME_OS_DEVTOOLS_PORT=8080,t.CHROME_OS_VM_SERVICE_PORT=8085,t.DART_STAGEHAND_PROJECT_TRIGGER_FILE="dart.sh.create",t.FLUTTER_CREATE_PROJECT_TRIGGER_FILE="flutter.create",t.REFACTOR_FAILED_DOC_MODIFIED="This refactor cannot be applied because the document has changed.",t.REFACTOR_ANYWAY="Refactor Anyway",t.TRACK_WIDGET_CREATION_ENABLED="dart-code:trackWidgetCreationEnabled",t.HAS_LAST_DEBUG_CONFIG="dart-code:hasLastDebugConfig",t.HAS_LAST_TEST_DEBUG_CONFIG="dart-code:hasLastTestDebugConfig",t.isInDebugSessionThatSupportsHotReloadContext="dart-code:isInDebugSessionThatSupportsHotReload",t.isInFlutterDebugModeDebugSessionContext="dart-code:isInFlutterDebugModeDebugSession",t.isInFlutterProfileModeDebugSessionContext="dart-code:isInFlutterProfileModeDebugSession",t.showErrorsAction="Show Errors",t.debugAnywayAction="Debug Anyway",t.userPromptContextPrefix="hasPrompted.",t.installFlutterExtensionPromptKey="install_flutter_extension_3",t.useRecommendedSettingsPromptKey="use_recommended_settings",t.yesAction="Yes",t.noAction="No",t.skipAction="Skip",t.showRecommendedSettingsAction="Show Recommended Settings",t.recommendedSettingsUrl="https://dartcode.org/docs/recommended-settings/",t.openSettingsAction="Open Settings File",t.reactivateDevToolsAction="Reactivate DevTools",t.observatoryListeningBannerPattern=new RegExp("Observatory (?:listening on|.* is available at:) (http:.+)"),t.observatoryHttpLinkPattern=new RegExp("(http://[\\d\\.:]+/)"),t.dartRecommendedConfig={"editor.formatOnSave":!0,"editor.formatOnType":!0,"editor.rulers":[80],"editor.selectionHighlight":!1,"editor.suggest.snippetsPreventQuickSuggestions":!1,"editor.suggestSelection":"first","editor.tabCompletion":"onlySnippets","editor.wordBasedSuggestions":!1,"files.insertFinalNewline":!0}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(28),o=i(0),a=i(0),c=i(4),l=i(12),u=i(1);t.SourceSortMembersCodeActionKind=a.CodeActionKind.Source.append("sortMembers");const d=a.extensions.getExtension(c.dartCodeExtensionIdentifier);function h(e){return!(!e||"file"!==e.uri.scheme)}function p(e){return new a.Position(e.startLine-1,e.startColumn-1)}function g(e){return new a.Position(e.line,e.character)}function f(e){return e.replace(/[\/\\]+$/,"")}t.isRunningLocally=!d||d.extensionKind===a.ExtensionKind.UI,t.getDartWorkspaceFolders=function(){return a.workspace.workspaceFolders?a.workspace.workspaceFolders.filter(h):[]},t.isDartWorkspaceFolder=h,t.toRange=function(e,t,i){return new a.Range(e.positionAt(t),e.positionAt(t+i))},t.lspToRange=function(e){return new a.Range(g(e.start),g(e.end))},t.toPosition=p,t.lspToPosition=g,t.toRangeOnLine=function(e){const t=p(e);return new a.Range(t,t.translate(0,e.length))},t.showCode=function(e,t,i,s){s&&(e.selection=new a.Selection(s.start,s.end)),e.revealRange(t,a.TextEditorRevealType.InCenterIfOutsideViewport)},t.trimTrailingSlashes=f,t.warnIfPathCaseMismatch=function(e,t,i,s){const r=f(u.forceWindowsDriveLetterToUppercase(t)),a=n.existsSync(r)&&f(u.forceWindowsDriveLetterToUppercase(n.realpathSync.native(r)));if(r&&a&&r.toLowerCase()===a.toLowerCase()&&r!==a){const t=`The casing of ${i} does not match the casing on disk; please ${s}. Expected ${a} but got ${r}`;return e.warn(t),o.window.showWarningMessage(t),!0}return!1};function m(e){return e.toString().replace(/%24/g,"$").replace(/%5B/g,"[")}t.envUtils=new class{openInBrowser(e,t=l.nullLogger){return s(this,void 0,void 0,(function*(){return t.info("Opening external URL: "+e),a.env.openExternal(a.Uri.parse(e))}))}exposeUrl(e,t=l.nullLogger){return s(this,void 0,void 0,(function*(){t.info("Exposing URL: "+e.toString());const i="ws"===e.scheme||"wss"===e.scheme,s="wss"===e.scheme||"https"===e.scheme;let n=e.scheme;i&&(n=s?"https":"http");const o=new r.URL(m(e));let c=e.authority;o.port||(c=`${o.hostname}:${s?"443":"80"}`);const l=e.with({scheme:n,authority:c});t.info("Mapping URL: "+l.toString());const u=yield a.env.asExternalUri(l);t.info("Mapped URL: "+u.toString());let d=u.scheme;i&&(d="https"===u.scheme?"wss":"ws");const h=m(u.with({scheme:d}));t.info("Final URI: "+h);const p=new r.URL(h).toString();return t.info("Final URL: "+p),p}))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(27),o=i(18),a=i(2),c=i(0),l=i(4),u=i(1),d=i(5),h=i(9),p=i(22),g=i(31),f=i(62);function m(e){return!!(e&&d.isDartWorkspaceFolder(e)&&v(u.fsPath(e.uri)))}function v(e){return f.referencesFlutterSdk(e)}function y(e){if(e.isUntitled||!u.fsPath(e.uri)||"file"!==e.uri.scheme)return!1;const t=["dart","htm","html"].concat(h.config.additionalAnalyzerFileExtensions),i=a.extname(u.fsPath(e.uri)),s=i?i.substr(1):void 0;return e.languageId&&["dart","html"].indexOf(e.languageId)>=0||[".analysis_options","analysis_options.yaml","pubspec.yaml"].indexOf(a.basename(u.fsPath(e.uri)))>=0||void 0!==s&&t.includes(s)}function b(e){return!!c.workspace.getWorkspaceFolder(c.Uri.file(e))}function w(e){return!!e&&C(e)&&(T(e,"test")||h.config.allowTestsOutsideTestFolder)&&e.toLowerCase().endsWith("_test.dart")}function S(e){return!!e&&T(e,"test")&&n.existsSync(e)&&n.statSync(e).isDirectory()}function C(e){return!!e&&".dart"===a.extname(e.toLowerCase())&&n.existsSync(e)&&n.statSync(e).isFile()}function T(e,t){if(!e)return!1;const i=c.workspace.getWorkspaceFolder(c.Uri.file(e));return!!i&&-1!==a.relative(u.fsPath(i.uri),e).toLowerCase().split(a.sep).indexOf(t.toLowerCase())}t.isFlutterWorkspaceFolder=m,t.isInsideFlutterProject=function(e){if(!e)return!1;const t=g.locateBestProjectRoot(u.fsPath(e));return t?v(t):m(c.workspace.getWorkspaceFolder(e))},t.isFlutterProjectFolder=v,t.resolvePaths=function(e){if("string"==typeof e)return e.startsWith("~/")?a.join(o.homedir(),e.substr(2)):!a.isAbsolute(e)&&c.workspace.workspaceFolders&&c.workspace.workspaceFolders.length?a.join(u.fsPath(c.workspace.workspaceFolders[0].uri),e):e},t.homeRelativePath=function(e){if(!e)return;const t=o.homedir();return u.isWithinPath(e,t)?a.join("~",a.relative(t,e)):e},t.createFolderForFile=function(e){try{if(!e||!a.isAbsolute(e))return;const t=a.dirname(e);return n.existsSync(t)||u.mkDirRecursive(t),e}catch(t){return void console.warn("Ignoring invalid file path "+e)}},t.getSdkVersion=function(e,{sdkRoot:t,versionFile:i}){if((t||i)&&(i||(i=a.join(t,"version")),n.existsSync(i)))try{return n.readFileSync(i,"utf8").trim().split("\n").filter(e=>e).filter(e=>"#"!==e.trim().substr(0,1)).join("\n").trim()}catch(t){return void e.error(t)}},t.isAnalyzable=y,t.shouldHotReloadFor=function(e){if(e.isUntitled||!u.fsPath(e.uri)||"file"!==e.uri.scheme)return!1;const t=a.extname(u.fsPath(e.uri)),i=t?t.substr(1):void 0;return void 0!==i&&["dart","htm","html","css"].includes(i)},t.isAnalyzableAndInWorkspace=function(e){return y(e)&&b(u.fsPath(e.uri))},t.isWithinWorkspace=b,t.isTestFileOrFolder=function(e){return!!e&&(w(e)||S(e))},t.isTestFile=w,t.isPubRunnableTestFile=function(e){return!!e&&C(e)&&e.toLowerCase().endsWith("_test.dart")},t.isTestFolder=S,t.projectShouldUsePubForTests=function(e,t){return u.hasPubspec(e)&&!t.useVmForTests},t.isDartFile=C,t.isInsideFolderNamed=T,t.getLatestSdkVersion=function(){return new Promise((e,t)=>{r.request({hostname:"storage.googleapis.com",method:"GET",path:"/dart-archive/channels/stable/release/latest/VERSION",port:443},i=>{!i||!i.statusCode||i.statusCode<200||i.statusCode>300?t({message:`Failed to get Dart SDK Version ${i&&i.statusCode}: ${i&&i.statusMessage}`}):i.on("data",t=>{e(JSON.parse(t.toString()).version)})}).end()})},t.escapeShell=function(e){const t=[];return e.forEach(e=>{/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)}),t.join(" ")},t.promptToReloadExtension=function(e,t,i){return s(this,void 0,void 0,(function*(){const s=t||"Restart",n=i?[s,l.showLogAction]:[s],r=p.ringLog.toString(),o=e&&(yield c.window.showInformationMessage(e,...n));o===l.showLogAction?E(void 0,r):e&&o!==s||c.commands.executeCommand("_dart.reloadExtension")}))};process.hrtime.bigint();function E(e="txt",t){const i=a.join(o.tmpdir(),`log-${u.getRandomInt(4096,65536).toString(16)}.${e}`);n.writeFileSync(i,t),c.workspace.openTextDocument(i).then(c.window.showTextDocument)}t.logTime=e=>{},t.openLogContents=E},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Waiting=0]="Waiting",e[e.Passed=1]="Passed",e[e.Skipped=2]="Skipped",e[e.Unknown=3]="Unknown",e[e.Failed=4]="Failed",e[e.Errored=5]="Errored",e[e.Running=6]="Running"}(t.TestStatus||(t.TestStatus={})),function(e){e.PlatformOverride="ext.flutter.platformOverride",e.DebugBanner="ext.flutter.debugAllowBanner",e.CheckElevations="ext.flutter.debugCheckElevationsEnabled",e.DebugPaint="ext.flutter.debugPaint",e.PaintBaselines="ext.flutter.debugPaintBaselinesEnabled",e.InspectorSelectMode="ext.flutter.inspector.show",e.InspectorSetPubRootDirectories="ext.flutter.inspector.setPubRootDirectories",e.InspectorStructuredErrors="ext.flutter.inspector.structuredErrors",e.RepaintRainbow="ext.flutter.repaintRainbow",e.PerformanceOverlay="ext.flutter.showPerformanceOverlay",e.SlowAnimations="ext.flutter.timeDilation"}(t.VmServiceExtension||(t.VmServiceExtension={})),function(e){e.HotReload="reloadSources",e.HotRestart="hotRestart",e.LaunchDevTools="launchDevTools"}(t.VmService||(t.VmService={})),function(e){e[e.NotInstalled=0]="NotInstalled",e[e.UpdateRequired=1]="UpdateRequired",e[e.UpdateAvailable=2]="UpdateAvailable",e[e.Valid=3]="Valid"}(t.VersionStatus||(t.VersionStatus={})),function(e){e[e.General=0]="General",e[e.CI=1]="CI",e[e.CommandProcesses=2]="CommandProcesses",e[e.DevTools=3]="DevTools",e[e.Analyzer=4]="Analyzer",e[e.PubTest=5]="PubTest",e[e.FlutterDaemon=6]="FlutterDaemon",e[e.FlutterRun=7]="FlutterRun",e[e.FlutterTest=8]="FlutterTest",e[e.Observatory=9]="Observatory",e[e.WebDaemon=10]="WebDaemon"}(t.LogCategory||(t.LogCategory={})),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error"}(t.LogSeverity||(t.LogSeverity={})),t.debugOptionNames=["my code","my code + packages","my code + packages + SDK","my code + SDK"],function(e){e[e.MyCode=0]="MyCode",e[e.MyCodePackages=1]="MyCodePackages",e[e.MyCodePackagesSdk=2]="MyCodePackagesSdk",e[e.MyCodeSdk=3]="MyCodeSdk"}(t.DebugOption||(t.DebugOption={}))},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(6),o=i(86),a=i(13);class c{constructor(e){this.uri=e,this.config=n.workspace.getConfiguration("dart",this.uri)}getConfig(e,t){return o.nullToUndefined(this.config.get(e,t))}get analysisExcludedFolders(){return this.getConfig("analysisExcludedFolders",[])}get analyzerInstrumentationLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("analyzerInstrumentationLogFile",null)))}get analyzerLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("analyzerLogFile",null)))}get analyzerPath(){return r.resolvePaths(this.getConfig("analyzerPath",null))}get devToolsLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("devToolsLogFile",null)))}get doNotFormat(){return this.getConfig("doNotFormat",[])}get enableCompletionCommitCharacters(){return this.getConfig("enableCompletionCommitCharacters",!1)}get evaluateGettersInDebugViews(){return this.getConfig("evaluateGettersInDebugViews",!0)}get extensionLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("extensionLogFile",null)))}get flutterAdditionalArgs(){return this.getConfig("flutterAdditionalArgs",[])}get flutterDaemonLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterDaemonLogFile",null)))}get flutterRunLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterRunLogFile",null)))}get flutterScreenshotPath(){return r.resolvePaths(this.getConfig("flutterScreenshotPath",null))}get flutterSdkPath(){return r.resolvePaths(this.getConfig("flutterSdkPath",null))}get flutterSdkPaths(){return this.getConfig("flutterSdkPaths",[]).map(r.resolvePaths)}get flutterStructuredErrors(){return this.getConfig("flutterStructuredErrors",!0)}get flutterTestLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterTestLogFile",null)))}get flutterTrackWidgetCreation(){return this.getConfig("flutterTrackWidgetCreation",!0)}get insertArgumentPlaceholders(){return this.getConfig("insertArgumentPlaceholders",!0)}get lineLength(){return this.getConfig("lineLength",80)}get observatoryLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("observatoryLogFile",null)))}get promptToGetPackages(){return this.getConfig("promptToGetPackages",!0)}get pubAdditionalArgs(){return this.getConfig("pubAdditionalArgs",[])}get pubTestLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("pubTestLogFile",null)))}get runPubGetOnPubspecChanges(){return this.getConfig("runPubGetOnPubspecChanges",!0)}get sdkPath(){return r.resolvePaths(this.getConfig("sdkPath",null))}get sdkPaths(){return this.getConfig("sdkPaths",[]).map(r.resolvePaths)}get showDartDeveloperLogs(){return this.getConfig("showDartDeveloperLogs",!0)}get vmAdditionalArgs(){return this.getConfig("vmAdditionalArgs",[])}get webDaemonLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("webDaemonLogFile",null)))}}t.config=new class{constructor(){n.workspace.onDidChangeConfiguration(e=>this.reloadConfig()),this.config=n.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}reloadConfig(){this.config=n.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}getConfig(e,t){const i=this.config.get(e,t);return o.nullToUndefined(i)}getWorkspaceConfig(e){const t=this.config.inspect(e);return t&&t.workspaceValue?o.nullToUndefined(t.workspaceValue):t&&t.workspaceFolderValue?o.nullToUndefined(t.workspaceFolderValue):void 0}setConfig(e,t,i){return s(this,void 0,void 0,(function*(){yield this.config.update(e,t,i)}))}get additionalAnalyzerFileExtensions(){return this.getConfig("additionalAnalyzerFileExtensions",[])}get allowAnalytics(){return this.getConfig("allowAnalytics",!0)}get allowTestsOutsideTestFolder(){return this.getConfig("allowTestsOutsideTestFolder",!1)}get analysisServerFolding(){return this.getConfig("analysisServerFolding",!0)}get analyzeAngularTemplates(){return this.getConfig("analyzeAngularTemplates",!0)}get analyzerAdditionalArgs(){return this.getConfig("analyzerAdditionalArgs",[])}get analyzerDiagnosticsPort(){return this.getConfig("analyzerDiagnosticsPort",null)}get analyzerInstrumentationLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("analyzerInstrumentationLogFile",null)))}get analyzerLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("analyzerLogFile",null)))}get analyzerObservatoryPort(){return this.getConfig("analyzerObservatoryPort",null)}get analyzerPath(){return r.resolvePaths(this.getConfig("analyzerPath",null))}get analyzerSshHost(){return this.getConfig("analyzerSshHost",null)}get autoImportCompletions(){return this.getConfig("autoImportCompletions",!0)}get buildRunnerAdditionalArgs(){return this.getConfig("buildRunnerAdditionalArgs",[])}get checkForSdkUpdates(){return this.getConfig("checkForSdkUpdates",!0)}get closingLabels(){return this.getConfig("closingLabels",!0)}get debugExternalLibraries(){return this.getConfig("debugExternalLibraries",!1)}get debugSdkLibraries(){return this.getConfig("debugSdkLibraries",!1)}get devToolsLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("devToolsLogFile",null)))}get devToolsPort(){return this.getConfig("devToolsPort",null)}get devToolsReuseWindows(){return this.getConfig("devToolsReuseWindows",!0)}get devToolsTheme(){return this.getConfig("devToolsTheme","dark")}get enableSdkFormatter(){return this.getConfig("enableSdkFormatter",!0)}get env(){return this.getConfig("env",{})}get evaluateToStringInDebugViews(){return this.getConfig("evaluateToStringInDebugViews",!1)}get extensionLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("extensionLogFile",null)))}get flutterAdbConnectOnChromeOs(){return this.getConfig("flutterAdbConnectOnChromeOs",!1)}get flutterAndroidX(){return this.getConfig("flutterAndroidX",!1)}get flutterCreateAndroidLanguage(){return this.getConfig("flutterCreateAndroidLanguage","kotlin")}get flutterCreateIOSLanguage(){return this.getConfig("flutterCreateIOSLanguage","swift")}get flutterCreateOffline(){return this.getConfig("flutterCreateOffline",!1)}get flutterCreateOrganization(){return this.getConfig("flutterCreateOrganization",null)}get flutterCustomEmulators(){return this.getConfig("flutterCustomEmulators",[])}get flutterDaemonLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterDaemonLogFile",null)))}get flutterGutterIcons(){return this.getConfig("flutterGutterIcons",!0)}get flutterHotReloadOnSave(){return this.getConfig("flutterHotReloadOnSave",!0)}get flutterHotRestartOnSave(){return this.getConfig("flutterHotRestartOnSave",!0)}get flutterOutline(){return this.getConfig("flutterOutline",!0)}get flutterRunLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterRunLogFile",null)))}get flutterScreenshotPath(){return r.resolvePaths(this.getConfig("flutterScreenshotPath",null))}get flutterSdkPath(){return r.resolvePaths(this.getConfig("flutterSdkPath",null))}get flutterSdkPaths(){return this.getConfig("flutterSdkPaths",[]).map(r.resolvePaths)}get flutterSelectDeviceWhenConnected(){return this.getConfig("flutterSelectDeviceWhenConnected",!0)}get flutterTestLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("flutterTestLogFile",null)))}get maxLogLineLength(){return this.getConfig("maxLogLineLength",2e3)}get notifyAnalyzerErrors(){return this.getConfig("notifyAnalyzerErrors",!0)}get observatoryLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("observatoryLogFile",null)))}get openDevTools(){return this.getConfig("openDevTools","never")}get openTestView(){return this.getConfig("openTestView",["testRunStart"])}get previewBazelWorkspaceCustomScripts(){return this.getConfig("previewBazelWorkspaceCustomScripts",!1)}get previewBuildRunnerTasks(){return this.getConfig("previewBuildRunnerTasks",!1)}get previewFlutterUiGuides(){return this.getConfig("previewFlutterUiGuides",!1)}get previewFlutterUiGuidesCustomTracking(){return this.getConfig("previewFlutterUiGuidesCustomTracking",!1)}get previewHotReloadOnSaveWatcher(){return this.getConfig("previewHotReloadOnSaveWatcher",!1)}get previewLsp(){return this.getConfig("previewLsp",!1)}get previewNewCompletionPlaceholders(){return this.getConfig("previewNewCompletionPlaceholders",!0)}get previewUpdateImportsOnRename(){return this.getConfig("previewUpdateImportsOnRename",!1)}get promptToRunIfErrors(){return this.getConfig("promptToRunIfErrors",!0)}get pubTestLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("pubTestLogFile",null)))}get sdkPath(){return r.resolvePaths(this.getConfig("sdkPath",null))}get sdkPaths(){return this.getConfig("sdkPaths",[]).map(r.resolvePaths)}get showDartPadSampleCodeLens(){return this.getConfig("showDartPadSampleCodeLens",!0)}get showIgnoreQuickFixes(){return this.getConfig("showIgnoreQuickFixes",!1)}get showMainCodeLens(){return this.getConfig("showMainCodeLens",!0)}get showTestCodeLens(){return this.getConfig("showTestCodeLens",!0)}get showTodos(){return this.getConfig("showTodos",!0)}get triggerSignatureHelpAutomatically(){return this.getConfig("triggerSignatureHelpAutomatically",!1)}get useKnownChromeOSPorts(){return this.getConfig("useKnownChromeOSPorts",!0)}get warnWhenEditingFilesOutsideWorkspace(){return this.getConfig("warnWhenEditingFilesOutsideWorkspace",!0)}get webDaemonLogFile(){return r.createFolderForFile(r.resolvePaths(this.getConfig("webDaemonLogFile",null)))}get useDevToolsDarkTheme(){return"dark"===this.devToolsTheme}get openTestViewOnFailure(){return-1!==this.openTestView.indexOf("testFailure")}get openTestViewOnStart(){return-1!==this.openTestView.indexOf("testRunStart")}get workspaceSdkPath(){return r.resolvePaths(this.getWorkspaceConfig("sdkPath"))}get workspaceFlutterSdkPath(){return r.resolvePaths(this.getWorkspaceConfig("flutterSdkPath"))}setCheckForSdkUpdates(e){return this.setConfig("checkForSdkUpdates",e,n.ConfigurationTarget.Global)}setFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,n.ConfigurationTarget.Workspace)}setGlobalDartSdkPath(e){return this.setConfig("sdkPath",e,n.ConfigurationTarget.Global)}setGlobalDebugSdkLibraries(e){return this.setConfig("debugSdkLibraries",e,n.ConfigurationTarget.Global)}setGlobalDebugExternalLibraries(e){return this.setConfig("debugExternalLibraries",e,n.ConfigurationTarget.Global)}setGlobalFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,n.ConfigurationTarget.Global)}setOpenDevTools(e){return this.setConfig("openDevTools",e,n.ConfigurationTarget.Global)}setSdkPath(e){return this.setConfig("sdkPath",e,n.ConfigurationTarget.Workspace)}setWarnWhenEditingFilesOutsideWorkspace(e){return this.setConfig("warnWhenEditingFilesOutsideWorkspace",e,n.ConfigurationTarget.Global)}for(e){return new c(e)}}},function(e,t,i){"use strict";function s(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});const n=i(20);t.ErrorCodes=n.ErrorCodes,t.ResponseError=n.ResponseError,t.CancellationToken=n.CancellationToken,t.CancellationTokenSource=n.CancellationTokenSource,t.Disposable=n.Disposable,t.Event=n.Event,t.Emitter=n.Emitter,t.Trace=n.Trace,t.TraceFormat=n.TraceFormat,t.SetTraceNotification=n.SetTraceNotification,t.LogTraceNotification=n.LogTraceNotification,t.RequestType=n.RequestType,t.RequestType0=n.RequestType0,t.NotificationType=n.NotificationType,t.NotificationType0=n.NotificationType0,t.MessageReader=n.MessageReader,t.MessageWriter=n.MessageWriter,t.ConnectionStrategy=n.ConnectionStrategy,t.StreamMessageReader=n.StreamMessageReader,t.StreamMessageWriter=n.StreamMessageWriter,t.IPCMessageReader=n.IPCMessageReader,t.IPCMessageWriter=n.IPCMessageWriter,t.createClientPipeTransport=n.createClientPipeTransport,t.createServerPipeTransport=n.createServerPipeTransport,t.generateRandomPipeName=n.generateRandomPipeName,t.createClientSocketTransport=n.createClientSocketTransport,t.createServerSocketTransport=n.createServerSocketTransport,t.ProgressType=n.ProgressType,s(i(157)),s(i(158));const r=i(169),o=i(170);!function(e){let t,i,s,n,a,c;!function(e){e.method=r.CallHierarchyPrepareRequest.method,e.type=r.CallHierarchyPrepareRequest.type}(t=e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})),function(e){e.method=r.CallHierarchyIncomingCallsRequest.method,e.type=r.CallHierarchyIncomingCallsRequest.type}(i=e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})),function(e){e.method=r.CallHierarchyOutgoingCallsRequest.method,e.type=r.CallHierarchyOutgoingCallsRequest.type}(s=e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={})),e.SemanticTokenTypes=o.SemanticTokenTypes,e.SemanticTokenModifiers=o.SemanticTokenModifiers,e.SemanticTokens=o.SemanticTokens,function(e){e.method=o.SemanticTokensRequest.method,e.type=o.SemanticTokensRequest.type}(n=e.SemanticTokensRequest||(e.SemanticTokensRequest={})),function(e){e.method=o.SemanticTokensEditsRequest.method,e.type=o.SemanticTokensEditsRequest.type}(a=e.SemanticTokensEditsRequest||(e.SemanticTokensEditsRequest={})),function(e){e.method=o.SemanticTokensRangeRequest.method,e.type=o.SemanticTokensRangeRequest.type}(c=e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={}))}(t.Proposed||(t.Proposed={})),t.createProtocolConnection=function(e,t,i,s){return n.createMessageConnection(e,t,i,s)}},function(e,t,i){const s=i(39),{MAX_LENGTH:n,MAX_SAFE_INTEGER:r}=i(38),{re:o,t:a}=i(23),{compareIdentifiers:c}=i(53);class l{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=e.trim().match(t.loose?o[a.LOOSE]:o[a.FULL]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],n=e.prerelease[t];if(s("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return c(i,n)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const i=this.build[t],n=e.build[t];if(s("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return c(i,n)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(29),n=i(7),r=i(18),o=i(2),a=i(8),c=i(3);class l extends s.EventEmitter{fire(e){this.emit("log",e)}onLog(e){return this.on("log",e),{dispose:()=>{this.removeListener("log",e)}}}}t.EmittingLogger=class{constructor(){this.onLogEmitter=new l,this.onLog=e=>this.onLogEmitter.onLog(e)}log(e,t,i=a.LogCategory.General){this.onLogEmitter.fire(new u(e,t,i))}info(e,t){this.log(e,a.LogSeverity.Info,t)}warn(e,t){this.log(c.errorString(e),a.LogSeverity.Warn,t)}error(e,t){this.log(c.errorString(e),a.LogSeverity.Error,t)}dispose(){this.onLogEmitter.removeAllListeners()}};class u{constructor(e,t,i){this.message=e,this.severity=t,this.category=i}toLine(e){const t=(e&&this.message&&this.message.length>e?this.message.substring(0,e)+"…":this.message||"<empty message>").trimRight();return`${`[${(new Date).toLocaleTimeString()}]`} ${`[${a.LogCategory[this.category]}] [${a.LogSeverity[this.severity]}]`} ${t}`}}t.CategoryLogger=class{constructor(e,t){this.base=e,this.defaultCategory=t}info(e,t=this.defaultCategory){this.base.info(e,t)}warn(e,t=this.defaultCategory){this.base.warn(e,t)}error(e,t=this.defaultCategory){this.base.error(e,t)}};t.nullLogger=new class{info(e,t){}warn(e,t){}error(e,t){}},t.logProcess=function(e,t,i){const s=`(PROC ${i.pid})`;e.info(s+" Logging data for process...",t),i.stdout.on("data",i=>e.info(`${s} ${i}`,t)),i.stderr.on("data",i=>e.info(`${s} ${i}`,t)),i.on("close",(i,n)=>e.info(`${s} closed (${i}, ${n})`,t)),i.on("exit",(i,n)=>e.info(`${s} exited (${i}, ${n})`,t))},t.logToConsole=function(e){e.onLog(e=>{e.severity===a.LogSeverity.Error?console.error(e.toLine(1e3)):e.severity===a.LogSeverity.Warn&&console.warn(e.toLine(1e3))})},t.captureLogs=function(e,t,i,s,c,l=!1){if(!t||!o.isAbsolute(t))throw new Error("Path passed to logTo must be an absolute path");const u=(e=!1)=>e?`[${(new Date).toTimeString()}] `:`[${(new Date).toLocaleTimeString()}] `;let d=n.createWriteStream(t);i&&d.write(i),d.write(`${(new Date).toDateString()} ${u(!0)}Log file started${r.EOL}`);let h=e.onLog(e=>{if(!d)return;(!c||(l?-1===c.indexOf(e.category):-1!==c.indexOf(e.category))||e.severity===a.LogSeverity.Warn||e.severity===a.LogSeverity.Error)&&d.write(`${e.toLine(s)}${r.EOL}`)});return{dispose:()=>(h&&(h.dispose(),h=void 0),new Promise(e=>{d&&(d.write(`${(new Date).toDateString()} ${u(!0)}Log file ended${r.EOL}`),d.end(e),d=void 0)}))}};t.RingLog=class{constructor(e){this.size=e,this.pointer=0,this.lines=new Array(this.size)}get rawLines(){return this.lines}log(e){this.lines[this.pointer]=e,this.pointer=(this.pointer+1)%this.size}toString(){return this.lines.slice(this.pointer,this.size).concat(this.lines.slice(0,this.pointer)).filter(e=>e).join("\n")}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(8),n=i(12),r=i(43),o=i(86);let a={},c=[];function l(e){a={},c=[],a.FLUTTER_HOST="VSCode",a.PUB_ENVIRONMENT=(a.PUB_ENVIRONMENT?a.PUB_ENVIRONMENT+":":"")+"vscode.dart-code",process.env.DART_CODE_IS_TEST_RUN&&(a.PUB_ENVIRONMENT+=".test.bot",c.push("--suppress-analytics")),e&&(a=Object.assign(a,e))}function u(e,t,i,s){return r.safeSpawn(e,t,i,{envOverrides:s,toolEnv:a})}t.getToolEnv=function(){return a},t.getGlobalFlutterArgs=function(){return c},t.setupToolEnv=l,l(),t.safeToolSpawn=u,t.runProcess=function(e,t,i,r,a){return new Promise(c=>{e.info(`Spawning ${i} with args ${JSON.stringify(r)} in ${t} with env ${JSON.stringify(a)}`);const l=u(t,i,r,a);n.logProcess(e,s.LogCategory.CommandProcesses,l);const h=[],p=[];l.stdout.on("data",e=>h.push(e.toString())),l.stderr.on("data",e=>p.push(e.toString())),l.on("exit",e=>{c(new d(o.nullToUndefined(e),h.join(""),p.join("")))})})};class d{constructor(e,t,i){this.exitCode=e,this.stdout=t,this.stderr=i}}t.RunProcessResult=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(0),o=i(4),a=i(81);function c(e){return JSON.parse(s.readFileSync(e).toString())}function l(){return void 0!==r.extensions.getExtension(o.flutterExtensionIdentifier)}t.extensionPath=r.extensions.getExtension(o.dartCodeExtensionIdentifier).extensionPath,t.extensionVersion=c(n.join(t.extensionPath,"package.json")).version,t.vsCodeVersionConstraint=c(n.join(t.extensionPath,"package.json")).engines.vscode,t.isDevExtension=t.extensionVersion.endsWith("-dev"),t.hasFlutterExtension=l(),t.docsIconPathFormat=r.Uri.file(n.join(t.extensionPath,"media/doc-icons/material/")).toString()+"$1%402x.png",t.readJson=c,t.checkHasFlutterExtension=l,t.cleanDartdoc=function(e){return a.cleanDartdoc(e,t.docsIconPathFormat)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20);class n extends s.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=n;class r extends s.RequestType{constructor(e){super(e)}}t.ProtocolRequestType=r;class o extends s.NotificationType{constructor(e){super(e)}}t.ProtocolNotificationType=o;class a extends s.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a},function(e,t,i){const s=i(11);e.exports=(e,t,i)=>new s(e,i).compare(new s(t,i))},function(e,t,i){class s{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof s)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new s(e.raw,t);if(e instanceof n)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=this.options.loose;e=e.trim();const i=t?a[c.HYPHENRANGELOOSE]:a[c.HYPHENRANGE];e=e.replace(i,T(this.options.includePrerelease)),r("hyphen replace",e),e=e.replace(a[c.COMPARATORTRIM],l),r("comparator trim",e,a[c.COMPARATORTRIM]),e=(e=(e=e.replace(a[c.TILDETRIM],u)).replace(a[c.CARETTRIM],d)).split(/\s+/).join(" ");const s=t?a[c.COMPARATORLOOSE]:a[c.COMPARATOR];return e.split(" ").map(e=>p(e,this.options)).join(" ").split(/\s+/).map(e=>C(e,this.options)).filter(this.options.loose?e=>!!e.match(s):()=>!0).map(e=>new n(e,this.options))}intersects(e,t){if(!(e instanceof s))throw new TypeError("a Range is required");return this.set.some(i=>h(i,t)&&e.set.some(e=>h(e,t)&&i.every(i=>e.every(e=>i.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(E(this.set[t],e,this.options))return!0;return!1}}e.exports=s;const n=i(41),r=i(39),o=i(11),{re:a,t:c,comparatorTrimReplace:l,tildeTrimReplace:u,caretTrimReplace:d}=i(23),h=(e,t)=>{let i=!0;const s=e.slice();let n=s.pop();for(;i&&s.length;)i=s.every(e=>n.intersects(e,t)),n=s.pop();return i},p=(e,t)=>(r("comp",e,t),e=v(e,t),r("caret",e),e=f(e,t),r("tildes",e),e=b(e,t),r("xrange",e),e=S(e,t),r("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,f=(e,t)=>e.trim().split(/\s+/).map(e=>m(e,t)).join(" "),m=(e,t)=>{const i=t.loose?a[c.TILDELOOSE]:a[c.TILDE];return e.replace(i,(t,i,s,n,o)=>{let a;return r("tilde",e,t,i,s,n,o),g(i)?a="":g(s)?a=`>=${i}.0.0 <${+i+1}.0.0-0`:g(n)?a=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:o?(r("replaceTilde pr",o),a=`>=${i}.${s}.${n}-${o} <${i}.${+s+1}.0-0`):a=`>=${i}.${s}.${n} <${i}.${+s+1}.0-0`,r("tilde return",a),a})},v=(e,t)=>e.trim().split(/\s+/).map(e=>y(e,t)).join(" "),y=(e,t)=>{r("caret",e,t);const i=t.loose?a[c.CARETLOOSE]:a[c.CARET],s=t.includePrerelease?"-0":"";return e.replace(i,(t,i,n,o,a)=>{let c;return r("caret",e,t,i,n,o,a),g(i)?c="":g(n)?c=`>=${i}.0.0${s} <${+i+1}.0.0-0`:g(o)?c="0"===i?`>=${i}.${n}.0${s} <${i}.${+n+1}.0-0`:`>=${i}.${n}.0${s} <${+i+1}.0.0-0`:a?(r("replaceCaret pr",a),c="0"===i?"0"===n?`>=${i}.${n}.${o}-${a} <${i}.${n}.${+o+1}-0`:`>=${i}.${n}.${o}-${a} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${o}-${a} <${+i+1}.0.0-0`):(r("no pr"),c="0"===i?"0"===n?`>=${i}.${n}.${o}${s} <${i}.${n}.${+o+1}-0`:`>=${i}.${n}.${o}${s} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${o} <${+i+1}.0.0-0`),r("caret return",c),c})},b=(e,t)=>(r("replaceXRanges",e,t),e.split(/\s+/).map(e=>w(e,t)).join(" ")),w=(e,t)=>{e=e.trim();const i=t.loose?a[c.XRANGELOOSE]:a[c.XRANGE];return e.replace(i,(i,s,n,o,a,c)=>{r("xRange",e,i,s,n,o,a,c);const l=g(n),u=l||g(o),d=u||g(a),h=d;return"="===s&&h&&(s=""),c=t.includePrerelease?"-0":"",l?i=">"===s||"<"===s?"<0.0.0-0":"*":s&&h?(u&&(o=0),a=0,">"===s?(s=">=",u?(n=+n+1,o=0,a=0):(o=+o+1,a=0)):"<="===s&&(s="<",u?n=+n+1:o=+o+1),"<"===s&&(c="-0"),i=`${s+n}.${o}.${a}${c}`):u?i=`>=${n}.0.0${c} <${+n+1}.0.0-0`:d&&(i=`>=${n}.${o}.0${c} <${n}.${+o+1}.0-0`),r("xRange return",i),i})},S=(e,t)=>(r("replaceStars",e,t),e.trim().replace(a[c.STAR],"")),C=(e,t)=>(r("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,i,s,n,r,o,a,c,l,u,d,h,p)=>`${i=g(s)?"":g(n)?`>=${s}.0.0${e?"-0":""}`:g(r)?`>=${s}.${n}.0${e?"-0":""}`:o?">="+i:`>=${i}${e?"-0":""}`} ${c=g(l)?"":g(u)?`<${+l+1}.0.0-0`:g(d)?`<${l}.${+u+1}.0-0`:h?`<=${l}.${u}.${d}-${h}`:e?`<${l}.${u}.${+d+1}-0`:"<="+c}`.trim(),E=(e,t,i)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(let i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==n.ANY&&e[i].semver.prerelease.length>0){const s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}},function(e,t){e.exports=require("os")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(171),o=i(172),a=i(35),c=i(173),l=i(91),u=i(92);!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(10));class d{error(e){console.error(e)}warn(e){console.warn(e)}info(e){console.info(e)}log(e){console.log(e)}}var h,p,g,f,m;!function(e){e[e.Continue=1]="Continue",e[e.Shutdown=2]="Shutdown"}(h=t.ErrorAction||(t.ErrorAction={})),function(e){e[e.DoNotRestart=1]="DoNotRestart",e[e.Restart=2]="Restart"}(p=t.CloseAction||(t.CloseAction={}));class v{constructor(e){this.name=e,this.restarts=[]}error(e,t,i){return i&&i<=3?h.Continue:h.Shutdown}closed(){if(this.restarts.push(Date.now()),this.restarts.length<5)return p.Restart;return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?(s.window.showErrorMessage(`The ${this.name} server crashed 5 times in the last 3 minutes. The server will not be restarted.`),p.DoNotRestart):(this.restarts.shift(),p.Restart)}}!function(e){e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Never=4]="Never"}(g=t.RevealOutputChannelOn||(t.RevealOutputChannelOn={})),function(e){e[e.Stopped=1]="Stopped",e[e.Starting=3]="Starting",e[e.Running=2]="Running"}(f=t.State||(t.State={})),function(e){e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.StartFailed=2]="StartFailed",e[e.Running=3]="Running",e[e.Stopping=4]="Stopping",e[e.Stopped=5]="Stopped"}(m||(m={}));const y=[n.SymbolKind.File,n.SymbolKind.Module,n.SymbolKind.Namespace,n.SymbolKind.Package,n.SymbolKind.Class,n.SymbolKind.Method,n.SymbolKind.Property,n.SymbolKind.Field,n.SymbolKind.Constructor,n.SymbolKind.Enum,n.SymbolKind.Interface,n.SymbolKind.Function,n.SymbolKind.Variable,n.SymbolKind.Constant,n.SymbolKind.String,n.SymbolKind.Number,n.SymbolKind.Boolean,n.SymbolKind.Array,n.SymbolKind.Object,n.SymbolKind.Key,n.SymbolKind.Null,n.SymbolKind.EnumMember,n.SymbolKind.Struct,n.SymbolKind.Event,n.SymbolKind.Operator,n.SymbolKind.TypeParameter],b=[n.CompletionItemKind.Text,n.CompletionItemKind.Method,n.CompletionItemKind.Function,n.CompletionItemKind.Constructor,n.CompletionItemKind.Field,n.CompletionItemKind.Variable,n.CompletionItemKind.Class,n.CompletionItemKind.Interface,n.CompletionItemKind.Module,n.CompletionItemKind.Property,n.CompletionItemKind.Unit,n.CompletionItemKind.Value,n.CompletionItemKind.Enum,n.CompletionItemKind.Keyword,n.CompletionItemKind.Snippet,n.CompletionItemKind.Color,n.CompletionItemKind.File,n.CompletionItemKind.Reference,n.CompletionItemKind.Folder,n.CompletionItemKind.EnumMember,n.CompletionItemKind.Constant,n.CompletionItemKind.Struct,n.CompletionItemKind.Event,n.CompletionItemKind.Operator,n.CompletionItemKind.TypeParameter];function w(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var S;!function(e){e.is=function(e){let t=e;return t&&a.func(t.register)&&a.func(t.unregister)&&a.func(t.dispose)&&void 0!==t.messages}}(S||(S={}));class C{constructor(e,t,i,s,n,r){this._client=e,this._event=t,this._type=i,this._middleware=s,this._createParams=n,this._selectorFilter=r,this._selectors=new Map}static textDocumentFilter(e,t){for(const i of e)if(s.languages.match(i,t))return!0;return!1}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){this._selectorFilter&&!this._selectorFilter(this._selectors.values(),e)||(this._middleware?this._middleware(e,e=>this._client.sendNotification(this._type,this._createParams(e))):this._client.sendNotification(this._type,this._createParams(e)),this.notificationSent(e))}notificationSent(e){}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const t of this._selectors.values())if(s.languages.match(t,e))return{send:e=>{this.callback(e)}};throw new Error("No provider available for the given text document")}}class T extends C{constructor(e,t){super(e,s.workspace.onDidOpenTextDocument,n.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t),C.textDocumentFilter),this._syncedDocuments=t}get messages(){return n.DidOpenTextDocumentNotification.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){if(super.register(e,t),!t.registerOptions.documentSelector)return;let i=t.registerOptions.documentSelector;s.workspace.textDocuments.forEach(e=>{let t=e.uri.toString();if(!this._syncedDocuments.has(t)&&s.languages.match(i,e)){let i=this._client.clientOptions.middleware,s=e=>{this._client.sendNotification(this._type,this._createParams(e))};i.didOpen?i.didOpen(e,s):s(e),this._syncedDocuments.set(t,e)}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.set(e.uri.toString(),e)}}class E extends C{constructor(e,t){super(e,s.workspace.onDidCloseTextDocument,n.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t),C.textDocumentFilter),this._syncedDocuments=t}get messages(){return n.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let i=this._selectors.values();this._syncedDocuments.forEach(e=>{if(s.languages.match(t,e)&&!this._selectorFilter(i,e)){let t=this._client.clientOptions.middleware,i=e=>{this._client.sendNotification(this._type,this._createParams(e))};this._syncedDocuments.delete(e.uri.toString()),t.didClose?t.didClose(e,i):i(e)}})}}class R{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1}get messages(){return n.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&void 0!==i.change&&i.change!==n.TextDocumentSyncKind.None&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:i.change})})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=s.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(t.id,{documentSelector:t.registerOptions.documentSelector,syncKind:t.registerOptions.syncKind}))}callback(e){if(0!==e.contentChanges.length)for(const t of this._changeData.values())if(s.languages.match(t.documentSelector,e.document)){let i=this._client.clientOptions.middleware;if(t.syncKind===n.TextDocumentSyncKind.Incremental){let t=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e);i.didChange?i.didChange(e,()=>this._client.sendNotification(n.DidChangeTextDocumentNotification.type,t)):this._client.sendNotification(n.DidChangeTextDocumentNotification.type,t)}else if(t.syncKind===n.TextDocumentSyncKind.Full){let t=e=>{this._changeDelayer?(this._changeDelayer.uri!==e.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=e.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(n.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))})):(this._changeDelayer={uri:e.document.uri.toString(),delayer:new c.Delayer(200)},this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(n.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))},-1))};i.didChange?i.didChange(e,t):t(e)}}}unregister(e){this._changeData.delete(e),0===this._changeData.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!this._forcingDelivery&&this._changeDelayer)try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(const t of this._changeData.values())if(s.languages.match(t.documentSelector,e))return{send:e=>{this.callback(e)}};throw new Error("No provider available for the given text document")}}class P extends C{constructor(e){super(e,s.workspace.onWillSaveTextDocument,n.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(e,t)=>C.textDocumentFilter(e,t.document))}get messages(){return n.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSave&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}}class D{constructor(e){this._client=e,this._selectors=new Map}get messages(){return n.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSaveWaitUntil&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=s.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){if(C.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,i=e=>this._client.sendRequest(n.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then(e=>{let t=this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,i):i(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}class _ extends C{constructor(e){super(e,s.workspace.onDidSaveTextDocument,n.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),C.textDocumentFilter)}get messages(){return n.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){w(w(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.save&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{includeText:!!i.save.includeText})})}register(e,t){this._includeText=!!t.registerOptions.includeText,super.register(e,t)}}class k{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get messages(){return n.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){w(w(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e,t){if(!Array.isArray(t.registerOptions.watchers))return;let i=[];for(let e of t.registerOptions.watchers){if(!a.string(e.globPattern))continue;let t=!0,r=!0,o=!0;void 0!==e.kind&&null!==e.kind&&(t=0!=(e.kind&n.WatchKind.Create),r=0!=(e.kind&n.WatchKind.Change),o=0!=(e.kind&n.WatchKind.Delete));let c=s.workspace.createFileSystemWatcher(e.globPattern,!t,!r,!o);this.hookListeners(c,t,r,o),i.push(c)}this._watchers.set(t.id,i)}registerRaw(e,t){let i=[];for(let e of t)this.hookListeners(e,!0,!0,!0,i);this._watchers.set(e,i)}hookListeners(e,t,i,s,r){t&&e.onDidCreate(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:n.FileChangeType.Created}),null,r),i&&e.onDidChange(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:n.FileChangeType.Changed}),null,r),s&&e.onDidDelete(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:n.FileChangeType.Deleted}),null,r)}unregister(e){let t=this._watchers.get(e);if(t)for(let e of t)e.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}}class x{constructor(e,t){this._client=e,this._message=t,this._registrations=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wrong feature. Requested ${e.method} but reached feature ${this.messages.method}`);if(!t.registerOptions.documentSelector)return;let i=this.registerLanguageProvider(t.registerOptions);this._registrations.set(t.id,{disposable:i[0],data:t,provider:i[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(!t)return[void 0,void 0];if(n.TextDocumentRegistrationOptions.is(t)){const i=n.StaticRegistrationOptions.hasId(t)?t.id:l.generateUuid(),s=t.documentSelector||e;if(s)return[i,Object.assign({},t,{documentSelector:s})]}else if(a.boolean(t)&&!0===t||n.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let i=a.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[l.generateUuid(),i]}return[void 0,void 0]}getRegistrationOptions(e,t){if(e&&t)return a.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const t of this._registrations.values()){let i=t.data.registerOptions.documentSelector;if(null!==i&&s.languages.match(i,e))return t.provider}throw new Error("The feature has no registration for the provided text document "+e.uri.toString())}}t.TextDocumentFeature=x;class O extends x{constructor(e){super(e,n.CompletionRequest.type)}fillClientCapabilities(e){let t=w(w(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[n.MarkupKind.Markdown,n.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[n.CompletionItemTag.Deprecated]}},t.completionItemKind={valueSet:b}}initialize(e,t){const i=this.getRegistrationOptions(t,e.completionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.triggerCharacters||[],i={provideCompletionItems:(e,t,i,s)=>{const r=this._client,o=this._client.clientOptions.middleware,a=(e,t,i,s)=>r.sendRequest(n.CompletionRequest.type,r.code2ProtocolConverter.asCompletionParams(e,t,i),s).then(r.protocol2CodeConverter.asCompletionResult,e=>(r.logFailedRequest(n.CompletionRequest.type,e),Promise.resolve([])));return o.provideCompletionItem?o.provideCompletionItem(e,t,s,i,a):a(e,t,s,i)},resolveCompletionItem:e.resolveProvider?(e,t)=>{const i=this._client,s=this._client.clientOptions.middleware,r=(e,t)=>i.sendRequest(n.CompletionResolveRequest.type,i.code2ProtocolConverter.asCompletionItem(e),t).then(i.protocol2CodeConverter.asCompletionItem,t=>(i.logFailedRequest(n.CompletionResolveRequest.type,t),Promise.resolve(e)));return s.resolveCompletionItem?s.resolveCompletionItem(e,t,r):r(e,t)}:void 0};return[s.languages.registerCompletionItemProvider(e.documentSelector,i,...t),i]}}class F extends x{constructor(e){super(e,n.HoverRequest.type)}fillClientCapabilities(e){const t=w(w(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[n.MarkupKind.Markdown,n.MarkupKind.PlainText]}initialize(e,t){const i=this.getRegistrationOptions(t,e.hoverProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideHover:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.HoverRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asHover,e=>(s.logFailedRequest(n.HoverRequest.type,e),Promise.resolve(null))),o=s.clientOptions.middleware;return o.provideHover?o.provideHover(e,t,i,r):r(e,t,i)}};return[s.languages.registerHoverProvider(e.documentSelector,t),t]}}class I extends x{constructor(e){super(e,n.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=w(w(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[n.MarkupKind.Markdown,n.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.contextSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.signatureHelpProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideSignatureHelp:(e,t,i,s)=>{const r=this._client,o=(e,t,i,s)=>r.sendRequest(n.SignatureHelpRequest.type,r.code2ProtocolConverter.asSignatureHelpParams(e,t,i),s).then(r.protocol2CodeConverter.asSignatureHelp,e=>(r.logFailedRequest(n.SignatureHelpRequest.type,e),Promise.resolve(null))),a=r.clientOptions.middleware;return a.provideSignatureHelp?a.provideSignatureHelp(e,t,s,i,o):o(e,t,s,i)}};let i;if(void 0===e.retriggerCharacters){const n=e.triggerCharacters||[];i=s.languages.registerSignatureHelpProvider(e.documentSelector,t,...n)}else{const n={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};i=s.languages.registerSignatureHelpProvider(e.documentSelector,t,n)}return[i,t]}}class L extends x{constructor(e){super(e,n.DefinitionRequest.type)}fillClientCapabilities(e){let t=w(w(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.definitionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDefinition:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.DefinitionRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asDefinitionResult,e=>(s.logFailedRequest(n.DefinitionRequest.type,e),Promise.resolve(null))),o=s.clientOptions.middleware;return o.provideDefinition?o.provideDefinition(e,t,i,r):r(e,t,i)}};return[s.languages.registerDefinitionProvider(e.documentSelector,t),t]}}class A extends x{constructor(e){super(e,n.ReferencesRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.referencesProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideReferences:(e,t,i,s)=>{const r=this._client,o=(e,t,i,s)=>r.sendRequest(n.ReferencesRequest.type,r.code2ProtocolConverter.asReferenceParams(e,t,i),s).then(r.protocol2CodeConverter.asReferences,e=>(r.logFailedRequest(n.ReferencesRequest.type,e),Promise.resolve([]))),a=r.clientOptions.middleware;return a.provideReferences?a.provideReferences(e,t,i,s,o):o(e,t,i,s)}};return[s.languages.registerReferenceProvider(e.documentSelector,t),t]}}class N extends x{constructor(e){super(e,n.DocumentHighlightRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentHighlightProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentHighlights:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.DocumentHighlightRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asDocumentHighlights,e=>(s.logFailedRequest(n.DocumentHighlightRequest.type,e),Promise.resolve([]))),o=s.clientOptions.middleware;return o.provideDocumentHighlights?o.provideDocumentHighlights(e,t,i,r):r(e,t,i)}};return[s.languages.registerDocumentHighlightProvider(e.documentSelector,t),t]}}class M extends x{constructor(e){super(e,n.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=w(w(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y},t.hierarchicalDocumentSymbolSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentSymbolProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentSymbols:(e,t)=>{const i=this._client,s=(e,t)=>i.sendRequest(n.DocumentSymbolRequest.type,i.code2ProtocolConverter.asDocumentSymbolParams(e),t).then(e=>{if(null!==e){if(0===e.length)return[];{let t=e[0];return n.DocumentSymbol.is(t)?i.protocol2CodeConverter.asDocumentSymbols(e):i.protocol2CodeConverter.asSymbolInformations(e)}}},e=>(i.logFailedRequest(n.DocumentSymbolRequest.type,e),Promise.resolve([]))),r=i.clientOptions.middleware;return r.provideDocumentSymbols?r.provideDocumentSymbols(e,t,s):s(e,t)}};return[s.languages.registerDocumentSymbolProvider(e.documentSelector,t),t]}}class U extends class{constructor(e,t){this._client=e,this._message=t,this._registrations=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wron feature. Requested ${e.method} but reached feature ${this.messages.method}`);const i=this.registerLanguageProvider(t.registerOptions);this._registrations.set(t.id,{disposable:i[0],provider:i[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}{constructor(e){super(e,n.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=w(w(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y}}initialize(e){e.workspaceSymbolProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:!0===e.workspaceSymbolProvider?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(e,t)=>{const i=this._client,s=(e,t)=>i.sendRequest(n.WorkspaceSymbolRequest.type,{query:e},t).then(i.protocol2CodeConverter.asSymbolInformations,e=>(i.logFailedRequest(n.WorkspaceSymbolRequest.type,e),Promise.resolve([]))),r=i.clientOptions.middleware;return r.provideWorkspaceSymbols?r.provideWorkspaceSymbols(e,t,s):s(e,t)}};return[s.languages.registerWorkspaceSymbolProvider(t),t]}}class q extends x{constructor(e){super(e,n.CodeActionRequest.type)}fillClientCapabilities(e){const t=w(w(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.codeActionLiteralSupport={codeActionKind:{valueSet:[n.CodeActionKind.Empty,n.CodeActionKind.QuickFix,n.CodeActionKind.Refactor,n.CodeActionKind.RefactorExtract,n.CodeActionKind.RefactorInline,n.CodeActionKind.RefactorRewrite,n.CodeActionKind.Source,n.CodeActionKind.SourceOrganizeImports]}}}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeActionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideCodeActions:(e,t,i,s)=>{const r=this._client,o=(e,t,i,s)=>{const o={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),range:r.code2ProtocolConverter.asRange(t),context:r.code2ProtocolConverter.asCodeActionContext(i)};return r.sendRequest(n.CodeActionRequest.type,o,s).then(e=>{if(null===e)return;const t=[];for(let i of e)n.Command.is(i)?t.push(r.protocol2CodeConverter.asCommand(i)):t.push(r.protocol2CodeConverter.asCodeAction(i));return t},e=>(r.logFailedRequest(n.CodeActionRequest.type,e),Promise.resolve([])))},a=r.clientOptions.middleware;return a.provideCodeActions?a.provideCodeActions(e,t,i,s,o):o(e,t,i,s)}};return[s.languages.registerCodeActionsProvider(e.documentSelector,t,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),t]}}class $ extends x{constructor(e){super(e,n.CodeLensRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"codeLens").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideCodeLenses:(e,t)=>{const i=this._client,s=(e,t)=>i.sendRequest(n.CodeLensRequest.type,i.code2ProtocolConverter.asCodeLensParams(e),t).then(i.protocol2CodeConverter.asCodeLenses,e=>(i.logFailedRequest(n.CodeLensRequest.type,e),Promise.resolve([]))),r=i.clientOptions.middleware;return r.provideCodeLenses?r.provideCodeLenses(e,t,s):s(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{const i=this._client,s=(e,t)=>i.sendRequest(n.CodeLensResolveRequest.type,i.code2ProtocolConverter.asCodeLens(e),t).then(i.protocol2CodeConverter.asCodeLens,t=>(i.logFailedRequest(n.CodeLensResolveRequest.type,t),e)),r=i.clientOptions.middleware;return r.resolveCodeLens?r.resolveCodeLens(e,t,s):s(e,t)}:void 0};return[s.languages.registerCodeLensProvider(e.documentSelector,t),t]}}class j extends x{constructor(e){super(e,n.DocumentFormattingRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentFormattingEdits:(e,t,i)=>{const s=this._client,r=(e,t,i)=>{const r={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),options:s.code2ProtocolConverter.asFormattingOptions(t)};return s.sendRequest(n.DocumentFormattingRequest.type,r,i).then(s.protocol2CodeConverter.asTextEdits,e=>(s.logFailedRequest(n.DocumentFormattingRequest.type,e),Promise.resolve([])))},o=s.clientOptions.middleware;return o.provideDocumentFormattingEdits?o.provideDocumentFormattingEdits(e,t,i,r):r(e,t,i)}};return[s.languages.registerDocumentFormattingEditProvider(e.documentSelector,t),t]}}class W extends x{constructor(e){super(e,n.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentRangeFormattingEdits:(e,t,i,s)=>{const r=this._client,o=(e,t,i,s)=>{let o={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),range:r.code2ProtocolConverter.asRange(t),options:r.code2ProtocolConverter.asFormattingOptions(i)};return r.sendRequest(n.DocumentRangeFormattingRequest.type,o,s).then(r.protocol2CodeConverter.asTextEdits,e=>(r.logFailedRequest(n.DocumentRangeFormattingRequest.type,e),Promise.resolve([])))};let a=r.clientOptions.middleware;return a.provideDocumentRangeFormattingEdits?a.provideDocumentRangeFormattingEdits(e,t,i,s,o):o(e,t,i,s)}};return[s.languages.registerDocumentRangeFormattingEditProvider(e.documentSelector,t),t]}}class z extends x{constructor(e){super(e,n.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){w(w(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideOnTypeFormattingEdits:(e,t,i,s,r)=>{const o=this._client,a=(e,t,i,s,r)=>{let a={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),position:o.code2ProtocolConverter.asPosition(t),ch:i,options:o.code2ProtocolConverter.asFormattingOptions(s)};return o.sendRequest(n.DocumentOnTypeFormattingRequest.type,a,r).then(o.protocol2CodeConverter.asTextEdits,e=>(o.logFailedRequest(n.DocumentOnTypeFormattingRequest.type,e),Promise.resolve([])))},c=o.clientOptions.middleware;return c.provideOnTypeFormattingEdits?c.provideOnTypeFormattingEdits(e,t,i,s,r,a):a(e,t,i,s,r)}},i=e.moreTriggerCharacter||[];return[s.languages.registerOnTypeFormattingEditProvider(e.documentSelector,t,e.firstTriggerCharacter,...i),t]}}class B extends x{constructor(e){super(e,n.RenameRequest.type)}fillClientCapabilities(e){let t=w(w(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.renameProvider);i&&(a.boolean(e.renameProvider)&&(i.prepareProvider=!1),this.register(this.messages,{id:l.generateUuid(),registerOptions:i}))}registerLanguageProvider(e){const t={provideRenameEdits:(e,t,i,s)=>{const r=this._client,o=(e,t,i,s)=>{let o={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),position:r.code2ProtocolConverter.asPosition(t),newName:i};return r.sendRequest(n.RenameRequest.type,o,s).then(r.protocol2CodeConverter.asWorkspaceEdit,e=>(r.logFailedRequest(n.RenameRequest.type,e),Promise.reject(new Error(e.message))))},a=r.clientOptions.middleware;return a.provideRenameEdits?a.provideRenameEdits(e,t,i,s,o):o(e,t,i,s)},prepareRename:e.prepareProvider?(e,t,i)=>{const s=this._client,r=(e,t,i)=>{let r={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),position:s.code2ProtocolConverter.asPosition(t)};return s.sendRequest(n.PrepareRenameRequest.type,r,i).then(e=>n.Range.is(e)?s.protocol2CodeConverter.asRange(e):e&&n.Range.is(e.range)?{range:s.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(new Error("The element can't be renamed.")),e=>(s.logFailedRequest(n.PrepareRenameRequest.type,e),Promise.reject(new Error(e.message))))},o=s.clientOptions.middleware;return o.prepareRename?o.prepareRename(e,t,i,r):r(e,t,i)}:void 0};return[s.languages.registerRenameProvider(e.documentSelector,t),t]}}class G extends x{constructor(e){super(e,n.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=w(w(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentLinkProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentLinks:(e,t)=>{const i=this._client,s=(e,t)=>i.sendRequest(n.DocumentLinkRequest.type,i.code2ProtocolConverter.asDocumentLinkParams(e),t).then(i.protocol2CodeConverter.asDocumentLinks,e=>(i.logFailedRequest(n.DocumentLinkRequest.type,e),Promise.resolve([]))),r=i.clientOptions.middleware;return r.provideDocumentLinks?r.provideDocumentLinks(e,t,s):s(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{const i=this._client;let s=(e,t)=>i.sendRequest(n.DocumentLinkResolveRequest.type,i.code2ProtocolConverter.asDocumentLink(e),t).then(i.protocol2CodeConverter.asDocumentLink,t=>(i.logFailedRequest(n.DocumentLinkResolveRequest.type,t),Promise.resolve(e)));const r=i.clientOptions.middleware;return r.resolveDocumentLink?r.resolveDocumentLink(e,t,s):s(e,t)}:void 0};return[s.languages.registerDocumentLinkProvider(e.documentSelector,t),t]}}class V{constructor(e){this._client=e,this._listeners=new Map}get messages(){return n.DidChangeConfigurationNotification.type}fillClientCapabilities(e){w(w(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;void 0!==e&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{section:e}})}register(e,t){let i=s.workspace.onDidChangeConfiguration(e=>{this.onDidChangeConfiguration(t.registerOptions.section,e)});this._listeners.set(t.id,i),void 0!==t.registerOptions.section&&this.onDidChangeConfiguration(t.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let i;if(i=a.string(e)?[e]:e,void 0!==i&&void 0!==t){if(!i.some(e=>t.affectsConfiguration(e)))return}let s=e=>{void 0!==e?this._client.sendNotification(n.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)}):this._client.sendNotification(n.DidChangeConfigurationNotification.type,{settings:null})},r=this.getMiddleware();r?r(i,s):s(i)}extractSettingsInformation(e){function t(e,t){let i=e;for(let e=0;e<t.length-1;e++){let s=i[t[e]];s||(s=Object.create(null),i[t[e]]=s),i=s}return i}let i=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,n=Object.create(null);for(let r=0;r<e.length;r++){let o=e[r],a=o.indexOf("."),c=null;if(c=a>=0?s.workspace.getConfiguration(o.substr(0,a),i).get(o.substr(a+1)):s.workspace.getConfiguration(o,i),c){let i=e[r].split(".");t(n,i)[i[i.length-1]]=c}}return n}getMiddleware(){let e=this._client.clientOptions.middleware;return e.workspace&&e.workspace.didChangeConfiguration?e.workspace.didChangeConfiguration:void 0}}class H{constructor(e){this._client=e,this._commands=new Map}get messages(){return n.ExecuteCommandRequest.type}fillClientCapabilities(e){w(w(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e,t){const i=this._client,r=i.clientOptions.middleware,o=(e,t)=>{let s={command:e,arguments:t};return i.sendRequest(n.ExecuteCommandRequest.type,s).then(void 0,e=>{i.logFailedRequest(n.ExecuteCommandRequest.type,e)})};if(t.registerOptions.commands){const e=[];for(const i of t.registerOptions.commands)e.push(s.commands.registerCommand(i,(...e)=>r.executeCommand?r.executeCommand(i,e,o):o(i,e)));this._commands.set(t.id,e)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(e=>e.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(e=>e.dispose())}),this._commands.clear()}}!function(e){e.is=function(e){return e&&n.MessageReader.is(e.reader)&&n.MessageWriter.is(e.writer)}}(t.MessageTransports||(t.MessageTransports={}));class K{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}}t.BaseLanguageClient=class{constructor(e,t,i){this._traceFormat=n.TraceFormat.Text,this._features=[],this._method2Message=new Map,this._dynamicFeatures=new Map,this._id=e,this._name=t,i=i||{},this._clientOptions={documentSelector:i.documentSelector||[],synchronize:i.synchronize||{},diagnosticCollectionName:i.diagnosticCollectionName,outputChannelName:i.outputChannelName||this._name,revealOutputChannelOn:i.revealOutputChannelOn||g.Error,stdioEncoding:i.stdioEncoding||"utf8",initializationOptions:i.initializationOptions,initializationFailedHandler:i.initializationFailedHandler,progressOnInitialization:!!i.progressOnInitialization,errorHandler:i.errorHandler||new v(this._name),middleware:i.middleware||{},uriConverters:i.uriConverters,workspaceFolder:i.workspaceFolder},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this.state=m.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,i.outputChannel?(this._outputChannel=i.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=i.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new c.Delayer(250),this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new K(e,t)}),this._onStop=void 0,this._telemetryEmitter=new n.Emitter,this._stateChangeEmitter=new n.Emitter,this._tracer={log:(e,t)=>{a.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=r.createConverter(i.uriConverters?i.uriConverters.code2Protocol:void 0),this._p2c=o.createConverter(i.uriConverters?i.uriConverters.protocol2Code:void 0),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let i=this.getPublicState();i!==t&&this._stateChangeEmitter.fire({oldState:t,newState:i})}getPublicState(){return this.state===m.Running?f.Running:this.state===m.Starting?f.Starting:f.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(t){throw this.error(`Sending request ${a.string(e)?e:e.method} failed.`,t),t}}onRequest(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onRequest(e,t)}catch(t){throw this.error(`Registering request handler ${a.string(e)?e:e.method} failed.`,t),t}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendNotification(e,t)}catch(t){throw this.error(`Sending notification ${a.string(e)?e:e.method} failed.`,t),t}}onNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onNotification(e,t)}catch(t){throw this.error(`Registering notification handler ${a.string(e)?e:e.method} failed.`,t),t}}onProgress(e,t,i){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onProgress(e,t,i)}catch(e){throw this.error(`Registering progress handler for token ${t} failed.`,e),e}}sendProgress(e,t,i){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendProgress(e,t,i)}catch(e){throw this.error(`Sending progress for token ${t} failed.`,e),e}}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=s.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(){return new v(this._name)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(e=>{e.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})})},()=>{})}data2String(e){if(e instanceof n.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?a.string(e.stack)?e.stack:e.message:a.string(e)?e:e.toString()}info(e,t,i=!0){this.outputChannel.appendLine(`[Info  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Info&&this.showNotificationMessage()}warn(e,t,i=!0){this.outputChannel.appendLine(`[Warn  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Warn&&this.showNotificationMessage()}error(e,t,i=!0){this.outputChannel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Error&&this.showNotificationMessage()}showNotificationMessage(){s.window.showInformationMessage("A request has failed. See the output for more information.","Go to output").then(()=>{this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${(new Date).toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${(new Date).toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(""+JSON.stringify(e))}needsStart(){return this.state===m.Initial||this.state===m.Stopping||this.state===m.Stopped}needsStop(){return this.state===m.Starting||this.state===m.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===m.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new K(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?s.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):s.languages.createDiagnosticCollection()),this.state=m.Starting,this.resolveConnection().then(e=>(e.onLogMessage(e=>{switch(e.type){case n.MessageType.Error:this.error(e.message,void 0,!1);break;case n.MessageType.Warning:this.warn(e.message,void 0,!1);break;case n.MessageType.Info:this.info(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}}),e.onShowMessage(e=>{switch(e.type){case n.MessageType.Error:s.window.showErrorMessage(e.message);break;case n.MessageType.Warning:s.window.showWarningMessage(e.message);break;case n.MessageType.Info:s.window.showInformationMessage(e.message);break;default:s.window.showInformationMessage(e.message)}}),e.onRequest(n.ShowMessageRequest.type,e=>{let t;switch(e.type){case n.MessageType.Error:t=s.window.showErrorMessage;break;case n.MessageType.Warning:t=s.window.showWarningMessage;break;case n.MessageType.Info:t=s.window.showInformationMessage;break;default:t=s.window.showInformationMessage}let i=e.actions||[];return t(e.message,...i)}),e.onTelemetry(e=>{this._telemetryEmitter.fire(e)}),e.listen(),this.initialize(e))).then(void 0,e=>{this.state=m.StartFailed,this._onReadyCallbacks.reject(e),this.error("Starting client failed",e),s.window.showErrorMessage("Couldn't start client "+this._name)}),new s.Disposable(()=>{this.needsStop()&&this.stop()})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,i=this._clientOptions.workspaceFolder?this._clientOptions.workspaceFolder.uri.fsPath:this._clientGetRootPath(),r={processId:process.pid,clientInfo:{name:"vscode",version:s.version},rootPath:i||null,rootUri:i?this._c2p.asUri(s.Uri.file(i)):null,capabilities:this.computeClientCapabilities(),initializationOptions:a.func(t)?t():t,trace:n.Trace.toString(this._trace),workspaceFolders:null};if(this.fillInitializeParams(r),this._clientOptions.progressOnInitialization){const t=l.generateUuid(),i=new u.ProgressPart(e,t);return r.workDoneToken=t,this.doInitialize(e,r).then(e=>(i.done(),e),e=>{throw i.cancel(),e})}return this.doInitialize(e,r)}doInitialize(e,t){return e.initialize(t).then(t=>{this._resolvedConnection=e,this._initializeResult=t,this.state=m.Running;let i=void 0;return a.number(t.capabilities.textDocumentSync)?i=t.capabilities.textDocumentSync===n.TextDocumentSyncKind.None?{openClose:!1,change:n.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:t.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==t.capabilities.textDocumentSync&&null!==t.capabilities.textDocumentSync&&(i=t.capabilities.textDocumentSync),this._capabilities=Object.assign({},t.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(e=>this.handleDiagnostics(e)),e.onRequest(n.RegistrationRequest.type,e=>this.handleRegistrationRequest(e)),e.onRequest("client/registerFeature",e=>this.handleRegistrationRequest(e)),e.onRequest(n.UnregistrationRequest.type,e=>this.handleUnregistrationRequest(e)),e.onRequest("client/unregisterFeature",e=>this.handleUnregistrationRequest(e)),e.onRequest(n.ApplyWorkspaceEditRequest.type,e=>this.handleApplyWorkspaceEdit(e)),e.sendNotification(n.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),t}).then(void 0,t=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(t)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(t)):t instanceof n.ResponseError&&t.data&&t.data.retry?s.window.showErrorMessage(t.message,{title:"Retry",id:"retry"}).then(i=>{i&&"retry"===i.id?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(t))}):(t&&t.message&&s.window.showErrorMessage(t.message),this.error("Server initialization failed.",t),this.stop(),this._onReadyCallbacks.reject(t)),t})}_clientGetRootPath(){let e=s.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}stop(){return this._initializeResult=void 0,this._connectionPromise?this.state===m.Stopping&&this._onStop?this._onStop:(this.state=m.Stopping,this.cleanUp(!1),this._onStop=this.resolveConnection().then(e=>e.shutdown().then(()=>{e.exit(),e.dispose(),this.state=m.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0}))):(this.state=m.Stopped,Promise.resolve())}cleanUp(e=!0,t=!0){this._listeners&&(this._listeners.forEach(e=>e.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(e=>e.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let e of this._dynamicFeatures.values())e.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var t,i;const s=this;function n(e){s._fileEvents.push(e),s._fileEventDelayer.trigger(()=>{s.onReady().then(()=>{s.resolveConnection().then(e=>{s.isConnectionActive()&&(s.forceDocumentSync(),e.didChangeWatchedFiles({changes:s._fileEvents})),s._fileEvents=[]})},e=>{s.error("Notify file events failed.",e)})})}const r=null===(t=this.clientOptions.middleware)||void 0===t?void 0:t.workspace;(null===(i=r)||void 0===i?void 0:i.didChangeWatchedFile)?r.didChangeWatchedFile(e,n):n(e)}forceDocumentSync(){this._dynamicFeatures.get(n.DidChangeTextDocumentNotification.type.method).forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=this._p2c.asUri(e.uri),i=this._p2c.asDiagnostics(e.diagnostics),s=this.clientOptions.middleware;s.handleDiagnostics?s.handleDiagnostics(t,i,(e,t)=>this.setDiagnostics(e,t)):this.setDiagnostics(t,i)}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}createConnection(){let e=(e,t,i)=>{this.handleConnectionError(e,t,i)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(i=>function(e,t,i,s){let r=new d,o=n.createProtocolConnection(e,t,r);return o.onError(e=>{i(e[0],e[1],e[2])}),o.onClose(s),{listen:()=>o.listen(),sendRequest:(e,...t)=>o.sendRequest(a.string(e)?e:e.method,...t),onRequest:(e,t)=>o.onRequest(a.string(e)?e:e.method,t),sendNotification:(e,t)=>o.sendNotification(a.string(e)?e:e.method,t),onNotification:(e,t)=>o.onNotification(a.string(e)?e:e.method,t),onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(e,t,i)=>{const s={sendNotification:!1,traceFormat:n.TraceFormat.Text};void 0===i?o.trace(e,t,s):(a.boolean(i),o.trace(e,t,i))},initialize:e=>o.sendRequest(n.InitializeRequest.type,e),shutdown:()=>o.sendRequest(n.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(n.ExitNotification.type),onLogMessage:e=>o.onNotification(n.LogMessageNotification.type,e),onShowMessage:e=>o.onNotification(n.ShowMessageNotification.type,e),onTelemetry:e=>o.onNotification(n.TelemetryEventNotification.type,e),didChangeConfiguration:e=>o.sendNotification(n.DidChangeConfigurationNotification.type,e),didChangeWatchedFiles:e=>o.sendNotification(n.DidChangeWatchedFilesNotification.type,e),didOpenTextDocument:e=>o.sendNotification(n.DidOpenTextDocumentNotification.type,e),didChangeTextDocument:e=>o.sendNotification(n.DidChangeTextDocumentNotification.type,e),didCloseTextDocument:e=>o.sendNotification(n.DidCloseTextDocumentNotification.type,e),didSaveTextDocument:e=>o.sendNotification(n.DidSaveTextDocumentNotification.type,e),onDiagnostics:e=>o.onNotification(n.PublishDiagnosticsNotification.type,e),dispose:()=>o.dispose()}}(i.reader,i.writer,e,t))}handleConnectionClosed(){if(this.state===m.Stopping||this.state===m.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch(e){}let e=p.DoNotRestart;try{e=this._clientOptions.errorHandler.closed()}catch(e){}this._connectionPromise=void 0,this._resolvedConnection=void 0,e===p.DoNotRestart?(this.error("Connection to server got closed. Server will not be restarted."),this.state=m.Stopped,this.cleanUp(!1,!0)):e===p.Restart&&(this.info("Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=m.Initial,this.start())}handleConnectionError(e,t,i){this._clientOptions.errorHandler.error(e,t,i)===h.Shutdown&&(this.error("Connection to server is erroring. Shutting down server."),this.stop())}hookConfigurationChanged(e){s.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let i=s.workspace.getConfiguration(this._id),r=n.Trace.Off,o=n.TraceFormat.Text;if(i){const e=i.get("trace.server","off");"string"==typeof e?r=n.Trace.fromString(e):(r=n.Trace.fromString(i.get("trace.server.verbosity","off")),o=n.TraceFormat.fromString(i.get("trace.server.format","text")))}this._trace=r,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t,i=this._clientOptions.synchronize.fileEvents;i&&(t=a.array(i)?i:[i],t&&this._dynamicFeatures.get(n.DidChangeWatchedFilesNotification.type.method).registerRaw(l.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),S.is(e)){let t=e.messages;if(Array.isArray(t))for(let i of t)this._method2Message.set(i.method,i),this._dynamicFeatures.set(i.method,e);else this._method2Message.set(t.method,t),this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new V(this)),this.registerFeature(new T(this,this._syncedDocuments)),this.registerFeature(new R(this)),this.registerFeature(new P(this)),this.registerFeature(new D(this)),this.registerFeature(new _(this)),this.registerFeature(new E(this,this._syncedDocuments)),this.registerFeature(new k(this,e=>this.notifyFileEvent(e))),this.registerFeature(new O(this)),this.registerFeature(new F(this)),this.registerFeature(new I(this)),this.registerFeature(new L(this)),this.registerFeature(new A(this)),this.registerFeature(new N(this)),this.registerFeature(new M(this)),this.registerFeature(new U(this)),this.registerFeature(new q(this)),this.registerFeature(new $(this)),this.registerFeature(new j(this)),this.registerFeature(new W(this)),this.registerFeature(new z(this)),this.registerFeature(new B(this)),this.registerFeature(new G(this)),this.registerFeature(new H(this))}fillInitializeParams(e){for(let t of this._features)a.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};w(e,"workspace").applyEdit=!0;let t=w(w(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[n.ResourceOperationKind.Create,n.ResourceOperationKind.Rename,n.ResourceOperationKind.Delete],t.failureHandling=n.FailureHandlingKind.TextOnlyTransactional;let i=w(w(e,"textDocument"),"publishDiagnostics");i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[n.DiagnosticTag.Unnecessary,n.DiagnosticTag.Deprecated]};for(let t of this._features)t.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let e of this._features)e.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,i)=>{for(let t of e.registrations){const e=this._dynamicFeatures.get(t.method);if(!e)return void i(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const s=t.registerOptions||{};s.documentSelector=s.documentSelector||this._clientOptions.documentSelector;const n={id:t.id,registerOptions:s};e.register(this._method2Message.get(t.method),n)}t()})}handleUnregistrationRequest(e){return new Promise((t,i)=>{for(let t of e.unregisterations){const e=this._dynamicFeatures.get(t.method);if(!e)return void i(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}t()})}handleApplyWorkspaceEdit(e){let t=e.edit,i=new Map;s.workspace.textDocuments.forEach(e=>i.set(e.uri.toString(),e));let r=!1;if(t.documentChanges)for(const e of t.documentChanges)if(n.TextDocumentEdit.is(e)&&e.textDocument.version&&e.textDocument.version>=0){let t=i.get(e.textDocument.uri);if(t&&t.version!==e.textDocument.version){r=!0;break}}return r?Promise.resolve({applied:!1}):a.asPromise(s.workspace.applyEdit(this._p2c.asWorkspaceEdit(e.edit)).then(e=>({applied:e})))}logFailedRequest(e,t){t instanceof n.ResponseError&&(t.code===n.ErrorCodes.RequestCancelled||t.code===n.ErrorCodes.ContentModified)||this.error(`Request ${e.method} failed.`,t)}}},function(e,t,i){"use strict";function s(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});const n=i(33),r=i(152);t.RequestType=r.RequestType,t.RequestType0=r.RequestType0,t.RequestType1=r.RequestType1,t.RequestType2=r.RequestType2,t.RequestType3=r.RequestType3,t.RequestType4=r.RequestType4,t.RequestType5=r.RequestType5,t.RequestType6=r.RequestType6,t.RequestType7=r.RequestType7,t.RequestType8=r.RequestType8,t.RequestType9=r.RequestType9,t.ResponseError=r.ResponseError,t.ErrorCodes=r.ErrorCodes,t.NotificationType=r.NotificationType,t.NotificationType0=r.NotificationType0,t.NotificationType1=r.NotificationType1,t.NotificationType2=r.NotificationType2,t.NotificationType3=r.NotificationType3,t.NotificationType4=r.NotificationType4,t.NotificationType5=r.NotificationType5,t.NotificationType6=r.NotificationType6,t.NotificationType7=r.NotificationType7,t.NotificationType8=r.NotificationType8,t.NotificationType9=r.NotificationType9;const o=i(65);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=i(66);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=i(45);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=i(153);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=i(154);var d,h,p,g,f,m,v,y;s(i(155)),s(i(156)),function(e){e.type=new r.NotificationType("$/cancelRequest")}(d||(d={})),function(e){e.type=new r.NotificationType("$/progress")}(h||(h={}));t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(p=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!n.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(p=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(g=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new r.NotificationType("$/setTraceNotification")}(f=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new r.NotificationType("$/logTraceNotification")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v=t.ConnectionErrors||(t.ConnectionErrors={}));class b extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,b.prototype)}}function w(e,t,i,s){let o=0,a=0,w=0;let S,C,T=void 0,E=Object.create(null),R=void 0,P=Object.create(null),D=new Map,_=new u.LinkedMap,k=Object.create(null),x=Object.create(null),O=p.Off,F=g.Text,I=y.New,L=new c.Emitter,A=new c.Emitter,N=new c.Emitter,M=new c.Emitter,U=new c.Emitter;function q(e){return"req-"+e.toString()}function $(e,t){var i;r.isRequestMessage(t)?e.set(q(t.id),t):r.isResponseMessage(t)?e.set(null===(i=t.id)?"res-unknown-"+(++w).toString():"res-"+i.toString(),t):e.set("not-"+(++a).toString(),t)}function j(e){}function W(){return I===y.Listening}function z(){return I===y.Closed}function B(){return I===y.Disposed}function G(){I!==y.New&&I!==y.Listening||(I=y.Closed,A.fire(void 0))}function V(){S||0===_.size||(S=setImmediate(()=>{S=void 0,function(){if(0===_.size)return;let e=_.shift();try{r.isRequestMessage(e)?function(e){if(B())return;function i(i,s,n){let o={jsonrpc:"2.0",id:e.id};i instanceof r.ResponseError?o.error=i.toJson():o.result=void 0===i?null:i,K(o,s,n),t.write(o)}function s(i,s,n){let r={jsonrpc:"2.0",id:e.id,error:i.toJson()};K(r,s,n),t.write(r)}!function(e){if(O===p.Off||!C)return;if(F===g.Text){let t=void 0;O===p.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),C.log(`Received request '${e.method} - (${e.id})'.`,t)}else X("receive-request",e)}(e);let o,a,c=E[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||T){let c=new l.CancellationTokenSource,d=String(e.id);x[d]=c;try{let l;l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):T(e.method,c.token):n.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):T(e.method,...e.params,c.token):a?a(e.params,c.token):T(e.method,e.params,c.token);let h=l;l?h.then?h.then(t=>{delete x[d],i(t,e.method,u)},t=>{delete x[d],t instanceof r.ResponseError?s(t,e.method,u):t&&n.string(t.message)?s(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):s(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}):(delete x[d],i(l,e.method,u)):(delete x[d],function(i,s,n){void 0===i&&(i=null);let r={jsonrpc:"2.0",id:e.id,result:i};K(r,s,n),t.write(r)}(l,e.method,u))}catch(t){delete x[d],t instanceof r.ResponseError?i(t,e.method,u):t&&n.string(t.message)?s(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):s(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else s(new r.ResponseError(r.ErrorCodes.MethodNotFound,"Unhandled method "+e.method),e.method,u)}(e):r.isNotificationMessage(e)?function(e){if(B())return;let t,s=void 0;if(e.method===d.type.method)t=e=>{let t=e.id,i=x[String(t)];i&&i.cancel()};else{let i=P[e.method];i&&(t=i.handler,s=i.type)}if(t||R)try{!function(e){if(O===p.Off||!C||e.method===m.type.method)return;if(F===g.Text){let t=void 0;O===p.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),C.log(`Received notification '${e.method}'.`,t)}else X("receive-notification",e)}(e),void 0===e.params||void 0!==s&&0===s.numberOfParams?t?t():R(e.method):n.array(e.params)&&(void 0===s||s.numberOfParams>1)?t?t(...e.params):R(e.method,...e.params):t?t(e.params):R(e.method,e.params)}catch(t){t.message?i.error(`Notification handler '${e.method}' failed with message: ${t.message}`):i.error(`Notification handler '${e.method}' failed unexpectedly.`)}else N.fire(e)}(e):r.isResponseMessage(e)?function(e){if(B())return;if(null===e.id)e.error?i.error("Received response message without id: Error is: \n"+JSON.stringify(e.error,void 0,4)):i.error("Received response message without id. No further error information provided.");else{let t=String(e.id),s=k[t];if(function(e,t){if(O===p.Off||!C)return;if(F===g.Text){let i=void 0;if(O===p.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),t){let s=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";C.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${s}`,i)}else C.log(`Received response ${e.id} without active response promise.`,i)}else X("receive-response",e)}(e,s),s){delete k[t];try{if(e.error){let t=e.error;s.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");s.resolve(e.result)}}catch(e){e.message?i.error(`Response handler '${s.method}' failed with message: ${e.message}`):i.error(`Response handler '${s.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void i.error("Received empty message.");i.error("Received message which is neither a response nor a notification message:\n"+JSON.stringify(e,null,4));let t=e;if(n.string(t.id)||n.number(t.id)){let e=String(t.id),i=k[e];i&&i.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{V()}}()}))}e.onClose(G),e.onError((function(e){L.fire([e,void 0,void 0])})),t.onClose(G),t.onError((function(e){L.fire(e)}));let H=e=>{try{if(r.isNotificationMessage(e)&&e.method===d.type.method){let i=q(e.params.id),n=_.get(i);if(r.isRequestMessage(n)){let r=s&&s.cancelUndispatched?s.cancelUndispatched(n,j):void 0;if(r&&(void 0!==r.error||void 0!==r.result))return _.delete(i),r.id=n.id,K(r,e.method,Date.now()),void t.write(r)}}$(_,e)}finally{V()}};function K(e,t,i){if(O!==p.Off&&C)if(F===g.Text){let s=void 0;O===p.Verbose&&(e.error&&e.error.data?s=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?s=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(s="No result returned.\n\n")),C.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-i}ms`,s)}else X("send-response",e)}function X(e,t){if(!C||O===p.Off)return;const i={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};C.log(i)}function J(){if(z())throw new b(v.Closed,"Connection is closed.");if(B())throw new b(v.Disposed,"Connection is disposed.")}function Y(e){return void 0===e?null:e}function Q(e,t){let i,s=e.numberOfParams;switch(s){case 0:i=null;break;case 1:i=Y(t[0]);break;default:i=[];for(let e=0;e<t.length&&e<s;e++)i.push(Y(t[e]));if(t.length<s)for(let e=t.length;e<s;e++)i.push(null)}return i}let Z={sendNotification:(e,...i)=>{let s,r;if(J(),n.string(e))switch(s=e,i.length){case 0:r=null;break;case 1:r=i[0];break;default:r=i}else s=e.method,r=Q(e,i);let o={jsonrpc:"2.0",method:s,params:r};!function(e){if(O!==p.Off&&C)if(F===g.Text){let t=void 0;O===p.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),C.log(`Sending notification '${e.method}'.`,t)}else X("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{J(),n.func(e)?R=e:t&&(n.string(e)?P[e]={type:void 0,handler:t}:P[e.method]={type:e,handler:t})},onProgress:(e,t,i)=>{if(D.has(t))throw new Error(`Progress handler for token ${t} already registered`);return D.set(t,i),{dispose:()=>{D.delete(t)}}},sendProgress:(e,t,i)=>{Z.sendNotification(h.type,{token:t,value:i})},onUnhandledProgress:M.event,sendRequest:(e,...i)=>{let s,a;J(),function(){if(!W())throw new Error("Call listen() first.")}();let c=void 0;if(n.string(e))switch(s=e,i.length){case 0:a=null;break;case 1:l.CancellationToken.is(i[0])?(a=null,c=i[0]):a=Y(i[0]);break;default:const e=i.length-1;l.CancellationToken.is(i[e])?(c=i[e],a=2===i.length?Y(i[0]):i.slice(0,e).map(e=>Y(e))):a=i.map(e=>Y(e))}else{s=e.method,a=Q(e,i);let t=e.numberOfParams;c=l.CancellationToken.is(i[t])?i[t]:void 0}let u=o++,h=new Promise((e,i)=>{let n={jsonrpc:"2.0",id:u,method:s,params:a},o={method:s,timerStart:Date.now(),resolve:e,reject:i};!function(e){if(O!==p.Off&&C)if(F===g.Text){let t=void 0;O===p.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),C.log(`Sending request '${e.method} - (${e.id})'.`,t)}else X("send-request",e)}(n);try{t.write(n)}catch(e){o.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(k[String(u)]=o)});return c&&c.onCancellationRequested(()=>{Z.sendNotification(d.type,{id:u})}),h},onRequest:(e,t)=>{J(),n.func(e)?T=e:t&&(n.string(e)?E[e]={type:void 0,handler:t}:E[e.method]={type:e,handler:t})},trace:(e,t,i)=>{let s=!1,r=g.Text;void 0!==i&&(n.boolean(i)?s=i:(s=i.sendNotification||!1,r=i.traceFormat||g.Text)),O=e,F=r,C=O===p.Off?void 0:t,!s||z()||B()||Z.sendNotification(f.type,{value:p.toString(e)})},onError:L.event,onClose:A.event,onUnhandledNotification:N.event,onDispose:U.event,dispose:()=>{if(B())return;I=y.Disposed,U.fire(void 0);let i=new Error("Connection got disposed.");Object.keys(k).forEach(e=>{k[e].reject(i)}),k=Object.create(null),x=Object.create(null),_=new u.LinkedMap,n.func(t.dispose)&&t.dispose(),n.func(e.dispose)&&e.dispose()},listen:()=>{J(),function(){if(W())throw new b(v.AlreadyListening,"Connection is already listening")}(),I=y.Listening,e.listen(H)},inspect:()=>{console.log("inspect")}};return Z.onNotification(m.type,e=>{O!==p.Off&&C&&C.log(e.message,O===p.Verbose?e.verbose:void 0)}),Z.onNotification(h.type,e=>{const t=D.get(e.token);t?t(e.value):M.fire(e)}),Z}t.ConnectionError=b,function(e){e.is=function(e){let t=e;return t&&n.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,i,s,n){var r;return s||(s=t.NullLogger),w(void 0!==(r=e).listen&&void 0===r.read?e:new o.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(i)?i:new a.StreamMessageWriter(i),s,n)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortBy=function(e,t){return e.sort((e,i)=>{const s=t(e),n=t(i);return s<n?-1:s>n?1:0})},t.not=function(e){return t=>!e(t)},t.unique=function(e){return Array.from(new Set(e))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(78),a=i(4),c=i(8),l=i(139),u=i(12),d=i(140),h=i(141),p=i(3),g=i(1),f=i(142),m=i(14),v=i(143),y=i(5),b=i(145),w=i(30),S=i(150),C=i(187),T=i(188),E=i(189),R=i(191),P=i(192),D=i(193),_=i(194),k=i(195),x=i(196),O=i(197),F=i(69),I=i(225),L=i(75),A=i(226),N=i(107),M=i(227),U=i(103),q=i(228),$=i(229),j=i(109),W=i(234),z=i(235),B=i(9),G=i(111),V=i(236),H=i(239),K=i(241),X=i(242),J=i(244),Y=i(245),Q=i(246),Z=i(247),ee=i(249),te=i(250),ie=i(251),se=i(252),ne=i(253),re=i(254),oe=i(77),ae=i(255),ce=i(256),le=i(257),ue=i(262),de=i(110),he=i(263),pe=i(264),ge=i(265),fe=i(266),me=i(267),ve=i(268),ye=i(70),be=i(269),we=i(270),Se=i(271),Ce=i(76),Te=i(272),Ee=i(273),Re=i(274),Pe=i(275),De=i(276),_e=i(277),ke=i(278),xe=i(279),Oe=i(62),Fe=i(280),Ie=i(6),Le=i(104),Ae=i(13),Ne=i(281),Me=i(105),Ue={language:"dart",scheme:"file"},qe={language:"html",scheme:"file"};t.FLUTTER_SUPPORTS_ATTACH="dart-code:flutterSupportsAttach";let $e,je,We;t.SERVICE_EXTENSION_CONTEXT_PREFIX="dart-code:serviceExtension.",t.SERVICE_CONTEXT_PREFIX="dart-code:service.";const ze=_e.DartCapabilities.empty,Be=o.FlutterCapabilities.empty;let Ge,Ve,He,Ke=[];const Xe=[];t.isUsingLsp=!1;const Je=new u.EmittingLogger;function Ye(e,t){e&&Xe.push(u.captureLogs(Je,e,Le.getLogHeader(),B.config.maxLogLineLength,[t]))}function Qe(e){if(Le.clearLogHeader(),Le.addToLogHeader(()=>"!! PLEASE REVIEW THIS LOG FOR SENSITIVE INFORMATION BEFORE SHARING !!"),Le.addToLogHeader(()=>""),Le.addToLogHeader(()=>"Dart Code extension: "+m.extensionVersion),Le.addToLogHeader(()=>{const e=r.extensions.getExtension(a.flutterExtensionIdentifier);return`Flutter extension: ${e.packageJSON.version} (${e.isActive?"":"not "}activated)`}),Le.addToLogHeader(()=>""),Le.addToLogHeader(()=>"App: "+r.env.appName),r.env.remoteName&&Le.addToLogHeader(()=>"Remote: "+r.env.remoteName),Le.addToLogHeader(()=>"Version: "+r.version),Le.addToLogHeader(()=>"Platform: "+a.platformDisplayName),e){Le.addToLogHeader(()=>""),Le.addToLogHeader(()=>"Workspace type: "+e.workspaceTypeDescription),Le.addToLogHeader(()=>"Multi-root?: "+(r.workspace.workspaceFolders&&r.workspace.workspaceFolders.length>1));const t=e.sdks;Le.addToLogHeader(()=>""),Le.addToLogHeader(()=>`Dart SDK:\n    Loc: ${t.dart}\n    Ver: ${t.dartVersion}`),Le.addToLogHeader(()=>`Flutter SDK:\n    Loc: ${t.flutter}\n    Ver: ${t.flutterVersion}`)}Le.addToLogHeader(()=>""),Le.addToLogHeader(()=>"HTTP_PROXY: "+process.env.HTTP_PROXY),Le.addToLogHeader(()=>"NO_PROXY: "+process.env.NO_PROXY)}function Ze(){Ke=y.getDartWorkspaceFolders().map(e=>g.fsPath(e.uri));const e=[];if(a.isWin){const t=t=>{if(!t||!n.isAbsolute(t))return;const i=Ke.find(e=>g.isWithinPath(t,e));i&&(Je.info(`Excluding folder ${t} from analysis roots as it is a child of analysis root ${i} and may cause performance issues.`),e.push(t))};t(process.env.PUB_CACHE),t(process.env.APPDATA),t(process.env.LOCALAPPDATA)}y.getDartWorkspaceFolders().forEach(t=>{const i=B.config.for(t.uri).analysisExcludedFolders,s=g.fsPath(t.uri);i&&Array.isArray(i)&&i.forEach(t=>{n.isAbsolute(t)||(t=n.join(s,t)),e.push(t)})}),$e.client.analysisSetAnalysisRoots({excluded:e,included:Ke})}function et(){var e,t;return"CONF-"+B.config.sdkPath+(null===(e=B.config.sdkPaths)||void 0===e?void 0:e.length)+B.config.analyzerPath+B.config.analyzerDiagnosticsPort+B.config.analyzerObservatoryPort+B.config.analyzerInstrumentationLogFile+B.config.extensionLogFile+B.config.analyzerAdditionalArgs+B.config.flutterSdkPath+(null===(t=B.config.flutterSdkPaths)||void 0===t?void 0:t.length)+B.config.flutterSelectDeviceWhenConnected+B.config.closingLabels+B.config.analyzeAngularTemplates+B.config.analysisServerFolding+B.config.showMainCodeLens+B.config.showTestCodeLens+B.config.previewBuildRunnerTasks+B.config.previewUpdateImportsOnRename+B.config.previewBazelWorkspaceCustomScripts+B.config.flutterOutline+B.config.triggerSignatureHelpAutomatically+B.config.flutterAdbConnectOnChromeOs}function tt(e=!1){return s(this,void 0,void 0,(function*(){it(!1),yield $e.dispose(),r.commands.executeCommand("setContext",t.FLUTTER_SUPPORTS_ATTACH,!1),e||(r.commands.executeCommand("setContext",a.HAS_LAST_DEBUG_CONFIG,!1),r.commands.executeCommand("setContext",a.HAS_LAST_TEST_DEBUG_CONFIG,!1),yield Ge.logExtensionShutdown(),Xe&&(yield Promise.all(Xe.map(e=>e.dispose())),Xe.length=0))}))}function it(e,t){r.commands.executeCommand("setContext","dart-code:dartProjectLoaded",e),r.commands.executeCommand("setContext","dart-code:anyFlutterProjectLoaded",e&&t&&t.hasAnyFlutterProjects),r.commands.executeCommand("setContext","dart-code:flutterMobileProjectLoaded",e&&t&&t.hasAnyFlutterMobileProjects),r.commands.executeCommand("setContext","dart-code:WebProjectLoaded",e&&t&&t.hasAnyWebProjects)}t.ringLog=new u.RingLog(200),t.activate=function e(i,_e=!1){return s(this,void 0,void 0,(function*(){_e||(m.isDevExtension&&u.logToConsole(Je),Je.onLog(e=>t.ringLog.log(e.toLine(500)))),r.commands.executeCommand("setContext",a.IS_RUNNING_LOCALLY_CONTEXT,y.isRunningLocally),Qe(),Ye(Le.getExtensionLogPath(),c.LogCategory.General);const Xe=b.Context.for(i),st=new l.WebClient(m.extensionVersion);Ie.logTime("Code called activate"),i.subscriptions.push(r.commands.registerCommand("_dart.reloadExtension",t=>s(this,void 0,void 0,(function*(){Je.info("Performing silent extension reload..."),yield tt(!0);const t=i.subscriptions.slice();i.subscriptions.length=0;for(const e of t)try{e.dispose()}catch(e){Je.error(e)}yield e(i,!0),Je.info("Done!")})))),Ve=B.config.showTodos,He=et();const nt=new Date;Ie.logTime();const rt=new Oe.SdkUtils(Je),ot=yield rt.scanWorkspace();if(Ie.logTime("initWorkspace"),Qe(ot),Ye(B.config.analyzerLogFile,c.LogCategory.Analyzer),Ye(B.config.flutterDaemonLogFile,c.LogCategory.FlutterDaemon),Ye(B.config.devToolsLogFile,c.LogCategory.DevTools),Ge=new E.Analytics(Je,ot),!ot.sdks.dart||ot.hasAnyFlutterProjects&&!ot.sdks.flutter)return rt.handleMissingSdks(i,Ge,ot);const at=ot,ct=at.sdks;ct.flutterVersion&&(Be.version=ct.flutterVersion,Ge.flutterSdkVersion=ct.flutterVersion),(B.config.previewLsp||process.env.DART_CODE_FORCE_LSP)&&(t.isUsingLsp=!0),r.commands.executeCommand("setContext",a.IS_LSP_CONTEXT,t.isUsingLsp),ct.dartVersion&&(ze.version=ct.dartVersion,Ge.sdkVersion=ct.dartVersion,xe.checkForStandardDartSdkUpdates(Je,at),i.subscriptions.push(new ke.StatusBarVersionTracker(at,t.isUsingLsp))),r.commands.executeCommand("setContext",a.PUB_OUTDATED_SUPPORTED_CONTEXT,ze.supportsPubOutdated);const lt=new Date;$e=t.isUsingLsp?new S.LspAnalyzer(Je,ct,ze,at):new w.DasAnalyzer(Je,Ge,ct,ze,at);const ut=t.isUsingLsp?$e:void 0,dt=t.isUsingLsp?void 0:$e,ht=dt?dt.client:void 0,pt=ht?void 0:$e.client;let gt;i.subscriptions.push($e),$e.onReady.then(()=>{const e=new Date;Ge.logAnalyzerStartupTime(e.getTime()-lt.getTime())});const ft=$e.onAnalysisStatusChange.listen(e=>{if(e.isAnalyzing&&!gt&&(gt=new Date),!e.isAnalyzing&&gt){const e=new Date;Ge.logAnalyzerFirstAnalysisTime(e.getTime()-gt.getTime()),ft.dispose()}});pt&&i.subscriptions.push(new ie.LspClosingLabelsDecorations(pt));const mt=t.isUsingLsp||!ht?void 0:new re.DartCompletionItemProvider(Je,ht),vt=t.isUsingLsp||!ht?void 0:new ge.DartReferenceProvider(ht),yt=[Ue];B.config.analyzeAngularTemplates&&yt.push(qe);for(const e of p.uniq(B.config.additionalAnalyzerFileExtensions))"dart"===e||B.config.analyzeAngularTemplates&&("htm"===e||"html"===e)||yt.push({scheme:"file",pattern:"**/*."+e});const bt=new Ce.RankingCodeActionProvider,wt=".(${'\"/\\".split("");if(!t.isUsingLsp&&ht){i.subscriptions.push(r.languages.registerHoverProvider(yt,new de.DartHoverProvider(Je,ht)));const e=new le.DartFormattingEditProvider(Je,ht,Xe);i.subscriptions.push(e),e.registerDocumentFormatter(yt),e.registerTypingFormatter(Ue,"}",";")}let St;if(mt&&i.subscriptions.push(r.languages.registerCompletionItemProvider(yt,mt,...wt)),vt&&(i.subscriptions.push(r.languages.registerDefinitionProvider(yt,vt)),i.subscriptions.push(r.languages.registerReferenceProvider(yt,vt))),!t.isUsingLsp&&ht&&dt){if(i.subscriptions.push(r.languages.registerDocumentHighlightProvider(yt,new ue.DartDocumentHighlightProvider(dt.fileTracker))),bt.registerProvider(new ne.AssistCodeActionProvider(Je,yt,ht)),bt.registerProvider(new be.FixCodeActionProvider(Je,yt,ht)),bt.registerProvider(new Te.RefactorCodeActionProvider(yt,ht)),St=new fe.DartRenameProvider(ht),i.subscriptions.push(r.languages.registerRenameProvider(yt,St)),i.subscriptions.push(r.languages.registerCodeActionsProvider(Ue,new Re.SourceCodeActionProvider,Re.SourceCodeActionProvider.metadata)),i.subscriptions.push(r.languages.registerImplementationProvider(Ue,new he.DartImplementationProvider(dt))),B.config.showMainCodeLens){const e=new D.MainCodeLensProvider(Je,dt);i.subscriptions.push(e),i.subscriptions.push(r.languages.registerCodeLensProvider(Ue,e))}if(B.config.showTestCodeLens){const e=new k.TestCodeLensProvider(Je,dt);i.subscriptions.push(e),i.subscriptions.push(r.languages.registerCodeLensProvider(Ue,e))}if(B.config.showDartPadSampleCodeLens&&ct.flutter){const e=new P.FlutterDartPadSamplesCodeLensProvider(Je,dt,ct);i.subscriptions.push(e),i.subscriptions.push(r.languages.registerCodeLensProvider(Ue,e))}}if(t.isUsingLsp&&pt&&ut){if(B.config.showMainCodeLens){const e=new _.LspMainCodeLensProvider(Je,ut);i.subscriptions.push(e),i.subscriptions.push(r.languages.registerCodeLensProvider(Ue,e))}if(B.config.showTestCodeLens){const e=new x.LspTestCodeLensProvider(Je,ut);i.subscriptions.push(e),i.subscriptions.push(r.languages.registerCodeLensProvider(Ue,e))}}if(bt.registerProvider(new we.IgnoreLintCodeActionProvider(yt)),i.subscriptions.push(r.languages.registerCodeActionsProvider(yt,bt,bt.metadata)),B.config.previewBuildRunnerTasks&&i.subscriptions.push(r.tasks.registerTaskProvider("pub",new Pe.PubBuildRunnerTaskProvider(ct))),i.subscriptions.push(r.languages.registerCompletionItemProvider(Ue,new Ee.SnippetCompletionItemProvider("snippets/dart.json",e=>!0))),i.subscriptions.push(r.languages.registerCompletionItemProvider(Ue,new Ee.SnippetCompletionItemProvider("snippets/flutter.json",e=>Ie.isInsideFlutterProject(e)))),i.subscriptions.push(r.languages.setLanguageConfiguration(Ue.language,new pe.DartLanguageConfiguration)),pt&&new te.LspAnalyzerStatusReporter($e),ht&&new C.AnalyzerStatusReporter(Je,ht,at,Ge),!t.isUsingLsp&&ht){const e=r.languages.createDiagnosticCollection("dart");i.subscriptions.push(e);new oe.DartDiagnosticProvider(ht,e);const t=ht.registerForServerConnected(e=>{t.dispose(),r.workspace.workspaceFolders&&Ze();let s=!1;const n=e=>{s||"dart"!==e.languageId||"file"!==e.uri.scheme||0!==Ke.length||(s=!0,r.window.showWarningMessage("For full Dart language support, please open a folder containing your Dart files instead of individual loose files"))};i.subscriptions.push(r.workspace.onDidOpenTextDocument(e=>n(e))),r.window.visibleTextEditors.forEach(e=>n(e.document))});i.subscriptions.push(new T.FileChangeHandler(ht))}at.hasAnyFlutterMobileProjects&&ct.flutter&&(je=new Q.FlutterDaemon(Je,at),We=new f.FlutterDeviceManager(Je,je,B.config),i.subscriptions.push(We),i.subscriptions.push(je),Y.setUpDaemonMessageHandler(Je,i,je),i.subscriptions.push(r.commands.registerCommand("flutter.selectDevice",We.showDevicePicker,We)),i.subscriptions.push(r.commands.registerCommand("flutter.launchEmulator",We.promptForAndLaunchEmulator,We))),Ie.logTime("All other stuff before debugger..");const Ct=new d.PubApi(st),Tt=new De.PubGlobal(Je,Xe,ct,Ct),Et=new ye.DebugConfigProvider(Je,at,Ge,Tt,je,We,ze,Be);if(i.subscriptions.push(r.debug.registerDebugConfigurationProvider("dart",Et)),i.subscriptions.push(Et),B.config.flutterGutterIcons&&i.subscriptions.push(new V.FlutterColorDecorations(Je,n.join(i.globalStoragePath,"flutterColors"))),!t.isUsingLsp&&ht&&dt){B.config.previewFlutterUiGuides&&i.subscriptions.push(new X.FlutterUiGuideDecorationsDas(dt)),B.config.flutterGutterIcons&&i.subscriptions.push(new H.FlutterIconDecorationsDas(Je,dt));const e=ht.registerForServerConnected(t=>s(this,void 0,void 0,(function*(){e.dispose(),i.subscriptions.push(new $.RefactorCommands(Je,i,ht)),ht.capabilities.supportsClosingLabels&&B.config.closingLabels&&i.subscriptions.push(new G.ClosingLabelsDecorations(ht)),ht.capabilities.supportsGetDeclerations?i.subscriptions.push(r.languages.registerWorkspaceSymbolProvider(new ve.DartWorkspaceSymbolProvider(Je,ht))):i.subscriptions.push(r.languages.registerWorkspaceSymbolProvider(new Se.LegacyDartWorkspaceSymbolProvider(Je,ht))),ht.capabilities.supportsCustomFolding&&B.config.analysisServerFolding&&i.subscriptions.push(r.languages.registerFoldingRangeProvider(yt,new ce.DartFoldingProvider(dt))),ht.capabilities.supportsGetSignature&&i.subscriptions.push(r.languages.registerSignatureHelpProvider(Ue,new me.DartSignatureHelpProvider(ht),...B.config.triggerSignatureHelpAutomatically?["(",","]:[]));const t=new ae.DartDocumentSymbolProvider(Je,dt.fileTracker);yt.forEach(e=>{i.subscriptions.push(r.languages.registerDocumentSymbolProvider(e,t))}),ht.capabilities.supportsAvailableSuggestions&&B.config.autoImportCompletions&&(yield ht.completionSetSubscriptions({subscriptions:["AVAILABLE_SUGGESTION_SETS"]}))})))}else t.isUsingLsp&&pt&&ut&&(B.config.previewFlutterUiGuides&&i.subscriptions.push(new J.FlutterUiGuideDecorationsLsp(ut)),B.config.flutterGutterIcons&&i.subscriptions.push(new K.FlutterIconDecorationsLsp(Je,ut)));i.subscriptions.push(r.workspace.onDidChangeConfiguration(()=>function(e){const t=B.config.showTodos,i=Ve!==t;Ve=t;const s=et(),n=He!==s;He=s,i&&$e instanceof w.DasAnalyzer&&$e.client.analysisReanalyze();n&&Ie.promptToReloadExtension()}()));new O.AnalyzerCommands(i,$e);const Rt=new j.SdkCommands(Je,i,at,rt,Tt,Be,We),Pt=new F.DebugCommands(Je,Xe,at,Ge,Tt);i.subscriptions.push(new ee.HotReloadOnSaveHandler(Pt)),i.subscriptions.push(r.window.registerUriHandler(new v.DartUriHandler(Be))),i.subscriptions.push(new U.LoggingCommands(Je,i.logPath)),i.subscriptions.push(new q.OpenInOtherEditorCommands(Je,ct)),dt&&i.subscriptions.push(new W.DasTestCommands(Je,dt.fileTracker)),ut&&i.subscriptions.push(new W.LspTestCommands(Je,ut.fileTracker)),pt&&ut&&i.subscriptions.push(new se.LspGoToSuperCommand(ut)),i.subscriptions.push(new I.EditCommands),ht&&dt?(i.subscriptions.push(new L.DasEditCommands(Je,i,ht)),i.subscriptions.push(new z.TypeHierarchyCommand(Je,ht)),i.subscriptions.push(new M.GoToSuperCommand(dt))):pt&&ut&&i.subscriptions.push(new A.LspEditCommands(ut));const Dt=new Ne.DartPackagesProvider(Je),_t=r.window.createTreeView("dartPackages",{treeDataProvider:Dt});i.subscriptions.push(Dt,_t);const kt=new Me.TestResultsProvider,xt=r.window.createTreeView("dartTestTree",{treeDataProvider:kt});let Ot;if(i.subscriptions.push(kt,xt,kt.onDidStartTests(e=>{B.config.openTestViewOnStart&&xt.reveal(e)}),kt.onFirstFailure(e=>{B.config.openTestViewOnFailure&&xt.reveal(e)}),xt.onDidChangeSelection(e=>{kt.setSelectedNodes(e.selection&&1===e.selection.length?e.selection[0]:void 0)})),B.config.flutterOutline){Ot=dt?new Z.DasFlutterOutlineProvider(dt):new Z.LspFlutterOutlineProvider(ut);const e=r.window.createTreeView("dartFlutterOutline",{treeDataProvider:Ot,showCollapseAll:!0});e.onDidChangeSelection(e=>s(this,void 0,void 0,(function*(){yield Ot.setContexts(e.selection)}))),i.subscriptions.push(r.window.onDidChangeTextEditorSelection(t=>{if(t.selections&&t.selections.length){const i=Ot.getNodeAt(t.textEditor.document.uri,t.selections[0].start);i&&e.visible&&e.reveal(i,{select:!0,focus:!1,expand:!0})}})),i.subscriptions.push(e),i.subscriptions.push(Ot);new N.FlutterOutlineCommands(e,i)}if(i.subscriptions.push(r.commands.registerCommand("dart.package.openFile",e=>{e&&r.workspace.openTextDocument(e).then(e=>{r.window.showTextDocument(e,{preview:!0})},e=>Je.error(e))})),r.workspace.workspaceFolders&&r.workspace.workspaceFolders.length)for(const e of r.workspace.workspaceFolders)if(y.warnIfPathCaseMismatch(Je,g.fsPath(e.uri),"the open workspace folder","re-open the folder using the File Open dialog"))break;function Ft(){at.config.disableAutomaticPackageGet||Rt.fetchPackagesOrPrompt(void 0,{alwaysPrompt:!0})}if(_e||Fe.showUserPrompts(Je,Xe,st,at),it(!0,at),r.commands.executeCommand("setContext","dart-code:dartPlatformName",a.dartPlatformName),_e||Ft(),at.shouldLoadFlutterExtension){const e=r.extensions.getExtension(a.flutterExtensionIdentifier);e&&(Je.info(`Activating Flutter extension for ${at.workspaceTypeDescription} project...`),e.activate())}const It=new Date;return _e?Ge.logExtensionRestart(It.getTime()-nt.getTime()):Ge.logExtensionStartup(It.getTime()-nt.getTime()),i.subscriptions.push(r.workspace.onDidChangeWorkspaceFolders(e=>s(this,void 0,void 0,(function*(){const e=yield rt.scanWorkspace();e.hasAnyFlutterProjects===at.hasAnyFlutterProjects&&e.hasProjectsInFuchsiaTree===at.hasProjectsInFuchsiaTree?(Dt.refresh(),Ze(),Ft()):Ie.promptToReloadExtension()})))),Object.assign(Object.assign({},new R.DartExtensionApi),{[h.internalApiSymbol]:{analyzer:$e,analyzerCapabilities:ht&&ht.capabilities,cancelAllAnalysisRequests:()=>ht&&ht.cancelAllRequests(),completionItemProvider:mt,context:Xe,currentAnalysis:()=>$e.onCurrentAnalysisComplete,daemonCapabilities:je?je.capabilities:o.DaemonCapabilities.empty,dartCapabilities:ze,debugCommands:Pt,debugProvider:Et,envUtils:y.envUtils,fileTracker:dt?dt.fileTracker:ut?ut.fileTracker:void 0,flutterCapabilities:Be,flutterOutlineTreeProvider:Ot,get cursorIsInTest(){return W.cursorIsInTest},get isInImplementationFile(){return W.isInImplementationFile},get isInTestFile(){return W.isInTestFile},getLogHeader:Le.getLogHeader,initialAnalysis:$e.onInitialAnalysis,isLsp:t.isUsingLsp,logger:Je,nextAnalysis:()=>$e.onNextAnalysisComplete,packagesTreeProvider:Dt,pubGlobal:Tt,renameProvider:St,safeToolSpawn:Ae.safeToolSpawn,testTreeProvider:kt,webClient:st,workspaceContext:at}})}))},t.deactivate=tt},function(e,t,i){const{MAX_SAFE_COMPONENT_LENGTH:s}=i(38),n=i(39),r=(t=e.exports={}).re=[],o=t.src=[],a=t.t={};let c=0;const l=(e,t,i)=>{const s=c++;n(s,t),a[e]=s,o[s]=t,r[s]=new RegExp(t,i?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),l("FULL",`^${o[a.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),l("LOOSE",`^${o[a.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",o[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",o[a.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),l("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?(?:$|[^\\d])`),l("COERCERTL",o[a.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,i){const{MAX_LENGTH:s}=i(38),{re:n,t:r}=i(23),o=i(11);e.exports=(e,t)=>{if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>s)return null;if(!(t.loose?n[r.LOOSE]:n[r.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedPromise=Promise.resolve(!0),t.waitFor=function(e,t=500,i=1e4,n){return s(this,void 0,void 0,(function*(){let s=i;for(;s>0&&(!n||!n.isCancellationRequested);){const i=yield e();if(i)return i;yield new Promise(e=>setTimeout(e,t)),s-=t}}))}},function(e,t,i){"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("events")},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(84),a=i(4),c=i(8),l=i(12),u=i(3),d=i(9),h=i(6),p=i(13),g=i(87),f=i(148),m=i(149);class v{constructor(e){this.version=e}static get empty(){return new v("0.0.0")}get hasCompleteStatementFix(){return u.versionIsAtLeast(this.version,"1.20.2")}get supportsPriorityFilesOutsideAnalysisRoots(){return u.versionIsAtLeast(this.version,"1.18.2")}get supportsDiagnostics(){return u.versionIsAtLeast(this.version,"1.18.1")}get supportsClosingLabels(){return u.versionIsAtLeast(this.version,"1.18.4")}get supportsCustomFolding(){return u.versionIsAtLeast(this.version,"1.20.3")}get supportsFlutterOutline(){return u.versionIsAtLeast(this.version,"1.26.0")}get supportsGetDeclerations(){return u.versionIsAtLeast(this.version,"1.18.7")}get supportsGetDeclerationsForFile(){return u.versionIsAtLeast(this.version,"1.19.0")}get supportsGetSignature(){return u.versionIsAtLeast(this.version,"1.20.5")}get supportsMoveFile(){return u.versionIsAtLeast(this.version,"1.27.0")}get isDart2(){return u.versionIsAtLeast(this.version,"1.19.0")}get hasNewSignatureFormat(){return u.versionIsAtLeast(this.version,"1.27.1")}get hasNewHoverLibraryFormat(){return u.versionIsAtLeast(this.version,"1.27.1")}get supportsAvailableSuggestions(){return u.versionIsAtLeast(this.version,"1.26.0")}get supportsIncludedImports(){return u.versionIsAtLeast(this.version,"1.27.1")}}t.AnalyzerCapabilities=v;class y extends o.Analyzer{constructor(e,t,i,s,n){super(new l.CategoryLogger(e,c.LogCategory.Analyzer)),this.client=new b(this.logger,i,s),this.fileTracker=new m.DasFileTracker(e,this.client,n),this.disposables.push(this.client),this.disposables.push(this.fileTracker);const r=this.client.registerForServerConnected(e=>{t.analysisServerVersion=e.version,this.onReadyCompleter.resolve(),r.dispose()});this.client.registerForServerStatus(e=>{e.analysis&&this.onAnalysisStatusChangeEmitter.fire({isAnalyzing:e.analysis.isAnalyzing})})}getDiagnosticServerPort(){return this.client.diagnosticGetServerPort()}}t.DasAnalyzer=y;class b extends f.AnalyzerGen{constructor(e,t,i){var s;super(e,d.config.maxLogLineLength),this.isAnalyzing=!1,this.capabilities=v.empty,this.resolvedPromise=Promise.resolve(),this.serverTerminatedSubscriptions=[],this.launchArgs=g.getAnalyzerArgs(e,t,i,!1),this.registerForServerError(e=>this.requestDiagnosticsUpdate()),this.registerForRequestError(e=>this.requestDiagnosticsUpdate()),this.registerForServerConnected(e=>{this.version=e.version,this.capabilities.version=this.version});const r=n.join(t.dart,a.dartVMPath);let o=r,c=this.launchArgs.slice();d.config.analyzerSshHost&&(o="ssh",c.unshift(r),c=["-q",d.config.analyzerSshHost,h.escapeShell(c)]),this.createProcess(void 0,o,c,{toolEnv:p.getToolEnv()}),null===(s=this.process)||void 0===s||s.on("exit",(e,t)=>{this.notify(this.serverTerminatedSubscriptions,void 0)}),this.registerForServerStatus(e=>{e.analysis&&(e.analysis.isAnalyzing?this.isAnalyzing=!0:(this.isAnalyzing=!1,this.currentAnalysisCompleter&&(this.currentAnalysisCompleter.resolve(),this.currentAnalysisCompleter=void 0)))}),this.serverSetSubscriptions({subscriptions:["STATUS"]})}get currentAnalysis(){return this.isAnalyzing?(this.currentAnalysisCompleter||(this.currentAnalysisCompleter=new u.PromiseCompleter),this.currentAnalysisCompleter.promise):this.resolvedPromise}sendMessage(e){try{super.sendMessage(e)}catch(e){const t=this.version?"The Dart Analyzer has terminated.":"The Dart Analyzer could not be started.";throw h.promptToReloadExtension(t,void 0,!0),e}}shouldHandleMessage(e){return!(e.startsWith("--- ")||e.startsWith("+++ ")||e.startsWith("Observatory listening on")||e.startsWith("Observatory server"))}requestDiagnosticsUpdate(){return s(this,void 0,void 0,(function*(){this.lastDiagnostics=void 0,this.capabilities.supportsDiagnostics&&(this.lastDiagnostics=(yield this.diagnosticGetDiagnostics()).contexts)}))}getLastDiagnostics(){return this.lastDiagnostics}getAnalyzerLaunchArgs(){return this.launchArgs}forceNotificationsFor(e){const t={};t[e]={edits:[{offset:0,length:0,replacement:"",id:""}],type:"change"},this.analysisUpdateContent({files:t})}completionGetSuggestionsResults(e){return this.requestWithStreamedResults(()=>this.completionGetSuggestions(e),this.registerForCompletionResults)}searchFindElementReferencesResults(e){return this.requestWithStreamedResults(()=>this.searchFindElementReferences(e),this.registerForSearchResults)}searchFindTopLevelDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindTopLevelDeclarations(e),this.registerForSearchResults)}searchFindMemberDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindMemberDeclarations(e),this.registerForSearchResults)}requestWithStreamedResults(e,t){return new Promise((i,s)=>{const n=[];let r;const o=t.bind(this)(e=>{r&&e.id===r&&e.isLast?(o.dispose(),i(e)):!r&&e.isLast&&n.push(e)});e.bind(this)().then(e=>{e.id||(o.dispose(),s()),r=e.id;const t=n.find(e=>e.id===r);t&&(o.dispose(),i(t))},()=>s())})}registerForServerTerminated(e){return this.subscribe(this.serverTerminatedSubscriptions,e)}}t.DasAnalyzerClient=b,t.getSymbolKindForElementKind=function(e,t){switch(t){case"CLASS":case"CLASS_TYPE_ALIAS":case"MIXIN":return r.SymbolKind.Class;case"COMPILATION_UNIT":case"EXTENSION":return r.SymbolKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return r.SymbolKind.Constructor;case"ENUM":return r.SymbolKind.Enum;case"ENUM_CONSTANT":return r.SymbolKind.EnumMember;case"FIELD":return r.SymbolKind.Field;case"FILE":return r.SymbolKind.File;case"FUNCTION":case"FUNCTION_INVOCATION":case"FUNCTION_TYPE_ALIAS":return r.SymbolKind.Function;case"GETTER":return r.SymbolKind.Property;case"LABEL":return r.SymbolKind.Module;case"LIBRARY":return r.SymbolKind.Namespace;case"LOCAL_VARIABLE":return r.SymbolKind.Variable;case"METHOD":return r.SymbolKind.Method;case"PARAMETER":case"PREFIX":return r.SymbolKind.Variable;case"SETTER":return r.SymbolKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return r.SymbolKind.Variable;case"UNIT_TEST_GROUP":return r.SymbolKind.Module;case"UNIT_TEST_TEST":return r.SymbolKind.Method;case"UNKNOWN":return r.SymbolKind.Object;default:return e.error("Unknown kind: "+t,c.LogCategory.Analyzer),r.SymbolKind.Object}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(1),r=i(6);t.UPGRADE_TO_WORKSPACE_FOLDERS="Mark Projects as Workspace Folders",t.locateBestProjectRoot=function(e){if(!e||!r.isWithinWorkspace(e))return;let t=e;for(;t!==s.dirname(t);){if(n.hasPubspec(t)||n.hasPackagesFile(t))return t;t=s.dirname(t)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(43);t.StdIOService=class{constructor(e,t,i=!1,s=!1,n){this.logger=e,this.maxLogLineLength=t,this.messagesWrappedInBrackets=i,this.treatHandlingErrorsAsUnhandledMessages=s,this.logFile=n,this.disposables=[],this.additionalPidsToTerminate=[],this.nextRequestID=1,this.activeRequests={},this.messageBuffers=[],this.requestErrorSubscriptions=[],this.processExited=!1}createProcess(e,t,i,s){this.logTraffic(`Spawning ${t} with args ${JSON.stringify(i)}`),e&&this.logTraffic("..  in "+e),(s.envOverrides||s.toolEnv)&&this.logTraffic("..  with "+JSON.stringify(s)),this.process=r.safeSpawn(e,t,i,s),this.logTraffic("    PID: "+process.pid),this.process.stdout.on("data",e=>{this.messageBuffers.push(Buffer.isBuffer(e)?e:Buffer.from(e)),e.toString().indexOf("\n")>=0&&this.processMessageBuffer()}),this.process.stderr.on("data",e=>{this.logTraffic(""+e.toString(),!0)}),this.process.on("exit",(e,t)=>{this.logTraffic(`Process terminated! ${e}, ${t}`),this.processExited=!0}),this.process.on("error",e=>{this.logTraffic("Process errored! "+e)})}buildRequest(e,t,i){return{id:e.toString(),method:t,params:i}}sendRequest(e,t){const i=this.nextRequestID++;return new Promise((s,n)=>{this.activeRequests[i.toString()]=[s,n,e];const r=this.buildRequest(i,e,t),o=this.messagesWrappedInBrackets?"["+JSON.stringify(r)+"]\r\n":JSON.stringify(r)+"\r\n";this.sendMessage(o)})}cancelAllRequests(){Object.keys(this.activeRequests).forEach(e=>this.activeRequests[e]="CANCELLED")}sendMessage(e){this.logTraffic("==> "+e),this.process?this.process.stdin.write(e):this.logTraffic("  (not sent: no process)")}processMessageBuffer(){let e=Buffer.concat(this.messageBuffers);this.messageBuffers=[];const t=e.lastIndexOf("\n");if(t!==e.length-1){const i=e.slice(t+1);e=e.slice(0,t),this.messageBuffers.push(i)}e.toString().split("\n").filter(e=>""!==e.trim()).forEach(e=>this.handleMessage(e+"\n"))}processUnhandledMessage(e){}handleMessage(e){return s(this,void 0,void 0,(function*(){if(this.logTraffic(`<== ${e.trimRight()}\r\n`),!this.shouldHandleMessage(e.trim()))return void this.processUnhandledMessage(e);let t;try{t=JSON.parse(e),this.messagesWrappedInBrackets&&t&&1===t.length&&(t=t[0])}catch(t){if(this.treatHandlingErrorsAsUnhandledMessages)return this.logger.error(`Unexpected non-JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),void this.processUnhandledMessage(e);throw t}try{t&&this.isNotification(t)?this.handleNotification(t):t&&this.isRequest(t)?yield this.processServerRequest(t):t&&this.isResponse(t)?this.handleResponse(t):(this.logger.error("Unexpected JSON message, assuming normal stdout : "+e),this.processUnhandledMessage(e))}catch(t){if(!this.treatHandlingErrorsAsUnhandledMessages)throw t;this.logger.error(`Failed to handle JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),this.processUnhandledMessage(e)}}))}handleRequest(e,t){return s(this,void 0,void 0,(function*(){}))}isNotification(e){return!!e.event}isRequest(e){return!!e.method&&!!e.id}isResponse(e){return!!e.id}processServerRequest(e){return s(this,void 0,void 0,(function*(){let t,i;try{t=yield this.handleRequest(e.method,e.params)}catch(e){i=e}const s={id:e.id,result:t,error:i},n=this.messagesWrappedInBrackets?"["+JSON.stringify(s)+"]\r\n":JSON.stringify(s)+"\r\n";this.sendMessage(n)}))}handleResponse(e){const t=this.activeRequests[e.id];if(delete this.activeRequests[e.id],"CANCELLED"===t)return void this.logger.info(`Ignoring response to ${e.id} because it was cancelled:\n\n${JSON.stringify(e,void 0,4)}`);if(!t)return void this.logger.error(`Unable to handle response with ID ${e.id} because its handler is not available`);const i=t[2],s=e.error;s&&"SERVER_ERROR"===s.code&&(s.method=i,this.notify(this.requestErrorSubscriptions,s)),s?t[1](s):t[0](e.result)}notify(e,t){Promise.all(e.slice().map(e=>e(t))).catch(e=>console.error(e))}subscribe(e,t){e.push(t);const i={dispose:()=>{let s=e.indexOf(t);s>=0&&e.splice(s,1),s=this.disposables.indexOf(i),s>=0&&this.disposables.splice(s,1)}};return this.disposables.push(i),i}registerForRequestError(e){return this.subscribe(this.requestErrorSubscriptions,e)}logTraffic(e,t=!1){t?this.logger.error(e):this.logger.info(e),this.openLogFile!==this.logFile&&this.logStream&&(this.logStream.end(),this.logStream=void 0,this.openLogFile=void 0),this.logFile&&(this.logStream||(this.logStream=n.createWriteStream(this.logFile),this.openLogFile=this.logFile),this.logStream.write(`[${(new Date).toLocaleTimeString()}]: `),this.maxLogLineLength&&e.length>this.maxLogLineLength?this.logStream.write(e.substring(0,this.maxLogLineLength)+"…\r\n"):this.logStream.write(e.trim()+"\r\n"))}dispose(){for(const e of this.additionalPidsToTerminate)try{process.kill(e)}catch(e){this.logger.error({message:e.toString()})}this.additionalPidsToTerminate.length=0;try{this.processExited||!this.process||this.process.killed||this.process.kill()}catch(e){}this.process=void 0,this.disposables.forEach(e=>s(this,void 0,void 0,(function*(){try{return yield e.dispose()}catch(e){this.logger.error({message:e.toString()})}}))),this.logFile=void 0,this.logStream&&(this.logStream.end(),this.logStream=void 0,this.openLogFile=void 0)}}},function(e,t,i){"use strict";function s(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every(e=>s(e))}},function(e,t){e.exports=require("net")},function(e,t,i){"use strict";function s(e){return"string"==typeof e||e instanceof String}function n(e){return"function"==typeof e}function r(e){return Array.isArray(e)}function o(e){return e&&n(e.then)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=n,t.array=r,t.stringArray=function(e){return r(e)&&e.every(e=>s(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=o,t.asPromise=function(e){return e instanceof Promise?e:o(e)?new Promise((t,i)=>{e.then(e=>t(e),e=>i(e))}):Promise.resolve(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(72);t.DebugSession=s.DebugSession,t.InitializedEvent=s.InitializedEvent,t.TerminatedEvent=s.TerminatedEvent,t.StoppedEvent=s.StoppedEvent,t.ContinuedEvent=s.ContinuedEvent,t.OutputEvent=s.OutputEvent,t.ThreadEvent=s.ThreadEvent,t.BreakpointEvent=s.BreakpointEvent,t.ModuleEvent=s.ModuleEvent,t.LoadedSourceEvent=s.LoadedSourceEvent,t.CapabilitiesEvent=s.CapabilitiesEvent,t.ProgressStartEvent=s.ProgressStartEvent,t.ProgressUpdateEvent=s.ProgressUpdateEvent,t.ProgressEndEvent=s.ProgressEndEvent,t.Thread=s.Thread,t.StackFrame=s.StackFrame,t.Scope=s.Scope,t.Variable=s.Variable,t.Breakpoint=s.Breakpoint,t.Source=s.Source,t.Module=s.Module,t.CompletionItem=s.CompletionItem,t.ErrorDestination=s.ErrorDestination;const n=i(200);t.LoggingDebugSession=n.LoggingDebugSession;const r=i(95);t.Logger=r;const o=i(73);t.Event=o.Event,t.Response=o.Response;const a=i(202);t.Handles=a.Handles;const c=r.logger;t.logger=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.isDartDocument=function(e){return e&&"dart"===e.languageId},t.getActiveDartEditor=function(){const e=s.window.activeTextEditor;if(e&&"dart"===e.document.languageId)return e}},function(e,t){const i=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:i,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t){const i="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=i},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>s(e,t,i)>0},function(e,t,i){const s=Symbol("SemVer ANY");class n{static get ANY(){return s}constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new l(i[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return a(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),r=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),c=a(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=a(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||s||r&&o||c||l}}e.exports=n;const{re:r,t:o}=i(23),a=i(80),c=i(39),l=i(11),u=i(17)},function(e,t,i){const s=i(17);e.exports=(e,t,i)=>{try{t=new s(t,i)}catch(e){return!1}return t.test(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(61);t.safeSpawn=function(e,t,i,n){const r=Object.assign({},process.env,n.toolEnv,n.envOverrides),o=i.map(e=>`"${e.replace(/"/g,'\\"')}"`);return s.spawn(`"${t}"`,o,{cwd:e,env:r,shell:!0})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(4),o=i(3),a=i(1);t.PackageMap=class{constructor(e){if(this.map={},!e)return;this.localPackageRoot=n.dirname(e);const t=s.readFileSync(e,{encoding:"utf8"}).split("\n");for(let e of t){if(e=e.trim(),0===e.length||e.startsWith("#"))continue;const t=e.indexOf(":");if(-1!==t){const i=e.substr(0,t),s=e.substring(t+1);s.startsWith("file:")?this.map[i]=o.uriToFilePath(s):this.map[i]=n.join(this.localPackageRoot,s)}}}static findPackagesFile(e){if("string"==typeof e)return o.findFile(".packages",e)}get packages(){return Object.assign({},this.map)}getPackagePath(e){return this.map[e]}resolvePackageUri(e){if(!e)return;let t=e;t.startsWith("package:")&&(t=t.substring(8));const i=t.indexOf("/");if(-1===i)return;const s=t.substring(i+1);t=t.substring(0,i);const r=this.getPackagePath(t);return r?n.join(r,s):void 0}convertFileToPackageUri(e){if(e)for(const t of Object.keys(this.map)){const i=this.map[t];if(a.isWithinPath(e,i)){let s=e.substring(i.length);return r.isWin&&(s=s.replace(/\\/g,"/")),s.startsWith("/")&&(s=s.substr(1)),`package:${t}/${s}`}}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class s{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var i=!1,s=0,n=this._callbacks.length;s<n;s++)if(this._callbacks[s]===e){if(this._contexts[s]===t)return this._callbacks.splice(s,1),void this._contexts.splice(s,1);i=!0}if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],i=this._callbacks.slice(0),s=this._contexts.slice(0),n=0,r=i.length;n<r;n++)try{t.push(i[n].apply(s[n],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{let r;return this._callbacks||(this._callbacks=new s),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),r={dispose:()=>{this._callbacks.remove(e,t),r.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(i)&&i.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=n,n._noop=function(){}},function(e,t){e.exports=require("crypto")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(0),r=i(3),o=i(1),a=new RegExp(r.escapeRegExp("${debugType}"),"gi");function c(e,t){var i;const s=(null===(i=e.codeLens)||void 0===i?void 0:i.for)||e.template;return!!s&&("string"==typeof s&&s===t||Array.isArray(s)&&-1!==s.indexOf(t))}t.getTemplatedLaunchConfigs=function(e,t){var i,r;const l=n.workspace.getConfiguration("launch",e.uri).get("configurations")||[],u=["run-"+t,"debug-"+t],d=o.fsPath(e.uri),h=null===(i=n.workspace.getWorkspaceFolder(e.uri))||void 0===i?void 0:i.uri,p=h?o.fsPath(h):void 0,g=[];for(const e of u){const t=l.filter(t=>"dart"===t.type&&c(t,e)).filter(e=>{var t,i,n;return(null===(t=e.codeLens)||void 0===t?void 0:t.path)&&p?o.isWithinPath(d,s.join(p,null===(i=e.codeLens)||void 0===i?void 0:i.path)):!(null===(n=e.codeLens)||void 0===n?void 0:n.path)});for(const i of t)g.push(Object.assign(Object.assign({},i),{name:((null===(r=i.codeLens)||void 0===r?void 0:r.title)||i.name||"${debugType}").replace(a,0===e.indexOf("run-")?"Run":"Debug"),template:e}))}return g},t.isTemplateOfType=c},function(e,t,i){"use strict";const s=i(207),n=i(49),r=i(208),{kStatusCode:o,NOOP:a}=i(26),c=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),u=Symbol("total-length"),d=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let g;function f(e){this[h].push(e),this[u]+=e.length}function m(e){this[u]+=e.length,this[l]._maxPayload<1||this[u]<=this[l]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p][o]=1009,this.removeListener("data",m),this.reset())}function v(e){this[l]._inflate=null,e[o]=1007,this[d](e)}e.exports=class{constructor(e,t,i){if(this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!g){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;g=new r(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,i=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!i)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(i.server_no_context_takeover=!0),t.clientNoContextTakeover&&(i.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(i.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?i.client_max_window_bits=t.clientMaxWindowBits:!0!==i.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete i.client_max_window_bits,i}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let i=e[t];if(i.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(i=i[0],"client_max_window_bits"===t){if(!0!==i){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}else if("server_max_window_bits"===t){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==i)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}e[t]=i})}),e}decompress(e,t,i){g.add(s=>{this._decompress(e,t,(e,t)=>{s(),i(e,t)})})}compress(e,t,i){g.add(s=>{this._compress(e,t,(e,t)=>{s(),i(e,t)})})}_decompress(e,t,i){const r=this._isServer?"client":"server";if(!this._inflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=s.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[u]=0,this._inflate[h]=[],this._inflate.on("error",v),this._inflate.on("data",m)}this._inflate[d]=i,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void i(e);const s=n.concat(this._inflate[h],this._inflate[u]);t&&this.params[r+"_no_context_takeover"]?(this._inflate.close(),this._inflate=null):(this._inflate[u]=0,this._inflate[h]=[]),i(null,s)})}_compress(e,t,i){const r=this._isServer?"server":"client";if(!this._deflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=s.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[u]=0,this._deflate[h]=[],this._deflate.on("error",a),this._deflate.on("data",f)}this._deflate[d]=i,this._deflate.write(e),this._deflate.flush(s.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[h],this._deflate[u]);t&&(e=e.slice(0,e.length-4)),this._deflate[d]=null,t&&this.params[r+"_no_context_takeover"]?(this._deflate.close(),this._deflate=null):(this._deflate[u]=0,this._deflate[h]=[]),i(null,e)})}}},function(e,t,i){"use strict";const{EMPTY_BUFFER:s}=i(26);function n(e,t){if(0===e.length)return s;if(1===e.length)return e[0];const i=Buffer.allocUnsafe(t);let n=0;for(let t=0;t<e.length;t++){const s=e[t];i.set(s,n),n+=s.length}return n<t?i.slice(0,n):i}function r(e,t,i,s,n){for(let r=0;r<n;r++)i[s+r]=e[r]^t[3&r]}function o(e,t){const i=e.length;for(let s=0;s<i;s++)e[s]^=t[3&s]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){if(c.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),c.readOnly=!1),t}try{const t=i(!function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()),s=t.BufferUtil||t;e.exports={concat:n,mask(e,t,i,n,o){o<48?r(e,t,i,n,o):s.mask(e,t,i,n,o)},toArrayBuffer:a,toBuffer:c,unmask(e,t){e.length<32?o(e,t):s.unmask(e,t)}}}catch(t){e.exports={concat:n,mask:r,toArrayBuffer:a,toBuffer:c,unmask:o}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(36),n=i(8),r=i(3);t.DebugAdapterLogger=class{constructor(e,t){this.debugClient=e,this.category=t}log(e,t,i=this.category){this.debugClient.sendEvent(new s.Event("dart.log",{message:e,severity:t,category:i}))}info(e,t){this.log(e,n.LogSeverity.Info,t)}warn(e,t){this.log(r.errorString(e),n.LogSeverity.Warn,t)}error(e,t){this.log(r.errorString(e),n.LogSeverity.Error,t)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(32);class r extends n.StdIOService{constructor(e,t,i,s,n,r=!1,o=!1){super(i,n,r,o,t),this.mode=e,this.urlExposer=s,this.unhandledMessageSubscriptions=[],this.daemonConnectedSubscriptions=[],this.appStartSubscriptions=[],this.appDebugPortSubscriptions=[],this.appStartedSubscriptions=[],this.appStopSubscriptions=[],this.appProgressSubscriptions=[],this.appWebLaunchUrlSubscriptions=[],this.appLogSubscriptions=[],this.errorSubscriptions=[],this.daemonLogMessageSubscriptions=[],this.daemonLogSubscriptions=[]}shouldHandleMessage(e){return e.startsWith("[{")&&e.endsWith("}]")}processUnhandledMessage(e){this.notify(this.unhandledMessageSubscriptions,e)}registerForUnhandledMessages(e){return this.subscribe(this.unhandledMessageSubscriptions,e)}handleRequest(e,t){return s(this,void 0,void 0,(function*(){switch(e){case"app.exposeUrl":return this.urlExposer(t.url);default:throw new Error("Unknown request "+e)}}))}handleNotification(e){switch(e.params.error&&this.notify(this.errorSubscriptions,e.params.error),e.event){case"daemon.connected":this.notify(this.daemonConnectedSubscriptions,e.params);break;case"app.start":this.notify(this.appStartSubscriptions,e.params);break;case"app.debugPort":this.notify(this.appDebugPortSubscriptions,e.params);break;case"app.started":this.notify(this.appStartedSubscriptions,e.params);break;case"app.webLaunchUrl":this.notify(this.appWebLaunchUrlSubscriptions,e.params);break;case"app.stop":this.notify(this.appStopSubscriptions,e.params);break;case"app.progress":this.notify(this.appProgressSubscriptions,e.params);break;case"app.log":this.notify(this.appLogSubscriptions,e.params);break;case"daemon.logMessage":this.notify(this.daemonLogMessageSubscriptions,e.params);break;case"daemon.log":this.notify(this.daemonLogSubscriptions,e.params)}}restart(e,t,i,s){return this.sendRequest("app.restart",{appId:e,fullRestart:!0===i,pause:t,reason:s})}detach(e){return this.sendRequest("app.detach",{appId:e})}stop(e){return this.sendRequest("app.stop",{appId:e})}callServiceExtension(e,t,i){return this.sendRequest("app.callServiceExtension",{appId:e,methodName:t,params:i})}registerForDaemonConnect(e){return this.subscribe(this.daemonConnectedSubscriptions,e)}registerForAppStart(e){return this.subscribe(this.appStartSubscriptions,e)}registerForAppDebugPort(e){return this.subscribe(this.appDebugPortSubscriptions,e)}registerForAppStarted(e){return this.subscribe(this.appStartedSubscriptions,e)}registerForAppStop(e){return this.subscribe(this.appStopSubscriptions,e)}registerForAppProgress(e){return this.subscribe(this.appProgressSubscriptions,e)}registerForAppWebLaunchUrl(e){return this.subscribe(this.appWebLaunchUrlSubscriptions,e)}registerForAppLog(e){return this.subscribe(this.appLogSubscriptions,e)}registerForError(e){return this.subscribe(this.errorSubscriptions,e)}registerForDaemonLogMessage(e){return this.subscribe(this.daemonLogMessageSubscriptions,e)}registerForDaemonLog(e){return this.subscribe(this.daemonLogSubscriptions,e)}}t.RunDaemonBase=r,function(e){e[e.Run=0]="Run",e[e.Attach=1]="Attach"}(t.RunMode||(t.RunMode={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n={};function r(e){return n[e]&&(n[e].hide(),n[e].dispose()),n[e]=s.window.createOutputChannel(e),n[e]}t.createChannel=r,t.getChannel=function(e){return n[e]?n[e]:r(e)},t.runProcessInChannel=function(e,t){e.stdout.on("data",e=>t.append(e.toString())),e.stderr.on("data",e=>t.append(e.toString())),e.on("close",e=>t.appendLine("exit code "+e))}},function(e,t){const i=/^[0-9]+$/,s=(e,t)=>{const s=i.test(e),n=i.test(t);return s&&n&&(e=+e,t=+t),e===t?0:s&&!n?-1:n&&!s?1:e<t?-1:1};e.exports={compareIdentifiers:s,rcompareIdentifiers:(e,t)=>s(t,e)}},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>0===s(e,t,i)},function(e,t,i){const s=i(11);e.exports=(e,t,i)=>{const n=new s(e,i),r=new s(t,i);return n.compare(r)||n.compareBuild(r)}},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>s(e,t,i)<0},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>s(e,t,i)>=0},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>s(e,t,i)<=0},function(e,t,i){const s=i(11),n=i(41),{ANY:r}=n,o=i(17),a=i(42),c=i(40),l=i(56),u=i(58),d=i(57);e.exports=(e,t,i,h)=>{let p,g,f,m,v;switch(e=new s(e,h),t=new o(t,h),i){case">":p=c,g=u,f=l,m=">",v=">=";break;case"<":p=l,g=d,f=c,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let i=0;i<t.set.length;++i){const s=t.set[i];let o=null,a=null;if(s.forEach(e=>{e.semver===r&&(e=new n(">=0.0.0")),o=o||e,a=a||e,p(e.semver,o.semver,h)?o=e:f(e.semver,a.semver,h)&&(a=e)}),o.operator===m||o.operator===v)return!1;if((!a.operator||a.operator===m)&&g(e,a.semver))return!1;if(a.operator===v&&f(e,a.semver))return!1}return!0}},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("child_process")},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(44),l=i(3),u=i(1),d=i(25),h=i(146),p=i(5),g=i(147),f=i(9),m=i(22),v=i(6);function y(e){if(e&&u.hasPubspec(e)){return new RegExp("sdk\\s*:\\s*flutter","i").test(n.readFileSync(r.join(e,"pubspec.yaml")).toString())}return!1}function b(e){if(!n.existsSync(e))return;let t=new c.PackageMap(e).getPackagePath("flutter");if(!t)return;a.isWin&&(t=t.replace(/\\/g,"/"));return t.endsWith("/packages/flutter/lib/")&&(t=t.substr(0,t.length-"/packages/flutter/lib/".length)),t.endsWith("/")||(t+="/"),t.endsWith("/bin/")||(t+="bin/"),a.isWin&&(t=t.replace(/\//g,"\\"),"\\"===t[0]&&(t=t.substring(1))),t}function w(e){return T(e,".jiri_root")}function S(e){return T(e,"WORKSPACE",!0)}function C(e){return T(e,".git")}function T(e,t,i=!1){if(e){let s=e;for(;s;){try{const e=n.statSync(r.join(s,t));if(i?e.isFile():e.isDirectory())return s}catch(e){}const e=r.dirname(s);if(s===e)break;s=e}}}t.SdkUtils=class{constructor(e){this.logger=e,this.hasShownActivationFailure=!1}handleMissingSdks(e,t,i){e.subscriptions.push(o.commands.registerCommand("flutter.createProject",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.createProject")})),e.subscriptions.push(o.commands.registerCommand("dart.createProject",e=>{this.showRelevantActivationFailureMessage(t,i,!1,"dart.createProject")})),e.subscriptions.push(o.commands.registerCommand("_dart.flutter.createSampleProject",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"_dart.flutter.createSampleProject")})),e.subscriptions.push(o.commands.registerCommand("flutter.doctor",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.doctor")})),e.subscriptions.push(o.commands.registerCommand("flutter.upgrade",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.upgrade")})),setTimeout(()=>{this.hasShownActivationFailure||(i.hasAnyFlutterProjects?this.showRelevantActivationFailureMessage(t,i,!0):i.hasAnyStandardDartProjects?this.showRelevantActivationFailureMessage(t,i,!1):this.logger.error("No Dart or Flutter SDK was found. Suppressing prompt because it doesn't appear that a Dart/Flutter project is open."))},500)}showRelevantActivationFailureMessage(e,t,i,s){i&&t.sdks.flutter&&!t.sdks.dart?this.showFluttersDartSdkActivationFailure():i?this.showFlutterActivationFailure(s):this.showDartActivationFailure(s),this.hasShownActivationFailure||(e.logSdkDetectionFailure(),this.hasShownActivationFailure=!0)}showFluttersDartSdkActivationFailure(){v.promptToReloadExtension("Could not find Dart in your Flutter SDK. Please run 'flutter doctor' in the terminal then reload the project once all issues are resolved.","Reload",!0)}showFlutterActivationFailure(e){this.showSdkActivationFailure("Flutter",e=>this.findFlutterSdk(e),a.FLUTTER_DOWNLOAD_URL,e=>f.config.setGlobalFlutterSdkPath(e),e)}showDartActivationFailure(e){this.showSdkActivationFailure("Dart",e=>this.findDartSdk(e),a.DART_DOWNLOAD_URL,e=>f.config.setGlobalDartSdkPath(e),e)}showSdkActivationFailure(e,t,i,n,r){return s(this,void 0,void 0,(function*(){let s=`Could not find a ${e} SDK. Please ensure ${e.toLowerCase()} is installed and in your PATH (you may need to restart).`;for(;;){const c=m.ringLog.toString(),l=yield o.window.showErrorMessage(s,"Locate SDK","Download SDK",a.showLogAction);if("Locate SDK"!==l){if("Download SDK"===l){yield p.envUtils.openInBrowser(i);break}if(l===a.showLogAction){v.openLogContents(void 0,c);break}break}{const i=yield o.window.showOpenDialog({canSelectFolders:!0,openLabel:`Set ${e} SDK folder`});if(i&&i.length>0){const a=t(i.map(u.fsPath));if(a){yield n(a),yield v.promptToReloadExtension(),r&&o.commands.executeCommand(r);break}s=`That folder does not appear to be a ${e} SDK.`}}}}))}scanWorkspace(){return s(this,void 0,void 0,(function*(){this.logger.info("Searching for SDKs...");const e=p.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=process.env.DART_PATH_OVERRIDE||"",i=process.env.PATH||"",s=(t+r.delimiter+i).split(r.delimiter).filter(e=>e);this.logger.info("Environment PATH:");for(const e of s)this.logger.info("    "+e);if(f.config.analyzerSshHost)return new g.WorkspaceContext({dart:f.config.sdkPath,dartSdkIsFromFlutter:!1,flutter:void 0},{},!1,!1,!1,!1);const o={},c=(t,i)=>{let s;return e.forEach(e=>s=s||t(e)),s&&i(this.logger,o,s),s};c(C,h.processKnownGitRepositories),c(S,(e,t,i)=>h.processBazelWorkspace(e,t,i,f.config.previewBazelWorkspaceCustomScripts));const m=c(w,h.processFuchsiaWorkspace);let T,E=!1,R=!1,P=!1,D=!1;const _=yield u.findProjectFolders(e);for(const e of _){const t=u.hasPubspec(e),i=t&&y(e),s=!1,o=n.existsSync(r.join(e,a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE)),c=n.existsSync(r.join(e,"bin/flutter"))&&n.existsSync(r.join(e,"bin/cache/dart-sdk"));yield d.resolvedPromise;const l=i||o||c;l&&this.logger.info(`Found Flutter project at ${e}:\n\t\t\tMobile? ${i}\n\t\t\tWeb? ${s}\n\t\t\tCreate Trigger? ${o}\n\t\t\tFlutter Repo? ${c}`),T=T||(l?e:void 0),E=E||l,R=R||i||o,P=P||s,D=D||!l&&t}m&&(this.logger.info("Found Fuchsia root at "+m),D&&this.logger.info("Found Fuchsia project that is not vanilla Flutter"));const k=[null==o?void 0:o.flutterSdkHome,f.config.flutterSdkPath,m&&r.join(m,"lib/flutter"),m&&r.join(m,"third_party/dart-pkg/git/flutter"),T,T&&b(r.join(T,".packages")),T&&r.join(T,".flutter"),T&&r.join(T,"vendor/flutter"),process.env.FLUTTER_ROOT].concat(s).filter(l.notUndefined),x=this.findFlutterSdk(k);yield d.resolvedPromise;const O=[a.isMac?null==o?void 0:o.dartSdkHomeMac:null==o?void 0:o.dartSdkHomeLinux,m&&r.join(m,"topaz/tools/prebuilt-dart-sdk",a.dartPlatformName+"-x64"),m&&r.join(m,"third_party/dart/tools/sdks/dart-sdk"),m&&r.join(m,"third_party/dart/tools/sdks",a.dartPlatformName,"dart-sdk"),m&&r.join(m,"dart/tools/sdks",a.dartPlatformName,"dart-sdk"),T&&x&&r.join(x,"bin/cache/dart-sdk"),f.config.sdkPath].concat(s).concat([x&&r.join(x,"bin/cache/dart-sdk")]).filter(l.notUndefined),F=this.findDartSdk(O);return yield d.resolvedPromise,new g.WorkspaceContext({dart:F,dartSdkIsFromFlutter:!!F&&l.isDartSdkFromFlutter(F),dartVersion:v.getSdkVersion(this.logger,{sdkRoot:F}),flutter:x,flutterVersion:v.getSdkVersion(this.logger,{sdkRoot:x,versionFile:null==o?void 0:o.flutterVersionFile})},o,R,P,D,!!m&&D)}))}findDartSdk(e){return this.searchPaths(e,a.dartExecutableName,e=>this.hasExecutable(e,a.dartVMPath)&&t.hasDartAnalysisServer(e))}findFlutterSdk(e){return this.searchPaths(e,a.flutterExecutableName,e=>this.hasExecutable(e,a.flutterPath))}hasExecutable(e,t){const i=r.join(e,t);return n.existsSync(i)&&n.statSync(i).isFile()}searchPaths(e,t,i){this.logger.info("Searching for "+t);let s=e.filter(e=>e).map(v.resolvePaths).filter(l.notUndefined);s=l.flatMap(s,e=>{return t=e,-1!==["bin","sbin"].indexOf(r.basename(t))?[e]:[e,r.join(e,"bin")];var t}),this.logger.info(`    Looking for ${t} in:`);for(const e of s)this.logger.info("        "+e);s=s.filter(e=>n.existsSync(r.join(e,t))),this.logger.info("    Found at:");for(const e of s)this.logger.info("        "+e);s=s.map(e=>{const i=r.join(e,t),s=e&&n.realpathSync(i);return s.toLowerCase()!==i.toLowerCase()&&this.logger.info(`Following symlink: ${i} ==> ${s}`),r.dirname(r.dirname(s))}),this.logger.info("    Candidate paths to be post-filtered:");for(const e of s)this.logger.info("        "+e);const o=s.find(i||(e=>!0));return o&&this.logger.info("    Found at "+o),this.logger.info(`    Returning SDK path ${o} for ${t}`),o}},t.referencesFlutterSdk=y,t.referencesBuildRunner=function(e){if(e&&u.hasPubspec(e)){return new RegExp("build_runner\\s*:","i").test(n.readFileSync(r.join(e,"pubspec.yaml")).toString())}return!1},t.hasDartAnalysisServer=e=>n.existsSync(r.join(e,a.analyzerSnapshotPath))},function(e,t){e.exports=require("stream")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(61),n=i(7),r=i(151),o=i(19),a=i(0),c=i(10),l=i(174),u=i(175),d=i(176),h=i(177),p=i(178),g=i(179),f=i(180),m=i(181),v=i(182),y=i(183),b=i(184),w=i(35),S=i(185);!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(19));var C,T,E,R,P,D,_;!function(e){e.is=function(e){return w.string(e.command)}}(C||(C={})),function(e){e[e.stdio=0]="stdio",e[e.ipc=1]="ipc",e[e.pipe=2]="pipe",e[e.socket=3]="socket"}(T=t.TransportKind||(t.TransportKind={})),function(e){e.isSocket=function(e){let t=e;return t&&t.kind===T.socket&&w.number(t.port)}}(E||(E={})),function(e){e.is=function(e){return w.string(e.module)}}(R||(R={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.writer&&void 0!==t.reader}}(P||(P={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.process&&"boolean"==typeof t.detached}}(D||(D={}));class k extends o.BaseLanguageClient{constructor(e,t,i,s,n){let r,o,a,c,l;w.string(t)?(r=e,o=t,a=i,c=s,l=!!n):(r=e.toLowerCase(),o=e,a=t,c=i,l=s),void 0===l&&(l=!1),super(r,o,c),this._serverOptions=a,this._forceDebug=l;try{this.checkVersion()}catch(e){throw w.string(e.message)&&this.outputChannel.appendLine(e.message),e}}checkVersion(){let e=r.parse(a.version);if(!e)throw new Error("No valid VS Code version detected. Version string is: "+a.version);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!r.satisfies(e,"^1.41.0"))throw new Error("The language client requires VS Code version ^1.41.0 but received version "+a.version)}stop(){return super.stop().then(()=>{if(this._serverProcess){let e=this._serverProcess;this._serverProcess=void 0,void 0!==this._isDetached&&this._isDetached||this.checkProcessDied(e),this._isDetached=void 0}})}checkProcessDied(e){e&&setTimeout(()=>{try{process.kill(e.pid,0),S.terminate(e)}catch(e){}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}createMessageTransports(e){function t(e,t){if(!e&&!t)return;let i=Object.create(null);return Object.keys(process.env).forEach(e=>i[e]=process.env[e]),t&&(i.ELECTRON_RUN_AS_NODE="1",i.ELECTRON_NO_ASAR="1"),e&&Object.keys(e).forEach(t=>i[t]=e[t]),i}const i=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],n=["--debug","--debug-brk","--inspect","--inspect-brk"];function r(e){if(null===e.stdin||null===e.stdout||null===e.stderr)throw new Error("Process created without stdio streams")}let a,l=this._serverOptions;if(w.func(l))return l().then(t=>{if(o.MessageTransports.is(t))return this._isDetached=!!t.detached,t;if(P.is(t))return this._isDetached=!!t.detached,{reader:new c.StreamMessageReader(t.reader),writer:new c.StreamMessageWriter(t.writer)};{let i;return D.is(t)?(i=t.process,this._isDetached=t.detached):(i=t,this._isDetached=!1),i.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),{reader:new c.StreamMessageReader(i.stdout),writer:new c.StreamMessageWriter(i.stdin)}}});let u=l;return a=u.run||u.debug?this._forceDebug||function(){let e=process.execArgv;return!!e&&e.some(e=>i.some(t=>e.startsWith(t))||n.some(t=>e===t))}()?u.debug:u.run:l,this._getServerWorkingDir(a.options).then(i=>{if(R.is(a)&&a.module){let n=a,o=n.transport||T.stdio;if(!n.runtime){let a=void 0;return new Promise((l,u)=>{let d=n.args&&n.args.slice()||[];o===T.ipc?d.push("--node-ipc"):o===T.stdio?d.push("--stdio"):o===T.pipe?(a=c.generateRandomPipeName(),d.push("--pipe="+a)):E.isSocket(o)&&d.push("--socket="+o.port),d.push("--clientProcessId="+process.pid.toString());let h=n.options||Object.create(null);if(h.env=t(h.env,!0),h.execArgv=h.execArgv||[],h.cwd=i,h.silent=!0,o===T.ipc||o===T.stdio){let t=s.fork(n.module,d||[],h);r(t),this._serverProcess=t,t.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),o===T.ipc?(t.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),l({reader:new c.IPCMessageReader(this._serverProcess),writer:new c.IPCMessageWriter(this._serverProcess)})):l({reader:new c.StreamMessageReader(t.stdout),writer:new c.StreamMessageWriter(t.stdin)})}else o===T.pipe?c.createClientPipeTransport(a).then(t=>{let i=s.fork(n.module,d||[],h);r(i),this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),t.onConnected().then(e=>{l({reader:e[0],writer:e[1]})})}):E.isSocket(o)&&c.createClientSocketTransport(o.port).then(t=>{let i=s.fork(n.module,d||[],h);r(i),this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),t.onConnected().then(e=>{l({reader:e[0],writer:e[1]})})})})}{let r=[],a=n.options||Object.create(null);a.execArgv&&a.execArgv.forEach(e=>r.push(e)),r.push(n.module),n.args&&n.args.forEach(e=>r.push(e));let l=Object.create(null);l.cwd=i,l.env=t(a.env,!1);let u=void 0;if(o===T.ipc?(l.stdio=[null,null,null,"ipc"],r.push("--node-ipc")):o===T.stdio?r.push("--stdio"):o===T.pipe?(u=c.generateRandomPipeName(),r.push("--pipe="+u)):E.isSocket(o)&&r.push("--socket="+o.port),r.push("--clientProcessId="+process.pid.toString()),o===T.ipc||o===T.stdio){let t=s.spawn(n.runtime,r,l);return t&&t.pid?(this._serverProcess=t,t.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),o===T.ipc?(t.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),Promise.resolve({reader:new c.IPCMessageReader(t),writer:new c.IPCMessageWriter(t)})):Promise.resolve({reader:new c.StreamMessageReader(t.stdout),writer:new c.StreamMessageWriter(t.stdin)})):Promise.reject(`Launching server using runtime ${n.runtime} failed.`)}if(o===T.pipe)return c.createClientPipeTransport(u).then(t=>{let i=s.spawn(n.runtime,r,l);return i&&i.pid?(this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${n.runtime} failed.`)});if(E.isSocket(o))return c.createClientSocketTransport(o.port).then(t=>{let i=s.spawn(n.runtime,r,l);return i&&i.pid?(this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${n.runtime} failed.`)})}}else if(C.is(a)&&a.command){let t=a,n=t.args||[],r=Object.assign({},t.options);r.cwd=r.cwd||i;let o=s.spawn(t.command,n,r);return o&&o.pid?(o.stderr.on("data",t=>this.outputChannel.append(w.string(t)?t:t.toString(e))),this._serverProcess=o,this._isDetached=!!r.detached,Promise.resolve({reader:new c.StreamMessageReader(o.stdout),writer:new c.StreamMessageWriter(o.stdin)})):Promise.reject(`Launching server using command ${t.command} failed.`)}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(l,null,4)))})}registerProposedFeatures(){this.registerFeatures(_.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new u.ConfigurationFeature(this)),this.registerFeature(new h.TypeDefinitionFeature(this)),this.registerFeature(new d.ImplementationFeature(this)),this.registerFeature(new l.ColorProviderFeature(this)),this.registerFeature(new p.WorkspaceFoldersFeature(this)),this.registerFeature(new g.FoldingRangeFeature(this)),this.registerFeature(new f.DeclarationFeature(this)),this.registerFeature(new m.SelectionRangeFeature(this)),this.registerFeature(new v.ProgressFeature(this))}_mainGetRootPath(){let e=a.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(e=>{n.lstat(t,(i,s)=>{e(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}}t.LanguageClient=k;t.SettingMonitor=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return a.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new a.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,i=e>=0?this._setting.substr(e+1):void 0,s=i?a.workspace.getConfiguration(t).get(i,!1):a.workspace.getConfiguration(t);s&&this._client.needsStart()?this._client.start():!s&&this._client.needsStop()&&this._client.stop()}},function(e){e.createAll=function(e){return[new y.CallHierarchyFeature(e),new b.SemanticTokensFeature(e)]}}(_=t.ProposedFeatures||(t.ProposedFeatures={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(45),n=i(33);let r=Buffer.from("\r","ascii")[0],o=Buffer.from("\n","ascii")[0];class a{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(8192)}append(e){var t=e;if("string"==typeof e){var i=e,s=Buffer.byteLength(i,this.encoding);(t=Buffer.allocUnsafe(s)).write(i,0,s,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var n=8192*(Math.ceil((this.index+t.length)/8192)+1);0===this.index?(this.buffer=Buffer.allocUnsafe(n),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],n)}this.index+=t.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==r||this.buffer[t+1]!==o||this.buffer[t+2]!==r||this.buffer[t+3]!==o);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach(t=>{let i=t.indexOf(":");if(-1===i)throw new Error("Message header must separate key and value using :");let s=t.substr(0,i),n=t.substr(i+1).trim();e[s]=n});let i=t+4;return this.buffer=this.buffer.slice(i),this.index=this.index-i,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),i=e;return this.buffer.copy(this.buffer,0,i),this.index=this.index-i,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&n.func(t.listen)&&n.func(t.dispose)&&n.func(t.onError)&&n.func(t.onClose)&&n.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class c{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter,this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error("Reader received error. Reason: "+(n.string(e.message)?e.message:"unknown"))}}t.AbstractMessageReader=c;class l extends c{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new a(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let i=parseInt(t);if(isNaN(i))throw new Error("Content-Length value must be a number.");this.nextMessageLength=i}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var i=JSON.parse(t);this.callback(i)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l;t.IPCMessageReader=class extends c{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(45),n=i(33);!function(e){e.is=function(e){let t=e;return t&&n.func(t.dispose)&&n.func(t.onClose)&&n.func(t.onError)&&n.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class r{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error("Writer received error. Reason: "+(n.string(e.message)?e.message:"unknown"))}}t.AbstractMessageWriter=r;t.StreamMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(e){let t=JSON.stringify(e),i=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(i.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.IPCMessageWriter=class extends r{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends r{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),i=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(i.join(""),"ascii",i=>{i&&this.handleError(i,e);try{this.socket.write(t,this.encoding,t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(i){this.handleError(i,e)}})}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(64);class n{}t.AnalyzerStatusNotification=n,n.type=new s.NotificationType("$/analyzerStatus");class r{}t.PublishClosingLabelsNotification=r,r.type=new s.NotificationType("dart/textDocument/publishClosingLabels");class o{}t.PublishOutlineNotification=o,o.type=new s.NotificationType("dart/textDocument/publishOutline");class a{}t.PublishFlutterOutlineNotification=a,a.type=new s.NotificationType("dart/textDocument/publishFlutterOutline");class c{}t.SuperRequest=c,c.type=new s.RequestType("dart/textDocument/super");class l{}t.DiagnosticServerRequest=l,l.type=new s.RequestType("dart/diagnosticServer");class u{}t.CompleteStatementRequest=u,u.type=new s.RequestType("dart/completeStatement")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.element&&e.element.kind){case"CLASS":this.visitClass(e);break;case"CLASS_TYPE_ALIAS":this.visitClassTypeAlias(e);break;case"COMPILATION_UNIT":this.visitCompilationUnit(e);break;case"CONSTRUCTOR":this.visitConstructor(e);break;case"CONSTRUCTOR_INVOCATION":this.visitContructorInvocation(e);break;case"ENUM":this.visitEnum(e);break;case"ENUM_CONSTANT":this.visitEnumConstant(e);break;case"FIELD":this.visitField(e);break;case"FILE":this.visitXXX(e);break;case"FUNCTION":this.visitFile(e);break;case"FUNCTION_INVOCATION":this.visitFunctionInvocation(e);break;case"FUNCTION_TYPE_ALIAS":this.visitFunctionTypeAlias(e);break;case"GETTER":this.visitGetter(e);break;case"LABEL":this.visitLabel(e);break;case"LIBRARY":this.visitLibrary(e);break;case"LOCAL_VARIABLE":this.visitLocalVariable(e);break;case"METHOD":this.visitMethod(e);break;case"PARAMETER":this.visitParameter(e);break;case"PREFIX":this.visitPrefix(e);break;case"SETTER":this.visitSetter(e);break;case"TOP_LEVEL_VARIABLE":this.visitTopLevelVariable(e);break;case"TYPE_PARAMETER":this.visitTypeParameter(e);break;case"UNIT_TEST_GROUP":this.visitUnitTestGroup(e);break;case"UNIT_TEST_TEST":this.visitUnitTestTest(e);break;case"UNKNOWN":this.visitUnknown(e);break;default:this.logger.error("Unknown Outline item! "+(e&&e.element&&e.element.kind))}}visitClass(e){this.visitChildren(e)}visitClassTypeAlias(e){this.visitChildren(e)}visitCompilationUnit(e){this.visitChildren(e)}visitConstructor(e){this.visitChildren(e)}visitContructorInvocation(e){this.visitChildren(e)}visitEnum(e){this.visitChildren(e)}visitEnumConstant(e){this.visitChildren(e)}visitField(e){this.visitChildren(e)}visitXXX(e){this.visitChildren(e)}visitFile(e){this.visitChildren(e)}visitFunctionInvocation(e){this.visitChildren(e)}visitFunctionTypeAlias(e){this.visitChildren(e)}visitGetter(e){this.visitChildren(e)}visitLabel(e){this.visitChildren(e)}visitLibrary(e){this.visitChildren(e)}visitLocalVariable(e){this.visitChildren(e)}visitMethod(e){this.visitChildren(e)}visitParameter(e){this.visitChildren(e)}visitPrefix(e){this.visitChildren(e)}visitSetter(e){this.visitChildren(e)}visitTopLevelVariable(e){this.visitChildren(e)}visitTypeParameter(e){this.visitChildren(e)}visitUnitTestGroup(e){this.visitChildren(e)}visitUnitTestTest(e){this.visitChildren(e)}visitUnknown(e){this.visitChildren(e)}}t.OutlineVisitor=s;t.TestOutlineVisitor=class extends s{constructor(){super(...arguments),this.tests=[],this.names=[]}visitUnitTestTest(e){this.addTest(e,super.visitUnitTestTest)}visitUnitTestGroup(e){this.addTest(e,super.visitUnitTestGroup)}addTest(e,t){const i=this.extractTestName(e.element.name);if(!i||!e.element.location)return;this.names.push(i);const s=this.names.join(" "),n="UNIT_TEST_GROUP"===e.element.kind;this.tests.push({file:e.element.location.file,fullName:s,isGroup:n,length:e.codeLength||e.element.location.length,offset:e.codeOffset||e.element.location.offset});try{t.bind(this)(e)}finally{this.names.pop()}}extractTestName(e){if(!e)return;const t=e.indexOf("("),i=e.lastIndexOf(")");return-1===t||-1===i||t>=i?void 0:(((e=e.substring(t+2,i-1)).startsWith("'")||e.startsWith('"'))&&(e.endsWith("'")||e.endsWith('"'))&&(e=e.substring(1,e.length-1)),e)}};t.ClassOutlineVisitor=class extends s{constructor(){super(...arguments),this.classes=[]}visitClass(e){this.addClass(e),super.visitClass(e)}addClass(e){e.element&&e.element.location&&e.element.name&&this.classes.push({className:e.element.name,codeLength:e.codeLength,codeOffset:e.codeOffset,length:e.length,offset:e.offset})}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(8),l=i(3),u=i(1),d=i(94),h=i(5),p=i(9),g=i(198),f=i(70),m=i(223),v=i(224);t.debugSessions=[];let y=[],b=!1;class w{}t.LastDebugSession=w;class S{}t.LastTestDebugSession=S;t.DebugCommands=class{constructor(e,i,a,l,d){this.logger=e,this.context=i,this.analytics=l,this.debugOptions=o.window.createStatusBarItem(o.StatusBarAlignment.Left,0),this.currentDebugOption=c.DebugOption.MyCode,this.debugMetrics=o.window.createStatusBarItem(o.StatusBarAlignment.Right,0),this.onWillHotReloadEmitter=new o.EventEmitter,this.onWillHotReload=this.onWillHotReloadEmitter.event,this.onWillHotRestartEmitter=new o.EventEmitter,this.onWillHotRestart=this.onWillHotRestartEmitter.event,this.onFirstFrameEmitter=new o.EventEmitter,this.onFirstFrame=this.onFirstFrameEmitter.event,this.onDebugSessionVmServiceAvailableEmitter=new o.EventEmitter,this.onDebugSessionVmServiceAvailable=this.onDebugSessionVmServiceAvailableEmitter.event,this.vmServices=new g.VmServiceExtensions(e,this.sendServiceSetting),this.devTools=new m.DevToolsManager(e,a,this,l,d),i.subscriptions.push(this.devTools),i.subscriptions.push(this.debugOptions),i.subscriptions.push(this.debugMetrics),i.subscriptions.push(o.debug.onDidChangeBreakpoints(e=>this.handleBreakpointChange(e))),i.subscriptions.push(o.debug.onDidStartDebugSession(e=>this.handleDebugSessionStart(e))),i.subscriptions.push(o.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),i.subscriptions.push(o.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),i.subscriptions.push(o.commands.registerCommand("flutter.togglePlatform",()=>this.vmServices.toggle(c.VmServiceExtension.PlatformOverride,"iOS","android"))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugPainting",()=>this.vmServices.toggle(c.VmServiceExtension.DebugPaint))),i.subscriptions.push(o.commands.registerCommand("flutter.togglePerformanceOverlay",()=>this.vmServices.toggle(c.VmServiceExtension.PerformanceOverlay))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleRepaintRainbow",()=>this.vmServices.toggle(c.VmServiceExtension.RepaintRainbow))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugModeBanner",()=>this.vmServices.toggle(c.VmServiceExtension.DebugBanner))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleCheckElevations",()=>this.vmServices.toggle(c.VmServiceExtension.CheckElevations))),i.subscriptions.push(o.commands.registerCommand("flutter.togglePaintBaselines",()=>this.vmServices.toggle(c.VmServiceExtension.PaintBaselines))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleSlowAnimations",()=>this.vmServices.toggle(c.VmServiceExtension.SlowAnimations,g.timeDilationNormal,g.timeDilationSlow))),i.subscriptions.push(o.commands.registerCommand("flutter.inspectWidget",()=>this.vmServices.toggle(c.VmServiceExtension.InspectorSelectMode,!0,!0))),i.subscriptions.push(o.commands.registerCommand("flutter.cancelInspectWidget",()=>this.vmServices.toggle(c.VmServiceExtension.InspectorSelectMode,!1,!1))),i.subscriptions.push(o.commands.registerCommand("dart.openObservatory",()=>s(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return;const i=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();i&&!i.session.configuration.noDebug&&i.observatoryUri?(yield h.envUtils.openInBrowser(i.observatoryUri),l.logDebuggerOpenObservatory()):i&&e.warn("Cannot start Observatory for session without debug/observatoryUri")})))),i.subscriptions.push(o.commands.registerCommand("flutter.openTimeline",()=>s(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return;const i=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();i&&!i.session.configuration.noDebug&&i.observatoryUri?(yield h.envUtils.openInBrowser(i.observatoryUri+"/#/timeline-dashboard"),l.logDebuggerOpenTimeline()):i&&e.warn("Cannot start Observatory for session without debug/observatoryUri")})))),i.subscriptions.push(o.commands.registerCommand("_dart.openDevTools.touchBar",()=>o.commands.executeCommand("dart.openDevTools"))),["Inspector","Timeline","Memory","Performance"].forEach(e=>{i.subscriptions.push(o.commands.registerCommand("dart.openDevTools"+e,t=>s(this,void 0,void 0,(function*(){return t=Object.assign({},t,{page:e.toLowerCase()}),o.commands.executeCommand("dart.openDevTools",t)}))))}),i.subscriptions.push(o.commands.registerCommand("dart.openDevTools",e=>s(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return void o.window.showInformationMessage("You must have an active debug session to start DevTools.");const i=e&&e.debugSessionId?t.debugSessions.find(t=>t.session.id===e.debugSessionId):1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();if(!i)return;const s=!e||!0!==e.triggeredAutomatically,n=p.config.devToolsReuseWindows,r=e?e.page:void 0;if(i.vmServiceUri)return this.devTools.spawnForSession(i,n,s,r);i.session.configuration.noDebug?o.window.showInformationMessage("You must start your app with debugging in order to use DevTools."):o.window.showInformationMessage("This debug session is not ready yet.")})))),i.subscriptions.push(o.commands.registerCommand("_flutter.hotReload.touchBar",e=>o.commands.executeCommand("flutter.hotReload",e))),i.subscriptions.push(o.commands.registerCommand("flutter.hotReload",e=>{t.debugSessions.length&&(this.onWillHotReloadEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotReload",e)),l.logDebuggerHotReload())})),i.subscriptions.push(o.commands.registerCommand("flutter.hotRestart",e=>{t.debugSessions.length&&(this.onWillHotRestartEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotRestart",e)),l.logDebuggerRestart())})),i.subscriptions.push(o.commands.registerCommand("dart.startDebugging",(e,t)=>{const i=Object.assign({noDebug:!1,request:"launch",type:"dart"},t,{program:u.fsPath(e)});o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),i)})),i.subscriptions.push(o.commands.registerCommand("dart.startWithoutDebugging",(e,t)=>{const i=Object.assign({noDebug:!0,request:"launch",type:"dart"},t,{program:u.fsPath(e)});o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),i)})),i.subscriptions.push(o.commands.registerCommand("dart.runAllTestsWithoutDebugging",()=>s(this,void 0,void 0,(function*(){const e=h.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=(yield u.findProjectFolders(e,{requirePubspec:!0})).map(e=>r.join(e,"test")).filter(e=>n.existsSync(e));if(0!==t.length)for(const e of t){const t=o.workspace.getWorkspaceFolder(o.Uri.file(e)),i=r.basename(r.dirname(e));o.debug.startDebugging(t,{name:i+" tests",noDebug:!0,program:e,request:"launch",type:"dart"})}else o.window.showErrorMessage("Unable to find any test folders")})))),i.subscriptions.push(o.commands.registerCommand("dart.rerunLastDebugSession",()=>{w.debugConfig?o.debug.startDebugging(w.workspaceFolder,w.debugConfig):o.window.showErrorMessage("There is no previous debug session to run.")})),i.subscriptions.push(o.commands.registerCommand("dart.rerunLastTestDebugSession",()=>{S.debugConfig?o.debug.startDebugging(S.workspaceFolder,S.debugConfig):o.window.showErrorMessage("There is no previous test session to run.")})),i.subscriptions.push(o.commands.registerCommand("dart.attach",()=>{o.debug.startDebugging(void 0,{name:"Dart: Attach to Process",request:"attach",type:"dart"})})),i.subscriptions.push(o.commands.registerCommand("flutter.attachProcess",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Process",observatoryUri:"${command:dart.promptForVmService}",request:"attach",type:"dart"})})),i.subscriptions.push(o.commands.registerCommand("flutter.attach",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Device",request:"attach",type:"dart"})})),i.subscriptions.push(o.commands.registerCommand("dart.promptForVmService",e=>s(this,void 0,void 0,(function*(){const t="string"==typeof e?e:void 0;return o.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Paste an Observatory URI",prompt:"Enter Observatory URI",validateInput:e=>{if(e&&(e=e.trim(),!Number.isInteger(parseFloat(e))))return e.startsWith("http://")||e.startsWith("https://")?void 0:"Please enter a valid Observatory URI"},value:t})})))),p.config.debugSdkLibraries&&p.config.debugExternalLibraries?this.currentDebugOption=c.DebugOption.MyCodePackagesSdk:p.config.debugSdkLibraries?this.currentDebugOption=c.DebugOption.MyCodeSdk:p.config.debugExternalLibraries&&(this.currentDebugOption=c.DebugOption.MyCodePackages),i.subscriptions.push(o.commands.registerCommand("_dart.toggleDebugOptions",this.toggleDebugOptions,this)),this.debugOptions.text="Debug "+c.debugOptionNames[this.currentDebugOption],this.debugOptions.tooltip="Controls whether to step into or stop at breakpoints in only files in this workspace or also those in SDK and/or external Pub packages",this.debugOptions.command="_dart.toggleDebugOptions"}handleBreakpointChange(e){if(!b)for(const t of e.added)this.promptAboutDebuggerSettingsIfBreakpointOutsideWorkspace(t)}promptAboutDebuggerSettingsIfBreakpointOutsideWorkspace(e){if(b||this.context.breakpointOutsideWorkspaceDoNotShow||!(e instanceof o.SourceBreakpoint))return;if(!u.fsPath(e.location.uri).toLocaleLowerCase().endsWith(".dart"))return;if(o.workspace.getWorkspaceFolder(e.location.uri))return;b=!0;o.window.showWarningMessage("You have a breakpoint outside of your workspace but debug settings are set to 'my code'. Would you like to change settings? You can also change this from the status bar while debugging.","Debug just my code","Debug my code + packages + SDK",a.doNotAskAgainAction).then(e=>{e===a.doNotAskAgainAction&&(this.context.breakpointOutsideWorkspaceDoNotShow=!0),"Debug my code + packages + SDK"===e&&(this.currentDebugOption=c.DebugOption.MyCodePackagesSdk,this.applyNewDebugOption())})}handleDebugSessionStart(e){if("dart"!==e.type)return;const i=e.configuration?f.DebuggerType[e.configuration.debuggerType]:"<unknown>",s=new v.DartDebugSessionInformation(e,i);if(0===t.debugSessions.length&&this.vmServices.resetToDefaults(),t.debugSessions.push(s),e.configuration.debuggerType===f.DebuggerType.Flutter||e.configuration.debuggerType===f.DebuggerType.Web){o.commands.executeCommand("setContext",a.isInDebugSessionThatSupportsHotReloadContext,!0);const t=e.configuration.flutterMode;"debug"===t&&o.commands.executeCommand("setContext",a.isInFlutterDebugModeDebugSessionContext,!0),"profile"===t&&o.commands.executeCommand("setContext",a.isInFlutterProfileModeDebugSessionContext,!0)}const n=y.filter(t=>t.session.id===e.id);y=y.filter(t=>t.session.id!==e.id),n.forEach(e=>{this.logger.info(`Processing delayed event ${e.event} for session ${e.session.id}`),this.handleCustomEventWithSession(s,e)}),this.debugOptions.show()}handleDebugSessionCustomEvent(e){if(this.vmServices.handleDebugEvent(e).catch(e=>this.logger.error(e)),this.handleCustomEvent(e))return;const i=t.debugSessions.find(t=>t.session.id===e.session.id);if(!i)return this.logger.warn(`Did not find session ${e.session.id} to handle ${e.event}. There were ${t.debugSessions.length} sessions:\n${t.debugSessions.map(e=>"  "+e.session.id).join("\n")}`),this.logger.warn("Event will be queued and processed when the session start event fires"),void y.push(e);this.handleCustomEventWithSession(i,e)}handleDebugSessionEnd(e){const i=t.debugSessions.findIndex(t=>t.session.id===e.id);if(-1===i)return;const s=t.debugSessions[i];t.debugSessions.splice(i,1),this.clearProgressIndicators(s);const n=new Date;if(this.analytics.logDebugSessionDuration(s.debuggerType,n.getTime()-s.sessionStart.getTime()),0===t.debugSessions.length){this.vmServices.markAllServicesUnloaded(),this.debugOptions.hide(),this.debugMetrics.hide();for(const e of[a.isInDebugSessionThatSupportsHotReloadContext,a.isInFlutterDebugModeDebugSessionContext,a.isInFlutterProfileModeDebugSessionContext])o.commands.executeCommand("setContext",e,!1)}}handleCustomEvent(e){if("dart.log"===e.event){const t=e.body,i=`[${e.session.name}] ${t.message}`;switch(t.severity){case c.LogSeverity.Info:this.logger.info(i,t.category);break;case c.LogSeverity.Warn:this.logger.warn(i,t.category);break;case c.LogSeverity.Error:this.logger.error(i,t.category);break;default:this.logger.warn(`Failed to handle log event [${e.session.name}] ${JSON.stringify(t)}`)}}else if("dart.hotRestartRequest"===e.event)this.analytics.logDebuggerRestart(),this.onWillHotRestartEmitter.fire();else if("dart.hotReloadRequest"===e.event)this.analytics.logDebuggerHotReload(),this.onWillHotReloadEmitter.fire();else if("dart.flutter.firstFrame"===e.event)this.onFirstFrameEmitter.fire();else if("dart.debugMetrics"===e.event){const t=e.body.memory,i=`${Math.ceil(t.current/1024/1024)}MB of ${Math.ceil(t.total/1024/1024)}MB`;this.debugMetrics.text=i,this.debugMetrics.tooltip="This is the amount of memory being consumed by your applications heaps (out of what has been allocated).\n\nNote: memory usage shown in debug builds may not be indicative of usage in release builds. Use profile builds for more accurate figures when testing memory usage.",this.debugMetrics.show()}else{if("dart.navigate"!==e.event)return!1;e.body.file&&e.body.line&&e.body.column&&o.commands.executeCommand("_dart.jumpToLineColInUri",o.Uri.parse(e.body.file),e.body.line,e.body.column)}return!0}handleCustomEventWithSession(e,t){return s(this,void 0,void 0,(function*(){if("dart.launching"===t.event)o.window.withProgress({location:o.ProgressLocation.Notification},i=>(i.report({message:t.body.message}),e.launchProgressReporter=i,e.launchProgressPromise.promise));else if("dart.launched"===t.event)this.clearProgressIndicators(e);else if("dart.terminating"===t.event)this.clearLaunchProgessIndicator(e),e.terminatingProgressReporter?e.terminatingProgressReporter.report({message:t.body.message}):o.window.withProgress({location:o.ProgressLocation.Notification},i=>(i.report({message:t.body.message}),e.terminatingProgressReporter=i,e.terminatingProgressPromise.promise));else if("dart.webLaunchUrl"===t.event){if(!!!t.body.launched)try{const e=o.Uri.parse(t.body.url,!0);yield h.envUtils.openInBrowser(e.toString())}catch(e){this.logger.error("Failed to parse URL from Flutter app.webLaunchUrl event: "+e.body.url)}}else if("dart.exposeUrl"===t.event){const i=t.body.url;try{const t=yield h.envUtils.exposeUrl(o.Uri.parse(i,!0),this.logger);e.session.customRequest("exposeUrlResponse",{originalUrl:i,exposedUrl:t})}catch(t){this.logger.error(`Failed to expose URL ${i}: ${t}`),e.session.customRequest("exposeUrlResponse",{originalUrl:i,exposedUrl:i})}}else if("dart.progress"===t.event)t.body.message&&(e.launchProgressReporter?e.launchProgressReporter.report({message:t.body.message}):e.progressReporter?e.progressReporter.report({message:t.body.message}):(e.progressID=t.body.progressID,o.window.withProgress({location:o.ProgressLocation.Notification},i=>(i.report({message:t.body.message}),e.progressReporter=i,e.progressPromise||(e.progressPromise=new l.PromiseCompleter),e.progressPromise.promise)))),t.body.finished&&(e.launchProgressReporter||e.progressID===t.body.progressID&&(e.progressPromise&&e.progressPromise.resolve(),e.progressPromise=void 0,e.progressReporter=void 0));else if("dart.debuggerUris"===t.event){e.observatoryUri=t.body.observatoryUri,e.vmServiceUri=t.body.vmServiceUri,this.onDebugSessionVmServiceAvailableEmitter.fire(e);const i=e.session.configuration.debuggerType;if(i===f.DebuggerType.Dart||i===f.DebuggerType.Flutter||i===f.DebuggerType.Web)if("never"!==p.config.openDevTools){(i!==f.DebuggerType.Dart||"always"===p.config.openDevTools)&&o.commands.executeCommand("dart.openDevTools",{debugSessionId:e.session.id,triggeredAutomatically:!0})}else i===f.DebuggerType.Flutter&&d.showDevToolsNotificationIfAppropriate(this.context).then(e=>{e.shouldAlwaysOpen&&p.config.setOpenDevTools("flutter")})}}))}toggleDebugOptions(){this.currentDebugOption=(this.currentDebugOption+1)%(c.debugOptionNames.length-1),this.applyNewDebugOption()}applyNewDebugOption(){this.debugOptions.text="Debug "+c.debugOptionNames[this.currentDebugOption];const e=this.currentDebugOption===c.DebugOption.MyCodePackages||this.currentDebugOption===c.DebugOption.MyCodePackagesSdk,i=this.currentDebugOption===c.DebugOption.MyCodeSdk||this.currentDebugOption===c.DebugOption.MyCodePackagesSdk;p.config.setGlobalDebugExternalLibraries(e),p.config.setGlobalDebugSdkLibraries(i),t.debugSessions.forEach(t=>{t.session.customRequest("updateDebugOptions",{debugExternalLibraries:e,debugSdkLibraries:i})})}clearProgressIndicators(e){this.clearLaunchProgessIndicator(e),e.terminatingProgressPromise&&e.terminatingProgressPromise.resolve(),e.terminatingProgressReporter=void 0,e.progressPromise&&e.progressPromise.resolve(),e.progressPromise=void 0,e.progressReporter=void 0}clearLaunchProgessIndicator(e){e.launchProgressPromise&&e.launchProgressPromise.resolve(),e.launchProgressReporter=void 0}promptForDebugSession(){return s(this,void 0,void 0,(function*(){const e=yield o.window.showQuickPick(t.debugSessions.map(e=>({description:e.session.workspaceFolder?e.session.workspaceFolder.name:void 0,detail:e.session.configuration.deviceName||"Started "+e.sessionStart.toLocaleTimeString(),label:e.session.name,session:e})),{placeHolder:"Which debug session?"});return e&&e.session}))}sendServiceSetting(e,i){t.debugSessions.forEach(e=>{e.session.customRequest("serviceExtension",i)})}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(34),o=i(2),a=i(0),c=i(0),l=i(71),u=i(74),d=i(102),h=i(218),p=i(219),g=i(221),f=i(4),m=i(3),v=i(1),y=i(5),b=i(69),w=i(103),S=i(9),C=i(31),T=i(222),E=i(6),R=i(13),P=i(105),D=!!process.env.CI;var _;t.DebugConfigProvider=class{constructor(e,t,i,s,n,r,o,a){this.logger=e,this.wsContext=t,this.analytics=i,this.pubGlobal=s,this.daemon=n,this.deviceManager=r,this.dartCapabilities=o,this.flutterCapabilities=a,this.debugServers={}}provideDebugConfigurations(e,t){const i=E.isFlutterWorkspaceFolder(e);return[{name:i?"Flutter":"Dart",program:i?void 0:"bin/main.dart",request:"launch",type:"dart"}]}resolveDebugConfiguration(e,t,i){return t.type=t.type||"dart",t.request=t.request||"launch",t}resolveDebugConfigurationWithSubstitutedVariables(e,t,i){return s(this,void 0,void 0,(function*(){const s=this.logger,r=c.window.activeTextEditor&&c.window.activeTextEditor.document&&"file"===c.window.activeTextEditor.document.uri.scheme?v.fsPath(c.window.activeTextEditor.document.uri):void 0;function l(e,t){if(!t)return!1;const i=function(e){if(!e)return;const t=/\${\w+}/.exec(e);return t?t[0]:void 0}(t);return!!i&&(s.error(`Launch config property '${e}' has unresolvable variable ${i}`),c.window.showErrorMessage(`Launch config property '${e}' has unresolvable variable ${i}`),!0)}if(s.info("Starting debug session..."),e&&s.info("    workspace: "+v.fsPath(e.uri)),t.program&&s.info("    program  : "+t.program),t.cwd&&s.info("    cwd      : "+t.cwd),l("program",t.program)||l("cwd",t.cwd))return null;r&&!e?(e=c.workspace.getWorkspaceFolder(c.Uri.file(r)))&&s.info("Setting workspace based on open file: "+v.fsPath(e.uri)):!e&&a.workspace.workspaceFolders&&1===a.workspace.workspaceFolders.length&&(e=a.workspace.workspaceFolders[0])&&s.info("Setting workspace based on single open workspace: "+v.fsPath(e.uri)),t.cwd&&!o.isAbsolute(t.cwd)&&e&&(t.cwd=o.join(v.fsPath(e.uri),t.cwd),s.info("Converted cwd to absolute path: "+t.cwd)),t.program&&!o.isAbsolute(t.program)&&(t.cwd||e)&&(t.program=o.join(t.cwd||v.fsPath(e.uri),t.program),s.info("Converted program to absolute path: "+t.program));const u="attach"===t.request;if(!u){if(!t.program){const i=t.cwd?t.cwd:e?v.fsPath(e.uri):void 0,s=!i||r&&v.isWithinPath(r,i)?r:void 0;t.program=t.program||this.guessBestEntryPoint(s,i)}if(!t.program)return s.warn("No program was set in launch config"),c.window.showInformationMessage("Set the 'program' value in your launch config (eg 'bin/main.dart') then launch again"),null}if(!t.cwd&&e&&(t.cwd=v.fsPath(e.uri),s.info("Using workspace as cwd: "+t.cwd),t.program)){const i=C.locateBestProjectRoot(t.program);i&&v.isWithinPath(i,v.fsPath(e.uri))&&(t.cwd=i,s.info("Found better project root to use as cwd: "+t.cwd))}t.program&&t.cwd&&!o.isAbsolute(t.program)&&(t.program=o.join(t.cwd,t.program)),t.program&&o.isAbsolute(t.program)&&!n.existsSync(t.program)&&(s.warn("Launch config references non-existant file "+t.program),c.window.showWarningMessage('Your launch config references a program that does not exist. If you have problems launching, check the "program" field in your ".vscode/launch.json" file.'));let d=_.Dart;!t.cwd||E.isInsideFolderNamed(t.program,"bin")||E.isInsideFolderNamed(t.program,"tool")||E.isInsideFolderNamed(t.program,".dart_tool")||(E.isInsideFolderNamed(t.program,"web")&&!E.isInsideFolderNamed(t.program,"test")?d=_.Web:E.isFlutterProjectFolder(t.cwd)?d=_.Flutter:s.info(`Project (${t.program}) not recognised as Flutter or Web, will use Dart debugger`)),s.info("Detected launch project as "+_[d]);const h=d===_.Flutter||d===_.Web,p=d===_.Flutter,g=t.program&&E.isTestFileOrFolder(t.program),m=g&&t.args&&(-1!==t.args.indexOf("--name")||-1!==t.args.indexOf("--pname"));g&&s.info("Detected launch project as a Test project");const w=g&&t.cwd&&E.projectShouldUsePubForTests(t.cwd,this.wsContext.config);if(g&&!w&&s.info("Project does not appear to support 'pub run test', will use VM directly"),g)switch(d){case _.Dart:w&&(d=_.PubTest);break;case _.Flutter:!t.runTestsOnDevice||m?(t.runTestsOnDevice&&m&&(a.window.showWarningMessage("Running with 'flutter test' as 'runTestsOnDevice' is not supported for individual tests."),s.info("runTestsOnDevice is set but args have test filter so will still use Flutter")),d=_.FlutterTest):s.info("runTestsOnDevice is set, so will use Flutter instead of FlutterTest");break;case _.Web:d=_.WebTest;break;default:s.info("Unknown debugType, unable to switch to test debugger")}if(s.info(`Using ${_[d]} debug adapter for this session`),d===_.WebTest)return s.error("Tests in web projects are not currently supported"),void c.window.showErrorMessage("Tests in web projects are not currently supported");if(u&&!t.serviceInfoFile&&(p||(t.observatoryUri=yield this.getFullVmServiceUri(t.observatoryUri)),!t.observatoryUri&&!p))return s.warn("No Observatory URI/port was provided"),void c.window.showInformationMessage("You must provide an Observatory URI/port to attach a debugger");if(i&&i.isCancellationRequested)return;let T=this.deviceManager&&this.deviceManager.currentDevice;if(d===_.Flutter&&this.deviceManager&&this.daemon&&"flutter-tester"!==t.deviceId){const e=this.daemon.capabilities.providesPlatformTypes&&t.cwd?(yield this.daemon.getSupportedPlatforms(t.cwd)).platforms:[];if(this.deviceManager.isSupported(e,T)||(T=yield this.deviceManager.showDevicePicker(e)),!this.deviceManager.isSupported(e,T))return s.warn("Unable to launch due to no active device"),void c.window.showInformationMessage("Cannot launch without an active device")}if(i&&i.isCancellationRequested)return;if(!(yield this.installDependencies(d,this.pubGlobal)))return;if(i&&i.isCancellationRequested)return;if(this.setupDebugConfig(e,t,h,T,this.deviceManager),t.program=v.forceWindowsDriveLetterToUppercase(t.program),t.cwd=v.forceWindowsDriveLetterToUppercase(t.cwd),!u&&t.cwd&&S.config.promptToRunIfErrors){s.info("Checking for errors before launching");const e=e=>"dart"===e.source&&e.severity===a.DiagnosticSeverity.Error,i=a.languages.getDiagnostics().filter(t=>t[1].find(e)).find(e=>{const i=v.fsPath(e[0]);return v.isWithinPath(i,t.cwd)&&(!E.isInsideFolderNamed(i,"test")||i===t.program)});if(i){s.warn("Project has errors, prompting user");const t=i[1].find(e),n=t.range;s.warn(`    ${v.fsPath(i[0])}:${n.start.line}:${n.start.character}`),s.warn("    "+t.message.split("\n")[0].trim());const r=yield c.window.showErrorMessage("Build errors exist in your project.",{modal:!0},f.debugAnywayAction,f.showErrorsAction);if(r!==f.debugAnywayAction)return s.info("Aborting!"),void(r===f.showErrorsAction&&a.commands.executeCommand("workbench.action.showErrorsWarnings"));s.info("Debugging anyway!")}}if(i&&i.isCancellationRequested)return;!(!(!t.cwd||!o.isAbsolute(t.cwd))&&y.warnIfPathCaseMismatch(s,t.cwd,"the launch script working directory","check the 'cwd' field in your launch configuration file (.vscode/launch.json)"))&&t.program&&o.isAbsolute(t.program)&&y.warnIfPathCaseMismatch(s,t.program,"the launch script","check the 'program' field in your launch configuration file (.vscode/launch.json)");const R=this.getDebugServer(d,t.debugServer).address();return R&&"string"!=typeof R?(t.debugServer=R.port,this.analytics.logDebuggerStart(e&&e.uri,_[d],t.noDebug?"Run":"Debug"),d!==_.FlutterTest&&d!==_.PubTest||P.TestResultsProvider.flagSuiteStart(t.program,!m),t.debuggerType=d,s.info("Debug session starting...\n    "+JSON.stringify(t,void 0,4).replace(/\n/g,"\n    ")),b.LastDebugSession.workspaceFolder=e,b.LastDebugSession.debugConfig=Object.assign({},t),a.commands.executeCommand("setContext",f.HAS_LAST_DEBUG_CONFIG,!0),g&&(b.LastTestDebugSession.workspaceFolder=e,b.LastTestDebugSession.debugConfig=Object.assign({},t),a.commands.executeCommand("setContext",f.HAS_LAST_TEST_DEBUG_CONFIG,!0)),t):(s.info("Debug server does not have a valid address"),void c.window.showErrorMessage("Debug server does not have a valid address"))}))}installDependencies(e,t){return e!==_.Web||new T.WebDev(t).promptToInstallIfRequired()}guessBestEntryPoint(e,t){if(e&&E.isDartFile(e)&&(E.isTestFile(e)||E.isInsideFolderNamed(e,"bin")||E.isInsideFolderNamed(e,"tool")))return this.logger.info("Using open file as entry point: "+e),e;const i=e&&C.locateBestProjectRoot(e)||t;if(!i)return;const s=[o.join(i,"lib","main.dart"),o.join(i,"bin","main.dart")];for(const e of s)if(n.existsSync(e))return this.logger.info("Using found common entry point: "+e),e;return n.existsSync(o.join(i,"bin"))||n.existsSync(o.join(i,"web"))||!n.existsSync(o.join(i,"example"))?void 0:this.guessBestEntryPoint(void 0,o.join(i,"example"))}getFullVmServiceUri(e,t){return s(this,void 0,void 0,(function*(){return(e=(e=e||(yield a.commands.executeCommand("dart.promptForVmService",t)))&&e.trim())&&/^[0-9]+$/.exec(e)&&(e="http://127.0.0.1:"+e),e}))}getDebugServer(e,t){switch(e){case _.Flutter:return this.spawnOrGetServer("flutter",t,()=>new d.FlutterDebugSession);case _.FlutterTest:return this.spawnOrGetServer("flutterTest",t,()=>new h.FlutterTestDebugSession);case _.Web:return this.spawnOrGetServer("web",t,()=>new p.WebDebugSession);case _.WebTest:return this.spawnOrGetServer("pubTest",t,()=>new g.WebTestDebugSession);case _.Dart:return this.spawnOrGetServer("dart",t,()=>new l.DartDebugSession);case _.PubTest:return this.spawnOrGetServer("pubTest",t,()=>new u.DartTestDebugSession);default:throw new Error("Unknown debugger type")}}spawnOrGetServer(e,t=0,i){return this.debugServers[e]||(this.logger.info(`Spawning a new ${e} debugger`),this.debugServers[e]=r.createServer(e=>{const t=i();t.setRunAsServer(!0),t.start(e,e)}).listen(t)),this.debugServers[e]}setupDebugConfig(e,t,i,s,n){var r,a;const c=S.config.for(e&&e.uri);t.name||(i&&t.deviceId?t.name=`Flutter (${t.deviceId})`:t.name=i&&s?`Flutter (${n?n.labelForDevice(s):s.name})`:i?"Flutter":"Dart"),t.toolEnv=R.getToolEnv(),t.sendLogsToClient=!0,t.globalFlutterArgs=R.getGlobalFlutterArgs(),t.cwd=t.cwd||e&&v.fsPath(e.uri),t.args=t.args||[],t.vmAdditionalArgs=t.vmAdditionalArgs||c.vmAdditionalArgs,t.vmServicePort=t.vmServicePort||(f.isChromeOS&&S.config.useKnownChromeOSPorts?f.CHROME_OS_VM_SERVICE_PORT:0),t.dartPath=t.dartPath||o.join(this.wsContext.sdks.dart,f.dartVMPath),t.observatoryLogFile=this.insertSessionName(t,t.observatoryLogFile||c.observatoryLogFile),t.webDaemonLogFile=this.insertSessionName(t,t.webDaemonLogFile||c.webDaemonLogFile),t.maxLogLineLength=t.maxLogLineLength||S.config.maxLogLineLength,t.pubPath=t.pubPath||o.join(this.wsContext.sdks.dart,f.pubPath),t.pubSnapshotPath=t.pubSnapshotPath||o.join(this.wsContext.sdks.dart,f.pubSnapshotPath),t.pubTestLogFile=this.insertSessionName(t,t.pubTestLogFile||c.pubTestLogFile),t.debugSdkLibraries=void 0!==t.debugSdkLibraries&&null!==t.debugSdkLibraries?t.debugSdkLibraries:!!S.config.debugSdkLibraries,t.debugExternalLibraries=void 0!==t.debugExternalLibraries&&null!==t.debugExternalLibraries?t.debugExternalLibraries:S.config.debugExternalLibraries,t.showDartDeveloperLogs=c.showDartDeveloperLogs,t.useFlutterStructuredErrors=c.flutterStructuredErrors,t.debuggerHandlesPathsEverywhereForBreakpoints=void 0!==t.debuggerHandlesPathsEverywhereForBreakpoints&&null!==t.debuggerHandlesPathsEverywhereForBreakpoints?t.debuggerHandlesPathsEverywhereForBreakpoints:this.dartCapabilities.handlesPathsEverywhereForBreakpoints,t.supportsWsVmService=this.flutterCapabilities.supportsWsVmService,t.supportsExposeUrl=this.flutterCapabilities.supportsExposeUrl,t.evaluateGettersInDebugViews=t.evaluateGettersInDebugViews||c.evaluateGettersInDebugViews,t.evaluateToStringInDebugViews=t.evaluateToStringInDebugViews||S.config.evaluateToStringInDebugViews,t.useWriteServiceInfo=void 0!==t.useWriteServiceInfo&&null!==t.useWriteServiceInfo?t.useWriteServiceInfo:this.dartCapabilities.supportsWriteServiceInfo,t.supportsDebugInternalLibraries=void 0!==t.supportsDebugInternalLibraries&&null!==t.supportsDebugInternalLibraries?t.supportsDebugInternalLibraries:this.dartCapabilities.supportsDebugInternalLibraries,i&&this.wsContext.sdks.flutter&&(t.args=c.flutterAdditionalArgs.concat(t.args),t.forceFlutterVerboseMode=w.isLogging||D,t.flutterTrackWidgetCreation=void 0!==t.flutterTrackWidgetCreation&&null!==t.flutterTrackWidgetCreation?t.flutterTrackWidgetCreation:c.flutterTrackWidgetCreation,t.flutterMode=t.flutterMode||"debug",t.flutterPlatform=t.flutterPlatform||"default",t.flutterPath=t.flutterPath||o.join(this.wsContext.sdks.flutter,f.flutterPath),t.flutterCustomRunScript=null===(r=this.wsContext.config)||void 0===r?void 0:r.flutterRunScript,t.flutterCustomTestScript=null===(a=this.wsContext.config)||void 0===a?void 0:a.flutterTestScript,t.flutterRunLogFile=this.insertSessionName(t,t.flutterRunLogFile||c.flutterRunLogFile),t.flutterTestLogFile=this.insertSessionName(t,t.flutterTestLogFile||c.flutterTestLogFile),!t.deviceId&&s&&(t.deviceId=s.id,t.deviceName=`${n?n.labelForDevice(s):s.name} (${s.platform})`),t.showMemoryUsage=t.showMemoryUsage||!1===t.showMemoryUsage?t.showMemoryUsage:"profile"===t.flutterMode)}insertSessionName(e,t){return t?t.replace(/\${name}/,m.filenameSafe(e.name||"unnamed-session")):t}dispose(){if(this.debugServers)for(const e of Object.keys(this.debugServers))this.debugServers[e].close(),delete this.debugServers[e]}},function(e){e[e.Dart=0]="Dart",e[e.PubTest=1]="PubTest",e[e.Flutter=2]="Flutter",e[e.FlutterTest=3]="FlutterTest",e[e.Web=4]="Web",e[e.WebTest=5]="WebTest"}(_=t.DebuggerType||(t.DebuggerType={}))},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(18),o=i(2),a=i(28),c=i(36),l=i(203),u=i(4),d=i(8),h=i(43),p=i(44),g=i(3),f=i(21),m=i(96),v=i(1),y=i(204),b=i(50),w=i(212),S=i(214),C=new RegExp("(.*#\\d+.*)\\(((?:package|dart|file):.*\\.dart):(\\d+):(\\d+)\\)\\s*$","m"),T=new RegExp("((?:package|dart|file):.*\\.dart) (\\d+):(\\d+)\\s*(\\S+)\\s*$","m"),E=new RegExp("(.*?)((?:package|dart|file):.*\\.dart):(\\d+):(\\d+)\\s*$","m"),R=new RegExp(";\\s*$","m");class P extends c.DebugSession{constructor(){super(),this.additionalPidsToTerminate=[],this.expectAdditionalPidToTerminate=!1,this.additionalPidCompleter=new g.PromiseCompleter,this.allowTerminatingObservatoryVmPid=!0,this.connectVmEvenForNoDebug=!1,this.allowWriteServiceInfo=!0,this.processExited=!1,this.sendLogsToClient=!1,this.debugSdkLibraries=!1,this.debugExternalLibraries=!1,this.showDartDeveloperLogs=!0,this.useFlutterStructuredErrors=!1,this.evaluateGettersInDebugViews=!1,this.evaluateToStringInDebugViews=!1,this.useWriteServiceInfo=!1,this.debuggerHandlesPathsEverywhereForBreakpoints=!1,this.sendStdOutToConsole=!0,this.supportsObservatory=!0,this.parseObservatoryUriFromStdOut=!0,this.requiresProgram=!0,this.processExit=Promise.resolve({code:0,signal:null}),this.maxLogLineLength=1e3,this.shouldKillProcessOnTerminate=!0,this.logCategory=d.LogCategory.General,this.supportsRunInTerminalRequest=!1,this.supportsDebugInternalLibraries=!1,this.isTerminating=!1,this.logger=new b.DebugAdapterLogger(this,d.LogCategory.Observatory),this.capabilities=l.VmServiceCapabilities.empty,this.urlExposeCompleters={},this.lastLoggingEvent=Promise.resolve(),this.logBuffer={},this.threadManager=new w.ThreadManager(this.logger,this)}get shouldConnectDebugger(){return!this.noDebug||this.connectVmEvenForNoDebug}initializeRequest(e,t){this.supportsRunInTerminalRequest=!!t.supportsRunInTerminalRequest,e.body=e.body||{},e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsDelayedStackTraceLoading=!0,e.body.supportsConditionalBreakpoints=!0,e.body.supportsLogPoints=!0,e.body.supportsTerminateRequest=!0,e.body.supportsRestartFrame=!0,e.body.supportsClipboardContext=!0,e.body.exceptionBreakpointFilters=[{filter:"All",label:"All Exceptions",default:!1},{filter:"Unhandled",label:"Uncaught Exceptions",default:!0}],this.sendResponse(e)}launchRequest(e,t){return s(this,void 0,void 0,(function*(){if(!t||!t.dartPath||this.requiresProgram&&!t.program)return this.logToUser("Unable to restart debugging. Please try ending the debug session and starting again.\n"),void this.sendEvent(new c.TerminatedEvent);if(t.program&&!o.isAbsolute(t.program)){if(!t.cwd)return this.errorResponse(e,"Unable to start debugging. program was specified as a relative path without cwd.");t.program=o.join(t.cwd,t.program)}this.shouldKillProcessOnTerminate=!0,this.cwd=t.cwd,this.noDebug=t.noDebug,yield this.threadManager.setExceptionPauseMode(this.noDebug?"None":"Unhandled"),this.packageMap=new p.PackageMap(p.PackageMap.findPackagesFile(t.program||t.cwd)),this.useWriteServiceInfo=this.allowWriteServiceInfo&&!1!==t.useWriteServiceInfo,this.supportsDebugInternalLibraries=!!t.supportsDebugInternalLibraries,this.readSharedArgs(t),this.sendResponse(e),this.useWriteServiceInfo&&(this.parseObservatoryUriFromStdOut=!1,this.vmServiceInfoFile=o.join(r.tmpdir(),`dart-vm-service-${v.getRandomInt(4096,65536).toString(16)}.json`));try{if("terminal"!==t.console||this.supportsRunInTerminalRequest||this.log("Ignoring request to run in terminal because client does not support runInTerminalRequest",d.LogSeverity.Warn),"terminal"===t.console&&this.useWriteServiceInfo&&this.supportsRunInTerminalRequest)this.childProcess=yield this.spawnRemoteEditorProcess(t);else{const e=this.spawnProcess(t);this.childProcess=e,this.processExited=!1,this.processExit=new Promise(t=>e.on("exit",(e,i)=>t({code:e,signal:i}))),e.stdout.setEncoding("utf8"),e.stdout.on("data",e=>s(this,void 0,void 0,(function*(){let t=null;this.shouldConnectDebugger&&this.parseObservatoryUriFromStdOut&&!this.observatory&&(t=u.observatoryListeningBannerPattern.exec(e.toString())),t?yield this.initDebugger(this.websocketUriForObservatoryUri(t[1])):this.sendStdOutToConsole&&this.logToUserBuffered(e.toString(),"stdout")}))),e.stderr.setEncoding("utf8"),e.stderr.on("data",e=>{this.logToUserBuffered(e.toString(),"stderr")}),e.on("error",e=>{this.logToUser(e+"\n","stderr")}),this.processExit.then(({code:e,signal:t})=>s(this,void 0,void 0,(function*(){this.stopServiceFilePolling(),this.processExited=!0,this.log(`Process exited (${t?(""+t).toLowerCase():e})`),e||t?this.logToUser(`Exited (${t?(""+t).toLowerCase():e})\n`):this.logToUser("Exited\n"),yield this.raceIgnoringErrors(()=>this.lastLoggingEvent,500),setTimeout(()=>this.sendEvent(new c.TerminatedEvent),250)})))}if(this.useWriteServiceInfo&&this.shouldConnectDebugger){const e=yield this.startServiceFilePolling();yield this.initDebugger(e.toString())}}catch(e){return this.logToUser("Unable to start debugging: "+e),void this.sendEvent(new c.TerminatedEvent)}this.shouldConnectDebugger||this.sendEvent(new c.InitializedEvent)}))}readSharedArgs(e){this.debugExternalLibraries=e.debugExternalLibraries,this.debuggerHandlesPathsEverywhereForBreakpoints=e.debuggerHandlesPathsEverywhereForBreakpoints,this.debugSdkLibraries=e.debugSdkLibraries,this.evaluateGettersInDebugViews=e.evaluateGettersInDebugViews,this.evaluateToStringInDebugViews=e.evaluateToStringInDebugViews,this.logFile=e.observatoryLogFile,this.maxLogLineLength=e.maxLogLineLength,this.sendLogsToClient=!!e.sendLogsToClient,this.showDartDeveloperLogs=e.showDartDeveloperLogs,this.toolEnv=e.toolEnv,this.useFlutterStructuredErrors=e.useFlutterStructuredErrors}attachRequest(e,t){return s(this,void 0,void 0,(function*(){if(!t||!t.observatoryUri&&!t.serviceInfoFile)return this.errorResponse(e,"Unable to attach; no Observatory address or service info file provided.");if(this.shouldKillProcessOnTerminate=!1,this.cwd=t.cwd,this.readSharedArgs(t),this.log("Attaching to process via "+(t.observatoryUri||t.serviceInfoFile)),t.packages){t.packages&&!o.isAbsolute(t.packages)&&(t.packages=t.cwd?o.join(t.cwd,t.packages):t.packages);try{this.packageMap=new p.PackageMap(p.PackageMap.findPackagesFile(t.packages))}catch(t){this.errorResponse(e,"Unable to load packages file: "+t)}}let i;this.sendResponse(e);try{t.observatoryUri?i=this.websocketUriForObservatoryUri(t.observatoryUri):(this.vmServiceInfoFile=t.serviceInfoFile,this.sendEvent(new c.Event("dart.progress",{message:"Waiting for "+this.vmServiceInfoFile,finished:!1})),i=yield this.startServiceFilePolling(),this.sendEvent(new c.Event("dart.launched"))),yield this.initDebugger(i)}catch(e){const s=t.serviceInfoFile?"\n    VM info was read from "+t.serviceInfoFile:"";return this.logToUser(`Unable to connect to VM service at ${i||"??"}${s}\n    ${e}`),void this.sendEvent(new c.TerminatedEvent)}}))}sourceFileForArgs(e){return e.cwd?o.relative(e.cwd,e.program):e.program}spawnProcess(e){const t=this.buildAppArgs(e);this.log(`Spawning ${e.dartPath} with args ${JSON.stringify(t)}`),e.cwd&&this.log("..  in "+e.cwd);const i=h.safeSpawn(e.cwd,e.dartPath,t,{envOverrides:e.env,toolEnv:e.toolEnv});return this.log("    PID: "+i.pid),i}spawnRemoteEditorProcess(e){return s(this,void 0,void 0,(function*(){const t=this.buildAppArgs(e);return this.log(`Spawning ${e.dartPath} remotely with args ${JSON.stringify(t)}`),e.cwd&&this.log("..  in "+e.cwd),this.remoteEditorTerminalLaunched=new Promise((i,s)=>{this.sendRequest("runInTerminal",{args:[e.dartPath].concat(t),cwd:e.cwd,env:e.env,kind:"integrated",title:e.name},15e3,e=>{if(e.success){this.log("    PID: "+process.pid);const t=e;i(new D(t.body.processId||t.body.shellProcessId))}else s(e.message)})}),this.remoteEditorTerminalLaunched}))}buildAppArgs(e){let t=[];return this.shouldConnectDebugger&&(this.expectAdditionalPidToTerminate=!0,t.push("--enable-vm-service="+e.vmServicePort),t.push("--pause_isolates_on_start=true")),this.useWriteServiceInfo&&this.vmServiceInfoFile&&(t.push("--write-service-info="+S.formatPathForVm(this.vmServiceInfoFile)),t.push("-DSILENT_OBSERVATORY=true")),!1!==e.enableAsserts&&t.push("--enable-asserts"),e.vmAdditionalArgs&&(t=t.concat(e.vmAdditionalArgs)),t.push(this.sourceFileForArgs(e)),e.args&&(t=t.concat(e.args)),t}websocketUriForObservatoryUri(e){const t=e.trim();return t.endsWith("/ws")?t:t.endsWith("/ws/")?t.substr(0,t.length-1):t.endsWith("/")?t+"ws":t+"/ws"}log(e,t=d.LogSeverity.Info){this.logFile&&(this.logStream||(this.logStream=n.createWriteStream(this.logFile)),this.logStream.write(`[${(new Date).toLocaleTimeString()}]: `),this.maxLogLineLength&&e.length>this.maxLogLineLength?this.logStream.write(e.substring(0,this.maxLogLineLength)+"…\r\n"):this.logStream.write(e.trim()+"\r\n")),this.sendLogsToClient&&this.sendEvent(new c.Event("dart.log",{message:e,severity:t,category:d.LogCategory.Observatory}))}startServiceFilePolling(){return this.logger.info("Starting to poll for file "+this.vmServiceInfoFile),this.stopServiceFilePolling(!1),this.serviceInfoFileCompleter&&this.serviceInfoFileCompleter.reject("Cancelled"),this.serviceInfoFileCompleter=new g.PromiseCompleter,this.serviceInfoPollTimer=setInterval(()=>this.tryReadServiceFile(),50),this.serviceInfoFileCompleter.promise}stopServiceFilePolling(e=!0){if(this.serviceInfoPollTimer&&(this.logger.info("Stopping polling for file "+this.vmServiceInfoFile),clearInterval(this.serviceInfoPollTimer)),e&&this.vmServiceInfoFile&&n.existsSync(this.vmServiceInfoFile)&&this.remoteEditorTerminalLaunched)try{n.unlinkSync(this.vmServiceInfoFile),this.vmServiceInfoFile=void 0}catch(e){}}tryReadServiceFile(){var e,t;return s(this,void 0,void 0,(function*(){if(this.vmServiceInfoFile&&n.existsSync(this.vmServiceInfoFile))try{const t=n.readFileSync(this.vmServiceInfoFile,"utf8");if(t.length<2||!t.trimRight().endsWith("}"))return;const i=JSON.parse(t);this.logger.info("Succesfully read JSON from "+this.vmServiceInfoFile);const s=new a.URL(i.uri);s.protocol="ws",s.pathname.endsWith("/")&&(s.pathname=s.pathname.substr(0,s.pathname.length-1)),s.pathname.endsWith("/ws")||(s.pathname=s.pathname+"/ws"),this.stopServiceFilePolling(),this.remoteEditorTerminalLaunched&&(yield this.remoteEditorTerminalLaunched,yield new Promise(e=>setTimeout(e,5))),null===(e=this.serviceInfoFileCompleter)||void 0===e||e.resolve(s.toString())}catch(e){this.logger.error(e),null===(t=this.serviceInfoFileCompleter)||void 0===t||t.reject(e)}}))}initDebugger(e){return s(this,void 0,void 0,(function*(){let t;if(this.log("Initialising debugger for "+e),e.endsWith("/ws")?(t=e.substring(0,e.length-2),t.startsWith("ws:")&&(t="http:"+t.substring(3))):t=e,this.sendEvent(new c.Event("dart.debuggerUris",{observatoryUri:this.supportsObservatory?t.toString():void 0,vmServiceUri:t.toString()})),this.shouldConnectDebugger)return new Promise((t,i)=>{this.log("Connecting to VM Service at "+e),this.logToUser("Connecting to VM Service at "+e),this.observatory=new y.ObservatoryConnection(e),this.observatory.onLogging(e=>this.log(e)),this.observatory.onOpen(()=>s(this,void 0,void 0,(function*(){this.observatory&&(yield this.observatory.getVersion().then(e=>s(this,void 0,void 0,(function*(){const t=e.result;this.capabilities.version=`${t.major}.${t.minor}.0`,this.observatory&&(yield this.observatory.getVM().then(e=>s(this,void 0,void 0,(function*(){if(!this.observatory)return;const t=e.result;yield this.subscribeToStreams(),this.allowTerminatingObservatoryVmPid&&this.childProcess&&this.recordAdditionalPid(t.pid);const i=yield Promise.all(t.isolates.map(e=>this.observatory.getIsolate(e.id))),n=i.find(e=>!!e.result.rootLib),r=n&&n.result;r&&r.extensionRPCs&&r.extensionRPCs.forEach(e=>this.notifyServiceExtensionAvailable(e,r.id)),this.packageMap||r&&r.rootLib&&(this.packageMap=new p.PackageMap(p.PackageMap.findPackagesFile(this.convertVMUriToSourcePath(r.rootLib.uri)))),yield Promise.all(i.map(e=>s(this,void 0,void 0,(function*(){const t=e.result;yield this.threadManager.registerThread(t,t.runnable?"IsolateRunnable":"IsolateStart"),t.pauseEvent.kind.startsWith("Pause")&&(yield this.handlePauseEvent(t.pauseEvent))})))),this.pollforMemoryMs&&setTimeout(()=>this.pollForMemoryUsage(),this.pollforMemoryMs),this.sendEvent(new c.InitializedEvent)}))))}))),t())}))),this.observatory.onClose((e,t)=>{this.log(`Observatory connection closed: ${e} (${t})`),this.logStream&&(this.logStream.end(),this.logStream=void 0,this.logFile=void 0),!this.childProcess||this.childProcess instanceof D?this.sendEvent(new c.TerminatedEvent):setTimeout(()=>{this.processExited||this.sendEvent(new c.TerminatedEvent)},5e3)}),this.observatory.onError(e=>{i(e)})})}))}recordAdditionalPid(e){this.additionalPidsToTerminate.push(e),this.additionalPidCompleter.resolve()}subscribeToStreams(){return s(this,void 0,void 0,(function*(){if(!this.observatory)return;const e=this.capabilities.serviceStreamIsPublic?"Service":"_Service";yield Promise.all([this.observatory.on("Isolate",e=>this.handleIsolateEvent(e)),this.observatory.on("Extension",e=>this.handleExtensionEvent(e)),this.observatory.on("Debug",e=>this.handleDebugEvent(e)),this.observatory.on(e,e=>this.handleServiceEvent(e))]),this.capabilities.hasLoggingStream&&this.showDartDeveloperLogs&&(yield this.observatory.on("Logging",e=>this.handleLoggingEvent(e)).catch(e=>{this.logger.info(g.errorString(e))}))}))}terminate(e){return s(this,void 0,void 0,(function*(){const t=e?"SIGKILL":"SIGINT",i=e?"DISC":"TERM";if(this.log(`${i}: Requested to terminate with ${t}...`),this.stopServiceFilePolling(),this.shouldKillProcessOnTerminate&&this.childProcess&&!this.processExited){this.log(i+": Terminating processes...");for(const e of this.additionalPidsToTerminate)if(e!==this.childProcess.pid)try{this.log(`${i}: Terminating related process ${e} with ${t}...`),process.kill(e,t)}catch(e){}if(this.processExited)this.log(i+": Main process had already quit.");else{if(this.childProcess.pid)try{this.log(`${i}: Terminating main process with ${t}...`),process.kill(this.childProcess.pid,t)}catch(e){}else this.log(i+": Process had no PID.");yield this.tryRemoveAllBreakpointsAndResumeAllThreads(i)}}else if(!this.shouldKillProcessOnTerminate&&this.observatory){this.log(i+": Disconnecting from process..."),yield this.tryRemoveAllBreakpointsAndResumeAllThreads(i);try{this.log(i+": Closing observatory..."),this.observatory.close()}catch(e){}finally{this.observatory=void 0}}else this.log(i+": Did not need to terminate processes");this.log(i+": Removing all stored data..."),this.threadManager.removeAllStoredData(),this.log(i+": Waiting for process to finish..."),yield this.processExit,this.log(i+": Disconnecting...")}))}tryRemoveAllBreakpointsAndResumeAllThreads(e){return s(this,void 0,void 0,(function*(){this.log(e+": Disabling break-on-exception and removing all breakpoints"),yield this.raceIgnoringErrors(()=>Promise.all([this.threadManager.setExceptionPauseMode("None"),this.threadManager.threads.map(e=>e.removeAllBreakpoints())])),this.log(e+": Unpausing all threads..."),yield this.raceIgnoringErrors(()=>Promise.all([this.threadManager.threads.map(e=>e.resume())]))}))}raceIgnoringErrors(e,t=250){return s(this,void 0,void 0,(function*(){try{return yield Promise.race([e().then(e=>!0),new Promise(e=>setTimeout(()=>e(!1),t))])}catch(e){return this.log("Error while while waiting for action: "+e),!1}}))}terminateRequest(e,t){const i=Object.create(null,{terminateRequest:{get:()=>super.terminateRequest}});return s(this,void 0,void 0,(function*(){if(this.log("Termination requested!"),this.isTerminating=!0,this.sendEvent(new c.Event("dart.terminating",{message:"Terminating debug session..."})),this.expectAdditionalPidToTerminate&&!this.additionalPidsToTerminate.length){this.log("Waiting for main process PID before terminating"),this.sendEvent(new c.Event("dart.terminating",{message:"Waiting for process..."})),(yield this.raceIgnoringErrors(()=>this.additionalPidCompleter.promise,2e4))?this.log("Got main process PID, continuing..."):this.log("Timed out waiting for main process PID, continuing anyway..."),this.sendEvent(new c.Event("dart.terminating",{message:"Terminating process..."}))}try{yield this.terminate(!1)}catch(t){return this.errorResponse(e,""+t)}i.terminateRequest.call(this,e,t)}))}disconnectRequest(e,t){const i=Object.create(null,{disconnectRequest:{get:()=>super.disconnectRequest}});return s(this,void 0,void 0,(function*(){this.log("Disconnect requested!"),this.isTerminating=!0;try{(yield this.raceIgnoringErrors(()=>this.terminate(!1),2e3))||(yield this.terminate(!0))}catch(t){return this.errorResponse(e,""+t)}i.disconnectRequest.call(this,e,t)}))}setBreakPointsRequest(e,t){return s(this,void 0,void 0,(function*(){if(this.noDebug)return e.body={breakpoints:(t.breakpoints||[]).map(e=>({verified:!1}))},void this.sendResponse(e);const i=t.source,s=t.breakpoints||[],n=this.packageMap&&!this.debuggerHandlesPathsEverywhereForBreakpoints&&this.packageMap.convertFileToPackageUri(i.path)||S.formatPathForVm(i.path||i.name);try{const t=yield this.threadManager.setBreakpoints(n,s),i=[];for(const e of t)i.push({verified:!!e});e.body={breakpoints:i},this.sendResponse(e)}catch(t){this.errorResponse(e,""+t)}}))}setExceptionBreakPointsRequest(e,t){return s(this,void 0,void 0,(function*(){const i=t.filters;let s="None";this.noDebug||(-1!==i.indexOf("Unhandled")&&(s="Unhandled"),-1!==i.indexOf("All")&&(s="All")),yield this.threadManager.setExceptionPauseMode(s),this.sendResponse(e)}))}configurationDoneRequest(e,t){this.sendResponse(e),this.threadManager.receivedConfigurationDone()}pauseRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId);i?this.observatory?this.observatory.pause(i.ref.id).then(t=>this.sendResponse(e)).catch(t=>this.errorResponse(e,""+t)):this.errorResponse(e,"No observatory connection"):this.errorResponse(e,"No thread with id "+t.threadId)}sourceRequest(e,t){const i=t.sourceReference,s=this.threadManager.getStoredData(i),n=s.data;s.thread.getScript(n).then(t=>{t.source?e.body={content:t.source,mimeType:"text/x-dart"}:(e.success=!1,e.message="<source not available>"),this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t))}threadsRequest(e){e.body={threads:this.threadManager.getThreads()},this.sendResponse(e)}stackTraceRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId),s=t.startFrame||0;let r=t.levels;i?this.observatory?this.observatory.getStack(i.ref.id).then(t=>{const o=t.result;let a=o.asyncCausalFrames||o.frames;const l=a.length;r||(r=l),s+r>l&&(r=l-s),a=a.slice(s,s+r);const u=[],d=[];a.forEach(e=>{const t=i.storeData(e);if("AsyncSuspensionMarker"===e.kind){const e=new c.StackFrame(t,"<asynchronous gap>");return e.presentationHint="label",void u.push(e)}const s=e&&e.code&&e.code.name?e.code.name.startsWith("[Unoptimized] ")?e.code.name.substring("[Unoptimized] ".length):e.code.name:"<unknown>",r=e.location;if(!r){const e=new c.StackFrame(t,s);return e.presentationHint="subtle",void u.push(e)}const o=r.script.uri;let a,l=this.convertVMUriToSourcePath(o),h=l&&n.existsSync(l);o.startsWith("dart:")&&(l=void 0,a=i.storeData(r.script),h=!0);const p=this.formatUriForShortDisplay(o),g=new c.StackFrame(t,s,h?new c.Source(p,l,a,void 0,r.script):void 0,0,0),f=0===u.length,m=0!==i.exceptionReference,v=!f||m;g.source&&v&&(!this.isValidToDebug(o)||this.isSdkLibrary(o)&&!this.debugSdkLibraries?(g.source.origin="from the Dart SDK",g.source.presentationHint="deemphasize"):this.isExternalLibrary(o)&&!this.debugExternalLibraries&&(g.source.origin=o.startsWith("package:flutter/")?"from the Flutter framework":"from Pub packages",g.source.presentationHint="deemphasize")),u.push(g);const y=i.getScript(r.script).then(e=>{const t=this.resolveFileLocation(e,r.tokenPos);t&&(g.line=t.line,g.column=t.column)});d.push(y)}),e.body={stackFrames:u,totalFrames:l},Promise.all(d).then(t=>{this.sendResponse(e)}).catch(t=>{this.sendResponse(e)})}).catch(t=>this.errorResponse(e,""+t)):this.errorResponse(e,"No observatory connection"):this.errorResponse(e,"No thread with id "+t.threadId)}scopesRequest(e,t){const i=t.frameId,s=this.threadManager.getStoredData(i),n=s.data,r=s.thread.storeData(n),o=[];s.thread.exceptionReference&&o.push(new c.Scope("Exception",s.thread.exceptionReference)),o.push(new c.Scope("Locals",r)),e.body={scopes:o},this.sendResponse(e)}variablesRequest(e,t){return s(this,void 0,void 0,(function*(){if(!this.observatory)return void this.errorResponse(e,"No observatory connection");const i=t.variablesReference,n=t.start||0,r=t.count,o=this.threadManager.getStoredData(i),a=o.thread;if("Frame"===o.data.type){const t=o.data;let i=[];if(t.vars){const e=t.vars.filter(e=>!e.value||"@TypeArguments"!==e.value.type).map((e,t)=>this.instanceRefToVariable(a,!0,e.name,e.name,e.value,t<=15)),s=yield Promise.all(e);i=i.concat(s)}e.body={variables:i},this.sendResponse(e)}else if("MapEntry"===o.data.type){const t=o.data,i=this.observatory.getObject(a.ref.id,t.keyId),s=this.observatory.getObject(a.ref.id,t.valueId),n=[];let r=!1,c="value";try{const e=(yield i).result;n.push(yield this.instanceRefToVariable(a,!1,"key","key",e,!0)),this.isSimpleKind(e.kind)&&t.mapEvaluateName&&(r=!0,c=`${t.mapEvaluateName}[${this.valueAsString(e)}]`)}catch(e){n.push({name:"key",value:this.errorAsDisplayValue(e),variablesReference:0})}try{const e=(yield s).result;n.push(yield this.instanceRefToVariable(a,r,c,"value",e,!0))}catch(e){n.push({name:"value",value:this.errorAsDisplayValue(e),variablesReference:0})}e.body={variables:n},this.sendResponse(e)}else{const t=o.data;try{const i=yield this.observatory.getObject(a.ref.id,t.id,n,r);let o=[];const c=void 0!==t.evaluateName;if("Sentinel"===i.result.type)o.push({name:"<evalError>",value:i.result.valueAsString,variablesReference:0});else{const e=i.result;if("Instance"===e.type){const i=e;if(this.isSimpleKind(i.kind))o.push(yield this.instanceRefToVariable(a,c,""+t.evaluateName,i.kind,t,!0));else if(i.elements){const e=i.elements.length,r=i.elements.map((i,r)=>s(this,void 0,void 0,(function*(){return this.instanceRefToVariable(a,c,`${t.evaluateName}[${r+n}]`,`[${r+n}]`,i,e<=15)}))),l=yield Promise.all(r);o=o.concat(l)}else if(i.associations){const e=i.associations.length;for(let s=0;s<e;s++){const e=i.associations[s],r=this.valueAsString(e.key,!0),c=this.valueAsString(e.value,!0);let l=0;if("Sentinel"!==e.key.type&&"Sentinel"!==e.value.type){const i={keyId:e.key.id,mapEvaluateName:t.evaluateName,type:"MapEntry",valueId:e.value.id};l=a.storeData(i)}o.push({name:""+(s+n),type:`${r} -> ${c}`,value:`${r} -> ${c}`,variablesReference:l})}}else if(i.fields){let e=[];const n=f.sortBy(i.fields,e=>e.decl.name).map((e,i)=>s(this,void 0,void 0,(function*(){return this.instanceRefToVariable(a,c,`${t.evaluateName}.${e.decl.name}`,e.decl.name,e.value,i<=15)})));if(e=e.concat(n),this.evaluateGettersInDebugViews&&i.class){let n=yield this.getGetterNamesForHierarchy(a.ref,i.class);n=n.sort();const r=n.map((e,n)=>s(this,void 0,void 0,(function*(){try{const s=yield this.observatory.evaluate(a.ref.id,t.id,e,!0);if("@Error"===s.result.type)return{name:e,value:s.result.message,variablesReference:0};if("Sentinel"===s.result.type)return{name:e,value:s.result.valueAsString,variablesReference:0};{const r=s.result;return this.instanceRefToVariable(a,c,`${t.evaluateName}.${e}`,e,r,i.fields.length+n<=15)}}catch(t){return{name:e,value:this.errorAsDisplayValue(t),variablesReference:0}}})));e=e.concat(r);const l=yield Promise.all(e);o=o.concat(l)}yield Promise.all(e)}else this.logToUser(`Unknown instance kind: ${i.kind}. ${u.pleaseReportBug}\n`)}else this.logToUser(`Unknown object type: ${e.type}. ${u.pleaseReportBug}\n`)}e.body={variables:o},this.sendResponse(e)}catch(t){e.body={variables:[{name:"<error>",value:this.errorAsDisplayValue(t),variablesReference:0}]},this.sendResponse(e)}}}))}errorAsDisplayValue(e){if(!e)return"<unknown error>";const t=""+(e.message||e);return t?`<${t.split("\n")[0].trim()}>`:"<unknown error>"}getGetterNamesForHierarchy(e,t){return s(this,void 0,void 0,(function*(){let i=[];for(;this.observatory&&t;){const s=yield this.observatory.getObject(e.id,t.id);if("Class"!==s.result.type)break;const n=s.result;i=i.concat(i,n.functions.filter(e=>"GetterFunction"===e._kind&&!e.static&&!e.const).map(e=>e.name)),t=n.super}return i=g.uniq(i),i.filter(e=>"_identityHashCode"!==e)}))}isSimpleKind(e){return"String"===e||"Bool"===e||"Int"===e||"Num"===e||"Double"===e||"Null"===e}callToString(e,t,i=!1){return s(this,void 0,void 0,(function*(){if(this.observatory)try{const s=this.capabilities.hasInvoke?yield this.observatory.invoke(e.id,t.id,"toString",[],!0):yield this.observatory.evaluate(e.id,t.id,"toString()",!0);if("@Error"===s.result.type)return;{let t=s.result;if(t.valueAsStringIsTruncated&&i){t=(yield this.observatory.getObject(e.id,t.id)).result}return this.valueAsString(t,void 0,!0)}}catch(e){return void this.logger.error(e)}}))}setVariableRequest(e,t){this.errorResponse(e,"not supported")}continueRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId);i?i.resume().then(t=>{e.body={allThreadsContinued:!1},this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t)):this.errorResponse(e,"No thread with id "+t.threadId)}nextRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId);if(!i)return void this.errorResponse(e,"No thread with id "+t.threadId);const s=i.atAsyncSuspension?"OverAsyncSuspension":"Over";i.resume(s).then(t=>{this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t))}stepInRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId);i?i.resume("Into").then(t=>{this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t)):this.errorResponse(e,"No thread with id "+t.threadId)}stepOutRequest(e,t){const i=this.threadManager.getThreadInfoFromNumber(t.threadId);i?i.resume("Out").then(t=>{this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t)):this.errorResponse(e,"No thread with id "+t.threadId)}restartFrameRequest(e,t){const i=t.frameId;if(!i)return void this.errorResponse(e,"unable to restart with no frame");const s=this.threadManager.getStoredData(i),n=s.thread,r=s.data;n.resume("Rewind",r.index).then(t=>{this.sendResponse(e)}).catch(t=>this.errorResponse(e,""+t))}reverseContinueRequest(e,t){this.logToUser("Reverse continue is not supported\n"),this.errorResponse(e,"Reverse continue is not supported for the Dart debugger")}evaluateRequest(e,t){return s(this,void 0,void 0,(function*(){const i="clipboard"===t.context,s="watch"===t.context,n=t.expression.replace(R,""),r=t.frameId,o=r?this.threadManager.getStoredData(r):void 0,a=o?o.thread:this.threadManager.threads[0];try{let t;if(o){const i=o.data;if(("$e"===n||n.startsWith("$e."))&&a.exceptionReference){const i=this.threadManager.getStoredData(a.exceptionReference),s=i&&i.data;if("$e"===n)return e.body={result:(yield this.fullValueAsString(a.ref,s))||"<unknown>",variablesReference:a.exceptionReference},void this.sendResponse(e);const r=s&&s.id;r&&(t=yield this.observatory.evaluate(a.ref.id,r,n.substr(3),!0))}t||(t=yield Promise.race([this.observatory.evaluateInFrame(a.ref.id,i.index,n,!0),new Promise((e,t)=>setTimeout(()=>t(new Error("<timed out>")),1e3))]))}else{if(!this.observatory||!a)return void this.errorResponse(e,"global evaluation requires a thread to have been loaded");const i=(yield this.observatory.getIsolate(a.ref.id)).result.rootLib;if(!i)return void this.errorResponse(e,"global evaluation requires a rootLib on the initial thread");t=yield Promise.race([this.observatory.evaluate(a.ref.id,i.id,n,!0),new Promise((e,t)=>setTimeout(()=>t(new Error("<timed out>")),1e3))])}if(t)if("@Error"===t.result.type){let i=t.result.message;i&&(i=i.split("\n").slice(0,6).join("\n")),this.errorResponse(e,i)}else{const s=t.result;s.evaluateName=n;const r=yield this.fullValueAsString(a.ref,s,i);e.body={result:r||"<unknown>",variablesReference:this.isSimpleKind(s.kind)?0:a.storeData(s)},this.sendResponse(e)}else this.errorResponse(e,"No evaluation result")}catch(t){t&&t.message&&-1!==t.message.indexOf("UnimplementedError")?this.errorResponse(e,"<not yet implemented>"):s&&t&&t.message&&-1!==t.message.indexOf("Expression compilation error")||s&&t&&t.message&&-1!==t.message.indexOf("noSuchMethodException")?this.errorResponse(e,"not available"):t&&t.data&&t.data.details?this.errorResponse(e,""+t.data.details):t&&t.message?this.errorResponse(e,""+t.message):this.errorResponse(e,""+t)}}))}exposeUrl(e){return s(this,void 0,void 0,(function*(){if(this.urlExposeCompleters[e])return this.urlExposeCompleters[e].promise;const t=new g.PromiseCompleter;return this.urlExposeCompleters[e]=t,this.sendEvent(new c.Event("dart.exposeUrl",{url:e})),t.promise}))}customRequest(e,t,i){const n=Object.create(null,{customRequest:{get:()=>super.customRequest}});return s(this,void 0,void 0,(function*(){try{switch(e){case"service":yield this.callService(i.type,i.params),this.sendResponse(t);break;case"exposeUrlResponse":const s=this.urlExposeCompleters[i.originalUrl];s&&s.resolve({url:i.exposedUrl});break;case"updateDebugOptions":this.debugExternalLibraries=!!i.debugExternalLibraries,this.debugSdkLibraries=!!i.debugSdkLibraries,yield this.threadManager.setLibrariesDuggableForAllIsolates(),this.sendResponse(t);break;case"serviceExtension":case"checkPlatformOverride":case"checkIsWidgetCreationTracked":case"hotReload":case"hotRestart":this.log(`Ignoring Flutter customRequest ${e} for non-Flutter-run app`,d.LogSeverity.Warn),this.sendResponse(t);break;default:this.log("Unknown customRequest "+e,d.LogSeverity.Warn),n.customRequest.call(this,e,t,i)}}catch(i){this.logger.error(`Error handling '${e}' custom request: ${i}`),this.errorResponse(t,i&&i.message)}}))}handleIsolateEvent(e){return s(this,void 0,void 0,(function*(){const t=e.kind;"IsolateStart"===t||"IsolateRunnable"===t?yield this.threadManager.registerThread(e.isolate,t):"IsolateExit"===t?this.threadManager.handleIsolateExit(e.isolate):"ServiceExtensionAdded"===t&&this.handleServiceExtensionAdded(e)}))}handleExtensionEvent(e){}handleServiceEvent(e){"ServiceRegistered"===e.kind&&this.handleServiceRegistered(e)}handleLoggingEvent(e){return s(this,void 0,void 0,(function*(){this.lastLoggingEvent=this.lastLoggingEvent.then(()=>this.processLoggingEvent(e))}))}processLoggingEvent(e){return s(this,void 0,void 0,(function*(){if("Logging"===e.kind&&e.logRecord){const t=e.logRecord;if(t){const i=`[${(t.loggerName?this.valueAsString(t.loggerName,!1,!0):void 0)||"log"}] `;let s=" ".repeat(i.length);if(t.message){const e=(t.message.valueAsString||"<empty message>")+(t.message.valueAsStringIsTruncated?"…":""),n=`${m.grey(i)}${e.split("\n").join("\n"+s)}`;this.logToUser(n.trimRight()+"\n")}if(s+="  ",t.error&&"Null"!==t.error.kind){const i=yield this.fullValueAsString(e.isolate,t.error);if(i){const e=`${s}${i.split("\n").join("\n"+s)}`;this.logToUser(e.trimRight()+"\n","stderr")}}if(t.stackTrace&&"Null"!==t.stackTrace.kind){const i=yield this.fullValueAsString(e.isolate,t.stackTrace);if(i){const e=`${s}${i.split("\n").join("\n"+s)}`;this.logToUser(e.trimRight()+"\n","stderr")}}}}}))}handleDebugEvent(e){return s(this,void 0,void 0,(function*(){try{const t=e.kind;t.startsWith("Pause")?yield this.handlePauseEvent(e):"Inspect"===t&&(yield this.handleInspectEvent(e))}catch(e){this.logger.error(e)}}))}handlePauseEvent(e){return s(this,void 0,void 0,(function*(){if(!e.isolate)return void this.logger.warn(`Unable to handle pause event (${e.kind}) that had no isolate`);const t=e.kind,i=this.threadManager.getThreadInfoFromRef(e.isolate);if(i)if(this.observatory)if("PausePostRequest"===t){try{yield this.threadManager.resetBreakpoints()}catch(e){this.logger.error(e)}try{yield this.observatory.resume(e.isolate.id)}catch(e){if(106!==e.code)throw e}}else if("PauseStart"===t)this.childProcess?i.receivedPauseStart():(i.handlePaused(e.atAsyncSuspension,e.exception),yield i.resume("Into"));else{let s,n="pause",r=!0;if("PauseBreakpoint"===t&&e.pauseBreakpoints&&e.pauseBreakpoints.length){n="breakpoint";const t=e.pauseBreakpoints.map(e=>i.breakpoints[e.id]);if(!(-1!==t.indexOf(void 0))){const e=t.filter(g.notUndefined),s=!!e.find(e=>!e.condition&&!e.logMessage),n=e.filter(e=>e.condition),o=e.filter(e=>e.logMessage);r=s||(yield this.anyBreakpointConditionReturnsTrue(n,i));for(const e of o){if(!e.logMessage)continue;const t=`print("""${e.logMessage.replace(/(^|[^\\\$]){/g,"$1${").replace(/\\({)/g,"$1").replace(/"""/g,'\\"\\"\\"')}""")`;yield this.evaluateAndSendErrors(i,t)}}}else"PauseBreakpoint"===t?n="step":"PauseException"===t&&(n="exception",s=e.exception?yield this.fullValueAsString(e.isolate,e.exception):void 0);i.handlePaused(e.atAsyncSuspension,e.exception),r?this.sendEvent(new c.StoppedEvent(n,i.num,s)):yield i.resume()}else this.logger.warn("No observatory connection");else this.logger.warn(`ThreadManager couldn't find thread with ref ${e.isolate.id} to handle ${t}`)}))}handleInspectEvent(e){return s(this,void 0,void 0,(function*(){}))}fullValueAsString(e,t,i=!1){return s(this,void 0,void 0,(function*(){let s;return t.valueAsStringIsTruncated||(s=this.valueAsString(t,!1,i)),!s&&e&&(s=yield this.callToString(e,t,!0)),"PlainInstance"===t.kind&&t.class&&t.class.name&&(s=s!==`Instance of '${t.class.name}'`&&s!==t.class.name&&s?`${t.class.name} (${s})`:t.class.name),s}))}anyBreakpointConditionReturnsTrue(e,t){return s(this,void 0,void 0,(function*(){for(const i of e){const e=yield this.evaluateAndSendErrors(t,i.condition);if(e){if("Bool"===e.kind&&"true"===e.valueAsString||"Int"===e.kind&&"0"!==e.valueAsString||"Double"===e.kind&&"0"!==e.valueAsString)return!0}}return!1}))}callService(e,t){if(!this.observatory)throw new Error("Observatory connection is not available");return this.observatory.callMethod(e,t)}evaluateAndSendErrors(e,t){return s(this,void 0,void 0,(function*(){if(this.observatory)try{const i=yield this.observatory.evaluateInFrame(e.ref.id,0,t,!0);if("@Error"!==i.result.type)return i.result;this.logToUser(`Debugger failed to evaluate expression \`${t}\`\n`)}catch(e){this.logToUser(`Debugger failed to evaluate expression \`${t}\`\n`)}}))}handleServiceExtensionAdded(e){e&&e.extensionRPC&&this.notifyServiceExtensionAvailable(e.extensionRPC,e.isolate?e.isolate.id:void 0)}handleServiceRegistered(e){e&&e.service&&this.notifyServiceRegistered(e.service,e.method)}notifyServiceExtensionAvailable(e,t){this.sendEvent(new c.Event("dart.serviceExtensionAdded",{id:e,isolateId:t}))}notifyServiceRegistered(e,t){this.sendEvent(new c.Event("dart.serviceRegistered",{service:e,method:t}))}errorResponse(e,t){e.success=!1,e.message=t,this.sendResponse(e)}formatUriForShortDisplay(e){e.startsWith("file:")&&(e=g.uriToFilePath(e),this.cwd&&(e=o.relative(this.cwd,e)));const t=-1===e.indexOf("/")&&-1!==e.indexOf("\\")?"\\":"/",i=e.split(t);return i.length>3?[i[0],"…",i[i.length-2],i[i.length-1]].join(t):e}convertVMUriToSourcePath(e,t){return e.startsWith("file:")?g.uriToFilePath(e,t):e.startsWith("package:")&&this.packageMap?this.packageMap.resolvePackageUri(e):e}valueAsString(e,t=!0,i=!1){if("Sentinel"===e.type)return e.valueAsString;const s=e;if("String"===e.kind||e.valueAsString){let e=s.valueAsString;return s.valueAsStringIsTruncated&&(e+="…"),"String"!==s.kind||i||(e=`"${e}"`),e}if("List"===e.kind)return`List (${s.length} ${1===s.length?"item":"items"})`;if("Map"===e.kind)return`Map (${s.length} ${1===s.length?"item":"items"})`;if("Type"===e.kind){return`Type (${e.name})`}return t?this.getFriendlyTypeName(s):void 0}getFriendlyTypeName(e){return"PlainInstance"!==e.kind?e.kind:e.class.name}instanceRefToVariable(e,t,i,n,r,o){return s(this,void 0,void 0,(function*(){if("Sentinel"===r.type)return{name:n,value:r.valueAsString,variablesReference:0};{const s=r;s.evaluateName=t?i:void 0;const a=this.evaluateToStringInDebugViews&&o&&!s.valueAsString?yield this.fullValueAsString(e.ref,s):this.valueAsString(s);return{evaluateName:t?i:void 0,indexedVariables:s&&s.kind&&s.kind.endsWith("List")?s.length:void 0,name:n,type:`${s.kind} (${s.class.name})`,value:a||"",variablesReference:s.valueAsString?0:e.storeData(s)}}}))}isValidToDebug(e){return this.supportsDebugInternalLibraries||!e.startsWith("dart:_")}isSdkLibrary(e){return e.startsWith("dart:")}isExternalLibrary(e){if(!e.startsWith("package:")||!this.packageMap)return!1;if(e.startsWith("package:flutter/")||e.startsWith("package:flutter_test/"))return!0;const t=this.packageMap.resolvePackageUri(e);return!!t&&(-1!==t.indexOf("/hosted/pub.dartlang.org/")||-1!==t.indexOf("\\hosted\\pub.dartlang.org\\"))}resolveFileLocation(e,t){const i=e.tokenPosTable;for(const e of i)for(let i=1;i<e.length;i+=2)if(e[i]===t){return{line:e[0],column:e[i+1]}}}pollForMemoryUsage(){return s(this,void 0,void 0,(function*(){if(!this.childProcess||this.childProcess.killed||!this.observatory)return;const e=(yield this.observatory.getVM()).result.isolates.map(e=>this.observatory.getIsolate(e.id)),t=(yield Promise.all(e)).map(e=>e.result);let i=0,s=0;for(const e of t)if(e._heaps)for(const t of[e._heaps.old,e._heaps.new])i+=t.used+t.external,s+=t.capacity+t.external;this.sendEvent(new c.Event("dart.debugMetrics",{memory:{current:i,total:s}})),this.pollforMemoryMs&&setTimeout(()=>this.pollForMemoryUsage(),this.pollforMemoryMs).unref()}))}getStackFrameData(e){const t=e&&C.exec(e);if(t)return{col:parseInt(t[4],10),line:parseInt(t[3],10),prefix:t[1],sourceUri:t[2]}}getWebStackFrameData(e){const t=e&&T.exec(e);if(t)return{col:parseInt(t[3],10),line:parseInt(t[2],10),prefix:t[4],sourceUri:t[1]}}getMessageWithUriData(e){const t=e&&E.exec(e);if(t)return{col:parseInt(t[4],10),line:parseInt(t[3],10),prefix:t[1],sourceUri:t[2]}}logToUserBuffered(e,t){this.logBuffer[t]=this.logBuffer[t]||"",this.logBuffer[t]+=e;const i=this.logBuffer[t].lastIndexOf("\n");if(-1!==i){const e=this.logBuffer[t].substr(0,i+1);this.logBuffer[t]=this.logBuffer[t].substr(i+1),this.logToUser(e,t)}}logToUser(e,t,i=(e=>e)){const s=this.getStackFrameData(e)||this.getWebStackFrameData(e)||this.getMessageWithUriData(e),r=-1!==e.trimRight().indexOf("\n");if(s&&r)return void e.split("\n").forEach(e=>this.logToUser(e+"\n",t));const o=new c.OutputEvent(""+m.applyColor(e,i),t);if(s){const e=this.convertVMUriToSourcePath(s.sourceUri),t=e&&e!==s.sourceUri&&n.existsSync(e),i=this.formatUriForShortDisplay(s.sourceUri),r=t?new c.Source(i,e,void 0,void 0,void 0):void 0;let a=`${s.prefix} (${s.sourceUri}:${s.line}:${s.col})`;r&&(o.body.source=r,o.body.line=s.line,o.body.column=s.col,a=s.prefix);const l=this.isSdkLibrary(s.sourceUri)||this.isExternalLibrary(s.sourceUri)&&(s.sourceUri.startsWith("package:flutter/")||s.sourceUri.startsWith("package:flutter_test/"))?m.applyColor(a,m.grey):m.applyColor(a,m.grey2);o.body.output=l+"\n"}else"stderr"===t&&o.body.output.trim().startsWith("<async")&&o.body.output.trim().endsWith(">")&&(o.body.output=m.applyColor(o.body.output.trimRight(),m.grey)+"\n");this.sendEvent(o)}}t.DartDebugSession=P;class D{constructor(e){this.pid=e,this.killed=!1}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(199),n=i(73),r=i(34),o=i(28);t.Source=class{constructor(e,t,i=0,s,n){this.name=e,this.path=t,this.sourceReference=i,s&&(this.origin=s),n&&(this.adapterData=n)}};t.Scope=class{constructor(e,t,i=!1){this.name=e,this.variablesReference=t,this.expensive=i}};t.StackFrame=class{constructor(e,t,i,s=0,n=0){this.id=e,this.source=i,this.line=s,this.column=n,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,i=0,s,n){this.name=e,this.value=t,this.variablesReference=i,"number"==typeof n&&(this.namedVariables=n),"number"==typeof s&&(this.indexedVariables=s)}};t.Breakpoint=class{constructor(e,t,i,s){this.verified=e;const n=this;"number"==typeof t&&(n.line=t),"number"==typeof i&&(n.column=i),s&&(n.source=s)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,i=0){this.label=e,this.start=t,this.length=i}};class a extends n.Event{constructor(e,t,i){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof i&&(this.body.text=i)}}t.StoppedEvent=a;class c extends n.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}t.ContinuedEvent=c;class l extends n.Event{constructor(){super("initialized")}}t.InitializedEvent=l;class u extends n.Event{constructor(e){if(super("terminated"),"boolean"==typeof e||e){this.body={restart:e}}}}t.TerminatedEvent=u;class d extends n.Event{constructor(e,t="console",i){super("output"),this.body={category:t,output:e},void 0!==i&&(this.body.data=i)}}t.OutputEvent=d;class h extends n.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}t.ThreadEvent=h;class p extends n.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}t.BreakpointEvent=p;class g extends n.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}}t.ModuleEvent=g;class f extends n.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}}t.LoadedSourceEvent=f;class m extends n.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}}t.CapabilitiesEvent=m;class v extends n.Event{constructor(e,t,i){super("progressStart"),this.body={progressId:e,title:t},"string"==typeof i&&(this.body.message=i)}}t.ProgressStartEvent=v;class y extends n.Event{constructor(e,t){super("progressUpdate"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressUpdateEvent=y;class b extends n.Event{constructor(e,t){super("progressEnd"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}var w;t.ProgressEndEvent=b,function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(w=t.ErrorDestination||(t.ErrorDestination={}));class S extends s.ProtocolServer{constructor(e,t){super();const i="boolean"==typeof e&&e;this._debuggerLinesStartAt1=i,this._debuggerColumnsStartAt1=i,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){let t=0;if(process.argv.slice(2).forEach((function(e,i,s){const n=/^--server=(\d{4,5})$/.exec(e);n&&(t=parseInt(n[1],10))})),t>0)console.error("waiting for debug protocol on port "+t),r.createServer(t=>{console.error(">> accepted connection from client"),t.on("end",()=>{console.error(">> client connection closed\n")});const i=new e(!1,!0);i.setRunAsServer(!0),i.start(t,t)}).listen(t);else{const t=new e(!1);process.on("SIGTERM",()=>{t.shutdown()}),t.start(process.stdin,process.stdout)}}shutdown(){this._isServer||this._isRunningInline()||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,i,s,n=w.User){let r;"number"==typeof t?(r={id:t,format:i},s&&(r.variables=s),n&w.User&&(r.showUser=!0),n&w.Telemetry&&(r.sendTelemetry=!0)):r=t,e.success=!1,e.message=S.formatPII(r.format,!0,r.variables),e.body||(e.body={}),e.body.error=r,this.sendResponse(e)}runInTerminalRequest(e,t,i){this.sendRequest("runInTerminal",e,t,i)}dispatchRequest(e){const t=new n.Response(e);try{if("initialize"===e.command){var i=e.arguments;if("boolean"==typeof i.linesStartAt1&&(this._clientLinesStartAt1=i.linesStartAt1),"boolean"==typeof i.columnsStartAt1&&(this._clientColumnsStartAt1=i.columnsStartAt1),"path"!==i.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,w.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,i)}}else"launch"===e.command?this.launchRequest(t,e.arguments,e):"attach"===e.command?this.attachRequest(t,e.arguments,e):"disconnect"===e.command?this.disconnectRequest(t,e.arguments,e):"terminate"===e.command?this.terminateRequest(t,e.arguments,e):"restart"===e.command?this.restartRequest(t,e.arguments,e):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments,e):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments,e):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments,e):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments,e):"continue"===e.command?this.continueRequest(t,e.arguments,e):"next"===e.command?this.nextRequest(t,e.arguments,e):"stepIn"===e.command?this.stepInRequest(t,e.arguments,e):"stepOut"===e.command?this.stepOutRequest(t,e.arguments,e):"stepBack"===e.command?this.stepBackRequest(t,e.arguments,e):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments,e):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments,e):"goto"===e.command?this.gotoRequest(t,e.arguments,e):"pause"===e.command?this.pauseRequest(t,e.arguments,e):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments,e):"scopes"===e.command?this.scopesRequest(t,e.arguments,e):"variables"===e.command?this.variablesRequest(t,e.arguments,e):"setVariable"===e.command?this.setVariableRequest(t,e.arguments,e):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments,e):"source"===e.command?this.sourceRequest(t,e.arguments,e):"threads"===e.command?this.threadsRequest(t,e):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments,e):"evaluate"===e.command?this.evaluateRequest(t,e.arguments,e):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments,e):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments,e):"completions"===e.command?this.completionsRequest(t,e.arguments,e):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments,e):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments,e):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments,e):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments,e):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments,e):"disassemble"===e.command?this.disassembleRequest(t,e.arguments,e):"cancel"===e.command?this.cancelRequest(t,e.arguments,e):"breakpointLocations"===e.command?this.breakpointLocationsRequest(t,e.arguments,e):this.customRequest(e.command,t,e.arguments,e)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},w.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsClipboardContext=!1,this.sendResponse(e)}disconnectRequest(e,t,i){this.sendResponse(e),this.shutdown()}launchRequest(e,t,i){this.sendResponse(e)}attachRequest(e,t,i){this.sendResponse(e)}terminateRequest(e,t,i){this.sendResponse(e)}restartRequest(e,t,i){this.sendResponse(e)}setBreakPointsRequest(e,t,i){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t,i){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t,i){this.sendResponse(e)}configurationDoneRequest(e,t,i){this.sendResponse(e)}continueRequest(e,t,i){this.sendResponse(e)}nextRequest(e,t,i){this.sendResponse(e)}stepInRequest(e,t,i){this.sendResponse(e)}stepOutRequest(e,t,i){this.sendResponse(e)}stepBackRequest(e,t,i){this.sendResponse(e)}reverseContinueRequest(e,t,i){this.sendResponse(e)}restartFrameRequest(e,t,i){this.sendResponse(e)}gotoRequest(e,t,i){this.sendResponse(e)}pauseRequest(e,t,i){this.sendResponse(e)}sourceRequest(e,t,i){this.sendResponse(e)}threadsRequest(e,t){this.sendResponse(e)}terminateThreadsRequest(e,t,i){this.sendResponse(e)}stackTraceRequest(e,t,i){this.sendResponse(e)}scopesRequest(e,t,i){this.sendResponse(e)}variablesRequest(e,t,i){this.sendResponse(e)}setVariableRequest(e,t,i){this.sendResponse(e)}setExpressionRequest(e,t,i){this.sendResponse(e)}evaluateRequest(e,t,i){this.sendResponse(e)}stepInTargetsRequest(e,t,i){this.sendResponse(e)}gotoTargetsRequest(e,t,i){this.sendResponse(e)}completionsRequest(e,t,i){this.sendResponse(e)}exceptionInfoRequest(e,t,i){this.sendResponse(e)}loadedSourcesRequest(e,t,i){this.sendResponse(e)}dataBreakpointInfoRequest(e,t,i){this.sendResponse(e)}setDataBreakpointsRequest(e,t,i){this.sendResponse(e)}readMemoryRequest(e,t,i){this.sendResponse(e)}disassembleRequest(e,t,i){this.sendResponse(e)}cancelRequest(e,t,i){this.sendResponse(e)}breakpointLocationsRequest(e,t,i){this.sendResponse(e)}customRequest(e,t,i,s){this.sendErrorResponse(t,1014,"unrecognized request",null,w.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?S.uri2path(e):S.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?S.uri2path(e):S.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),i=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(i)&&(i=i[1].toLowerCase()+i.substr(2)),i=i.replace(/\//g,"\\")),i}static formatPII(e,t,i){return e.replace(S._formatPIIRegexp,(function(e,s){return t&&s.length>0&&"_"!==s[0]?e:i[s]&&i.hasOwnProperty(s)?i[s]:e}))}}S._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=S},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.seq=0,this.type=e}}t.Message=s;t.Response=class extends s{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends s{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(36),o=i(4),a=i(8),c=i(71),l=i(50),u=i(215);class d extends c.DartDebugSession{constructor(){super(),this.suitePaths=[],this.tests=[],this.sendStdOutToConsole=!1,this.allowWriteServiceInfo=!1,this.requiresProgram=!1}spawnProcess(e){let t=[];this.shouldConnectDebugger&&(this.expectAdditionalPidToTerminate=!0,t.push("--enable-vm-service=0"),t.push("--pause_isolates_on_start=true")),e.vmAdditionalArgs&&(t=t.concat(e.vmAdditionalArgs)),t.push(e.pubSnapshotPath),t=t.concat(["run","test","-r","json"]),t.push("-j1"),e.program&&t.push(this.sourceFileForArgs(e)),e.args&&(t=t.concat(e.args));const i=new l.DebugAdapterLogger(this,a.LogCategory.PubTest);return this.createRunner(e.dartPath,e.cwd,e.program,t,e.env,e.pubTestLogFile,i,e.maxLogLineLength)}createRunner(e,t,i,n,o,a,c,l){const d=new u.TestRunner(e,t,n,{envOverrides:o,toolEnv:this.toolEnv},a,c,l);return d.registerForUnhandledMessages(e=>{-1!==e.toLowerCase().indexOf("waiting for current test(s) to finish")&&this.sendEvent(new r.Event("dart.terminating",{message:e.trim()+".."})),this.logToUserIfAppropriate(e,"stdout")}),d.registerForTestStartedProcess(e=>this.initDebugger(e.observatoryUri+"ws")),d.registerForAllTestNotifications(e=>s(this,void 0,void 0,(function*(){try{yield this.handleTestEvent(e)}catch(e){this.log(e),this.logToUser(e+"\n")}try{this.sendTestEventToEditor(e)}catch(e){this.log(e),this.logToUser(e+"\n")}}))),d.process}logToUserIfAppropriate(e,t){e&&e.startsWith("Observatory listening on")||e&&e.startsWith("Press Control-C again")||this.logToUser(e,t)}handleTestEvent(e){return s(this,void 0,void 0,(function*(){switch(e.type){case"start":const t=e.pid;t&&this.recordAdditionalPid(t);break;case"debug":const i=e.observatory;if(i){const e=o.observatoryHttpLinkPattern.exec(i);e&&(yield this.initDebugger(this.websocketUriForObservatoryUri(e[1])))}break;case"suite":const s=e;!n.isAbsolute(s.suite.path)&&this.cwd&&(s.suite.path=n.join(this.cwd,s.suite.path)),this.suitePaths[s.suite.id]=s.suite.path;break;case"testStart":const a=e;this.tests[a.test.id]=a.test;break;case"testDone":const c=e;if(c.hidden)return;const l="success"===c.result?"✓":"✖";this.sendEvent(new r.OutputEvent(`${l} ${this.tests[c.testID].name}\n`,"stdout"));break;case"print":const u=e;this.sendEvent(new r.OutputEvent(u.message+"\n","stdout"));break;case"error":const d=e;this.sendEvent(new r.OutputEvent(d.error+"\n","stderr")),this.sendEvent(new r.OutputEvent(d.stackTrace+"\n","stderr"))}}))}sendTestEventToEditor(e){let t;switch(e.type){case"suite":t=e.suite.id;break;case"group":t=e.group.suiteID;break;case"testStart":t=e.test.suiteID;break;case"testDone":const i=e;t=this.tests[i.testID].suiteID;break;case"print":const s=e;t=this.tests[s.testID].suiteID;break;case"error":const n=e;t=this.tests[n.testID].suiteID}const i=void 0!==t?this.suitePaths[t]:void 0;i&&this.sendEvent(new r.Event("dart.testRunNotification",{suitePath:i,notification:e}))}}t.DartTestDebugSession=d},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(0),o=i(1),a=i(37);function c(e){const t={};for(const i of e.edits){t[i.file]||(t[i.file]=[]);for(const e of i.edits){if(t[i.file].find(t=>t.offset<=e.offset))return!0;t[i.file].push(e)}}return!1}t.DasEditCommands=class{constructor(e,t,i){this.logger=e,this.context=t,this.analyzer=i,this.commands=[],this.commands.push(r.commands.registerCommand("_dart.organizeImports",this.organizeImports,this),r.commands.registerCommand("dart.sortMembers",this.sortMembers,this),r.commands.registerCommand("_dart.applySourceChange",this.applyEdits,this),r.commands.registerCommand("dart.completeStatement",this.completeStatement,this))}getActiveDoc(){return r.window.activeTextEditor&&r.window.activeTextEditor.document}organizeImports(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editOrganizeDirectives,"Organize Imports",e)}sortMembers(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editSortMembers,"Sort Members",e)}completeStatement(){return s(this,void 0,void 0,(function*(){const e=r.window.activeTextEditor;if(!e||!e.selection||!this.analyzer.capabilities.hasCompleteStatementFix)return;const t=e.document,i=o.fsPath(t.uri),s=t.offsetAt(e.selection.end),n=yield this.analyzer.editGetStatementCompletion({file:i,offset:s});n&&n.change&&(yield this.applyEdits(t,n.change))}))}sendEdit(e,t,i){return s(this,void 0,void 0,(function*(){if(!i||!a.isDartDocument(i))return void r.window.showWarningMessage("Not a Dart file.");const s=i.version;e=e.bind(this.analyzer);try{const n=(yield e({file:o.fsPath(i.uri)})).edit;if(0===n.edits.length)return;if(i.isClosed)return void r.window.showErrorMessage(`Error running ${t}: Document has been closed.`);if(i.version!==s)return void r.window.showErrorMessage(`Error running ${t}: Document has been modified.`);const a=new r.WorkspaceEdit;n.edits.forEach(e=>{const t=new r.Range(i.positionAt(e.offset),i.positionAt(e.offset+e.length));a.replace(i.uri,t,e.replacement)}),yield r.workspace.applyEdit(a)}catch(e){r.window.showErrorMessage(`Error running ${t}: ${e.message}.`)}}))}dispose(){for(const e of this.commands)e.dispose()}applyEdits(e,t){return s(this,void 0,void 0,(function*(){if(1===t.edits.length&&t.linkedEditGroups&&0!==t.linkedEditGroups.length)return this.applyEditsWithSnippets(e,t);const i=c(t);i&&this.logger.warn("Falling back to sequential edits due to overlapping edits in server.");const s=i;let o=s?void 0:new r.WorkspaceEdit;for(const e of t.edits){const t=r.Uri.file(e.file);if(!n.existsSync(e.file)&&e.edits.find(e=>0!==e.offset||0!==e.length)){this.logger.error(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`),r.window.showErrorMessage(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`);continue}const i=n.existsSync(e.file)?yield r.workspace.openTextDocument(t):void 0;o&&o.createFile(t,{ignoreIfExists:!0});for(const n of e.edits){o||(o=new r.WorkspaceEdit,o.createFile(t,{ignoreIfExists:!0}));const e=i?new r.Range(i.positionAt(n.offset),i.positionAt(n.offset+n.length)):new r.Range(new r.Position(0,0),new r.Position(0,0));o.replace(t,e,n.replacement),s&&(yield r.workspace.applyEdit(o),o=void 0)}}if(o&&(yield r.workspace.applyEdit(o)),t.selection){const e=r.Uri.file(t.selection.file),i=yield r.workspace.openTextDocument(e),s=yield r.window.showTextDocument(i),n=i.positionAt(t.selection.offset),o=new r.Selection(n,n);s.selection=o}}))}applyEditsWithSnippets(e,t){return s(this,void 0,void 0,(function*(){const i=t.edits[0],s=yield r.workspace.openTextDocument(i.file),n=yield r.window.showTextDocument(s);yield n.edit(e=>{i.edits.forEach(t=>{e.replace(new r.Range(s.positionAt(t.offset),s.positionAt(t.offset+t.length)),t.replacement)})});const o=n.document.getText(),a=[];let c=1;t.linkedEditGroups.forEach(e=>{e.positions.forEach(t=>{const i=o.substr(t.offset,e.length);let s=e.suggestions?e.suggestions.map(e=>e.value):void 0;i&&s&&-1===s.indexOf(i)&&(s=[i,...s]),a.push({offset:t.offset,length:e.length,defaultValue:i,choices:s,placeholderNumber:c})}),c++}),a.sort((e,t)=>e.offset-t.offset);const l=new r.SnippetString,u=a[0],d=a[a.length-1],h=u.offset,p=d.offset+d.length;let g=h;a.forEach(e=>{g!==e.offset&&l.appendText(o.substring(g,e.offset)),e.choices&&e.choices.length>1?l.appendChoice(e.choices,e.placeholderNumber):l.appendPlaceholder(e.defaultValue,e.placeholderNumber),g=e.offset+e.length}),yield n.insertSnippet(l,new r.Range(s.positionAt(h),s.positionAt(p))),yield r.window.showTextDocument(e)}))}snippetStringEscape(e){return e.replace(/\$|}|\\|,/g,"\\$&")}},t.hasOverlappingEdits=c},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),o=i(21);t.RankingCodeActionProvider=class{constructor(){this.codeActionProviders=[]}registerProvider(e){this.codeActionProviders.push(e),o.sortBy(this.codeActionProviders,e=>e.rank)}get metadata(){const e=r.flatMap(this.codeActionProviders,e=>e.metadata.providedCodeActionKinds||[]);return{providedCodeActionKinds:r.uniq(e)}}provideCodeActions(e,t,i,o){return s(this,void 0,void 0,(function*(){const s=this.codeActionProviders.filter(t=>n.languages.match(t.selector,e)).map(s=>s.provideCodeActions(e,t,i,o)),a=yield Promise.all(s);return r.flatMap(a,e=>e||[])}))}},t.getKindFor=function(e,t){if(!e)return t;const i=e.replace("dart.assist.","").replace("dart.fix.","").replace("analysisOptions.assist.","").replace("analysisOptions.fix.","");return t.append(i)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(5),r=i(9);class o{constructor(e,t){this.analyzer=e,this.diagnostics=t,this.analyzer.registerForAnalysisErrors(e=>this.handleErrors(e)),this.analyzer.registerForAnalysisFlushResults(e=>this.flushResults(e))}handleErrors(e){const t=JSON.stringify(e);if(this.lastErrorJson===t)return;let i=e.errors;r.config.showTodos||(i=i.filter(e=>"TODO"!==e.type)),this.diagnostics.set(s.Uri.file(e.file),i.map(e=>o.createDiagnostic(e))),this.lastErrorJson=t}static createDiagnostic(e){const t=new a(n.toRangeOnLine(e.location),e.message,o.getSeverity(e.severity,e.type),e.type);return t.code=e.url?{value:e.code,target:s.Uri.parse(e.url)}:e.code,t.source="dart",t.tags=o.getTags(e),e.correction&&(t.message+="\n"+e.correction),e.contextMessages&&e.contextMessages.length&&(t.relatedInformation=e.contextMessages.map(o.createRelatedInformation)),t}static createRelatedInformation(e){return new s.DiagnosticRelatedInformation(new s.Location(s.Uri.file(e.location.file),n.toRangeOnLine(e.location)),e.message)}static getSeverity(e,t){switch(e){case"ERROR":return s.DiagnosticSeverity.Error;case"WARNING":return s.DiagnosticSeverity.Warning;case"INFO":switch(t){case"TODO":default:return s.DiagnosticSeverity.Information}default:throw new Error("Unknown severity type: "+e)}}static getTags(e){const t=[];return"dead_code"!==e.code&&"unused_local_variable"!==e.code&&"unused_import"!==e.code||t.push(s.DiagnosticTag.Unnecessary),"deprecated_member_use"!==e.code&&"deprecated_member_use_from_same_package"!==e.code||t.push(s.DiagnosticTag.Deprecated),t}flushResults(e){this.lastErrorJson=void 0;const t=e.files.map(e=>[s.Uri.file(e),void 0]);this.diagnostics.set(t)}}t.DartDiagnosticProvider=o;class a extends s.Diagnostic{constructor(e,t,i,s){super(e,t,i),this.type=s}}t.DartDiagnostic=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);class n{constructor(e){this.version=e}static get empty(){return new n("0.0.0")}get supportsPidFileForMachine(){return s.versionIsAtLeast(this.version,"0.10.0")}get supportsCreatingSamples(){return s.versionIsAtLeast(this.version,"1.0.0")}get supportsMultipleSamplesPerElement(){return s.versionIsAtLeast(this.version,"1.2.2")}get supportsDevTools(){return s.versionIsAtLeast(this.version,"1.1.0")}get hasTestGroupFix(){return s.versionIsAtLeast(this.version,"1.3.4")}get hasEvictBug(){return!s.versionIsAtLeast(this.version,"1.2.2")}get hasUpdatedStructuredErrorsFormat(){return s.versionIsAtLeast(this.version,"1.8.0")}get supportsFlutterCreateListSamples(){return s.versionIsAtLeast(this.version,"1.3.10")}get supportsWsVmService(){return s.versionIsAtLeast(this.version,"1.18.0-5")}get supportsExposeUrl(){return s.versionIsAtLeast(this.version,"1.18.0-5")}get webSupportsDebugging(){return!1}}t.FlutterCapabilities=n;class r{constructor(e){this.version=e}static get empty(){return new r("0.0.0")}get canCreateEmulators(){return s.versionIsAtLeast(this.version,"0.4.0")}get canFlutterAttach(){return s.versionIsAtLeast(this.version,"0.4.1")}get providesPlatformTypes(){return s.versionIsAtLeast(this.version,"0.5.2")}}t.DaemonCapabilities=r},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>0!==s(e,t,i)},function(e,t,i){const s=i(54),n=i(79),r=i(40),o=i(57),a=i(56),c=i(58);e.exports=(e,t,i,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return s(e,i,l);case"!=":return n(e,i,l);case">":return r(e,i,l);case">=":return o(e,i,l);case"<":return a(e,i,l);case"<=":return c(e,i,l);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3),n=new RegExp(`(?:${s.escapeRegExp("<p>")})?`+s.escapeRegExp('<i class="material-icons md-36">')+"([\\w\\s_]+)"+s.escapeRegExp('</i> &#x2014; material icon named "')+"([\\w\\s_]+)"+s.escapeRegExp('".')+`(?:${s.escapeRegExp("</p>")})?`,"gi"),r=new RegExp("(\\n\\s*{@.*?}$)|(^{@.*?}\\s*\\n)|(^{@.*?}$)","gim"),o=new RegExp("(```\\w+) +\\w+","gi");t.cleanDartdoc=function(e,t){if(!e)return"";const i=e.indexOf("## Other resources");return-1!==i&&(e=e.substring(0,i)),e=(e=(e=(e=e.replace(/\[:\S+:\]/g,e=>`[${e.substring(2,e.length-2)}]`)).replace(n,`![$1](${t}|width=32,height=32)`)).replace(r,"")).replace(o,"$1")},t.stripMarkdown=function(e){return e?e=(e=e.replace(/\[(.+?)\]\(.+?\)/g,"$1")).replace(/\[(.+?)\]/g,"$1"):""}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(18),r=i(2),o=i(0),a=i(4),c=i(1),l=i(83);t.createFlutterSampleInTempFolder=function(e,t,i){if(!e.supportsCreatingSamples)return void o.window.showErrorMessage("Opening sample projects requires Flutter v1.0 or later");const u=r.join(n.tmpdir(),a.dartCodeExtensionIdentifier,"flutter","sample",t,c.getRandomInt(4096,65536).toString(16));c.mkDirRecursive(u),s.writeFileSync(r.join(u,a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),t),i&&l.writeFlutterSdkSettingIntoProject(i,u);const d=!(!o.workspace.workspaceFolders||!o.workspace.workspaceFolders.length),h=o.Uri.file(u);return o.commands.executeCommand("vscode.openFolder",h,d),h}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2);function r(e,t){const i=n.join(e,".vscode"),r=n.join(i,"settings.json");s.existsSync(i)||s.mkdirSync(i),s.existsSync(r)||s.writeFileSync(r,JSON.stringify(t,void 0,4))}t.writeDartSdkSettingIntoProject=function(e,t){r(t,{"dart.sdkPath":e})},t.writeFlutterSdkSettingIntoProject=function(e,t){r(t,{"dart.flutterSdkPath":e})},t.writeSettingIntoProject=r},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(85),r=i(3),o=i(25);t.Analyzer=class{constructor(e){this.logger=e,this.disposables=[],this.onReadyCompleter=new r.PromiseCompleter,this.onReady=this.onReadyCompleter.promise,this.onAnalysisCompleteCompleter=new r.PromiseCompleter,this.onInitialAnalysis=this.onAnalysisCompleteCompleter.promise,this.onAnalysisStatusChangeEmitter=new n.EventEmitter,this.onAnalysisStatusChange=this.onAnalysisStatusChangeEmitter.event,this.isAnalyzing=!1,this.disposables.push(this.onAnalysisStatusChangeEmitter),this.setup()}get onCurrentAnalysisComplete(){return this.isAnalyzing?this.onAnalysisCompleteCompleter.promise:o.resolvedPromise}get onNextAnalysisComplete(){return this.onAnalysisCompleteCompleter.promise}setup(){return s(this,void 0,void 0,(function*(){yield this.onReady,this.onAnalysisStatusChange.listen(e=>{this.isAnalyzing=e.isAnalyzing,e.isAnalyzing||(this.onAnalysisCompleteCompleter.resolve(),this.onAnalysisCompleteCompleter=new r.PromiseCompleter)})}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(29);t.EventEmitter=class{constructor(){this.emitter=new s.EventEmitter}fire(e){this.emitter.emit("thing",e)}listen(e){return this.emitter.on("thing",e),{dispose:()=>{this.emitter.removeListener("thing",e)}}}get event(){return this}dispose(){this.emitter.removeAllListeners()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nullToUndefined=function(e){return null===e?void 0:e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(0),o=i(4),a=i(14),c=i(5),l=i(9);t.getAnalyzerArgs=function(e,t,i,u){const d=l.config.analyzerPath||n.join(t.dart,o.analyzerSnapshotPath);if(!l.config.analyzerSshHost&&!s.existsSync(d)){const t="Could not find a Dart Analysis Server at "+d;throw r.window.showErrorMessage(t),e.error(t),new Error(t)}return function(e,t,i){let s=[];l.config.analyzerObservatoryPort&&s.push("--enable-vm-service="+l.config.analyzerObservatoryPort);s.push(e),i&&s.push("--lsp");l.config.analyzerDiagnosticsPort&&s.push("--port="+l.config.analyzerDiagnosticsPort);const n=c.isRunningLocally?"VS-Code":"VS-Code-Remote";s.push("--client-id="+n),s.push("--client-version="+a.extensionVersion),l.config.analyzerInstrumentationLogFile&&s.push("--instrumentation-log-file="+l.config.analyzerInstrumentationLogFile);l.config.analyzerAdditionalArgs&&(s=s.concat(l.config.analyzerAdditionalArgs));return s}(d,0,u)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);class n extends s.CompletionItem{constructor(e){super(e)}}t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);class n extends s.CodeLens{constructor(e){super(e)}}t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);class n extends s.DocumentLink{constructor(e,t){super(e,t)}}t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class n extends s{constructor(){super([n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-","4",n._randomHex(),n._randomHex(),n._randomHex(),"-",n._oneOf(n._timeHighBits),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return n._oneOf(n._chars)}}function r(){return new n}n._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],n._timeHighBits=["8","9","a","b"],t.empty=new s("00000000-0000-0000-0000-000000000000"),t.v4=r;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return o.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new s(e)},t.generateUuid=function(){return r().asHex()}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(35);t.ProgressPart=class{constructor(e,t){this._client=e,this._token=t,this._reported=0,this._disposable=this._client.onProgress(n.WorkDoneProgress.type,this._token,e=>{switch(e.kind){case"begin":this.begin(e);break;case"report":this.report(e);break;case"end":this.done()}})}begin(e){let t=e.cancellable?s.ProgressLocation.Notification:s.ProgressLocation.Window;s.window.withProgress({location:t,cancellable:e.cancellable,title:e.title},async(t,i)=>(this._progress=t,this._infinite=void 0===e.percentage,this._cancellationToken=i,this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(n.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((e,t)=>{this._resolve=e,this._reject=t})))}report(e){if(this._infinite&&r.string(e.message))this._progress.report({message:e.message});else if(r.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),i=Math.max(0,t-this._reported);this._progress.report({message:e.message,increment:i}),this._reported+=i}}cancel(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.element&&e.element.kind){case"CLASS":this.visitClass(e);break;case"CLASS_TYPE_ALIAS":this.visitClassTypeAlias(e);break;case"COMPILATION_UNIT":this.visitCompilationUnit(e);break;case"CONSTRUCTOR":this.visitConstructor(e);break;case"CONSTRUCTOR_INVOCATION":this.visitContructorInvocation(e);break;case"ENUM":this.visitEnum(e);break;case"ENUM_CONSTANT":this.visitEnumConstant(e);break;case"FIELD":this.visitField(e);break;case"FILE":this.visitXXX(e);break;case"FUNCTION":this.visitFile(e);break;case"FUNCTION_INVOCATION":this.visitFunctionInvocation(e);break;case"FUNCTION_TYPE_ALIAS":this.visitFunctionTypeAlias(e);break;case"GETTER":this.visitGetter(e);break;case"LABEL":this.visitLabel(e);break;case"LIBRARY":this.visitLibrary(e);break;case"LOCAL_VARIABLE":this.visitLocalVariable(e);break;case"METHOD":this.visitMethod(e);break;case"PARAMETER":this.visitParameter(e);break;case"PREFIX":this.visitPrefix(e);break;case"SETTER":this.visitSetter(e);break;case"TOP_LEVEL_VARIABLE":this.visitTopLevelVariable(e);break;case"TYPE_PARAMETER":this.visitTypeParameter(e);break;case"UNIT_TEST_GROUP":this.visitUnitTestGroup(e);break;case"UNIT_TEST_TEST":this.visitUnitTestTest(e);break;case"UNKNOWN":this.visitUnknown(e);break;default:this.logger.error("Unknown Outline item! "+(e&&e.element&&e.element.kind))}}visitClass(e){this.visitChildren(e)}visitClassTypeAlias(e){this.visitChildren(e)}visitCompilationUnit(e){this.visitChildren(e)}visitConstructor(e){this.visitChildren(e)}visitContructorInvocation(e){this.visitChildren(e)}visitEnum(e){this.visitChildren(e)}visitEnumConstant(e){this.visitChildren(e)}visitField(e){this.visitChildren(e)}visitXXX(e){this.visitChildren(e)}visitFile(e){this.visitChildren(e)}visitFunctionInvocation(e){this.visitChildren(e)}visitFunctionTypeAlias(e){this.visitChildren(e)}visitGetter(e){this.visitChildren(e)}visitLabel(e){this.visitChildren(e)}visitLibrary(e){this.visitChildren(e)}visitLocalVariable(e){this.visitChildren(e)}visitMethod(e){this.visitChildren(e)}visitParameter(e){this.visitChildren(e)}visitPrefix(e){this.visitChildren(e)}visitSetter(e){this.visitChildren(e)}visitTopLevelVariable(e){this.visitChildren(e)}visitTypeParameter(e){this.visitChildren(e)}visitUnitTestGroup(e){this.visitChildren(e)}visitUnitTestTest(e){this.visitChildren(e)}visitUnknown(e){this.visitChildren(e)}}t.LspOutlineVisitor=s;t.LspTestOutlineVisitor=class extends s{constructor(e,t){super(e),this.file=t,this.tests=[],this.names=[]}visitUnitTestTest(e){this.addTest(e,super.visitUnitTestTest)}visitUnitTestGroup(e){this.addTest(e,super.visitUnitTestGroup)}addTest(e,t){const i=this.extractTestName(e.element.name);if(!i||!e.element.range)return;this.names.push(i);const s=this.names.join(" "),n="UNIT_TEST_GROUP"===e.element.kind;this.tests.push({file:this.file,fullName:s,isGroup:n,range:e.codeRange||e.range||(e.element?e.element.range:void 0)});try{t.bind(this)(e)}finally{this.names.pop()}}extractTestName(e){if(!e)return;const t=e.indexOf("("),i=e.lastIndexOf(")");return-1===t||-1===i||t>=i?void 0:e=e.substring(t+2,i-1)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(18),o=i(2),a=i(0),c=i(4);t.showFlutterSurveyNotificationIfAppropriate=function(e,t,i,l,u){return s(this,void 0,void 0,(function*(){let d;try{const e=yield t.fetch(c.flutterSurveyDataUrl),i=JSON.parse(e);if(d=Object.assign(Object.assign({},i),{endDate:new Date(i.endDate).getTime(),startDate:new Date(i.startDate).getTime()}),!d.uniqueId||!d.title||!d.url)throw new Error("Survey data did not include ID, Title or URL:\n"+e)}catch(e){return u.error(e),!1}if(l<=d.startDate||l>=d.endDate)return!1;const h=e.getFlutterSurveyNotificationLastShown(d.uniqueId);if(e.getFlutterSurveyNotificationDoNotShow(d.uniqueId))return!1;if(h&&l-h<c.longRepeatPromptThreshold)return!1;let p;try{const e=c.isWin&&process.env.APPDATA||r.homedir(),t=o.join(e,".flutter");if(n.existsSync(t)){const e=n.readFileSync(t).toString(),i=JSON.parse(e);!1!==i.enabled&&(p=i.clientId)}}catch(e){u.warn("Unable to read Flutter settings for preparing survey link")}const g=p?`${d.title} ${c.flutterSurveyAnalyticsText}`:d.title,f=-1!==d.url.indexOf("?")?"&":"?",m=`${d.url}${f}Source=VSCode${p?"&ClientID="+encodeURIComponent(p):""}`;return e.setFlutterSurveyNotificationLastShown(d.uniqueId,Date.now()),a.window.showInformationMessage(g,c.takeSurveyAction,c.skipThisSurveyAction).then(t=>s(this,void 0,void 0,(function*(){t===c.skipThisSurveyAction?e.setFlutterSurveyNotificationDoNotShow(d.uniqueId,!0):t===c.takeSurveyAction&&(e.setFlutterSurveyNotificationDoNotShow(d.uniqueId,!0),yield i(m))}))),!0}))},t.showDevToolsNotificationIfAppropriate=function(e){return s(this,void 0,void 0,(function*(){const t=e.devToolsNotificationLastShown;if(e.devToolsNotificationDoNotShow)return{didOpen:!1};if(t&&Date.now()-t<c.noRepeatPromptThreshold)return{didOpen:!1};e.devToolsNotificationLastShown=Date.now();const i=yield a.window.showInformationMessage(c.wantToTryDevToolsPrompt,c.openDevToolsAction,c.alwaysOpenAction,c.notTodayAction,c.doNotAskAgainAction);return i===c.doNotAskAgainAction?(e.devToolsNotificationDoNotShow=!0,{didOpen:!1}):i===c.alwaysOpenAction?(a.commands.executeCommand("dart.openDevTools"),{didOpen:!0,shouldAlwaysOpen:!0}):i===c.openDevToolsAction?(a.commands.executeCommand("dart.openDevTools"),{didOpen:!0}):{didOpen:!1}}))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(201),a=i(72);var c;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(c=t.LogLevel||(t.LogLevel={}));class l{constructor(){this._pendingLogQ=[]}log(e,t=c.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,c.Verbose)}warn(e){this.log(e,c.Warn)}error(e){this.log(e,c.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=c.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,i=!0){const s="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:s,prependTimestamp:i};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,i){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new u(e,i),this._logFilePathFromInit=t}}t.Logger=l,t.logger=new l;class u{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=c.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return s(this,void 0,void 0,(function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(r.isAbsolute(e.logFilePath)){const i=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,c.Error);try{yield(t=r.dirname(e.logFilePath),new Promise((e,i)=>{o(t,t=>{t?i(t):e()})})),this.log("Verbose logs are written to:\n",c.Warn),this.log(e.logFilePath+"\n",c.Warn),this._logFileStream=n.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{i(e)})}catch(e){i(e)}}else this.log("logFilePath must be an absolute path: "+e.logFilePath,c.Error);var t}))}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+", "+p();this.log(t+"\n",c.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,i=!0){if(this._minLogLevel!==c.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const i=t===c.Error?console.error:t===c.Warn?console.warn:null;i&&i(h(e))}t===c.Error&&(e=`[${c[t]}] ${e}`),this._prependTimestamp&&i&&(e="["+p()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const i=new d(e,t);this._logCallback(i)}}}class d extends a.OutputEvent{constructor(e,t){super(e,t===c.Error?"stderr":t===c.Warn?"console":"stdout")}}function h(e){return e.replace(/(\n|\r\n)$/,"")}function p(){let e=new Date;return g(2,String(e.getUTCHours()))+":"+g(2,String(e.getUTCMinutes()))+":"+g(2,String(e.getUTCSeconds()))+"."+g(3,String(e.getUTCMilliseconds()))+" UTC"}function g(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=d,t.trimLastNewline=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=(...e)=>`[${e.join(";")}m`;t.black=e=>`${s("38;5",0)}${e}${s("39;49")}`,t.red=e=>`${s("38;5",1)}${e}${s("39;49")}`,t.green=e=>`${s("38;5",2)}${e}${s("39;49")}`,t.yellow=e=>`${s("38;5",3)}${e}${s("39;49")}`,t.blue=e=>`${s("38;5",4)}${e}${s("39;49")}`,t.magenta=e=>`${s("38;5",5)}${e}${s("39;49")}`,t.cyan=e=>`${s("38;5",6)}${e}${s("39;49")}`,t.white=e=>`${s("38;5",7)}${e}${s("39;49")}`,t.grey=e=>`${s("38;5",244)}${e}${s("39;49")}`,t.grey2=e=>`${s("38;5",248)}${e}${s("39;49")}`,t.brightBlack=e=>`${s("38;5",8)}${e}${s("39;49")}`,t.brightRed=e=>`${s("38;5",9)}${e}${s("39;49")}`,t.brightGreen=e=>`${s("38;5",10)}${e}${s("39;49")}`,t.brightYellow=e=>`${s("38;5",11)}${e}${s("39;49")}`,t.brightBlue=e=>`${s("38;5",12)}${e}${s("39;49")}`,t.brightMagenta=e=>`${s("38;5",13)}${e}${s("39;49")}`,t.brightCyan=e=>`${s("38;5",14)}${e}${s("39;49")}`,t.brightWhite=e=>`${s("38;5",15)}${e}${s("39;49")}`,t.blackBackground=e=>`${s("48;5",8)}${e}${s("39;49")}`,t.redBackground=e=>`${s("48;5",1)}${e}${s("39;49")}`,t.greenBackground=e=>`${s("48;5",2)}${e}${s("39;49")}`,t.yellowBackground=e=>`${s("48;5",3)}${e}${s("39;49")}`,t.blueBackground=e=>`${s("48;5",4)}${e}${s("39;49")}`,t.magentaBackground=e=>`${s("48;5",5)}${e}${s("39;49")}`,t.cyanBackground=e=>`${s("48;5",6)}${e}${s("39;49")}`,t.whiteBackground=e=>`${s("48;5",7)}${e}${s("39;49")}`,t.brightBlackBackground=e=>`${s("48;5",8)}${e}${s("39;49")}`,t.brightRedBackground=e=>`${s("48;5",9)}${e}${s("39;49")}`,t.brightGreenBackground=e=>`${s("48;5",10)}${e}${s("39;49")}`,t.brightYellowBackground=e=>`${s("48;5",11)}${e}${s("39;49")}`,t.brightBlueBackground=e=>`${s("48;5",12)}${e}${s("39;49")}`,t.brightMagentaBackground=e=>`${s("48;5",13)}${e}${s("39;49")}`,t.brightCyanBackground=e=>`${s("48;5",14)}${e}${s("39;49")}`,t.brightWhiteBackground=e=>`${s("48;5",15)}${e}${s("39;49")}`;const n=new RegExp("^(\\s*)(\\S.*\\S)(\\s*)$");t.applyColor=function(e,t){const i=e&&n.exec(e);return i?`${i[1]}${t(i[2])}${i[3]}`:t(e)}},function(e,t,i){"use strict";const s=i(29),n=i(27),r=i(60),o=i(34),a=i(206),{randomBytes:c,createHash:l}=i(46),{URL:u}=i(28),d=i(48),h=i(98),p=i(100),{BINARY_TYPES:g,EMPTY_BUFFER:f,GUID:m,kStatusCode:v,kWebSocket:y,NOOP:b}=i(26),{addEventListener:w,removeEventListener:S}=i(209),{format:C,parse:T}=i(101),{toBuffer:E}=i(49),R=["CONNECTING","OPEN","CLOSING","CLOSED"],P=[8,13];class D extends s{constructor(e,t,i){super(),this.readyState=D.CONNECTING,this.protocol="",this._binaryType=g[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(i=t,t=void 0),function e(t,i,s,o){const a={protocolVersion:P[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!P.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} (supported versions: ${P.join(", ")})`);let h;i instanceof u?(h=i,t.url=i.href):(h=new u(i),t.url=i);const p="ws+unix:"===h.protocol;if(!(h.host||p&&h.pathname))throw new Error("Invalid URL: "+t.url);const g="wss:"===h.protocol||"https:"===h.protocol,f=g?443:80,v=c(16).toString("base64"),y=g?n.get:r.get;let b;a.createConnection=g?k:_,a.defaultPort=a.defaultPort||f,a.port=h.port||f,a.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,a.headers={"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket",...a.headers},a.path=h.pathname+h.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(b=new d(!0!==a.perMessageDeflate?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=C({[d.extensionName]:b.offer()}));s&&(a.headers["Sec-WebSocket-Protocol"]=s);a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin);(h.username||h.password)&&(a.auth=`${h.username}:${h.password}`);if(p){const e=a.path.split(":");a.socketPath=e[0],a.path=e[1]}let w=t._req=y(a);a.timeout&&w.on("timeout",()=>{x(t,w,"Opening handshake has timed out")});w.on("error",e=>{t._req.aborted||(w=t._req=null,t.readyState=D.CLOSING,t.emit("error",e),t.emitClose())}),w.on("response",n=>{const r=n.headers.location,c=n.statusCode;if(r&&a.followRedirects&&c>=300&&c<400){if(++t._redirects>a.maxRedirects)return void x(t,w,"Maximum redirects exceeded");w.abort();const n=new u(r,i);e(t,n,s,o)}else t.emit("unexpected-response",w,n)||x(t,w,"Unexpected server response: "+n.statusCode)}),w.on("upgrade",(e,i,n)=>{if(t.emit("upgrade",e),t.readyState!==D.CONNECTING)return;w=t._req=null;const r=l("sha1").update(v+m).digest("base64");if(e.headers["sec-websocket-accept"]!==r)return void x(t,i,"Invalid Sec-WebSocket-Accept header");const o=e.headers["sec-websocket-protocol"],c=(s||"").split(/, */);let u;if(!s&&o?u="Server sent a subprotocol but none was requested":s&&!o?u="Server sent no subprotocol":o&&!c.includes(o)&&(u="Server sent an invalid subprotocol"),u)x(t,i,u);else{if(o&&(t.protocol=o),b)try{const i=T(e.headers["sec-websocket-extensions"]);i[d.extensionName]&&(b.accept(i[d.extensionName]),t._extensions[d.extensionName]=b)}catch(e){return void x(t,i,"Invalid Sec-WebSocket-Extensions header")}t.setSocket(i,n,a.maxPayload)}})}(this,e,t,i)):this._isServer=!0}get CONNECTING(){return D.CONNECTING}get CLOSING(){return D.CLOSING}get CLOSED(){return D.CLOSED}get OPEN(){return D.OPEN}get binaryType(){return this._binaryType}set binaryType(e){g.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,i){const s=new h(this._binaryType,this._extensions,this._isServer,i);this._sender=new p(e,this._extensions),this._receiver=s,this._socket=e,s[y]=this,e[y]=this,s.on("conclude",F),s.on("drain",I),s.on("error",L),s.on("message",N),s.on("ping",M),s.on("pong",U),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",q),e.on("data",$),e.on("end",j),e.on("error",W),this.readyState=D.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this.readyState=D.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this.readyState=D.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING){const e="WebSocket was closed before the connection was established";return x(this,this._req,e)}this.readyState!==D.CLOSING?(this.readyState=D.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._closeFrameReceived&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,i){if(this.readyState===D.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===D.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||f,t,i)):O(this,e,i)}pong(e,t,i){if(this.readyState===D.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===D.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||f,t,i)):O(this,e,i)}send(e,t,i){if(this.readyState===D.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(i=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==D.OPEN)return void O(this,e,i);const s={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[d.extensionName]||(s.compress=!1),this._sender.send(e||f,s,i)}terminate(){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING){const e="WebSocket was closed before the connection was established";return x(this,this._req,e)}this._socket&&(this.readyState=D.CLOSING,this._socket.destroy())}}}function _(e){return e.path=e.socketPath,o.connect(e)}function k(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=e.host),a.connect(e)}function x(e,t,i){e.readyState=D.CLOSING;const s=new Error(i);Error.captureStackTrace(s,x),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",s)):(t.destroy(s),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function O(e,t,i){if(t){const i=E(t).length;e._socket?e._sender._bufferedBytes+=i:e._bufferedAmount+=i}if(i){i(new Error(`WebSocket is not open: readyState ${e.readyState} (${R[e.readyState]})`))}}function F(e,t){const i=this[y];i._socket.removeListener("data",$),i._socket.resume(),i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=e,1005===e?i.close():i.close(e,t)}function I(){this[y]._socket.resume()}function L(e){const t=this[y];t._socket.removeListener("data",$),t.readyState=D.CLOSING,t._closeCode=e[v],t.emit("error",e),t._socket.destroy()}function A(){this[y].emitClose()}function N(e){this[y].emit("message",e)}function M(e){const t=this[y];t.pong(e,!t._isServer,b),t.emit("ping",e)}function U(e){this[y].emit("pong",e)}function q(){const e=this[y];this.removeListener("close",q),this.removeListener("end",j),e.readyState=D.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",$),this[y]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",A),e._receiver.on("finish",A))}function $(e){this[y]._receiver.write(e)||this.pause()}function j(){const e=this[y];e.readyState=D.CLOSING,e._receiver.end(),this.end()}function W(){const e=this[y];this.removeListener("error",W),this.on("error",b),e&&(e.readyState=D.CLOSING,this.destroy())}R.forEach((e,t)=>{D[e]=t}),["open","error","close","message"].forEach(e=>{Object.defineProperty(D.prototype,"on"+e,{get(){const t=this.listeners(e);for(let e=0;e<t.length;e++)if(t[e]._listener)return t[e]._listener},set(t){const i=this.listeners(e);for(let t=0;t<i.length;t++)i[t]._listener&&this.removeListener(e,i[t]);this.addEventListener(e,t)}})}),D.prototype.addEventListener=w,D.prototype.removeEventListener=S,e.exports=D},function(e,t,i){"use strict";const{Writable:s}=i(63),n=i(48),{BINARY_TYPES:r,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:c}=i(26),{concat:l,toArrayBuffer:u,unmask:d}=i(49),{isValidStatusCode:h,isValidUTF8:p}=i(99);function g(e,t,i,s){const n=new e(i?"Invalid WebSocket frame: "+t:t);return Error.captureStackTrace(n,g),n[a]=s,n}e.exports=class extends s{constructor(e,t,i,s){super(),this._binaryType=e||r[0],this[c]=void 0,this._extensions=t||{},this._isServer=!!i,this._maxPayload=0|s,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,i){if(8===this._opcode&&0==this._state)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const i=this._buffers[0],s=t.length-e;e>=i.length?t.set(this._buffers.shift(),s):(t.set(new Uint8Array(i.buffer,i.byteOffset,e),s),this._buffers[0]=i.slice(e)),e-=i.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,g(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[n.extensionName])return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,g(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,g(RangeError,"invalid opcode "+this._opcode,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,g(RangeError,"invalid opcode "+this._opcode,!0,1002);if(!this._fin)return this._loop=!1,g(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,g(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,g(RangeError,"invalid payload length "+this._payloadLength,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,g(RangeError,"MASK must be set",!0,1002)}else if(this._masked)return this._loop=!1,g(RangeError,"MASK must be clear",!0,1002);if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,g(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,g(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&d(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[n.extensionName].decompress(e,this._fin,(e,i)=>{if(e)return t(e);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(g(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(i)}const s=this.dataMessage();if(s)return t(s);this.startLoop(t)})}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let i;i="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?u(l(t,e)):t,this.emit("message",i)}else{const i=l(t,e);if(!p(i))return this._loop=!1,g(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",i.toString())}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return g(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!h(t))return g(RangeError,"invalid status code "+t,!0,1002);const i=e.slice(2);if(!p(i))return g(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,i.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},function(e,t,i){"use strict";try{const e=i(!function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=()=>!0}t.isValidStatusCode=e=>e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},function(e,t,i){"use strict";const{randomFillSync:s}=i(46),n=i(48),{EMPTY_BUFFER:r}=i(26),{isValidStatusCode:o}=i(99),{mask:a,toBuffer:c}=i(49),l=Buffer.alloc(4);class u{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const i=t.mask&&t.readOnly;let n=t.mask?6:2,r=e.length;e.length>=65536?(n+=8,r=127):e.length>125&&(n+=2,r=126);const o=Buffer.allocUnsafe(i?e.length+n:n);return o[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(o[0]|=64),o[1]=r,126===r?o.writeUInt16BE(e.length,2):127===r&&(o.writeUInt32BE(0,2),o.writeUInt32BE(e.length,6)),t.mask?(s(l,0,4),o[1]|=128,o[n-4]=l[0],o[n-3]=l[1],o[n-2]=l[2],o[n-1]=l[3],i?(a(e,l,o,n,e.length),[o]):(a(e,l,e,0,e.length),[o,e])):[o,e]}close(e,t,i,s){let n;if(void 0===e)n=r;else{if("number"!=typeof e||!o(e))throw new TypeError("First argument must be a valid error code number");if(void 0===t||""===t)n=Buffer.allocUnsafe(2),n.writeUInt16BE(e,0);else{const i=Buffer.byteLength(t);if(i>123)throw new RangeError("The message must not be greater than 123 bytes");n=Buffer.allocUnsafe(2+i),n.writeUInt16BE(e,0),n.write(t,2)}}this._deflating?this.enqueue([this.doClose,n,i,s]):this.doClose(n,i,s)}doClose(e,t,i){this.sendFrame(u.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),i)}ping(e,t,i){const s=c(e);if(s.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,s,t,c.readOnly,i]):this.doPing(s,t,c.readOnly,i)}doPing(e,t,i,s){this.sendFrame(u.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:i}),s)}pong(e,t,i){const s=c(e);if(s.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,s,t,c.readOnly,i]):this.doPong(s,t,c.readOnly,i)}doPong(e,t,i,s){this.sendFrame(u.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:i}),s)}send(e,t,i){const s=c(e),r=this._extensions[n.extensionName];let o=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&r&&(a=s.length>=r._threshold),this._compress=a):(a=!1,o=0),t.fin&&(this._firstFragment=!0),r){const e={fin:t.fin,rsv1:a,opcode:o,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,s,this._compress,e,i]):this.dispatch(s,this._compress,e,i)}else this.sendFrame(u.frame(s,{fin:t.fin,rsv1:!1,opcode:o,mask:t.mask,readOnly:c.readOnly}),i)}dispatch(e,t,i,s){if(!t)return void this.sendFrame(u.frame(e,i),s);const r=this._extensions[n.extensionName];this._deflating=!0,r.compress(e,i.fin,(e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof s&&s(e);for(let t=0;t<this._queue.length;t++){const i=this._queue[t][4];"function"==typeof i&&i(e)}}else this._deflating=!1,i.readOnly=!1,this.sendFrame(u.frame(t,i),s),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=u},function(e,t,i){"use strict";const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function n(e,t,i){void 0===e[t]?e[t]=[i]:e[t].push(i)}e.exports={format:function(e){return Object.keys(e).map(t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map(e=>[t].concat(Object.keys(e).map(t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){const t=Object.create(null);if(void 0===e||""===e)return t;let i,r,o=Object.create(null),a=!1,c=!1,l=!1,u=-1,d=-1,h=0;for(;h<e.length;h++){const p=e.charCodeAt(h);if(void 0===i)if(-1===d&&1===s[p])-1===u&&(u=h);else if(32===p||9===p)-1===d&&-1!==u&&(d=h);else{if(59!==p&&44!==p)throw new SyntaxError("Unexpected character at index "+h);{if(-1===u)throw new SyntaxError("Unexpected character at index "+h);-1===d&&(d=h);const s=e.slice(u,d);44===p?(n(t,s,o),o=Object.create(null)):i=s,u=d=-1}}else if(void 0===r)if(-1===d&&1===s[p])-1===u&&(u=h);else if(32===p||9===p)-1===d&&-1!==u&&(d=h);else if(59===p||44===p){if(-1===u)throw new SyntaxError("Unexpected character at index "+h);-1===d&&(d=h),n(o,e.slice(u,d),!0),44===p&&(n(t,i,o),o=Object.create(null),i=void 0),u=d=-1}else{if(61!==p||-1===u||-1!==d)throw new SyntaxError("Unexpected character at index "+h);r=e.slice(u,h),u=d=-1}else if(c){if(1!==s[p])throw new SyntaxError("Unexpected character at index "+h);-1===u?u=h:a||(a=!0),c=!1}else if(l)if(1===s[p])-1===u&&(u=h);else if(34===p&&-1!==u)l=!1,d=h;else{if(92!==p)throw new SyntaxError("Unexpected character at index "+h);c=!0}else if(34===p&&61===e.charCodeAt(h-1))l=!0;else if(-1===d&&1===s[p])-1===u&&(u=h);else if(-1===u||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError("Unexpected character at index "+h);{if(-1===u)throw new SyntaxError("Unexpected character at index "+h);-1===d&&(d=h);let s=e.slice(u,d);a&&(s=s.replace(/\\/g,""),a=!1),n(o,r,s),44===p&&(n(t,i,o),o=Object.create(null),i=void 0),r=void 0,u=d=-1}}else-1===d&&(d=h)}if(-1===u||l)throw new SyntaxError("Unexpected end of input");-1===d&&(d=h);const p=e.slice(u,d);return void 0===i?n(t,p,o):(void 0===r?n(o,p,!0):n(o,r,a?p.replace(/\\/g,""):p),n(t,i,o)),t}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(36),r=i(4),o=i(8),a=i(216),c=i(96),l=i(71),u=i(217),d=i(50),h=i(51);class p extends l.DartDebugSession{constructor(){super(),this.flutterTrackWidgetCreation=!1,this.appHasStarted=!1,this.appHasBeenToldToStopOrDetach=!1,this.isReloadInProgress=!1,this.outputCategory="stdout",this.sendStdOutToConsole=!1,this.allowWriteServiceInfo=!1,this.parseObservatoryUriFromStdOut=!1,this.requiresProgram=!1,this.logCategory=o.LogCategory.FlutterRun,this.connectVmEvenForNoDebug=!0}initializeRequest(e,t){e.body=e.body||{},e.body.supportsRestartRequest=!0,super.initializeRequest(e,t)}launchRequest(e,t){const i=Object.create(null,{launchRequest:{get:()=>super.launchRequest}});return s(this,void 0,void 0,(function*(){return this.flutterTrackWidgetCreation=t&&t.flutterTrackWidgetCreation,this.outputCategory="stdout",i.launchRequest.call(this,e,t)}))}attachRequest(e,t){return s(this,void 0,void 0,(function*(){return this.launchRequest(e,t)}))}spawnProcess(e){const t="attach"===e.request;t?this.sendEvent(new n.Event("dart.launching",{message:"Waiting for Application to connect...",finished:!1})):this.sendEvent(new n.Event("dart.launching",{message:"Launching...",finished:!1})),e.showMemoryUsage&&(this.pollforMemoryMs=1e3),this.allowTerminatingObservatoryVmPid="flutter-tester"===e.deviceId&&!t;const i=new d.DebugAdapterLogger(this,this.logCategory);return this.expectAdditionalPidToTerminate=!0,this.runDaemon=this.spawnRunDaemon(t,e,i),this.runDaemon.registerForUnhandledMessages(e=>this.handleLogOutput(e)),this.runDaemon.registerForDaemonConnect(e=>this.recordAdditionalPid(e.pid)),this.runDaemon.registerForAppStart(e=>this.currentRunningAppId=e.appId),this.runDaemon.registerForAppDebugPort(e=>s(this,void 0,void 0,(function*(){this.observatoryUri=e.wsUri,yield this.connectToObservatoryIfReady()}))),this.runDaemon.registerForAppStarted(e=>s(this,void 0,void 0,(function*(){this.appHasStarted=!0,yield this.connectToObservatoryIfReady(),this.sendEvent(new n.Event("dart.launched"))}))),this.runDaemon.registerForAppStop(e=>{this.currentRunningAppId=void 0,this.runDaemon&&(this.runDaemon.dispose(),this.runDaemon=void 0)}),this.runDaemon.registerForAppProgress(e=>this.sendEvent(new n.Event("dart.progress",{message:e.message,finished:e.finished,progressID:e.progressId||e.id}))),this.runDaemon.registerForAppWebLaunchUrl(e=>this.sendEvent(new n.Event("dart.webLaunchUrl",{url:e.url,launched:e.launched}))),this.runDaemon.registerForError(e=>this.sendEvent(new n.OutputEvent(e+"\n","stderr"))),this.runDaemon.registerForDaemonLog(e=>this.handleLogOutput(e.log,e.error)),this.runDaemon.registerForAppLog(e=>this.handleLogOutput(e.log,e.error)),this.runDaemon.process}handleLogOutput(e,t=!1){-1!==(e=e.trimRight()+"\n").indexOf("══╡ EXCEPTION CAUGHT BY")?(this.outputCategory="stderr",this.logToUser(e,this.outputCategory)):-1!==e.indexOf("══════════════════════════════════════════")?(this.logToUser(e,this.outputCategory),this.outputCategory="stdout"):this.logToUser(e,t?"stderr":this.outputCategory)}spawnRunDaemon(e,t,i){let s=[];if(e&&!t.program||(s.push("--target"),s.push(this.sourceFileForArgs(t))),t.deviceId&&(s.push("-d"),s.push(t.deviceId)),e){const e=t;e.observatoryUri&&(s.push("--debug-uri"),s.push(e.observatoryUri))}return e||("profile"===t.flutterMode?s.push("--profile"):"release"===t.flutterMode?s.push("--release"):this.flutterTrackWidgetCreation?s.push("--track-widget-creation"):s.push("--no-track-widget-creation"),t.flutterPlatform&&"default"!==t.flutterPlatform&&s.push("--target-platform="+t.flutterPlatform),this.shouldConnectDebugger&&(s.push("--start-paused"),t.vmServicePort&&-1===s.indexOf("--observatory-port")&&(s.push("--observatory-port"),s.push(t.vmServicePort.toString())),t.supportsWsVmService&&s.push("--web-server-debug-protocol","ws"),t.supportsExposeUrl&&s.push("--web-allow-expose-url"))),t.args&&(s=s.concat(t.args)),!0===t.forceFlutterVerboseMode&&-1===s.indexOf("-v")&&-1===s.indexOf("--verbose")&&s.push("-v"),new u.FlutterRun(e?h.RunMode.Attach:h.RunMode.Run,t.flutterPath,t.flutterCustomRunScript,t.globalFlutterArgs||[],t.cwd,s,{envOverrides:t.env,toolEnv:this.toolEnv},t.flutterRunLogFile,i,e=>this.exposeUrl(e),this.maxLogLineLength)}connectToObservatoryIfReady(){return s(this,void 0,void 0,(function*(){this.observatoryUri&&this.appHasStarted&&!this.observatory&&(yield this.initDebugger(this.observatoryUri))}))}terminate(e){const t=Object.create(null,{terminate:{get:()=>super.terminate}});return s(this,void 0,void 0,(function*(){if(!this.appHasBeenToldToStopOrDetach){this.appHasBeenToldToStopOrDetach=!0;try{this.currentRunningAppId&&this.appHasStarted&&!this.processExited&&this.runDaemon&&(this.runDaemon.mode===h.RunMode.Run?this.runDaemon.stop(this.currentRunningAppId):this.runDaemon.detach(this.currentRunningAppId),yield Promise.race([this.processExit,new Promise(e=>setTimeout(e,3e3))]))}catch(e){}}yield t.terminate.call(this,e)}))}restartRequest(e,t){const i=Object.create(null,{restartRequest:{get:()=>super.restartRequest}});return s(this,void 0,void 0,(function*(){this.sendEvent(new n.Event("dart.hotRestartRequest")),this.sendEvent(new n.ContinuedEvent(0,!0)),yield this.performReload(!0,r.restartReasonManual),i.restartRequest.call(this,e,t)}))}performReload(e,t){return s(this,void 0,void 0,(function*(){if(!this.appHasStarted||!this.currentRunningAppId||!this.runDaemon)return;if(this.isReloadInProgress)return void this.sendEvent(new n.OutputEvent("Reload already in progress, ignoring request","stderr"));this.isReloadInProgress=!0;const i=e?"hot-restart":"hot-reload";try{yield this.runDaemon.restart(this.currentRunningAppId,!this.noDebug,e,t)}catch(e){this.sendEvent(new n.OutputEvent(`Error running ${i}: ${e}\n`,"stderr"))}finally{this.isReloadInProgress=!1}}))}customRequest(e,t,i){const o=Object.create(null,{customRequest:{get:()=>super.customRequest}});return s(this,void 0,void 0,(function*(){try{switch(e){case"serviceExtension":this.currentRunningAppId&&this.runDaemon&&(yield this.runDaemon.callServiceExtension(this.currentRunningAppId,i.type,i.params)),this.sendResponse(t);break;case"checkPlatformOverride":if(this.currentRunningAppId&&this.runDaemon){const e=yield this.runDaemon.callServiceExtension(this.currentRunningAppId,"ext.flutter.platformOverride",void 0);this.sendEvent(new n.Event("dart.flutter.updatePlatformOverride",{platform:e.value}))}this.sendResponse(t);break;case"checkIsWidgetCreationTracked":if(this.currentRunningAppId&&this.runDaemon){const e=yield this.runDaemon.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.isWidgetCreationTracked",void 0);this.sendEvent(new n.Event("dart.flutter.updateIsWidgetCreationTracked",{isWidgetCreationTracked:e.result}))}this.sendResponse(t);break;case"hotReload":this.currentRunningAppId&&(yield this.performReload(!1,i&&i.reason||r.restartReasonManual)),this.sendResponse(t);break;case"hotRestart":this.currentRunningAppId&&(yield this.performReload(!0,i&&i.reason||r.restartReasonManual)),this.sendResponse(t);break;default:yield o.customRequest.call(this,e,t,i)}}catch(i){const s=i&&i.message?i.message:i,r=`Error handling '${e}' custom request: ${s}`;this.isTerminating||this.sendEvent(new n.OutputEvent(r+"\n","stderr")),this.logger.error(r),this.errorResponse(t,r)}}))}handleInspectEvent(e){return s(this,void 0,void 0,(function*(){if(!this.runDaemon||!this.currentRunningAppId)return;const e=yield this.runDaemon.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.getSelectedSummaryWidget",{previousSelectionId:null,objectGroup:"my-group"});if(e&&e.result&&e.result.creationLocation){const t=e.result.creationLocation,i=t.file,s=t.line,r=t.column;this.sendEvent(new n.Event("dart.navigate",{file:i,line:s,column:r}))}yield this.runDaemon.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.disposeGroup",{objectGroup:"my-group"})}))}handleFlutterErrorEvent(e){const t=e.extensionData;this.logFlutterErrorToUser(t)}logFlutterErrorToUser(e){const t="═".repeat(8),i="═".repeat(Math.max(80-e.description.length-2-t.length,0)),s=`${t} ${e.description} ${i}`;this.logToUser(`\n${s}\n`,"stderr",c.grey2),e.errorsSinceReload?this.logFlutterErrorSummary(e):this.logDiagnosticNodeDescendents(e),this.logToUser("═".repeat(s.length)+"\n","stderr",c.grey2)}logDiagnosticNodeToUser(e,{parent:t,level:i=0,blankLineAfterSummary:s=!0}){if(e.description&&e.description.startsWith("◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤◢◤"))return;if(e.type===a.DiagnosticsNodeType.ErrorSpacer)return;let n=" ".repeat(4*i);e.name&&!1!==e.showName&&(n+=e.name,!1!==e.showSeparator&&e.description&&(n+=": ")),e.description&&(n+=e.description),n=n.trimRight();const r=e.level===a.DiagnosticsNodeLevel.Error||e.level===a.DiagnosticsNodeLevel.Summary||e.description&&e.description.startsWith("Exception: "),o=e.level===a.DiagnosticsNodeLevel.Hint,l=r?e=>e:o?c.grey2:c.grey;this.logToUser(n+"\n","stderr",l),s&&e.level===a.DiagnosticsNodeLevel.Summary&&this.logToUser("\n");const u=e.style===a.DiagnosticsNodeStyle.Flat?i:i+1;this.logDiagnosticNodeDescendents(e,u)}logFlutterErrorSummary(e){for(const t of e.properties){const i=t.children&&t.children.length&&!t.children.find(e=>e.children&&e.children.length);(t.level===a.DiagnosticsNodeLevel.Summary||i)&&this.logDiagnosticNodeToUser(t,{parent:e,blankLineAfterSummary:!1})}}logDiagnosticNodeDescendents(e,t=0){if(e.style!==a.DiagnosticsNodeStyle.Shallow){if(e.properties){let i;for(const s of e.properties)i===s.level||i!==a.DiagnosticsNodeLevel.Hint&&s.level!==a.DiagnosticsNodeLevel.Hint||this.logToUser("\n"),this.logDiagnosticNodeToUser(s,{parent:e,level:t}),i=s.level}e.children&&e.children.forEach(i=>this.logDiagnosticNodeToUser(i,{parent:e,level:t}))}}handleExtensionEvent(e){"Extension"===e.kind&&"Flutter.FirstFrame"===e.extensionKind?this.sendEvent(new n.Event("dart.flutter.firstFrame",{})):"Extension"===e.kind&&"Flutter.Error"===e.extensionKind?this.handleFlutterErrorEvent(e):"Extension"===e.kind&&"Flutter.ServiceExtensionStateChanged"===e.extensionKind?this.sendEvent(new n.Event("dart.flutter.serviceExtensionStateChanged",e.extensionData)):super.handleExtensionEvent(e)}handleServiceExtensionAdded(e){super.handleServiceExtensionAdded(e),this.runDaemon&&this.currentRunningAppId&&e.extensionRPC===o.VmServiceExtension.InspectorStructuredErrors&&this.useFlutterStructuredErrors&&this.runDaemon.callServiceExtension(this.currentRunningAppId,e.extensionRPC,{enabled:!0}).catch(e=>this.logger.error(e))}}t.FlutterDebugSession=p},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(4),a=i(8),c=i(12),l=i(3),u=i(1),d=i(9),h=i(6),p=i(104);t.isLogging=!1;t.LoggingCommands=class{constructor(e,t){this.logger=e,this.extensionLogPath=t,this.disposables=[],this.disposables.push(r.commands.registerCommand("dart.startLogging",this.startLogging,this),r.commands.registerCommand("dart.stopLogging",this.stopLogging,this))}startLogging(){return s(this,void 0,void 0,(function*(){const e=n.join(u.forceWindowsDriveLetterToUppercase(this.extensionLogPath),this.generateFilename()),i=r.Uri.file(e);h.createFolderForFile(e);const s=yield r.window.showQuickPick(Object.keys(p.userSelectableLogCategories).map(e=>({label:e,logCategory:p.userSelectableLogCategories[e],picked:!0})),{canPickMany:!0,placeHolder:"Select which categories to include in the log"});if(!s||!s.length)return;const g=[a.LogCategory.General].concat(s.map(e=>e.logCategory)),f=c.captureLogs(this.logger,u.fsPath(i),p.getLogHeader(),d.config.maxLogLineLength,g);t.isLogging=!0,this.disposables.push(f),r.commands.executeCommand("setContext",o.DART_IS_CAPTURING_LOGS_CONTEXT,!0);const m=new l.PromiseCompleter;this.currentLogCompleter=m,yield r.window.withProgress({cancellable:!0,location:r.ProgressLocation.Notification,title:"Dart and Flutter logs are being captured. Reproduce your issue then click Cancel."},(e,t)=>(t.onCancellationRequested(()=>m.resolve()),m.promise)),t.isLogging=!1,yield f.dispose();const v=yield r.workspace.openTextDocument(i);return yield r.window.showTextDocument(v),e}))}stopLogging(){return s(this,void 0,void 0,(function*(){this.currentLogCompleter&&this.currentLogCompleter.resolve()}))}generateFilename(){const e=e=>("0"+e.toString()).slice(-2),t=new Date;return`Dart-Code-Log-${`${t.getFullYear()}-${e(t.getMonth())}-${e(t.getDay())} ${e(t.getHours())}-${e(t.getMinutes())}-${e(t.getSeconds())}`}.txt`}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(18),n=i(2),r=i(4),o=i(8),a=i(1),c=i(9);let l;t.getExtensionLogPath=function(){return l=l||c.config.extensionLogFile||n.join(process.env.DC_TEST_LOGS||s.tmpdir(),`dart-code-startup-log-${a.getRandomInt(4096,65536).toString(16)}.txt`),l},t.userSelectableLogCategories={"Analysis Server":o.LogCategory.Analyzer,"Command Processes":o.LogCategory.CommandProcesses,"Debugger (Observatory)":o.LogCategory.Observatory,DevTools:o.LogCategory.DevTools,"Flutter Device Daemon":o.LogCategory.FlutterDaemon,"Flutter Run":o.LogCategory.FlutterRun,"Flutter Test":o.LogCategory.FlutterTest,"Pub Run Test":o.LogCategory.PubTest,"Web Daemon":o.LogCategory.WebDaemon};const u=[];t.clearLogHeader=function(){u.length=0},t.getLogHeader=function(){return u.length?u.join(r.platformEol)+r.platformEol+r.platformEol:""},t.addToLogHeader=function(e){try{u.push(e().replace(/\r/g,"").replace(/\n/g,"\r\n"))}catch(e){}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(0),r=i(4),o=i(8),a=i(3),c=i(21),l=i(1),u=i(106),d=i(14),h=i(52),p={};class g{constructor(){this.disposables=[],this.onDidChangeTreeDataEmitter=new n.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.onDidStartTestsEmitter=new n.EventEmitter,this.onDidStartTests=this.onDidStartTestsEmitter.event,this.onFirstFailureEmitter=new n.EventEmitter,this.onFirstFailure=this.onFirstFailureEmitter.event,this.owningDebugSessions={},this.disposables.push(n.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),this.disposables.push(n.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),this.disposables.push(n.commands.registerCommand("dart.startDebuggingTest",e=>{const t=e instanceof b?e.test.name:e instanceof y?e.group.name:void 0;n.debug.startDebugging(n.workspace.getWorkspaceFolder(e.resourceUri),u.getLaunchConfig(!1,l.fsPath(e.resourceUri),t,e instanceof y))})),this.disposables.push(n.commands.registerCommand("dart.startWithoutDebuggingTest",e=>{const t=e instanceof b?e.test.name:e instanceof y?e.group.name:void 0;n.debug.startDebugging(n.workspace.getWorkspaceFolder(e.resourceUri),u.getLaunchConfig(!0,l.fsPath(e.resourceUri),t,e instanceof y))})),this.disposables.push(n.commands.registerCommand("_dart.displaySuite",e=>n.commands.executeCommand("_dart.jumpToLineColInUri",n.Uri.file(e.suite.path)))),this.disposables.push(n.commands.registerCommand("_dart.displayGroup",e=>{if(e.group.url||e.group.root_url)return n.commands.executeCommand("_dart.jumpToLineColInUri",n.Uri.parse(e.group.url||e.group.root_url),e.group.root_line||e.group.line,e.group.root_column||e.group.column)})),this.disposables.push(n.commands.registerCommand("_dart.displayTest",e=>{if(this.writeTestOutput(e,!0),e.test.url||e.test.root_url)return n.commands.executeCommand("_dart.jumpToLineColInUri",n.Uri.parse(e.test.root_url||e.test.url),e.test.root_line||e.test.line,e.test.root_column||e.test.column)}))}static flagSuiteStart(e,t){if(g.isNewTestRun=!0,g.nextFailureIsFirst=!0,t&&e&&s.isAbsolute(e)){const t=p[l.fsPath(e)],i=t?[t]:Object.values(p);for(const e of i)e.getAllGroups().forEach(e=>e.isPotentiallyDeleted=!0),e.getAllTests().forEach(e=>e.isPotentiallyDeleted=!0)}Object.keys(p).forEach(e=>{const t=p[l.fsPath(e)];t.currentRunNumber++,t.getAllGroups().forEach(e=>e.isStale=!0),t.getAllTests().forEach(e=>e.isStale=!0)})}setSelectedNodes(e){this.currentSelectedNode=e}writeTestOutput(e,t=!1){const i=h.getChannel("Test Output");i.clear(),t&&i.show(!0),i.appendLine(e.test.name+":\n"),e.outputEvents.length||i.appendLine("(no output)");for(const t of e.outputEvents)this.appendTestOutput(t,i)}appendTestOutput(e,t=h.getChannel("Test Output")){"error"===e.type?(e=e,t.appendLine("ERROR: "+e.error),t.appendLine(e.stackTrace)):"print"===e.type?(e=e,t.appendLine(e.message)):t.appendLine(`Unknown message type '${e.type}'.`)}handleDebugSessionCustomEvent(e){"dart.testRunNotification"===e.event&&("suite"===e.body.notification.type&&(this.owningDebugSessions[e.body.suitePath]=e.session),this.handleNotification(e.body.suitePath,e.body.notification))}getTreeItem(e){return e}getChildren(e){let t=e?e instanceof v||e instanceof y?e.children:[]:Object.keys(p).map(e=>p[e].node);return t=t.filter(e=>e),e||(t=t.sort((e,t)=>{if(e.sort>t.sort)return 1;if(e.sort<t.sort)return-1;const i=e.label||(e.resourceUri?e.resourceUri.toString():""),s=t.label||(t.resourceUri?t.resourceUri.toString():"");return i>s?1:i<s?-1:0})),t}getParent(e){if(e instanceof b||e instanceof y)return e.parent}updateNode(e){this.onDidChangeTreeDataEmitter.fire(e)}updateAllStatuses(e){this.updateStatusFromChildren(e.node),this.updateNode()}updateStatusFromChildren(e){const t=e.children.length?e.children.filter(e=>e instanceof y&&!e.isPhantomGroup||e instanceof b&&!e.hidden).map(e=>e instanceof y?this.updateStatusFromChildren(e):e instanceof b?e.status:o.TestStatus.Unknown):[o.TestStatus.Unknown],i=Math.max.apply(Math,t);return i!==e.status&&(e.status=i,e.iconPath=w(e.status,!1),this.updateNode(e)),e.status}dispose(){this.disposables.forEach(e=>e.dispose())}handleNotification(e,t){const i=p[e];switch(t.type){case"suite":this.handleSuiteNotification(e,t);break;case"testStart":this.handleTestStartNotifcation(i,t);break;case"testDone":this.handleTestDoneNotification(i,t);break;case"group":this.handleGroupNotification(i,t);break;case"print":this.handlePrintNotification(i,t);break;case"error":this.handleErrorNotification(i,t)}}handleSuiteNotification(e,t){let i=p[t.suite.path];i||(i=new f(e,new v(t.suite)),p[t.suite.path]=i),i.node.status=o.TestStatus.Waiting,this.updateNode(i.node),this.updateNode(),g.isNewTestRun&&(g.isNewTestRun=!1,this.onDidStartTestsEmitter.fire(i.node))}handleTestStartNotifcation(e,t){let i;const s=e.getCurrentTest(t.test.id)||e.reuseMatchingTest(e.currentRunNumber,t.test,e=>i=e),n=s||new b(e,t.test);s||e.storeTest(t.test.id,n),n.test=t.test,n.test.name&&n.test.name.startsWith("loading ")&&n.parent instanceof v?n.hidden=!0:n.hidden=!1;const r=i&&i!==n.parent;i&&r&&(i.tests.splice(i.tests.indexOf(n),1),this.updateNode(i)),s&&!r||n.parent.tests.push(n),n.status=o.TestStatus.Running,this.updateNode(n),this.updateNode(n.parent),n.hidden||this.updateAllStatuses(e)}handleTestDoneNotification(e,t){const i=e.getCurrentTest(t.testID);i.hidden=t.hidden,t.skipped?i.status=o.TestStatus.Skipped:"success"===t.result?i.status=o.TestStatus.Passed:"failure"===t.result?i.status=o.TestStatus.Failed:"error"===t.result?i.status=o.TestStatus.Errored:i.status=o.TestStatus.Unknown,t.time&&(i.description=t.time+"ms"),this.updateNode(i),this.updateNode(i.parent),this.updateAllStatuses(e),i.status!==o.TestStatus.Failed&&i.status!==o.TestStatus.Errored||!g.nextFailureIsFirst||(g.nextFailureIsFirst=!1,this.onFirstFailureEmitter.fire(i))}handleGroupNotification(e,t){let i;const s=e.getCurrentGroup(t.group.id)||e.reuseMatchingGroup(e.currentRunNumber,t.group,e=>i=e),n=s||new y(e,t.group);s||e.storeGroup(t.group.id,n),n.group=t.group;const r=i&&i!==n.parent;i&&r&&(i.groups.splice(i.groups.indexOf(n),1),this.updateNode(i)),s&&!r||n.parent.groups.push(n),n.status=o.TestStatus.Running,this.updateNode(n),this.updateNode(n.parent)}handleDebugSessionEnd(e){const t=Object.keys(this.owningDebugSessions).filter(t=>{const i=this.owningDebugSessions[t];return e&&i&&i.id===e.id});for(const e of t)this.handleSuiteEnd(p[e]),this.owningDebugSessions[e]=void 0,delete this.owningDebugSessions[e]}handleSuiteEnd(e){e&&(e.getAllTests(!0).filter(e=>e.isPotentiallyDeleted||e.hidden).forEach(e=>{e.hidden=!0,this.updateNode(e.parent)}),e.getAllTests().filter(e=>e.status===o.TestStatus.Running).forEach(e=>{e.status=o.TestStatus.Unknown,this.updateNode(e)}),this.updateAllStatuses(e))}handlePrintNotification(e,t){const i=e.getCurrentTest(t.testID);i.outputEvents.push(t),i===this.currentSelectedNode&&this.appendTestOutput(t)}handleErrorNotification(e,t){const i=e.getCurrentTest(t.testID);i.outputEvents.push(t),i===this.currentSelectedNode&&this.appendTestOutput(t)}}t.TestResultsProvider=g,g.isNewTestRun=!0,g.nextFailureIsFirst=!0;class f{constructor(e,t){this.path=e,this.node=t,this.currentRunNumber=1,this.groups={},this.tests={}}getAllGroups(e=!1){return a.uniq(Object.keys(this.groups).map(e=>this.groups[e]).filter(t=>e||!t.hidden&&!t.isPhantomGroup))}getAllTests(e=!1){return a.uniq(Object.keys(this.tests).map(e=>this.tests[e]).filter(t=>e||!t.hidden))}getCurrentGroup(e){return this.groups[`${this.currentRunNumber}_${e}`]}getCurrentTest(e){return this.tests[`${this.currentRunNumber}_${e}`]}getMyGroup(e,t){return this.groups[`${e}_${t}`]}getMyTest(e,t){return this.tests[`${e}_${t}`]}storeGroup(e,t){return this.groups[`${this.currentRunNumber}_${e}`]=t}storeTest(e,t){return this.tests[`${this.currentRunNumber}_${e}`]=t}reuseMatchingGroup(e,t,i){const s=this.getAllGroups().filter(i=>i.group.name===t.name&&i.suiteRunNumber!==e).sort((e,i)=>Math.abs((e.group.line||0)-(t.line||0))-Math.abs((i.group.line||0)-(t.line||0))),n=s.length?s[0]:void 0;return n&&(i(n.parent),n.suiteRunNumber=this.currentRunNumber,this.storeGroup(t.id,n)),n}reuseMatchingTest(e,t,i){const s=this.getAllTests().filter(i=>i.test.name===t.name&&i.suiteRunNumber!==e),n=c.sortBy(s,e=>Math.abs((e.test.line||0)-(t.line||0))),r=n.length?n[0]:void 0;return r&&(i(r.parent),r.suiteRunNumber=this.currentRunNumber,this.storeTest(t.id,r)),r}}class m extends n.TreeItem{constructor(){super(...arguments),this._isStale=!1,this._status=o.TestStatus.Unknown,this._sort=S.Middle,this.suiteRunNumber=0,this.isPotentiallyDeleted=!1}get status(){return this._status}set status(e){this._status=e,this.iconPath=w(e,this.isStale),this.description=void 0,e!==o.TestStatus.Errored&&e!==o.TestStatus.Failed&&e!==o.TestStatus.Passed&&e!==o.TestStatus.Skipped||(this.isStale=!1,this.isPotentiallyDeleted=!1,this._sort=function(e){return e===o.TestStatus.Failed||e===o.TestStatus.Errored?S.Top:S.Middle}(e))}get isStale(){return this._isStale}set isStale(e){this._isStale=e,this.iconPath=w(this.status,this.isStale)}get sort(){return this._sort}}t.TestItemTreeItem=m;class v extends m{constructor(e){super(n.Uri.file(e.path),n.TreeItemCollapsibleState.Collapsed),this.suite=e,this.groups=[],this.tests=[],this.contextValue=r.DART_TEST_SUITE_NODE_CONTEXT,this.resourceUri=n.Uri.file(e.path),this.description=!0,this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_${this.suite.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displaySuite",arguments:[this],title:""}}get children(){return[...a.flatMap(this.groups.filter(e=>e.isPhantomGroup),e=>e.children),...this.groups.filter(e=>!e.isPhantomGroup&&!e.hidden),...this.tests.filter(e=>!e.hidden)]}}t.SuiteTreeItem=v;class y extends m{constructor(e,t){super(t.name||"<unnamed>",n.TreeItemCollapsibleState.Collapsed),this.suite=e,this.groups=[],this.tests=[],this.suiteRunNumber=e.currentRunNumber,this._group=t,this.group=t,this.contextValue=r.DART_TEST_GROUP_NODE_CONTEXT,this.resourceUri=n.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_group_${this.group.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displayGroup",arguments:[this],title:""}}get isPhantomGroup(){return!this.group.name&&this.parent instanceof v}get hidden(){return this.children.every(e=>e instanceof y&&e.hidden||e instanceof b&&e.hidden)}get parent(){const e=this.group.parentID?this.suite.getMyGroup(this.suiteRunNumber,this.group.parentID):this.suite.node;return e instanceof y&&e.isPhantomGroup?e.parent:e}get children(){return[].concat(this.groups.filter(e=>!e.hidden)).concat(this.tests.filter(e=>!e.hidden))}get group(){return this._group}set group(e){this._group=e;const t=this.parent;this.label=t&&t instanceof y&&t.fullName&&e.name&&e.name.startsWith(t.fullName+" ")?e.name.substr(t.fullName.length+1):e.name}get fullName(){return this._group.name}}class b extends m{constructor(e,t,i=!1){super(t.name||"<unnamed>",n.TreeItemCollapsibleState.None),this.suite=e,this.hidden=i,this.outputEvents=[],this.suiteRunNumber=e.currentRunNumber,this._test=t,this.test=t,this.contextValue=r.DART_TEST_TEST_NODE_CONTEXT,this.resourceUri=n.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_test_${this.test.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displayTest",arguments:[this],title:""}}get parent(){const e=this.test.groupIDs&&this.test.groupIDs.length?this.suite.getMyGroup(this.suiteRunNumber,this.test.groupIDs[this.test.groupIDs.length-1]):this.suite.node;return e instanceof y&&e.isPhantomGroup?e.parent:e}get test(){return this._test}set test(e){this._test=e,this.outputEvents.length=0;const t=this.parent;this.label=t&&t instanceof y&&t.fullName&&e.name&&e.name.startsWith(t.fullName+" ")?e.name.substr(t.fullName.length+1):e.name||"<unnamed>"}get fullName(){return this._test.name}}function w(e,t){let i;switch(e){case o.TestStatus.Running:i="running";break;case o.TestStatus.Passed:i=t?"pass_stale":"pass";break;case o.TestStatus.Failed:case o.TestStatus.Errored:i=t?"fail_stale":"fail";break;case o.TestStatus.Skipped:i=t?"skip_stale":"skip";break;case o.TestStatus.Unknown:i="unknown";break;case o.TestStatus.Waiting:i="loading";break;default:i=void 0}return i&&d.extensionPath?n.Uri.file(s.join(d.extensionPath,`media/icons/tests/${i}.svg`)):void 0}var S;!function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(S||(S={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);t.getLaunchConfig=function(e,t,i,s,n){return Object.assign({name:"Tests",noDebug:e,request:"launch",type:"dart"},n,{args:(n&&n.args||[]).concat(i?["--name",r(i,s)]:[]),program:t})};const n=/\\\$(?:(?:\w+)|(?:\\\{.*\\\}))/g;function r(e,t){const i=t?"":"$";return`^${s.escapeRegExp(e).replace(n,".*")}${i}`}t.makeRegexForTest=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.flutterOutlineCommands=["refactor.flutter.wrap.center","refactor.flutter.wrap.padding","refactor.flutter.wrap.column","refactor.flutter.move.up","refactor.flutter.move.down","refactor.flutter.removeWidget"];t.FlutterOutlineCommands=class{constructor(e,i){this.tree=e;for(const e of t.flutterOutlineCommands)i.subscriptions.push(s.commands.registerCommand("_flutter.outline."+e,()=>this.applyRefactoring(e)))}applyRefactoring(e){if(!this.tree.selection||1!==this.tree.selection.length)return void console.error("Invalid selection when running Flutter Outline refactor: "+e);const t=this.tree.selection[0].fixes.filter(e=>e.command).find(t=>t.kind&&t.kind.value.endsWith(e));t?t.command&&t.command.arguments?s.commands.executeCommand(t.command.command,...t.command.arguments):console.error("Flutter Outline fix was missing command/arguments"):console.error("Unable to find command for Flutter Outline: "+e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findNearestOutlineNode=function(e,t,i,s=!1,n=["CLASS","METHOD","GETTER","SETTER"]){const r=e.getOutlineFor(t.uri);return r&&function e(t,i,s,n){if(!t)return;for(const r of t){const t=r.offset,o=r.offset+r.length;if(t>i||o<i)continue;const a=!s||!r.element||!r.element.location||i>=t&&i<=r.element.location.offset+r.element.location.length;return e(r.children,i,s,n)||(-1!==n.indexOf(r.element.kind)&&a?r:void 0)}}([r],t.offsetAt(i),s,n)}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(18),o=i(2),a=i(0),c=i(0),l=i(4),u=i(8),d=i(12),h=i(3),p=i(21),g=i(81),f=i(1),m=i(83),v=i(82),y=i(5),b=i(9),w=i(31),S=i(110),C=i(230),T=i(231),E=i(232),R=i(233),P=i(6),D=i(13),_=i(52),k=new RegExp("^[a-z][a-z0-9_]*$");let x,O,F=!1,I=0;t.SdkCommands=class{constructor(e,t,i,l,u,d,h){this.logger=e,this.context=t,this.workspace=i,this.sdkUtils=l,this.pubGlobal=u,this.flutterCapabilities=d,this.deviceManager=h,this.runningCommands={},this.sdks=i.sdks;const p=new R.DartSdkManager(this.logger,this.workspace.sdks);if(t.subscriptions.push(a.commands.registerCommand("dart.changeSdk",()=>p.changeSdk())),i.hasAnyFlutterProjects){const e=new R.FlutterSdkManager(this.logger,i.sdks);t.subscriptions.push(a.commands.registerCommand("dart.changeFlutterSdk",()=>e.changeSdk()))}t.subscriptions.push(a.commands.registerCommand("dart.getPackages",e=>s(this,void 0,void 0,(function*(){if(e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to get packages for"))){"string"==typeof e&&(e=a.Uri.file(e));try{return P.isInsideFlutterProject(e)?this.runFlutter(["pub","get"],e):this.runPub(["get"],e)}finally{S.DartHoverProvider.clearPackageMapCaches()}}})))),t.subscriptions.push(a.commands.registerCommand("dart.listOutdatedPackages",e=>s(this,void 0,void 0,(function*(){if(e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to check for outdated packages")))return"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["pub","outdated"],e,!0):this.runPub(["outdated"],e,!0)})))),t.subscriptions.push(a.commands.registerCommand("dart.upgradePackages",e=>s(this,void 0,void 0,(function*(){return e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to upgrade packages in")),"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["pub","upgrade"],e):this.runPub(["upgrade"],e)})))),t.subscriptions.push(a.commands.registerCommand("pub.get",e=>a.commands.executeCommand("dart.getPackages",e))),t.subscriptions.push(a.commands.registerCommand("pub.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("pub.outdated",e=>a.commands.executeCommand("dart.listOutdatedPackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.get",e=>s(this,void 0,void 0,(function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter packages get" in',e);if(!t)return;e=a.Uri.file(t)}if(e&&f.fsPath(e)===i.sdks.flutter)return this.runFlutter(["update-packages"],e);try{return this.runFlutter(["pub","get"],e)}finally{S.DartHoverProvider.clearPackageMapCaches()}})))),t.subscriptions.push(a.commands.registerCommand("flutter.clean",e=>s(this,void 0,void 0,(function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter clean" in',e,!0);if(!t)return;e=a.Uri.file(t)}return this.runFlutter(["clean"],e)})))),t.subscriptions.push(a.commands.registerCommand("_flutter.screenshot.touchBar",e=>a.commands.executeCommand("flutter.screenshot",e))),t.subscriptions.push(a.commands.registerCommand("flutter.screenshot",()=>s(this,void 0,void 0,(function*(){let e=!1;if((!this.flutterScreenshotPath||b.config.flutterScreenshotPath&&this.flutterScreenshotPath!==b.config.flutterScreenshotPath)&&(this.flutterScreenshotPath=b.config.flutterScreenshotPath,e=!0),!this.flutterScreenshotPath){const t=yield c.window.showOpenDialog({canSelectFolders:!0,openLabel:"Set screenshots folder"});if(!(t&&t.length>0))return;this.flutterScreenshotPath=t[0].path,e=!0}f.mkDirRecursive(this.flutterScreenshotPath);const t=this.deviceManager&&this.deviceManager.currentDevice?this.deviceManager.currentDevice.id:void 0,i=t?["screenshot","-d",t]:["screenshot"];if(yield this.runFlutterInFolder(this.flutterScreenshotPath,i,"screenshot",!0),e){(yield a.window.showInformationMessage("Screenshots will be saved to "+this.flutterScreenshotPath,"Show Folder"))&&(yield a.commands.executeCommand("revealFileInOS",c.Uri.file(this.flutterScreenshotPath)))}})))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.outdated",e=>a.commands.executeCommand("dart.listOutdatedPackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.doctor",e=>{var t;if(!i.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.doctor");const s=o.join(r.tmpdir(),"dart-code-cmd-run");return n.existsSync(s)||n.mkdirSync(s),this.runFlutterInFolder(s,["doctor","-v"],"flutter",!0,{customScript:null===(t=i.config)||void 0===t?void 0:t.flutterDoctorScript})})),t.subscriptions.push(a.commands.registerCommand("flutter.upgrade",e=>s(this,void 0,void 0,(function*(){if(!i.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.upgrade");const e=o.join(r.tmpdir(),"dart-code-cmd-run");n.existsSync(e)||n.mkdirSync(e),yield this.runFlutterInFolder(e,["upgrade"],"flutter",!0),yield P.promptToReloadExtension()})))),t.subscriptions.push(a.commands.registerCommand("flutter.createProject",e=>this.createFlutterProject())),t.subscriptions.push(a.commands.registerCommand("_dart.flutter.createSampleProject",e=>this.createFlutterSampleProject())),t.subscriptions.push(a.commands.registerCommand("dart.createProject",e=>this.createDartProject())),t.subscriptions.push(a.commands.registerCommand("_dart.create",(e,t)=>{const i=["global","run","stagehand",t];return this.runPubInFolder(e,i,t)})),t.subscriptions.push(a.commands.registerCommand("_flutter.create",(e,t,i)=>{const s=["create"];return b.config.flutterCreateOffline&&s.push("--offline"),t&&(s.push("--project-name"),s.push(t)),b.config.flutterCreateOrganization&&(s.push("--org"),s.push(b.config.flutterCreateOrganization)),b.config.flutterCreateIOSLanguage&&(s.push("--ios-language"),s.push(b.config.flutterCreateIOSLanguage)),b.config.flutterCreateAndroidLanguage&&(s.push("--android-language"),s.push(b.config.flutterCreateAndroidLanguage)),b.config.flutterAndroidX&&s.push("--androidx"),i&&(s.push("--sample"),s.push(i),s.push("--overwrite")),s.push("."),this.runFlutterInFolder(e,s,t)})),t.subscriptions.push(a.commands.registerCommand("_flutter.clean",(e,t)=>{t=t||o.basename(e);return this.runFlutterInFolder(e,["clean"],t)})),this.setupPubspecWatcher(t)}setupPubspecWatcher(e){e.subscriptions.push(a.workspace.onWillSaveTextDocument(e=>{"pubspec.yaml"===o.basename(f.fsPath(e.document.uri)).toLowerCase()&&(O=e.reason)}));const t=a.workspace.createFileSystemWatcher("**/pubspec.yaml");e.subscriptions.push(t),t.onDidChange(this.handlePubspecChange,this),t.onDidCreate(this.handlePubspecChange,this)}handlePubspecChange(e){if(this.logger.info(`Pubspec ${f.fsPath(e)} was modified`),!b.config.for(e).runPubGetOnPubspecChanges)return void this.logger.info('Automatically running "pub get" is disabled');if(this.workspace.config.disableAutomaticPackageGet)return void this.logger.info('Workspace suppresses automatic "pub get"');if(-1!==f.fsPath(e).indexOf(`${o.sep}.dart_tool${o.sep}`))return void this.logger.info("Change was inside a .dart_tool folder, skipping");if(I>0)return void this.logger.info("Skipping package fetch because project creation is in progress");x&&clearTimeout(x);const t=O===a.TextDocumentSaveReason.FocusOut||O===a.TextDocumentSaveReason.AfterDelay?1e4:1e3;x=setTimeout(()=>{x=void 0,O=void 0,this.fetchPackagesOrPrompt(e)},t)}fetchPackagesOrPrompt(e,t){return s(this,void 0,void 0,(function*(){if(F)this.logger.info("Already running pub get, skipping!");else{F=!0;try{const i=t&&t.alwaysPrompt,s=y.getDartWorkspaceFolders().map(e=>f.fsPath(e.uri)),n=yield f.findProjectFolders(s,{requirePubspec:!0}),r=h.uniq(n).map(a.Uri.file).filter(e=>b.config.for(e).promptToGetPackages).filter(C.isPubGetProbablyRequired);this.logger.info(`Found ${r.length} folders requiring "pub get":${r.map(e=>"\n    "+f.fsPath(e)).join("")}`),i||0!==r.length?i||1!==r.length?r.length&&C.promptToRunPubGet(r):yield a.commands.executeCommand("dart.getPackages",r[0]):yield a.commands.executeCommand("dart.getPackages",e)}finally{F=!1}}}))}runCommandForWorkspace(e,t,i,n,r=!1){return s(this,void 0,void 0,(function*(){const s=yield this.getFolderToRunCommandIn(t,n);if(!s)return;const c=a.workspace.getWorkspaceFolder(a.Uri.file(s));if(!c)throw this.logger.error("Failed to get workspace folder for "+s),new Error("Failed to get workspace folder for "+s);const l=f.fsPath(c.uri),u=o.relative(l,s)||o.basename(s);return e(s,i,u,r)}))}getFolderToRunCommandIn(e,t,i=!1){return s(this,void 0,void 0,(function*(){let s=t&&f.fsPath(t);s=s||a.window.activeTextEditor&&f.fsPath(a.window.activeTextEditor.document.uri);const n=s&&w.locateBestProjectRoot(s);if(n)return n;const r=y.getDartWorkspaceFolders().map(e=>f.fsPath(e.uri)),o=(yield f.findProjectFolders(r,{requirePubspec:!0,sort:!0})).filter(i?P.isFlutterProjectFolder:()=>!0);if(o&&o.length)return this.showFolderPicker(o,e);{const e=i?"Flutter":"Dart/Flutter";a.window.showWarningMessage(`No ${e} projects were found.`)}}))}showFolderPicker(e,t){return s(this,void 0,void 0,(function*(){if(1===e.length)return e[0];const i=e.map(e=>{const t=a.workspace.getWorkspaceFolder(c.Uri.file(e));if(!t)return;const i=o.dirname(f.fsPath(t.uri));return{description:P.homeRelativePath(i),label:o.relative(i,e),path:e}}).filter(h.notUndefined),s=yield a.window.showQuickPick(i,{placeHolder:t});return s&&s.path}))}runFlutter(e,t,i=!1){return this.runCommandForWorkspace(this.runFlutterInFolder.bind(this),`Select the folder to run "flutter ${e.join(" ")}" in`,e,t,i)}runFlutterInFolder(e,t,i,s=!1,n){if(!this.sdks.flutter)throw new Error("Flutter SDK not available");const{binPath:r,binArgs:c}=h.usingCustomScript(o.join(this.sdks.flutter,l.flutterPath),t,n),u=D.getGlobalFlutterArgs().concat(b.config.for(a.Uri.file(e)).flutterAdditionalArgs).concat(c);return this.runCommandInFolder(i,e,r,u,s)}runPub(e,t,i=!1){return this.runCommandForWorkspace(this.runPubInFolder.bind(this),`Select the folder to run "pub ${e.join(" ")}" in`,e,t,i)}runPubInFolder(e,t,i,s=!1){if(!this.sdks.dart)throw new Error("Flutter SDK not available");const n=o.join(this.sdks.dart,l.pubPath);return t=t.concat(...b.config.for(a.Uri.file(e)).pubAdditionalArgs),this.runCommandInFolder(i,e,n,t,s)}runCommandInFolder(e,t,i,s,n){e=e||o.basename(t);const r=o.basename(i).split(".")[0],l=_.createChannel(`${r} (${e})`);n&&l.show();const h=`${t}|${r}|${s}`,p=this.runningCommands[h];return p&&!p.hasStarted?Promise.resolve(void 0):a.window.withProgress({cancellable:!0,location:c.ProgressLocation.Notification,title:`${r} ${s.join(" ")}`},(n,o)=>{p?(n.report({message:"terminating previous command..."}),p.cancel()):l.clear();const a=new L(()=>{l.appendLine(`[${e}] ${r} ${s.join(" ")}`),n.report({message:"running..."});const o=D.safeToolSpawn(t,i,s);return _.runProcessInChannel(o,l),this.logger.info(`(PROC ${o.pid}) Spawned ${i} ${s.join(" ")} in ${t}`,u.LogCategory.CommandProcesses),d.logProcess(this.logger,u.LogCategory.CommandProcesses,o),o.on("close",e=>{e&&l.show(!0)}),o},p);return this.runningCommands[h]=a,o.onCancellationRequested(()=>a.cancel()),a.completed})}createDartProject(){return s(this,void 0,void 0,(function*(){return this.createStagehandProject("dart.createProject",l.DART_STAGEHAND_PROJECT_TRIGGER_FILE,!1)}))}createStagehandProject(e,t,i,r){return s(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.dart)return void this.sdkUtils.showDartActivationFailure(e);const s=new T.Stagehand(this.logger,this.sdks,this.pubGlobal);if(!(yield s.promptToInstallIfRequired()))return;let l;try{l=yield s.getTemplates()}catch(e){return void a.window.showErrorMessage("Unable to execute Stagehand. "+e)}const u=r?l.filter(r):l,d=p.sortBy(u,e=>e.label).map(e=>({description:e.name,detail:e.description,label:e.label,template:e})),h=i&&1===d.length?d[0]:yield a.window.showQuickPick(d,{matchOnDescription:!0,placeHolder:"Which Dart template?"});if(!h)return;const g=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateDartProjectName});if(!g)return;const v=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!v||1!==v.length)return;const y=v[0],w=c.Uri.file(o.join(f.fsPath(y),g));if(n.existsSync(f.fsPath(w)))return void a.window.showErrorMessage(`A folder named ${g} already exists in ${f.fsPath(y)}`);n.mkdirSync(f.fsPath(w)),n.writeFileSync(o.join(f.fsPath(w),t),JSON.stringify(h.template)),b.config.workspaceSdkPath&&m.writeDartSdkSettingIntoProject(b.config.workspaceSdkPath,f.fsPath(w));const S=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",w,S)}))}createFlutterProject(){return s(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.createProject");const e=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateFlutterProjectName});if(!e)return;const t=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!t||1!==t.length)return;const i=t[0],s=c.Uri.file(o.join(f.fsPath(i),e));if(n.existsSync(f.fsPath(s)))return void a.window.showErrorMessage(`A folder named ${e} already exists in ${f.fsPath(i)}`);n.mkdirSync(f.fsPath(s)),n.writeFileSync(o.join(f.fsPath(s),l.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),""),b.config.workspaceFlutterSdkPath&&m.writeFlutterSdkSettingIntoProject(b.config.workspaceFlutterSdkPath,f.fsPath(s));const r=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",s,r)}))}createFlutterSampleProject(){return s(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("_dart.flutter.createSampleProject");let e;try{e=yield E.getFlutterSnippets(this.logger,this.sdks,this.flutterCapabilities)}catch(e){return void a.window.showErrorMessage("Unable to retrieve Flutter documentation snippets")}const t=p.sortBy(e,e=>e.element),i=yield a.window.showQuickPick(t.map(e=>({description:`${e.package}/${e.library}`,detail:g.stripMarkdown(e.description),label:e.element,snippet:e})),{matchOnDescription:!0,placeHolder:"Which Flutter sample?"});return i?v.createFlutterSampleInTempFolder(this.flutterCapabilities,i.snippet.id,b.config.workspaceFlutterSdkPath):void 0}))}validateDartProjectName(e){if(!k.test(e))return"Dart project names should be all lowercase, with underscores to separate words";return-1!==["dart","test"].indexOf(e)?`You may not use ${e} as the name for a dart project`:void 0}validateFlutterProjectName(e){if(!k.test(e))return"Flutter project names should be all lowercase, with underscores to separate words";return-1!==["flutter","flutter_test","test"].indexOf(e)?`You may not use ${e} as the name for a flutter project`:void 0}},t.markProjectCreationStarted=function(){I++},t.markProjectCreationEnded=function(){I--};class L{constructor(e,t){this.spawn=e,this.processNumber=L.processNumber++,this.completer=new h.PromiseCompleter,this.completed=this.completer.promise,this.isCancelled=!1,t?t.completed.then(()=>this.start()):this.start()}get hasStarted(){return void 0!==this.process}start(){if(this.process)throw new Error(this.processNumber+" Can't start an already started process!");this.isCancelled?this.completer.resolve(void 0):(this.process=this.spawn(),this.process.on("close",e=>this.completer.resolve(e)))}cancel(){this.isCancelled=!0}}L.processNumber=1},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(44),o=i(1),a=i(14);class c{constructor(e,t){this.logger=e,this.analyzer=t}provideHover(e,t,i){return s(this,void 0,void 0,(function*(){try{const s=yield this.analyzer.analysisGetHover({file:o.fsPath(e.uri),offset:e.offsetAt(t)});if(i.isCancellationRequested||0===s.hovers.length)return;const r=s.hovers[0],a=this.getHoverData(e.uri,r);if(!a)return;const c=new n.Range(e.positionAt(r.offset),e.positionAt(r.offset+r.length));return new n.Hover([{language:"dart",value:a.displayString},a.documentation||void 0],c.isSingleLine?c:void 0)}catch(e){this.logger.error(e)}}))}getHoverData(e,t){if(!t.elementDescription)return;if("import prefix"===t.elementKind)return;const i=t.elementDescription,s=t.dartdoc,n=t.propagatedType;let r="";i&&(r+=(t.isDeprecated?"(deprecated) ":"")+i+"\n"),n&&(r+="propogated type: "+n.trim());let o=a.cleanDartdoc(s);if(this.analyzer.capabilities.hasNewHoverLibraryFormat)t.containingLibraryName&&(o=`*${t.containingLibraryName}*\n\n`+o);else{const e=t.containingLibraryName;e&&(o=`*${e}*\n\n`+o)}return{displayString:r.trim(),documentation:o.trim()}}static getPackageMapFor(e){const t=o.fsPath(e);if(this.packageMaps[t])return this.packageMaps[t];const i=r.PackageMap.findPackagesFile(t),s=i?new r.PackageMap(i):void 0;return s&&(this.packageMaps[t]=s),s}static clearPackageMapCaches(){this.packageMaps={}}}t.DartHoverProvider=c,c.packageMaps={}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(1),r=i(6);t.validLastCharacters=[")","]"];t.ClosingLabelsDecorations=class{constructor(e){this.analyzer=e,this.subscriptions=[],this.decorationType=s.window.createTextEditorDecorationType({after:{color:new s.ThemeColor("dart.closingLabels"),margin:"2px"},rangeBehavior:s.DecorationRangeBehavior.ClosedOpen}),this.subscriptions.push(this.analyzer.registerForAnalysisClosingLabels(e=>{this.activeEditor&&e.file===n.fsPath(this.activeEditor.document.uri)&&(this.closingLabels=e,this.update())})),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),s.window.activeTextEditor&&this.setTrackingFile(s.window.activeTextEditor)}update(){if(!this.closingLabels||!this.activeEditor||this.closingLabels.file!==n.fsPath(this.activeEditor.document.uri))return;const e=[];for(const i of this.closingLabels.labels){const n=this.activeEditor.document.positionAt(i.offset+i.length);if(n.character<1)return;const r=new s.Range(n.translate({characterDelta:-1}),n),o=this.activeEditor.document.getText(r);if(-1===t.validLastCharacters.indexOf(o))return;const a=this.activeEditor.document.lineAt(n).range.end,c=e[a.line];if(c)c.renderOptions.after.contentText=" // "+i.label+" "+c.renderOptions.after.contentText;else{const t={range:new s.Range(this.activeEditor.document.positionAt(i.offset),a),renderOptions:{after:{contentText:" // "+i.label}}};e[a.line]=t}}this.activeEditor.setDecorations(this.decorationType,Object.keys(e).map(e=>parseInt(e,10)).map(t=>e[t]))}setTrackingFile(e){var t;e&&r.isAnalyzable(e.document)&&(e!==this.activeEditor&&(null===(t=this.activeEditor)||void 0===t||t.setDecorations(this.decorationType,[])),e?(this.activeEditor=e,this.closingLabels=void 0,this.analyzer.forceNotificationsFor(n.fsPath(e.document.uri))):(this.activeEditor=void 0,this.closingLabels=void 0))}dispose(){var e;null===(e=this.activeEditor)||void 0===e||e.setDecorations(this.decorationType,[]),this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(240),n=i(5);t.IconRangeComputer=class{constructor(e){this.logger=e}compute(e,t){const i=new r(this.logger);i.visit(t);const s={};return i.icons.forEach(t=>{s[t.iconName]||(s[t.iconName]=[]),s[t.iconName].push(n.toRange(e,t.offset,t.length))}),s}};class r extends s.FlutterOutlineVisitor{constructor(){super(...arguments),this.icons=[],this.iconValuePattern=new RegExp("Icons\\.([\\w_]+)")}visitAttribute(e){if(e.label&&e.valueLocation){const t=this.iconValuePattern.exec(e.label);t&&this.icons.push({iconName:t[1],offset:e.valueLocation.offset,length:e.valueLocation.length})}}}t.IconRangeComputerLsp=class{constructor(e){this.logger=e}compute(e){const t=new o(this.logger);t.visit(e);const i={};return t.icons.forEach(e=>{i[e.iconName]||(i[e.iconName]=[]),i[e.iconName].push(n.lspToRange(e.range))}),i}};class o extends s.FlutterOutlineVisitorLsp{constructor(){super(...arguments),this.icons=[],this.iconValuePattern=new RegExp("Icons\\.([\\w_]+)")}visitAttribute(e){if(e.label&&e.valueRange){const t=this.iconValuePattern.exec(e.label);t&&this.icons.push({iconName:t[1],range:e.valueRange})}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(14),r=i(6);t.FlutterIconDecorations=class{constructor(e){this.logger=e,this.subscriptions=[],this.decorationTypes={},this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>{this.setTrackingFile(e),this.update()})),setImmediate(()=>{this.setTrackingFile(s.window.activeTextEditor),this.update()})}render(e){if(this.activeEditor){for(const t of Object.keys(e))this.decorationTypes[t]||(this.decorationTypes[t]=s.window.createTextEditorDecorationType({gutterIconPath:s.Uri.parse(n.docsIconPathFormat.replace("$1",t)),gutterIconSize:"75%"}));for(const t of Object.keys(this.decorationTypes))this.activeEditor.setDecorations(this.decorationTypes[t],e[t]||[])}}setTrackingFile(e){e&&r.isAnalyzable(e.document)?this.activeEditor=e:this.activeEditor=void 0}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3),r=i(243),o=i(9);t.FlutterUiGuideDecorations=class{constructor(){this.disposables=[],this.borderDecoration=s.window.createTextEditorDecorationType({rangeBehavior:s.DecorationRangeBehavior.OpenOpen}),this.disposables.push(s.window.onDidChangeActiveTextEditor(e=>this.buildForTextEditor(e))),o.config.previewFlutterUiGuidesCustomTracking&&(this.tracker=new c,this.disposables.push(this.tracker),this.tracker.onGuidesChanged(([e,t])=>this.buildFromUpdatedGuides(e,t))),setImmediate(()=>this.buildForTextEditor(s.window.activeTextEditor))}buildFromUpdatedGuides(e,t){s.window.activeTextEditor&&s.window.activeTextEditor.document===e&&this.renderGuides(s.window.activeTextEditor,t,"#A3A3A3")}renderGuides(e,t,i){const s={};for(const e of t)for(let t=e.start.line;t<=e.end.line;t++)s[t]=s[t]||[],s[t].push(e);const n=this.buildDecorations(e.document,e.options.tabSize,s,i);e.setDecorations(this.borderDecoration,n)}buildDecorations(e,t,i,n){const r=[];for(const o of Object.keys(i).map(e=>parseInt(e,10))){const a=e.lineAt(o),c=Math.min(...i[o].map(e=>Math.min(e.start.character,e.end.character))),l=Math.max(...i[o].map(e=>Math.max(e.start.character,e.end.character))),u=a.range.end.character,d=Math.max(u<c?0:c,0),h=new Array(l).fill(" ");for(const e of i[o])if(o!==e.end.line)" "===h[e.start.character]?h[e.start.character]="│":"└"===h[e.start.character]&&(h[e.start.character]="├");else for(let t=e.start.character;t<=e.end.character;t++)t===e.start.character?h[t]="└":h[t]="─";h.fill(" ",a.firstNonWhitespaceCharacterIndex,a.range.end.character),h.splice(0,d);const p=[];for(let e=0;e<h.length;e++)if(p.push(h[e]),"\t"===a.text[d+e]){const i="─"===h[e]||"└"===h[e]||"├"===h[e]?"─":" ";for(let e=0;e<t-1;e++)p.push(i)}r.push({range:new s.Range(new s.Position(o,d),new s.Position(o,d)),renderOptions:{before:{color:n,contentText:p.join(""),margin:"0 3px 0 -3px",width:"0"}}})}return r}firstNonWhitespace(e,t){return new s.Position(t,e.lineAt(t).firstNonWhitespaceCharacterIndex)}dispose(){this.disposables.forEach(e=>e.dispose())}};class a{constructor(e,t){this.start=e,this.end=t}}t.WidgetGuide=a;class c{constructor(){this.disposables=[],this.tracker=new r.DocumentPositionTracker,this.guideMap=new Map,this.onGuidesChangedEmitter=new s.EventEmitter,this.onGuidesChanged=this.onGuidesChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onPositionsChanged(([e,t])=>{const i=[];for(const e of this.guideMap.keys()){const s=this.guideMap.get(e),n=s[0],r=s[1],o=t.get(n),c=t.get(r);o&&c&&i.push(new a(o,c))}this.onGuidesChangedEmitter.fire([e,i])})}clear(){this.guideMap.clear(),this.tracker.clear()}trackDoc(e,t){this.guideMap.clear();for(const e of t)this.guideMap.set(e,[e.start,e.end]);const i=n.flatMap([...this.guideMap.values()],e=>[e[0],e[1]]);this.tracker.trackDoc(e,i)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){const s=i(23);e.exports={re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:i(38).SEMVER_SPEC_VERSION,SemVer:i(11),compareIdentifiers:i(53).compareIdentifiers,rcompareIdentifiers:i(53).rcompareIdentifiers,parse:i(24),valid:i(116),clean:i(117),inc:i(118),diff:i(119),major:i(120),minor:i(121),patch:i(122),prerelease:i(123),compare:i(16),rcompare:i(124),compareLoose:i(125),compareBuild:i(55),sort:i(126),rsort:i(127),gt:i(40),lt:i(56),eq:i(54),neq:i(79),gte:i(57),lte:i(58),cmp:i(80),coerce:i(128),Comparator:i(41),Range:i(17),satisfies:i(42),toComparators:i(129),maxSatisfying:i(130),minSatisfying:i(131),minVersion:i(132),validRange:i(133),outside:i(59),gtr:i(134),ltr:i(135),intersects:i(136),simplifyRange:i(137),subset:i(138)}},function(e,t,i){const s=i(24);e.exports=(e,t)=>{const i=s(e,t);return i?i.version:null}},function(e,t,i){const s=i(24);e.exports=(e,t)=>{const i=s(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}},function(e,t,i){const s=i(11);e.exports=(e,t,i,n)=>{"string"==typeof i&&(n=i,i=void 0);try{return new s(e,i).inc(t,n).version}catch(e){return null}}},function(e,t,i){const s=i(24),n=i(54);e.exports=(e,t)=>{if(n(e,t))return null;{const i=s(e),n=s(t),r=i.prerelease.length||n.prerelease.length,o=r?"pre":"",a=r?"prerelease":"";for(const e in i)if(("major"===e||"minor"===e||"patch"===e)&&i[e]!==n[e])return o+e;return a}}},function(e,t,i){const s=i(11);e.exports=(e,t)=>new s(e,t).major},function(e,t,i){const s=i(11);e.exports=(e,t)=>new s(e,t).minor},function(e,t,i){const s=i(11);e.exports=(e,t)=>new s(e,t).patch},function(e,t,i){const s=i(24);e.exports=(e,t)=>{const i=s(e,t);return i&&i.prerelease.length?i.prerelease:null}},function(e,t,i){const s=i(16);e.exports=(e,t,i)=>s(t,e,i)},function(e,t,i){const s=i(16);e.exports=(e,t)=>s(e,t,!0)},function(e,t,i){const s=i(55);e.exports=(e,t)=>e.sort((e,i)=>s(e,i,t))},function(e,t,i){const s=i(55);e.exports=(e,t)=>e.sort((e,i)=>s(i,e,t))},function(e,t,i){const s=i(11),n=i(24),{re:r,t:o}=i(23);e.exports=(e,t)=>{if(e instanceof s)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let i=null;if((t=t||{}).rtl){let t;for(;(t=r[o.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&t.index+t[0].length===i.index+i[0].length||(i=t),r[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[o.COERCERTL].lastIndex=-1}else i=e.match(r[o.COERCE]);return null===i?null:n(`${i[2]}.${i[3]||"0"}.${i[4]||"0"}`,t)}},function(e,t,i){const s=i(17);e.exports=(e,t)=>new s(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,i){const s=i(11),n=i(17);e.exports=(e,t,i)=>{let r=null,o=null,a=null;try{a=new n(t,i)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(r&&-1!==o.compare(e)||(r=e,o=new s(r,i)))}),r}},function(e,t,i){const s=i(11),n=i(17);e.exports=(e,t,i)=>{let r=null,o=null,a=null;try{a=new n(t,i)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(r&&1!==o.compare(e)||(r=e,o=new s(r,i)))}),r}},function(e,t,i){const s=i(11),n=i(17),r=i(40);e.exports=(e,t)=>{e=new n(e,t);let i=new s("0.0.0");if(e.test(i))return i;if(i=new s("0.0.0-0"),e.test(i))return i;i=null;for(let t=0;t<e.set.length;++t){e.set[t].forEach(e=>{const t=new s(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!r(i,t)||(i=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return i&&e.test(i)?i:null}},function(e,t,i){const s=i(17);e.exports=(e,t)=>{try{return new s(e,t).range||"*"}catch(e){return null}}},function(e,t,i){const s=i(59);e.exports=(e,t,i)=>s(e,t,">",i)},function(e,t,i){const s=i(59);e.exports=(e,t,i)=>s(e,t,"<",i)},function(e,t,i){const s=i(17);e.exports=(e,t,i)=>(e=new s(e,i),t=new s(t,i),e.intersects(t))},function(e,t,i){const s=i(42),n=i(16);e.exports=(e,t,i)=>{const r=[];let o=null,a=null;const c=e.sort((e,t)=>n(e,t,i));for(const e of c){s(e,t,i)?(a=e,o||(o=e)):(a&&r.push([o,a]),a=null,o=null)}o&&r.push([o,null]);const l=[];for(const[e,t]of r)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push("<="+t):l.push(`${e} - ${t}`):l.push(">="+e):l.push("*");const u=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,i){const s=i(17),{ANY:n}=i(41),r=i(42),o=i(16),a=(e,t,i)=>{if(1===e.length&&e[0].semver===n)return 1===t.length&&t[0].semver===n;const s=new Set;let a,u,d,h,p,g,f;for(const t of e)">"===t.operator||">="===t.operator?a=c(a,t,i):"<"===t.operator||"<="===t.operator?u=l(u,t,i):s.add(t.semver);if(s.size>1)return null;if(a&&u){if(d=o(a.semver,u.semver,i),d>0)return null;if(0===d&&(">="!==a.operator||"<="!==u.operator))return null}for(const e of s){if(a&&!r(e,String(a),i))return null;if(u&&!r(e,String(u),i))return null;for(const s of t)if(!r(e,String(s),i))return!1;return!0}for(const e of t){if(f=f||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,a)if(">"===e.operator||">="===e.operator){if(h=c(a,e,i),h===e)return!1}else if(">="===a.operator&&!r(a.semver,String(e),i))return!1;if(u)if("<"===e.operator||"<="===e.operator){if(p=l(u,e,i),p===e)return!1}else if("<="===u.operator&&!r(u.semver,String(e),i))return!1;if(!e.operator&&(u||a)&&0!==d)return!1}return!(a&&g&&!u&&0!==d)&&!(u&&f&&!a&&0!==d)},c=(e,t,i)=>{if(!e)return t;const s=o(e.semver,t.semver,i);return s>0?e:s<0||">"===t.operator&&">="===e.operator?t:e},l=(e,t,i)=>{if(!e)return t;const s=o(e.semver,t.semver,i);return s<0?e:s>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,i)=>{e=new s(e,i),t=new s(t,i);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=a(s,e,i);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(60),n=i(27),r=i(28);t.WebClient=class{constructor(e){this.userAgent=`Dart-Code/${e} (https://dartcode.org/)`}fetch(e,t){const i=r.parse(e);if("https:"===i.protocol&&i.hostname)return this.fetchHttps(i.hostname,i.port||"443",i.path||"",t);if("http:"===i.protocol&&i.hostname)return this.fetchHttp(i.hostname,i.port||"80",i.path||"",t);throw new Error("Cannot fetch URL "+e)}fetchHttps(e,t,i,s={}){return new Promise((r,o)=>{const a={headers:Object.assign(Object.assign({},s),{"User-Agent":this.userAgent}),hostname:e,method:"GET",path:i,port:t};n.request(a,e=>{if(!e||!e.statusCode||e.statusCode<200||e.statusCode>300)o({message:`Failed to get ${i}: ${e&&e.statusCode}: ${e&&e.statusMessage}`});else{const t=[];e.on("data",e=>t.push(e.toString())),e.on("end",()=>{const e=t.join("");r(e)})}}).end()})}fetchHttp(e,t,i,n={}){return new Promise((r,o)=>{const a={headers:Object.assign(Object.assign({},n),{"User-Agent":this.userAgent}),hostname:e,method:"GET",path:i,port:t};s.request(a,e=>{if(!e||!e.statusCode||e.statusCode<200||e.statusCode>300)o({message:`Failed to get ${i}: ${e&&e.statusCode}: ${e&&e.statusMessage}`});else{const t=[];e.on("data",e=>t.push(e.toString())),e.on("end",()=>{const e=t.join("");r(e)})}}).end()})}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.PubApi=class{constructor(e){this.webClient=e}getPackage(e){return s(this,void 0,void 0,(function*(){return this.get("packages/"+e)}))}get(e){return s(this,void 0,void 0,(function*(){return JSON.parse(yield this.webClient.fetch("https://pub.dev/api/"+e,{Accept:"application/vnd.pub.v2+json"}))}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internalApiSymbol="_privateApi"},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),o=i(1),a=i(5),c=i(8),l=i(12),u=i(43),d=i(21),h=i(5);t.FlutterDeviceManager=class{constructor(e,t,i){this.logger=e,this.daemon=t,this.config=i,this.subscriptions=[],this.devices=[],this.knownEmulatorNames={},this.statusBarItem=n.window.createStatusBarItem(n.StatusBarAlignment.Right,1),this.statusBarItem.tooltip="Flutter",this.statusBarItem.command="flutter.selectDevice",this.statusBarItem.show(),this.updateStatusBar(),this.getEmulators().then(()=>this.updateStatusBar()).catch(e=>console.error(e)),this.subscriptions.push(this.statusBarItem),t.registerForDeviceAdded(this.deviceAdded.bind(this)),t.registerForDeviceRemoved(this.deviceRemoved.bind(this))}dispose(){this.subscriptions.forEach(e=>e.dispose())}isSupported(e,t){return t&&(!e||!e.length||!t.platformType||-1!==e.indexOf(t.platformType))}deviceAdded(e){return s(this,void 0,void 0,(function*(){e=Object.assign(Object.assign({},e),{type:"device"}),this.devices.push(e);const t=!1!==e.ephemeral,i=()=>{var i;return!this.currentDevice||this.config.flutterSelectDeviceWhenConnected&&t||"web-server"===(null===(i=this.currentDevice)||void 0===i?void 0:i.id)&&"chrome"===e.id};if(i()){const t=yield this.getSupportedPlatformsForWorkspace();i()&&this.isSupported(t,e)&&(this.currentDevice=e,this.updateStatusBar())}}))}deviceRemoved(e){return s(this,void 0,void 0,(function*(){if(this.devices=this.devices.filter(t=>t.id!==e.id),this.currentDevice&&this.currentDevice.id===e.id){if(this.currentDevice=void 0,this.devices.length){const e=yield this.getSupportedPlatformsForWorkspace(),t=this.devices.filter(t=>this.isSupported(e,t));t&&t.length&&(this.currentDevice=t[0])}this.updateStatusBar()}}))}showDevicePicker(e){return s(this,void 0,void 0,(function*(){!e&&this.daemon.capabilities.providesPlatformTypes&&(e=yield this.getSupportedPlatformsForWorkspace());const t=n.window.createQuickPick();t.placeholder="Select a device to use",t.busy=!0;let i,s=!0;const r=()=>{if(!s)return;const n=this.devices.sort(this.deviceSortComparer.bind(this)).filter(t=>this.isSupported(e,t)).map(e=>({description:e.category||e.platform,device:e,label:this.labelForDevice(e)}));if(i){const e=this.devices.map(e=>e.emulatorId).filter(e=>e);i.filter(t=>-1===e.indexOf(t.device.id)).forEach(e=>n.push(e))}t.items=n};this.getPickableEmulators(!0,e).then(e=>i=e).finally(()=>t.busy=!1).finally(()=>r()).catch(e=>console.error(e));const o=this.daemon.registerForDeviceAdded(e=>r()),a=this.daemon.registerForDeviceRemoved(e=>r());r();const c=yield new Promise(e=>{t.onDidAccept(()=>e(t.selectedItems&&t.selectedItems[0])),t.onDidHide(()=>e(void 0)),t.show()});if(s=!1,t.dispose(),o.dispose(),a.dispose(),c&&c.device){const e=this.emulatorLabel(c.device.platformType);switch(c.device.type){case"emulator-creator":this.currentDevice=void 0,this.statusBarItem.text=`Creating ${e}...`,yield this.createEmulator(),this.updateStatusBar();break;case"emulator":this.currentDevice=void 0,this.statusBarItem.text=`Launching ${e}...`,yield this.launchEmulator(c.device),this.updateStatusBar();break;case"custom-emulator":this.currentDevice=void 0,this.statusBarItem.text=`Launching ${e}...`,yield this.launchCustomEmulator(c.device),this.updateStatusBar();break;case"device":this.currentDevice=c.device,this.updateStatusBar()}return this.currentDevice}}))}getSupportedPlatformsForWorkspace(){return s(this,void 0,void 0,(function*(){return this.shortCacheForSupportedPlatforms?(this.logger.info("Returning cached promise for getSupportedPlatforms()"),this.shortCacheForSupportedPlatforms):(this.shortCacheForSupportedPlatforms=new Promise(e=>s(this,void 0,void 0,(function*(){const t=a.getDartWorkspaceFolders().map(e=>o.fsPath(e.uri)),i=yield o.findProjectFolders(t,{requirePubspec:!0});this.logger.info(`Checking ${i.length} projects for supported platforms`);const s=i.map(e=>this.daemon.getSupportedPlatforms(e)),n=yield Promise.all(s).catch(e=>(this.logger.error(e),[])),c=d.unique(r.flatMap(n,e=>e.platforms));this.logger.info("Supported platforms for the workspace are "+c.join(", ")),e(c),setTimeout(()=>this.shortCacheForSupportedPlatforms=void 0,1e4)}))),this.shortCacheForSupportedPlatforms)}))}labelForDevice(e){return e.emulatorId&&this.knownEmulatorNames[e.emulatorId]&&"android"===e.platformType?this.knownEmulatorNames[e.emulatorId]:e.name}deviceSortComparer(e,t){return e===this.currentDevice?-1:t===this.currentDevice?1:e.name.localeCompare(t.name)}updateStatusBar(){if(this.currentDevice){const e=this.currentDevice.emulator?this.emulatorLabel(this.currentDevice.platformType):"",t=`${this.currentDevice.platform} ${e}`.trim();this.statusBarItem.text=`${this.labelForDevice(this.currentDevice)} (${t})`.trim()}else this.statusBarItem.text="No Device";this.devices.length>1?this.statusBarItem.tooltip=this.devices.length+" Devices Connected":1===this.devices.length?this.statusBarItem.tooltip="1 Device Connected":this.statusBarItem.tooltip=void 0}getEmulators(){return s(this,void 0,void 0,(function*(){try{const e=yield this.daemon.getEmulators(),t={};for(const i of e)t[i.id]={category:i.category,id:i.id,name:i.name||i.id,platformType:i.platformType,type:"emulator"};for(const e of this.config.flutterCustomEmulators){const i=t[e.id];t[e.id]=Object.assign(Object.assign(Object.assign({category:"custom"},i),e),{type:"custom-emulator"})}const i=Object.values(t);for(const e of i)this.knownEmulatorNames[e.id]=e.name;return i}catch(e){return this.logger.error({message:e}),[]}}))}promptForAndLaunchEmulator(e=!1){return s(this,void 0,void 0,(function*(){const t=yield this.getPickableEmulators(!1);if(e&&this.currentDevice)return!0;if(0===t.length)return!1;const i=new n.CancellationTokenSource,s=this.daemon.registerForDeviceAdded(()=>{i.cancel(),s.dispose()}),r=yield n.window.showQuickPick(t,{matchOnDescription:!0,placeHolder:"Connect a device or select an emulator to launch"},i.token);return s.dispose(),r&&r.device&&"emulator-creator"===r.device.type?this.createEmulator():r&&r.device&&"emulator"===r.device.type?this.launchEmulator(r.device):r&&r.device&&"custom-emulator"===r.device.type?this.launchCustomEmulator(r.device):!!this.currentDevice}))}createEmulator(){return s(this,void 0,void 0,(function*(){const e=this.daemon.createEmulator(void 0);n.window.withProgress({location:n.ProgressLocation.Notification,title:"Creating emulator ".trim()+"..."},()=>e);const t=yield e;return t.success?this.launchEmulator({id:t.emulatorName,name:t.emulatorName}):(n.window.showErrorMessage(t.error),!1)}))}emulatorLabel(e){return!e||"ios"!==e&&"macos"!==e?"emulator":"simulator"}getPickableEmulators(e,t){return s(this,void 0,void 0,(function*(){if(!h.isRunningLocally)return[];const i=(yield this.getEmulators()).filter(e=>this.isSupported(t,e)).map(t=>({alwaysShow:!1,description:e?`${t.category||"mobile"} ${this.emulatorLabel(t.platformType)}`:t.platformType||void 0,device:t,label:e?"Start "+t.name:t.name}));return this.daemon.capabilities.canCreateEmulators&&this.isSupported(t,{platformType:"android"})&&i.push({alwaysShow:!0,device:{type:"emulator-creator",platformType:"android",name:"Create Android emulator"},label:"Create Android emulator"}),i}))}launchEmulator(e){return s(this,void 0,void 0,(function*(){try{yield n.window.withProgress({location:n.ProgressLocation.Notification},t=>s(this,void 0,void 0,(function*(){t.report({message:`Launching ${e.name}...`}),yield this.daemon.launchEmulator(e.id),t.report({message:`Waiting for ${e.name} to connect...`});for(let e=0;e<120;e++)if(yield new Promise(e=>setTimeout(e,500)),this.currentDevice)return;throw new Error("Emulator didn't connect within 60 seconds")})))}catch(t){return n.window.showErrorMessage(`Failed to launch ${e.name}: ${t}`),!1}return yield new Promise(e=>setTimeout(e,1e3)),!0}))}launchCustomEmulator(e){return s(this,void 0,void 0,(function*(){try{yield n.window.withProgress({location:n.ProgressLocation.Notification},t=>s(this,void 0,void 0,(function*(){t.report({message:`Launching ${e.name}...`});const i=e.executable,s=e.args||[],n=u.safeSpawn(void 0,e.executable,s,{});this.logger.info(`(PROC ${n.pid}) Spawned ${i} ${s.join(" ")}`,c.LogCategory.CommandProcesses),l.logProcess(this.logger,c.LogCategory.CommandProcesses,n),t.report({message:`Waiting for ${e.name} to connect...`});for(let e=0;e<120;e++)if(yield new Promise(e=>setTimeout(e,500)),this.currentDevice)return;throw new Error("Emulator didn't connect within 60 seconds")})))}catch(t){return n.window.showErrorMessage(`Failed to launch ${e.name}: ${t}`),!1}return yield new Promise(e=>setTimeout(e,1e3)),!0}))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(144);t.DartUriHandler=class{constructor(e){this.handlers={"/flutter/sample/":new r.FlutterSampleUriHandler(e)}}handleUri(e){return s(this,void 0,void 0,(function*(){const t=Object.keys(this.handlers).find(t=>e.path.startsWith(t));t?yield this.handlers[t].handle(e.path.substr(t.length)):n.window.showErrorMessage(`No handler for '${e.path}'. Check you have the latest version of the Dart plugin and try again.`)}))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(82);t.FlutterSampleUriHandler=class{constructor(e){this.flutterCapabilities=e,this.validSampleIdentifierPattern=new RegExp("^[\\w\\.]+$")}handle(e){return s(this,void 0,void 0,(function*(){this.isValidSampleName(e)?r.createFlutterSampleInTempFolder(this.flutterCapabilities,e):n.window.showErrorMessage(e+" is not a valid Flutter sample identifier")}))}isValidSampleName(e){return this.validSampleIdentifierPattern.test(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.context=e}static for(e){return new s(e)}get devToolsNotificationLastShown(){return this.context.globalState.get("devToolsNotificationLastShown")}set devToolsNotificationLastShown(e){this.context.globalState.update("devToolsNotificationLastShown",e)}get devToolsNotificationDoNotShow(){return!!this.context.globalState.get("devToolsNotificationDoNotShowAgain")}set devToolsNotificationDoNotShow(e){this.context.globalState.update("devToolsNotificationDoNotShowAgain",e)}get breakpointOutsideWorkspaceDoNotShow(){return!!this.context.globalState.get("breakpointOutsideWorkspaceDoNotShowAgain")}set breakpointOutsideWorkspaceDoNotShow(e){this.context.globalState.update("breakpointOutsideWorkspaceDoNotShowAgain",e)}getFlutterSurveyNotificationLastShown(e){return this.context.globalState.get(`flutterSurvey${e}NotificationLastShown`)}setFlutterSurveyNotificationLastShown(e,t){this.context.globalState.update(`flutterSurvey${e}NotificationLastShown`,t)}getFlutterSurveyNotificationDoNotShow(e){return!!this.context.globalState.get(`flutterSurvey${e}NotificationDoNotShowAgain`)}setFlutterSurveyNotificationDoNotShow(e,t){this.context.globalState.update(`flutterSurvey${e}NotificationDoNotShowAgain`,t)}get hasWarnedAboutFormatterSyntaxLimitation(){return!!this.context.globalState.get("hasWarnedAboutFormatterSyntaxLimitation")}set hasWarnedAboutFormatterSyntaxLimitation(e){this.context.globalState.update("hasWarnedAboutFormatterSyntaxLimitation",e)}get lastSeenVersion(){return this.context.globalState.get("lastSeenVersion")}set lastSeenVersion(e){this.context.globalState.update("lastSeenVersion",e)}getPackageLastCheckedForUpdates(e){return this.context.globalState.get("packageLastCheckedForUpdates:"+e)}setPackageLastCheckedForUpdates(e,t){this.context.globalState.update("packageLastCheckedForUpdates:"+e,t)}update(e,t){return this.context.globalState.update(e,t)}get(e){return this.context.globalState.get(e)}get subscriptions(){return this.context.subscriptions}}t.Context=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(4);function o(e,t,i){var o,a;if(!r.isWin)try{const r=n.join(i,"dart/config/intellij-plugins/flutter.json");if(!s.existsSync(r))return;e.info("Loading Bazel Flutter config from "+r);const l=s.readFileSync(r,"utf8"),u=JSON.parse(l);function c(e){if(e)return n.isAbsolute(e)?e:n.join(i,e)}t.activateDevToolsEagerly=!!u.devtoolsActivateScript,t.dartSdkHomeLinux=c(null===(o=u.dartSdkHome)||void 0===o?void 0:o.linux),t.dartSdkHomeMac=c(null===(a=u.dartSdkHome)||void 0===a?void 0:a.macos),t.devtoolsActivateScript=c(u.devtoolsActivateScript),t.devtoolsRunScript=c(u.devtoolsRunScript),t.flutterDaemonScript=c(u.daemonScript),t.flutterDoctorScript=c(u.doctorScript),t.flutterRunScript=c(u.runScript),t.flutterSdkHome=c(u.sdkHome),t.flutterTestScript=c(u.testScript),t.flutterVersionFile=c(u.versionFile)}catch(t){e.error(t)}}t.processKnownGitRepositories=function(e,t,i){s.existsSync(n.join(i,"README.dart-sdk"))&&s.existsSync(n.join(i,".packages"))&&(t.disableAutomaticPackageGet=!0,t.useVmForTests=!0)},t.processFuchsiaWorkspace=function(e,t,i){t.disableAutomaticPackageGet=!0,t.disableSdkUpdateChecks=!0},t.processBazelWorkspace=function(e,t,i,s){t.disableAutomaticPackageGet=!0,t.disableSdkUpdateChecks=!0,s&&o(e,t,i)},t.tryProcessBazelFlutterConfig=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WorkspaceContext=class{constructor(e,t,i,s,n,r){this.sdks=e,this.config=t,this.hasAnyFlutterMobileProjects=i,this.hasAnyWebProjects=s,this.hasAnyStandardDartProjects=n,this.hasProjectsInFuchsiaTree=r,this.workspaceTypeDescription=this.buildWorkspaceTypeDescription()}get hasAnyFlutterProjects(){return this.hasAnyFlutterMobileProjects}get shouldLoadFlutterExtension(){return this.hasAnyFlutterProjects}buildWorkspaceTypeDescription(){const e=[];return this.hasAnyStandardDartProjects&&e.push("Dart"),this.hasAnyFlutterMobileProjects&&e.push("Flutter"),this.hasProjectsInFuchsiaTree&&e.push("Fuchsia"),0===e.length&&(this.sdks&&this.sdks.dartSdkIsFromFlutter?e.push("Unknown (Flutter SDK)"):this.sdks&&this.sdks.dart?e.push("Unknown (Dart SDK)"):e.push("Unknown (No SDK)")),e.join(", ")}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(32);class n extends s.StdIOService{constructor(e,t){super(e,t),this.serverConnectedSubscriptions=[],this.serverErrorSubscriptions=[],this.serverStatusSubscriptions=[],this.analysisAnalyzedFilesSubscriptions=[],this.analysisClosingLabelsSubscriptions=[],this.analysisErrorsSubscriptions=[],this.analysisFlushResultsSubscriptions=[],this.analysisFoldingSubscriptions=[],this.analysisHighlightsSubscriptions=[],this.analysisImplementedSubscriptions=[],this.analysisInvalidateSubscriptions=[],this.analysisNavigationSubscriptions=[],this.analysisOccurrencesSubscriptions=[],this.analysisOutlineSubscriptions=[],this.analysisOverridesSubscriptions=[],this.completionResultsSubscriptions=[],this.completionAvailableSuggestionsSubscriptions=[],this.completionExistingImportsSubscriptions=[],this.searchResultsSubscriptions=[],this.executionLaunchDataSubscriptions=[],this.flutterOutlineSubscriptions=[]}buildRequest(e,t,i){return Object.assign(super.buildRequest(e,t,i),{clientRequestTime:Date.now()})}handleNotification(e){switch(e.event){case"server.connected":this.notify(this.serverConnectedSubscriptions,e.params);break;case"server.error":this.notify(this.serverErrorSubscriptions,e.params);break;case"server.status":this.notify(this.serverStatusSubscriptions,e.params);break;case"analysis.analyzedFiles":this.notify(this.analysisAnalyzedFilesSubscriptions,e.params);break;case"analysis.closingLabels":this.notify(this.analysisClosingLabelsSubscriptions,e.params);break;case"analysis.errors":this.notify(this.analysisErrorsSubscriptions,e.params);break;case"analysis.flushResults":this.notify(this.analysisFlushResultsSubscriptions,e.params);break;case"analysis.folding":this.notify(this.analysisFoldingSubscriptions,e.params);break;case"analysis.highlights":this.notify(this.analysisHighlightsSubscriptions,e.params);break;case"analysis.implemented":this.notify(this.analysisImplementedSubscriptions,e.params);break;case"analysis.invalidate":this.notify(this.analysisInvalidateSubscriptions,e.params);break;case"analysis.navigation":this.notify(this.analysisNavigationSubscriptions,e.params);break;case"analysis.occurrences":this.notify(this.analysisOccurrencesSubscriptions,e.params);break;case"analysis.outline":this.notify(this.analysisOutlineSubscriptions,e.params);break;case"analysis.overrides":this.notify(this.analysisOverridesSubscriptions,e.params);break;case"completion.results":this.notify(this.completionResultsSubscriptions,e.params);break;case"completion.availableSuggestions":this.notify(this.completionAvailableSuggestionsSubscriptions,e.params);break;case"completion.existingImports":this.notify(this.completionExistingImportsSubscriptions,e.params);break;case"search.results":this.notify(this.searchResultsSubscriptions,e.params);break;case"execution.launchData":this.notify(this.executionLaunchDataSubscriptions,e.params);break;case"flutter.outline":this.notify(this.flutterOutlineSubscriptions,e.params)}}registerForServerConnected(e){return this.subscribe(this.serverConnectedSubscriptions,e)}registerForServerError(e){return this.subscribe(this.serverErrorSubscriptions,e)}registerForServerStatus(e){return this.subscribe(this.serverStatusSubscriptions,e)}registerForAnalysisAnalyzedFiles(e){return this.subscribe(this.analysisAnalyzedFilesSubscriptions,e)}registerForAnalysisClosingLabels(e){return this.subscribe(this.analysisClosingLabelsSubscriptions,e)}registerForAnalysisErrors(e){return this.subscribe(this.analysisErrorsSubscriptions,e)}registerForAnalysisFlushResults(e){return this.subscribe(this.analysisFlushResultsSubscriptions,e)}registerForAnalysisFolding(e){return this.subscribe(this.analysisFoldingSubscriptions,e)}registerForAnalysisHighlights(e){return this.subscribe(this.analysisHighlightsSubscriptions,e)}registerForAnalysisImplemented(e){return this.subscribe(this.analysisImplementedSubscriptions,e)}registerForAnalysisInvalidate(e){return this.subscribe(this.analysisInvalidateSubscriptions,e)}registerForAnalysisNavigation(e){return this.subscribe(this.analysisNavigationSubscriptions,e)}registerForAnalysisOccurrences(e){return this.subscribe(this.analysisOccurrencesSubscriptions,e)}registerForAnalysisOutline(e){return this.subscribe(this.analysisOutlineSubscriptions,e)}registerForAnalysisOverrides(e){return this.subscribe(this.analysisOverridesSubscriptions,e)}registerForCompletionResults(e){return this.subscribe(this.completionResultsSubscriptions,e)}registerForCompletionAvailableSuggestions(e){return this.subscribe(this.completionAvailableSuggestionsSubscriptions,e)}registerForCompletionExistingImports(e){return this.subscribe(this.completionExistingImportsSubscriptions,e)}registerForSearchResults(e){return this.subscribe(this.searchResultsSubscriptions,e)}registerForExecutionLaunchData(e){return this.subscribe(this.executionLaunchDataSubscriptions,e)}registerForFlutterOutline(e){return this.subscribe(this.flutterOutlineSubscriptions,e)}serverGetVersion(){return this.sendRequest("server.getVersion")}serverShutdown(){return this.sendRequest("server.shutdown")}serverSetSubscriptions(e){return this.sendRequest("server.setSubscriptions",e)}analysisGetErrors(e){return this.sendRequest("analysis.getErrors",e)}analysisGetHover(e){return this.sendRequest("analysis.getHover",e)}analysisGetImportedElements(e){return this.sendRequest("analysis.getImportedElements",e)}analysisGetLibraryDependencies(){return this.sendRequest("analysis.getLibraryDependencies")}analysisGetNavigation(e){return this.sendRequest("analysis.getNavigation",e)}analysisGetReachableSources(e){return this.sendRequest("analysis.getReachableSources",e)}analysisGetSignature(e){return this.sendRequest("analysis.getSignature",e)}analysisReanalyze(){return this.sendRequest("analysis.reanalyze")}analysisSetAnalysisRoots(e){return this.sendRequest("analysis.setAnalysisRoots",e)}analysisSetGeneralSubscriptions(e){return this.sendRequest("analysis.setGeneralSubscriptions",e)}analysisSetPriorityFiles(e){return this.sendRequest("analysis.setPriorityFiles",e)}analysisSetSubscriptions(e){return this.sendRequest("analysis.setSubscriptions",e)}analysisUpdateContent(e){return this.sendRequest("analysis.updateContent",e)}analysisUpdateOptions(e){return this.sendRequest("analysis.updateOptions",e)}completionGetSuggestions(e){return this.sendRequest("completion.getSuggestions",e)}completionSetSubscriptions(e){return this.sendRequest("completion.setSubscriptions",e)}completionRegisterLibraryPaths(e){return this.sendRequest("completion.registerLibraryPaths",e)}completionGetSuggestionDetails(e){return this.sendRequest("completion.getSuggestionDetails",e)}completionListTokenDetails(e){return this.sendRequest("completion.listTokenDetails",e)}searchFindElementReferences(e){return this.sendRequest("search.findElementReferences",e)}searchFindMemberDeclarations(e){return this.sendRequest("search.findMemberDeclarations",e)}searchFindMemberReferences(e){return this.sendRequest("search.findMemberReferences",e)}searchFindTopLevelDeclarations(e){return this.sendRequest("search.findTopLevelDeclarations",e)}searchGetElementDeclarations(e){return this.sendRequest("search.getElementDeclarations",e)}searchGetTypeHierarchy(e){return this.sendRequest("search.getTypeHierarchy",e)}editFormat(e){return this.sendRequest("edit.format",e)}editGetAssists(e){return this.sendRequest("edit.getAssists",e)}editGetAvailableRefactorings(e){return this.sendRequest("edit.getAvailableRefactorings",e)}editGetDartfixInfo(){return this.sendRequest("edit.getDartfixInfo")}editDartfix(e){return this.sendRequest("edit.dartfix",e)}editGetFixes(e){return this.sendRequest("edit.getFixes",e)}editGetPostfixCompletion(e){return this.sendRequest("edit.getPostfixCompletion",e)}editGetRefactoring(e){return this.sendRequest("edit.getRefactoring",e)}editGetStatementCompletion(e){return this.sendRequest("edit.getStatementCompletion",e)}editIsPostfixCompletionApplicable(e){return this.sendRequest("edit.isPostfixCompletionApplicable",e)}editListPostfixCompletionTemplates(){return this.sendRequest("edit.listPostfixCompletionTemplates")}editImportElements(e){return this.sendRequest("edit.importElements",e)}editSortMembers(e){return this.sendRequest("edit.sortMembers",e)}editOrganizeDirectives(e){return this.sendRequest("edit.organizeDirectives",e)}executionCreateContext(e){return this.sendRequest("execution.createContext",e)}executionDeleteContext(e){return this.sendRequest("execution.deleteContext",e)}executionGetSuggestions(e){return this.sendRequest("execution.getSuggestions",e)}executionMapUri(e){return this.sendRequest("execution.mapUri",e)}executionSetSubscriptions(e){return this.sendRequest("execution.setSubscriptions",e)}diagnosticGetDiagnostics(){return this.sendRequest("diagnostic.getDiagnostics")}diagnosticGetServerPort(){return this.sendRequest("diagnostic.getServerPort")}analyticsIsEnabled(){return this.sendRequest("analytics.isEnabled")}analyticsEnable(e){return this.sendRequest("analytics.enable",e)}analyticsSendEvent(e){return this.sendRequest("analytics.sendEvent",e)}analyticsSendTiming(e){return this.sendRequest("analytics.sendTiming",e)}kytheGetKytheEntries(e){return this.sendRequest("kythe.getKytheEntries",e)}flutterSetSubscriptions(e){return this.sendRequest("flutter.setSubscriptions",e)}}t.AnalyzerGen=n},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(22),a=i(31),c=i(6);t.DasFileTracker=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.wsContext=i,this.disposables=[],this.outlines={},this.flutterOutlines={},this.occurrences={},this.folding={},this.pubRunTestSupport={},this.lastPriorityFiles=[],this.lastSubscribedFiles=[],this.lastPriorityFiles=[],this.lastSubscribedFiles=[],this.disposables.push(n.workspace.onDidOpenTextDocument(e=>s(this,void 0,void 0,(function*(){yield this.updateSubscriptions()})))),this.disposables.push(n.workspace.onDidCloseTextDocument(e=>s(this,void 0,void 0,(function*(){const t=r.fsPath(e.uri);delete this.outlines[t],delete this.flutterOutlines[t],delete this.occurrences[t],delete this.folding[t],delete this.pubRunTestSupport[t],yield this.updateSubscriptions()})))),this.disposables.push(n.window.onDidChangeVisibleTextEditors(e=>this.updatePriorityFiles())),this.disposables.push(this.analyzer.registerForAnalysisOutline(e=>this.outlines[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForFlutterOutline(e=>this.flutterOutlines[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForAnalysisOccurrences(e=>this.occurrences[e.file]=e.occurrences)),this.disposables.push(this.analyzer.registerForAnalysisFolding(e=>this.folding[e.file]=e.regions)),this.disposables.push(this.analyzer.registerForServerConnected(e=>this.updateSubscriptions(!0))),this.updatePriorityFiles(),this.updateSubscriptions()}updatePriorityFiles(){return s(this,void 0,void 0,(function*(){const e=this.validPathsFor(n.window.visibleTextEditors.map(e=>e.document));if(this.pathsHaveChanged(this.lastPriorityFiles,e)){this.lastPriorityFiles=e;try{yield this.analyzer.analysisSetPriorityFiles({files:e})}catch(e){this.logger.error(e)}}}))}updateSubscriptions(e=!1){return s(this,void 0,void 0,(function*(){const t=this.validPathsFor(n.workspace.textDocuments);if(e||this.pathsHaveChanged(this.lastSubscribedFiles,t)){this.lastSubscribedFiles=t;try{yield this.analyzer.analysisSetSubscriptions({subscriptions:{CLOSING_LABELS:this.analyzer.capabilities.supportsClosingLabels?t:void 0,FOLDING:o.isUsingLsp?void 0:t,OCCURRENCES:o.isUsingLsp?void 0:t,OUTLINE:t}})}catch(e){this.logger.error(e)}if(this.wsContext.hasAnyFlutterProjects&&this.analyzer.capabilities.supportsFlutterOutline)try{yield this.analyzer.flutterSetSubscriptions({subscriptions:{OUTLINE:t}})}catch(e){this.logger.error(e)}}}))}pathsHaveChanged(e,t){return e.length!==t.length||e.some((e,i)=>e!==t[i])}validPathsFor(e){const t=this.analyzer.capabilities.supportsPriorityFilesOutsideAnalysisRoots?c.isAnalyzable:c.isAnalyzableAndInWorkspace;return e.filter(e=>!e.isClosed&&t(e)).map(e=>r.fsPath(e.uri)).sort((e,t)=>e.localeCompare(t))}getOutlineFor(e){return this.outlines[r.fsPath(e)]}getFlutterOutlineFor(e){return this.flutterOutlines[r.fsPath(e)]}getOccurrencesFor(e){return this.occurrences[r.fsPath(e)]}supportsPubRunTest(e){const t=r.fsPath(e);if(!c.isPubRunnableTestFile(t))return!1;if(void 0===this.pubRunTestSupport[t]){const e=a.locateBestProjectRoot(t);this.pubRunTestSupport[t]=!(!e||!c.projectShouldUsePubForTests(e,this.wsContext.config))}return this.pubRunTestSupport[r.fsPath(e)]}getFoldingRegionsFor(e){return this.folding[r.fsPath(e)]}getLastPriorityFiles(){return this.lastPriorityFiles.slice()}getLastSubscribedFiles(){return this.lastSubscribedFiles.slice()}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(63),o=i(64),a=i(67),c=i(84),l=i(4),u=i(8),d=i(12),h=i(9),p=i(13),g=i(87),f=i(186);class m extends c.Analyzer{constructor(e,t,i,s){super(new d.CategoryLogger(e,u.LogCategory.Analyzer)),this.client=function(e,t,i,s){const r={initializationOptions:{closingLabels:h.config.closingLabels,flutterOutline:s.hasAnyFlutterProjects,outline:!0},outputChannelName:"LSP"};return new o.LanguageClient("dartAnalysisLSP","Dart Analysis Server",()=>function(e,t,i){const s=n.join(t.dart,l.dartVMPath),r=g.getAnalyzerArgs(e,t,i,!0),o=p.safeToolSpawn(void 0,s,r),a=o.stdout.pipe(new v(e,"<==")),c=new v(e,"==>");return c.pipe(o.stdin),Promise.resolve({reader:a,writer:c})}(e,t,i),r)}(this.logger,t,i,s),this.fileTracker=new f.LspFileTracker(e,this.client,s),this.disposables.push(this.client.start()),this.disposables.push(this.fileTracker),this.client.onReady().then(()=>{this.client.onNotification(a.AnalyzerStatusNotification.type,e=>{this.onAnalysisStatusChangeEmitter.fire({isAnalyzing:e.isAnalyzing})}),this.onReadyCompleter.resolve()})}getDiagnosticServerPort(){return s(this,void 0,void 0,(function*(){return this.client.sendRequest(a.DiagnosticServerRequest.type,void 0)}))}getSuper(e){return s(this,void 0,void 0,(function*(){return this.client.sendRequest(a.SuperRequest.type,e)}))}completeStatement(e){return s(this,void 0,void 0,(function*(){return this.client.sendRequest(a.CompleteStatementRequest.type,e)}))}}t.LspAnalyzer=m;class v extends r.Transform{constructor(e,t,i){super(i),this.logger=e,this.prefix=t}_transform(e,t,i){this.logger.info(`${this.prefix} ${e}`),this.push(e,t),i()}}},function(e,t){var i;t=e.exports=d,i="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var s=Number.MAX_SAFE_INTEGER||9007199254740991,n=t.re=[],r=t.src=[],o=t.tokens={},a=0;function c(e){o[e]=a++}c("NUMERICIDENTIFIER"),r[o.NUMERICIDENTIFIER]="0|[1-9]\\d*",c("NUMERICIDENTIFIERLOOSE"),r[o.NUMERICIDENTIFIERLOOSE]="[0-9]+",c("NONNUMERICIDENTIFIER"),r[o.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",c("MAINVERSION"),r[o.MAINVERSION]="("+r[o.NUMERICIDENTIFIER]+")\\.("+r[o.NUMERICIDENTIFIER]+")\\.("+r[o.NUMERICIDENTIFIER]+")",c("MAINVERSIONLOOSE"),r[o.MAINVERSIONLOOSE]="("+r[o.NUMERICIDENTIFIERLOOSE]+")\\.("+r[o.NUMERICIDENTIFIERLOOSE]+")\\.("+r[o.NUMERICIDENTIFIERLOOSE]+")",c("PRERELEASEIDENTIFIER"),r[o.PRERELEASEIDENTIFIER]="(?:"+r[o.NUMERICIDENTIFIER]+"|"+r[o.NONNUMERICIDENTIFIER]+")",c("PRERELEASEIDENTIFIERLOOSE"),r[o.PRERELEASEIDENTIFIERLOOSE]="(?:"+r[o.NUMERICIDENTIFIERLOOSE]+"|"+r[o.NONNUMERICIDENTIFIER]+")",c("PRERELEASE"),r[o.PRERELEASE]="(?:-("+r[o.PRERELEASEIDENTIFIER]+"(?:\\."+r[o.PRERELEASEIDENTIFIER]+")*))",c("PRERELEASELOOSE"),r[o.PRERELEASELOOSE]="(?:-?("+r[o.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+r[o.PRERELEASEIDENTIFIERLOOSE]+")*))",c("BUILDIDENTIFIER"),r[o.BUILDIDENTIFIER]="[0-9A-Za-z-]+",c("BUILD"),r[o.BUILD]="(?:\\+("+r[o.BUILDIDENTIFIER]+"(?:\\."+r[o.BUILDIDENTIFIER]+")*))",c("FULL"),c("FULLPLAIN"),r[o.FULLPLAIN]="v?"+r[o.MAINVERSION]+r[o.PRERELEASE]+"?"+r[o.BUILD]+"?",r[o.FULL]="^"+r[o.FULLPLAIN]+"$",c("LOOSEPLAIN"),r[o.LOOSEPLAIN]="[v=\\s]*"+r[o.MAINVERSIONLOOSE]+r[o.PRERELEASELOOSE]+"?"+r[o.BUILD]+"?",c("LOOSE"),r[o.LOOSE]="^"+r[o.LOOSEPLAIN]+"$",c("GTLT"),r[o.GTLT]="((?:<|>)?=?)",c("XRANGEIDENTIFIERLOOSE"),r[o.XRANGEIDENTIFIERLOOSE]=r[o.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",c("XRANGEIDENTIFIER"),r[o.XRANGEIDENTIFIER]=r[o.NUMERICIDENTIFIER]+"|x|X|\\*",c("XRANGEPLAIN"),r[o.XRANGEPLAIN]="[v=\\s]*("+r[o.XRANGEIDENTIFIER]+")(?:\\.("+r[o.XRANGEIDENTIFIER]+")(?:\\.("+r[o.XRANGEIDENTIFIER]+")(?:"+r[o.PRERELEASE]+")?"+r[o.BUILD]+"?)?)?",c("XRANGEPLAINLOOSE"),r[o.XRANGEPLAINLOOSE]="[v=\\s]*("+r[o.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+r[o.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+r[o.XRANGEIDENTIFIERLOOSE]+")(?:"+r[o.PRERELEASELOOSE]+")?"+r[o.BUILD]+"?)?)?",c("XRANGE"),r[o.XRANGE]="^"+r[o.GTLT]+"\\s*"+r[o.XRANGEPLAIN]+"$",c("XRANGELOOSE"),r[o.XRANGELOOSE]="^"+r[o.GTLT]+"\\s*"+r[o.XRANGEPLAINLOOSE]+"$",c("COERCE"),r[o.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",c("COERCERTL"),n[o.COERCERTL]=new RegExp(r[o.COERCE],"g"),c("LONETILDE"),r[o.LONETILDE]="(?:~>?)",c("TILDETRIM"),r[o.TILDETRIM]="(\\s*)"+r[o.LONETILDE]+"\\s+",n[o.TILDETRIM]=new RegExp(r[o.TILDETRIM],"g");c("TILDE"),r[o.TILDE]="^"+r[o.LONETILDE]+r[o.XRANGEPLAIN]+"$",c("TILDELOOSE"),r[o.TILDELOOSE]="^"+r[o.LONETILDE]+r[o.XRANGEPLAINLOOSE]+"$",c("LONECARET"),r[o.LONECARET]="(?:\\^)",c("CARETTRIM"),r[o.CARETTRIM]="(\\s*)"+r[o.LONECARET]+"\\s+",n[o.CARETTRIM]=new RegExp(r[o.CARETTRIM],"g");c("CARET"),r[o.CARET]="^"+r[o.LONECARET]+r[o.XRANGEPLAIN]+"$",c("CARETLOOSE"),r[o.CARETLOOSE]="^"+r[o.LONECARET]+r[o.XRANGEPLAINLOOSE]+"$",c("COMPARATORLOOSE"),r[o.COMPARATORLOOSE]="^"+r[o.GTLT]+"\\s*("+r[o.LOOSEPLAIN]+")$|^$",c("COMPARATOR"),r[o.COMPARATOR]="^"+r[o.GTLT]+"\\s*("+r[o.FULLPLAIN]+")$|^$",c("COMPARATORTRIM"),r[o.COMPARATORTRIM]="(\\s*)"+r[o.GTLT]+"\\s*("+r[o.LOOSEPLAIN]+"|"+r[o.XRANGEPLAIN]+")",n[o.COMPARATORTRIM]=new RegExp(r[o.COMPARATORTRIM],"g");c("HYPHENRANGE"),r[o.HYPHENRANGE]="^\\s*("+r[o.XRANGEPLAIN]+")\\s+-\\s+("+r[o.XRANGEPLAIN]+")\\s*$",c("HYPHENRANGELOOSE"),r[o.HYPHENRANGELOOSE]="^\\s*("+r[o.XRANGEPLAINLOOSE]+")\\s+-\\s+("+r[o.XRANGEPLAINLOOSE]+")\\s*$",c("STAR"),r[o.STAR]="(<|>)?=?\\s*\\*";for(var l=0;l<a;l++)i(l,r[l]),n[l]||(n[l]=new RegExp(r[l]));function u(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof d)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?n[o.LOOSE]:n[o.FULL]).test(e))return null;try{return new d(e,t)}catch(e){return null}}function d(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof d){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof d))return new d(e,t);i("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?n[o.LOOSE]:n[o.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}t.parse=u,t.valid=function(e,t){var i=u(e,t);return i?i.version:null},t.clean=function(e,t){var i=u(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null},t.SemVer=d,d.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},d.prototype.toString=function(){return this.version},d.prototype.compare=function(e){return i("SemVer.compare",this.version,this.options,e),e instanceof d||(e=new d(e,this.options)),this.compareMain(e)||this.comparePre(e)},d.prototype.compareMain=function(e){return e instanceof d||(e=new d(e,this.options)),p(this.major,e.major)||p(this.minor,e.minor)||p(this.patch,e.patch)},d.prototype.comparePre=function(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var s=this.prerelease[t],n=e.prerelease[t];if(i("prerelease compare",t,s,n),void 0===s&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===s)return-1;if(s!==n)return p(s,n)}while(++t)},d.prototype.compareBuild=function(e){e instanceof d||(e=new d(e,this.options));var t=0;do{var s=this.build[t],n=e.build[t];if(i("prerelease compare",t,s,n),void 0===s&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===s)return-1;if(s!==n)return p(s,n)}while(++t)},d.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,i,s){"string"==typeof i&&(s=i,i=void 0);try{return new d(e,i).inc(t,s).version}catch(e){return null}},t.diff=function(e,t){if(v(e,t))return null;var i=u(e),s=u(t),n="";if(i.prerelease.length||s.prerelease.length){n="pre";var r="prerelease"}for(var o in i)if(("major"===o||"minor"===o||"patch"===o)&&i[o]!==s[o])return n+o;return r},t.compareIdentifiers=p;var h=/^[0-9]+$/;function p(e,t){var i=h.test(e),s=h.test(t);return i&&s&&(e=+e,t=+t),e===t?0:i&&!s?-1:s&&!i?1:e<t?-1:1}function g(e,t,i){return new d(e,i).compare(new d(t,i))}function f(e,t,i){return g(e,t,i)>0}function m(e,t,i){return g(e,t,i)<0}function v(e,t,i){return 0===g(e,t,i)}function y(e,t,i){return 0!==g(e,t,i)}function b(e,t,i){return g(e,t,i)>=0}function w(e,t,i){return g(e,t,i)<=0}function S(e,t,i,s){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return v(e,i,s);case"!=":return y(e,i,s);case">":return f(e,i,s);case">=":return b(e,i,s);case"<":return m(e,i,s);case"<=":return w(e,i,s);default:throw new TypeError("Invalid operator: "+t)}}function C(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof C){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof C))return new C(e,t);i("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===T?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}t.rcompareIdentifiers=function(e,t){return p(t,e)},t.major=function(e,t){return new d(e,t).major},t.minor=function(e,t){return new d(e,t).minor},t.patch=function(e,t){return new d(e,t).patch},t.compare=g,t.compareLoose=function(e,t){return g(e,t,!0)},t.compareBuild=function(e,t,i){var s=new d(e,i),n=new d(t,i);return s.compare(n)||s.compareBuild(n)},t.rcompare=function(e,t,i){return g(t,e,i)},t.sort=function(e,i){return e.sort((function(e,s){return t.compareBuild(e,s,i)}))},t.rsort=function(e,i){return e.sort((function(e,s){return t.compareBuild(s,e,i)}))},t.gt=f,t.lt=m,t.eq=v,t.neq=y,t.gte=b,t.lte=w,t.cmp=S,t.Comparator=C;var T={};function E(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof E)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new E(e.raw,t);if(e instanceof C)return new E(e.value,t);if(!(this instanceof E))return new E(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function R(e,t){for(var i=!0,s=e.slice(),n=s.pop();i&&s.length;)i=s.every((function(e){return n.intersects(e,t)})),n=s.pop();return i}function P(e){return!e||"x"===e.toLowerCase()||"*"===e}function D(e,t,i,s,n,r,o,a,c,l,u,d,h){return((t=P(i)?"":P(s)?">="+i+".0.0":P(n)?">="+i+"."+s+".0":">="+t)+" "+(a=P(c)?"":P(l)?"<"+(+c+1)+".0.0":P(u)?"<"+c+"."+(+l+1)+".0":d?"<="+c+"."+l+"."+u+"-"+d:"<="+a)).trim()}function _(e,t,s){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!s.includePrerelease){for(n=0;n<e.length;n++)if(i(e[n].semver),e[n].semver!==T&&e[n].semver.prerelease.length>0){var r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}function k(e,t,i){try{t=new E(t,i)}catch(e){return!1}return t.test(e)}function x(e,t,i,s){var n,r,o,a,c;switch(e=new d(e,s),t=new E(t,s),i){case">":n=f,r=w,o=m,a=">",c=">=";break;case"<":n=m,r=b,o=f,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(k(e,t,s))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],h=null,p=null;if(u.forEach((function(e){e.semver===T&&(e=new C(">=0.0.0")),h=h||e,p=p||e,n(e.semver,h.semver,s)?h=e:o(e.semver,p.semver,s)&&(p=e)})),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&r(e,p.semver))return!1;if(p.operator===c&&o(e,p.semver))return!1}return!0}C.prototype.parse=function(e){var t=this.options.loose?n[o.COMPARATORLOOSE]:n[o.COMPARATOR],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new d(i[2],this.options.loose):this.semver=T},C.prototype.toString=function(){return this.value},C.prototype.test=function(e){if(i("Comparator.test",e,this.options.loose),this.semver===T||e===T)return!0;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}return S(e,this.operator,this.semver,this.options)},C.prototype.intersects=function(e,t){if(!(e instanceof C))throw new TypeError("a Comparator is required");var i;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(i=new E(e.value,t),k(this.value,i,t));if(""===e.operator)return""===e.value||(i=new E(this.value,t),k(e.semver,i,t));var s=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),r=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=S(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=S(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return s||n||r&&o||a||c},t.Range=E,E.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},E.prototype.toString=function(){return this.range},E.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var s=t?n[o.HYPHENRANGELOOSE]:n[o.HYPHENRANGE];e=e.replace(s,D),i("hyphen replace",e),e=e.replace(n[o.COMPARATORTRIM],"$1$2$3"),i("comparator trim",e,n[o.COMPARATORTRIM]),e=(e=(e=e.replace(n[o.TILDETRIM],"$1~")).replace(n[o.CARETTRIM],"$1^")).split(/\s+/).join(" ");var r=t?n[o.COMPARATORLOOSE]:n[o.COMPARATOR],a=e.split(" ").map((function(e){return function(e,t){return i("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){i("caret",e,t);var s=t.loose?n[o.CARETLOOSE]:n[o.CARET];return e.replace(s,(function(t,s,n,r,o){var a;return i("caret",e,t,s,n,r,o),P(s)?a="":P(n)?a=">="+s+".0.0 <"+(+s+1)+".0.0":P(r)?a="0"===s?">="+s+"."+n+".0 <"+s+"."+(+n+1)+".0":">="+s+"."+n+".0 <"+(+s+1)+".0.0":o?(i("replaceCaret pr",o),a="0"===s?"0"===n?">="+s+"."+n+"."+r+"-"+o+" <"+s+"."+n+"."+(+r+1):">="+s+"."+n+"."+r+"-"+o+" <"+s+"."+(+n+1)+".0":">="+s+"."+n+"."+r+"-"+o+" <"+(+s+1)+".0.0"):(i("no pr"),a="0"===s?"0"===n?">="+s+"."+n+"."+r+" <"+s+"."+n+"."+(+r+1):">="+s+"."+n+"."+r+" <"+s+"."+(+n+1)+".0":">="+s+"."+n+"."+r+" <"+(+s+1)+".0.0"),i("caret return",a),a}))}(e,t)})).join(" ")}(e,t),i("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var s=t.loose?n[o.TILDELOOSE]:n[o.TILDE];return e.replace(s,(function(t,s,n,r,o){var a;return i("tilde",e,t,s,n,r,o),P(s)?a="":P(n)?a=">="+s+".0.0 <"+(+s+1)+".0.0":P(r)?a=">="+s+"."+n+".0 <"+s+"."+(+n+1)+".0":o?(i("replaceTilde pr",o),a=">="+s+"."+n+"."+r+"-"+o+" <"+s+"."+(+n+1)+".0"):a=">="+s+"."+n+"."+r+" <"+s+"."+(+n+1)+".0",i("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),i("tildes",e),e=function(e,t){return i("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var s=t.loose?n[o.XRANGELOOSE]:n[o.XRANGE];return e.replace(s,(function(s,n,r,o,a,c){i("xRange",e,s,n,r,o,a,c);var l=P(r),u=l||P(o),d=u||P(a),h=d;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",l?s=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(u&&(o=0),a=0,">"===n?(n=">=",u?(r=+r+1,o=0,a=0):(o=+o+1,a=0)):"<="===n&&(n="<",u?r=+r+1:o=+o+1),s=n+r+"."+o+"."+a+c):u?s=">="+r+".0.0"+c+" <"+(+r+1)+".0.0"+c:d&&(s=">="+r+"."+o+".0"+c+" <"+r+"."+(+o+1)+".0"+c),i("xRange return",s),s}))}(e,t)})).join(" ")}(e,t),i("xrange",e),e=function(e,t){return i("replaceStars",e,t),e.trim().replace(n[o.STAR],"")}(e,t),i("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(r)}))),a=a.map((function(e){return new C(e,this.options)}),this)},E.prototype.intersects=function(e,t){if(!(e instanceof E))throw new TypeError("a Range is required");return this.set.some((function(i){return R(i,t)&&e.set.some((function(e){return R(e,t)&&i.every((function(i){return e.every((function(e){return i.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new E(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},E.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(_(this.set[t],e,this.options))return!0;return!1},t.satisfies=k,t.maxSatisfying=function(e,t,i){var s=null,n=null;try{var r=new E(t,i)}catch(e){return null}return e.forEach((function(e){r.test(e)&&(s&&-1!==n.compare(e)||(n=new d(s=e,i)))})),s},t.minSatisfying=function(e,t,i){var s=null,n=null;try{var r=new E(t,i)}catch(e){return null}return e.forEach((function(e){r.test(e)&&(s&&1!==n.compare(e)||(n=new d(s=e,i)))})),s},t.minVersion=function(e,t){e=new E(e,t);var i=new d("0.0.0");if(e.test(i))return i;if(i=new d("0.0.0-0"),e.test(i))return i;i=null;for(var s=0;s<e.set.length;++s){e.set[s].forEach((function(e){var t=new d(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!f(i,t)||(i=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(i&&e.test(i))return i;return null},t.validRange=function(e,t){try{return new E(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,i){return x(e,t,"<",i)},t.gtr=function(e,t,i){return x(e,t,">",i)},t.outside=x,t.prerelease=function(e,t){var i=u(e,t);return i&&i.prerelease.length?i.prerelease:null},t.intersects=function(e,t,i){return e=new E(e,i),t=new E(t,i),e.intersects(t)},t.coerce=function(e,t){if(e instanceof d)return e;"number"==typeof e&&(e=String(e));if("string"!=typeof e)return null;var i=null;if((t=t||{}).rtl){for(var s;(s=n[o.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&s.index+s[0].length===i.index+i[0].length||(i=s),n[o.COERCERTL].lastIndex=s.index+s[1].length+s[2].length;n[o.COERCERTL].lastIndex=-1}else i=e.match(n[o.COERCE]);if(null===i)return null;return u(i[2]+"."+(i[3]||"0")+"."+(i[4]||"0"),t)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(33);var n;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(n=t.ErrorCodes||(t.ErrorCodes={}));class r extends Error{constructor(e,t,i){super(t),this.code=s.number(e)?e:n.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,r.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=r;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0)}};t.RequestType=class extends o{constructor(e){super(e,1)}};t.RequestType1=class extends o{constructor(e){super(e,1)}};t.RequestType2=class extends o{constructor(e){super(e,2)}};t.RequestType3=class extends o{constructor(e){super(e,3)}};t.RequestType4=class extends o{constructor(e){super(e,4)}};t.RequestType5=class extends o{constructor(e){super(e,5)}};t.RequestType6=class extends o{constructor(e){super(e,6)}};t.RequestType7=class extends o{constructor(e){super(e,7)}};t.RequestType8=class extends o{constructor(e){super(e,8)}};t.RequestType9=class extends o{constructor(e){super(e,9)}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0)}};t.NotificationType1=class extends o{constructor(e){super(e,1)}};t.NotificationType2=class extends o{constructor(e){super(e,2)}};t.NotificationType3=class extends o{constructor(e){super(e,3)}};t.NotificationType4=class extends o{constructor(e){super(e,4)}};t.NotificationType5=class extends o{constructor(e){super(e,5)}};t.NotificationType6=class extends o{constructor(e){super(e,6)}};t.NotificationType7=class extends o{constructor(e){super(e,7)}};t.NotificationType8=class extends o{constructor(e){super(e,8)}};t.NotificationType9=class extends o{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&s.string(t.method)&&(s.string(t.id)||s.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&s.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(s.string(t.id)||s.number(t.id)||null===t.id)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(45),n=i(33);var r;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:s.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:s.Event.None}),e.is=function(t){let i=t;return i&&(i===e.None||i===e.Cancelled||n.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}}(r=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new s.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=r.None}}},function(e,t,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(s=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,i=s.None){let n=this._map.get(e);if(n)n.value=t,i!==s.None&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case s.None:this.addItemLast(n);break;case s.First:this.addItemFirst(n);break;case s.Last:default:this.addItemLast(n)}this._map.set(e,n),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let i=this._head;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.next}forEachReverse(e,t){let i=this._tail;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===s.First||t===s.Last)if(t===s.First){if(e===this._head)return;const t=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===s.Last){if(e===this._tail)return;const t=e.next,i=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(18),r=i(46),o=i(34),a=i(65),c=i(66);t.generateRandomPipeName=function(){const e=r.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:s.join(n.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let i,s=new Promise((e,t)=>{i=e});return new Promise((n,r)=>{let l=o.createServer(e=>{l.close(),i([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",r),l.listen(e,()=>{l.removeListener("error",r),n({onConnected:()=>s})})})},t.createServerPipeTransport=function(e,t="utf-8"){const i=o.createConnection(e);return[new a.SocketMessageReader(i,t),new c.SocketMessageWriter(i,t)]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(34),n=i(65),r=i(66);t.createClientSocketTransport=function(e,t="utf-8"){let i,o=new Promise((e,t)=>{i=e});return new Promise((a,c)=>{let l=s.createServer(e=>{l.close(),i([new n.SocketMessageReader(e,t),new r.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const i=s.createConnection(e,"127.0.0.1");return[new n.SocketMessageReader(i,t),new r.SocketMessageWriter(i,t)]}},function(e,t,i){"use strict";var s,n,r,o,a,c,l,u,d,h,p,g,f,m,v,y,b,w,S,C;i.r(t),i.d(t,"Position",(function(){return s})),i.d(t,"Range",(function(){return n})),i.d(t,"Location",(function(){return r})),i.d(t,"LocationLink",(function(){return o})),i.d(t,"Color",(function(){return a})),i.d(t,"ColorInformation",(function(){return c})),i.d(t,"ColorPresentation",(function(){return l})),i.d(t,"FoldingRangeKind",(function(){return u})),i.d(t,"FoldingRange",(function(){return d})),i.d(t,"DiagnosticRelatedInformation",(function(){return h})),i.d(t,"DiagnosticSeverity",(function(){return p})),i.d(t,"DiagnosticTag",(function(){return g})),i.d(t,"Diagnostic",(function(){return f})),i.d(t,"Command",(function(){return m})),i.d(t,"TextEdit",(function(){return v})),i.d(t,"TextDocumentEdit",(function(){return y})),i.d(t,"CreateFile",(function(){return b})),i.d(t,"RenameFile",(function(){return w})),i.d(t,"DeleteFile",(function(){return S})),i.d(t,"WorkspaceEdit",(function(){return C})),i.d(t,"WorkspaceChange",(function(){return Y})),i.d(t,"TextDocumentIdentifier",(function(){return T})),i.d(t,"VersionedTextDocumentIdentifier",(function(){return E})),i.d(t,"TextDocumentItem",(function(){return R})),i.d(t,"MarkupKind",(function(){return P})),i.d(t,"MarkupContent",(function(){return D})),i.d(t,"CompletionItemKind",(function(){return _})),i.d(t,"InsertTextFormat",(function(){return k})),i.d(t,"CompletionItemTag",(function(){return x})),i.d(t,"CompletionItem",(function(){return O})),i.d(t,"CompletionList",(function(){return F})),i.d(t,"MarkedString",(function(){return I})),i.d(t,"Hover",(function(){return L})),i.d(t,"ParameterInformation",(function(){return A})),i.d(t,"SignatureInformation",(function(){return N})),i.d(t,"DocumentHighlightKind",(function(){return M})),i.d(t,"DocumentHighlight",(function(){return U})),i.d(t,"SymbolKind",(function(){return q})),i.d(t,"SymbolTag",(function(){return $})),i.d(t,"SymbolInformation",(function(){return j})),i.d(t,"DocumentSymbol",(function(){return W})),i.d(t,"CodeActionKind",(function(){return z})),i.d(t,"CodeActionContext",(function(){return B})),i.d(t,"CodeAction",(function(){return G})),i.d(t,"CodeLens",(function(){return V})),i.d(t,"FormattingOptions",(function(){return H})),i.d(t,"DocumentLink",(function(){return K})),i.d(t,"SelectionRange",(function(){return X})),i.d(t,"EOL",(function(){return Z})),i.d(t,"TextDocument",(function(){return Q})),function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.number(t.line)&&ee.number(t.character)}}(s||(s={})),function(e){e.create=function(e,t,i,n){if(ee.number(e)&&ee.number(t)&&ee.number(i)&&ee.number(n))return{start:s.create(e,t),end:s.create(i,n)};if(s.is(e)&&s.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+i+", "+n+"]")},e.is=function(e){var t=e;return ee.objectLiteral(t)&&s.is(t.start)&&s.is(t.end)}}(n||(n={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ee.defined(t)&&n.is(t.range)&&(ee.string(t.uri)||ee.undefined(t.uri))}}(r||(r={})),function(e){e.create=function(e,t,i,s){return{targetUri:e,targetRange:t,targetSelectionRange:i,originSelectionRange:s}},e.is=function(e){var t=e;return ee.defined(t)&&n.is(t.targetRange)&&ee.string(t.targetUri)&&(n.is(t.targetSelectionRange)||ee.undefined(t.targetSelectionRange))&&(n.is(t.originSelectionRange)||ee.undefined(t.originSelectionRange))}}(o||(o={})),function(e){e.create=function(e,t,i,s){return{red:e,green:t,blue:i,alpha:s}},e.is=function(e){var t=e;return ee.number(t.red)&&ee.number(t.green)&&ee.number(t.blue)&&ee.number(t.alpha)}}(a||(a={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return n.is(t.range)&&a.is(t.color)}}(c||(c={})),function(e){e.create=function(e,t,i){return{label:e,textEdit:t,additionalTextEdits:i}},e.is=function(e){var t=e;return ee.string(t.label)&&(ee.undefined(t.textEdit)||v.is(t))&&(ee.undefined(t.additionalTextEdits)||ee.typedArray(t.additionalTextEdits,v.is))}}(l||(l={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(u||(u={})),function(e){e.create=function(e,t,i,s,n){var r={startLine:e,endLine:t};return ee.defined(i)&&(r.startCharacter=i),ee.defined(s)&&(r.endCharacter=s),ee.defined(n)&&(r.kind=n),r},e.is=function(e){var t=e;return ee.number(t.startLine)&&ee.number(t.startLine)&&(ee.undefined(t.startCharacter)||ee.number(t.startCharacter))&&(ee.undefined(t.endCharacter)||ee.number(t.endCharacter))&&(ee.undefined(t.kind)||ee.string(t.kind))}}(d||(d={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.location)&&ee.string(t.message)}}(h||(h={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(p||(p={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.create=function(e,t,i,s,n,r){var o={range:e,message:t};return ee.defined(i)&&(o.severity=i),ee.defined(s)&&(o.code=s),ee.defined(n)&&(o.source=n),ee.defined(r)&&(o.relatedInformation=r),o},e.is=function(e){var t=e;return ee.defined(t)&&n.is(t.range)&&ee.string(t.message)&&(ee.number(t.severity)||ee.undefined(t.severity))&&(ee.number(t.code)||ee.string(t.code)||ee.undefined(t.code))&&(ee.string(t.source)||ee.undefined(t.source))&&(ee.undefined(t.relatedInformation)||ee.typedArray(t.relatedInformation,h.is))}}(f||(f={})),function(e){e.create=function(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n={title:e,command:t};return ee.defined(i)&&i.length>0&&(n.arguments=i),n},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.title)&&ee.string(t.command)}}(m||(m={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.string(t.newText)&&n.is(t.range)}}(v||(v={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ee.defined(t)&&E.is(t.textDocument)&&Array.isArray(t.edits)}}(y||(y={})),function(e){e.create=function(e,t){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(b||(b={})),function(e){e.create=function(e,t,i){var s={kind:"rename",oldUri:e,newUri:t};return void 0===i||void 0===i.overwrite&&void 0===i.ignoreIfExists||(s.options=i),s},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ee.string(t.oldUri)&&ee.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(w||(w={})),function(e){e.create=function(e,t){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ee.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ee.boolean(t.options.ignoreIfNotExists)))}}(S||(S={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ee.string(e.kind)?b.is(e)||w.is(e)||S.is(e):y.is(e)})))}}(C||(C={}));var T,E,R,P,D,_,k,x,O,F,I,L,A,N,M,U,q,$,j,W,z,B,G,V,H,K,X,J=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(v.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(v.replace(e,t))},e.prototype.delete=function(e){this.edits.push(v.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}(),Y=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(y.is(e)){var i=new J(e.edits);t._textEditChanges[e.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach((function(i){var s=new J(e.changes[i]);t._textEditChanges[i]=s})))}return Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(E.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(s=this._textEditChanges[t.uri])){var i={textDocument:t,edits:n=[]};this._workspaceEdit.documentChanges.push(i),s=new J(n),this._textEditChanges[t.uri]=s}return s}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var s;if(!(s=this._textEditChanges[e])){var n=[];this._workspaceEdit.changes[e]=n,s=new J(n),this._textEditChanges[e]=s}return s},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(b.create(e,t))},e.prototype.renameFile=function(e,t,i){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(w.create(e,t,i))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(S.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)}}(T||(T={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&(null===t.version||ee.number(t.version))}}(E||(E={})),function(e){e.create=function(e,t,i,s){return{uri:e,languageId:t,version:i,text:s}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&ee.string(t.languageId)&&ee.number(t.version)&&ee.string(t.text)}}(R||(R={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(P||(P={})),function(e){e.is=function(t){var i=t;return i===e.PlainText||i===e.Markdown}}(P||(P={})),function(e){e.is=function(e){var t=e;return ee.objectLiteral(e)&&P.is(t.kind)&&ee.string(t.value)}}(D||(D={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(_||(_={})),function(e){e.PlainText=1,e.Snippet=2}(k||(k={})),function(e){e.Deprecated=1}(x||(x={})),function(e){e.create=function(e){return{label:e}}}(O||(O={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(F||(F={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ee.string(t)||ee.objectLiteral(t)&&ee.string(t.language)&&ee.string(t.value)}}(I||(I={})),function(e){e.is=function(e){var t=e;return!!t&&ee.objectLiteral(t)&&(D.is(t.contents)||I.is(t.contents)||ee.typedArray(t.contents,I.is))&&(void 0===e.range||n.is(e.range))}}(L||(L={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(A||(A={})),function(e){e.create=function(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n={label:e};return ee.defined(t)&&(n.documentation=t),ee.defined(i)?n.parameters=i:n.parameters=[],n}}(N||(N={})),function(e){e.Text=1,e.Read=2,e.Write=3}(M||(M={})),function(e){e.create=function(e,t){var i={range:e};return ee.number(t)&&(i.kind=t),i}}(U||(U={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(q||(q={})),function(e){e.Deprecated=1}($||($={})),function(e){e.create=function(e,t,i,s,n){var r={name:e,kind:t,location:{uri:s,range:i}};return n&&(r.containerName=n),r}}(j||(j={})),function(e){e.create=function(e,t,i,s,n,r){var o={name:e,detail:t,kind:i,range:s,selectionRange:n};return void 0!==r&&(o.children=r),o},e.is=function(e){var t=e;return t&&ee.string(t.name)&&ee.number(t.kind)&&n.is(t.range)&&n.is(t.selectionRange)&&(void 0===t.detail||ee.string(t.detail))&&(void 0===t.deprecated||ee.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(W||(W={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(z||(z={})),function(e){e.create=function(e,t){var i={diagnostics:e};return null!=t&&(i.only=t),i},e.is=function(e){var t=e;return ee.defined(t)&&ee.typedArray(t.diagnostics,f.is)&&(void 0===t.only||ee.typedArray(t.only,ee.string))}}(B||(B={})),function(e){e.create=function(e,t,i){var s={title:e};return m.is(t)?s.command=t:s.edit=t,void 0!==i&&(s.kind=i),s},e.is=function(e){var t=e;return t&&ee.string(t.title)&&(void 0===t.diagnostics||ee.typedArray(t.diagnostics,f.is))&&(void 0===t.kind||ee.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||m.is(t.command))&&(void 0===t.isPreferred||ee.boolean(t.isPreferred))&&(void 0===t.edit||C.is(t.edit))}}(G||(G={})),function(e){e.create=function(e,t){var i={range:e};return ee.defined(t)&&(i.data=t),i},e.is=function(e){var t=e;return ee.defined(t)&&n.is(t.range)&&(ee.undefined(t.command)||m.is(t.command))}}(V||(V={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.number(t.tabSize)&&ee.boolean(t.insertSpaces)}}(H||(H={})),function(e){e.create=function(e,t,i){return{range:e,target:t,data:i}},e.is=function(e){var t=e;return ee.defined(t)&&n.is(t.range)&&(ee.undefined(t.target)||ee.string(t.target))}}(K||(K={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var i=t;return void 0!==i&&n.is(i.range)&&(void 0===i.parent||e.is(i.parent))}}(X||(X={}));var Q,Z=["\n","\r\n","\r"];!function(e){e.create=function(e,t,i,s){return new te(e,t,i,s)},e.is=function(e){var t=e;return!!(ee.defined(t)&&ee.string(t.uri)&&(ee.undefined(t.languageId)||ee.string(t.languageId))&&ee.number(t.lineCount)&&ee.func(t.getText)&&ee.func(t.positionAt)&&ee.func(t.offsetAt))},e.applyEdits=function(e,t){for(var i=e.getText(),s=function e(t,i){if(t.length<=1)return t;var s=t.length/2|0,n=t.slice(0,s),r=t.slice(s);e(n,i),e(r,i);var o=0,a=0,c=0;for(;o<n.length&&a<r.length;){var l=i(n[o],r[a]);t[c++]=l<=0?n[o++]:r[a++]}for(;o<n.length;)t[c++]=n[o++];for(;a<r.length;)t[c++]=r[a++];return t}(t,(function(e,t){var i=e.range.start.line-t.range.start.line;return 0===i?e.range.start.character-t.range.start.character:i})),n=i.length,r=s.length-1;r>=0;r--){var o=s[r],a=e.offsetAt(o.range.start),c=e.offsetAt(o.range.end);if(!(c<=n))throw new Error("Overlapping edit");i=i.substring(0,a)+o.newText+i.substring(c,i.length),n=a}return i}}(Q||(Q={}));var ee,te=function(){function e(e,t,i,s){this._uri=e,this._languageId=t,this._version=i,this._content=s,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(t,i)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,i=!0,s=0;s<t.length;s++){i&&(e.push(s),i=!1);var n=t.charAt(s);i="\r"===n||"\n"===n,"\r"===n&&s+1<t.length&&"\n"===t.charAt(s+1)&&s++}i&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),i=0,n=t.length;if(0===n)return s.create(0,e);for(;i<n;){var r=Math.floor((i+n)/2);t[r]>e?n=r:i=r+1}var o=i-1;return s.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var i=t[e.line],s=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(i+e.character,s),i)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ee||(ee={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(159),n=i(20),r=i(15),o=i(160);t.ImplementationRequest=o.ImplementationRequest;const a=i(161);t.TypeDefinitionRequest=a.TypeDefinitionRequest;const c=i(162);t.WorkspaceFoldersRequest=c.WorkspaceFoldersRequest,t.DidChangeWorkspaceFoldersNotification=c.DidChangeWorkspaceFoldersNotification;const l=i(163);t.ConfigurationRequest=l.ConfigurationRequest;const u=i(164);t.DocumentColorRequest=u.DocumentColorRequest,t.ColorPresentationRequest=u.ColorPresentationRequest;const d=i(165);t.FoldingRangeRequest=d.FoldingRangeRequest;const h=i(166);t.DeclarationRequest=h.DeclarationRequest;const p=i(167);t.SelectionRangeRequest=p.SelectionRangeRequest;const g=i(168);var f,m;t.WorkDoneProgress=g.WorkDoneProgress,t.WorkDoneProgressCreateRequest=g.WorkDoneProgressCreateRequest,t.WorkDoneProgressCancelNotification=g.WorkDoneProgressCancelNotification,function(e){e.is=function(e){const t=e;return s.string(t.language)||s.string(t.scheme)||s.string(t.pattern)}}(f=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!s.string(t)&&!f.is(t))return!1;return!0}}(m=t.DocumentSelector||(t.DocumentSelector={})),function(e){e.type=new r.ProtocolRequestType("client/registerCapability")}(t.RegistrationRequest||(t.RegistrationRequest={})),function(e){e.type=new r.ProtocolRequestType("client/unregisterCapability")}(t.UnregistrationRequest||(t.UnregistrationRequest={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(t.ResourceOperationKind||(t.ResourceOperationKind={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(t.FailureHandlingKind||(t.FailureHandlingKind={})),function(e){e.hasId=function(e){const t=e;return t&&s.string(t.id)&&t.id.length>0}}(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||m.is(t.documentSelector))}}(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})),function(e){e.is=function(e){const t=e;return s.objectLiteral(t)&&(void 0===t.workDoneProgress||s.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&s.boolean(t.workDoneProgress)}}(t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})),function(e){e.type=new r.ProtocolRequestType("initialize")}(t.InitializeRequest||(t.InitializeRequest={})),function(e){e.unknownProtocolVersion=1}(t.InitializeError||(t.InitializeError={})),function(e){e.type=new r.ProtocolNotificationType("initialized")}(t.InitializedNotification||(t.InitializedNotification={})),function(e){e.type=new r.ProtocolRequestType0("shutdown")}(t.ShutdownRequest||(t.ShutdownRequest={})),function(e){e.type=new r.ProtocolNotificationType0("exit")}(t.ExitNotification||(t.ExitNotification={})),function(e){e.type=new r.ProtocolNotificationType("workspace/didChangeConfiguration")}(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4}(t.MessageType||(t.MessageType={})),function(e){e.type=new r.ProtocolNotificationType("window/showMessage")}(t.ShowMessageNotification||(t.ShowMessageNotification={})),function(e){e.type=new r.ProtocolRequestType("window/showMessageRequest")}(t.ShowMessageRequest||(t.ShowMessageRequest={})),function(e){e.type=new r.ProtocolNotificationType("window/logMessage")}(t.LogMessageNotification||(t.LogMessageNotification={})),function(e){e.type=new r.ProtocolNotificationType("telemetry/event")}(t.TelemetryEventNotification||(t.TelemetryEventNotification={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})),function(e){e.method="textDocument/didOpen",e.type=new r.ProtocolNotificationType(e.method)}(t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})),function(e){e.method="textDocument/didChange",e.type=new r.ProtocolNotificationType(e.method)}(t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})),function(e){e.method="textDocument/didClose",e.type=new r.ProtocolNotificationType(e.method)}(t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})),function(e){e.method="textDocument/didSave",e.type=new r.ProtocolNotificationType(e.method)}(t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})),function(e){e.method="textDocument/willSave",e.type=new r.ProtocolNotificationType(e.method)}(t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})),function(e){e.method="textDocument/willSaveWaitUntil",e.type=new r.ProtocolRequestType(e.method)}(t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})),function(e){e.type=new r.ProtocolNotificationType("workspace/didChangeWatchedFiles")}(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(t.FileChangeType||(t.FileChangeType={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(t.WatchKind||(t.WatchKind={})),function(e){e.type=new r.ProtocolNotificationType("textDocument/publishDiagnostics")}(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(t.CompletionTriggerKind||(t.CompletionTriggerKind={})),function(e){e.method="textDocument/completion",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.CompletionRequest||(t.CompletionRequest={})),function(e){e.method="completionItem/resolve",e.type=new r.ProtocolRequestType(e.method)}(t.CompletionResolveRequest||(t.CompletionResolveRequest={})),function(e){e.method="textDocument/hover",e.type=new r.ProtocolRequestType(e.method)}(t.HoverRequest||(t.HoverRequest={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})),function(e){e.method="textDocument/signatureHelp",e.type=new r.ProtocolRequestType(e.method)}(t.SignatureHelpRequest||(t.SignatureHelpRequest={})),function(e){e.method="textDocument/definition",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DefinitionRequest||(t.DefinitionRequest={})),function(e){e.method="textDocument/references",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.ReferencesRequest||(t.ReferencesRequest={})),function(e){e.method="textDocument/documentHighlight",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})),function(e){e.method="textDocument/documentSymbol",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})),function(e){e.method="textDocument/codeAction",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.CodeActionRequest||(t.CodeActionRequest={})),function(e){e.method="workspace/symbol",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})),function(e){e.type=new r.ProtocolRequestType("textDocument/codeLens"),e.resultType=new n.ProgressType}(t.CodeLensRequest||(t.CodeLensRequest={})),function(e){e.type=new r.ProtocolRequestType("codeLens/resolve")}(t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})),function(e){e.method="textDocument/documentLink",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DocumentLinkRequest||(t.DocumentLinkRequest={})),function(e){e.type=new r.ProtocolRequestType("documentLink/resolve")}(t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})),function(e){e.method="textDocument/formatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})),function(e){e.method="textDocument/rangeFormatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})),function(e){e.method="textDocument/onTypeFormatting",e.type=new r.ProtocolRequestType(e.method)}(t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})),function(e){e.method="textDocument/rename",e.type=new r.ProtocolRequestType(e.method)}(t.RenameRequest||(t.RenameRequest={})),function(e){e.method="textDocument/prepareRename",e.type=new r.ProtocolRequestType(e.method)}(t.PrepareRenameRequest||(t.PrepareRenameRequest={})),function(e){e.type=new r.ProtocolRequestType("workspace/executeCommand")}(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})),function(e){e.type=new r.ProtocolRequestType("workspace/applyEdit")}(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={}))},function(e,t,i){"use strict";function s(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=s,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every(e=>s(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.method="textDocument/implementation",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.ImplementationRequest||(t.ImplementationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.method="textDocument/typeDefinition",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.TypeDefinitionRequest||(t.TypeDefinitionRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(15);!function(e){e.type=new s.ProtocolRequestType0("workspace/workspaceFolders")}(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})),function(e){e.type=new s.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")}(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(15);!function(e){e.type=new s.ProtocolRequestType("workspace/configuration")}(t.ConfigurationRequest||(t.ConfigurationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.method="textDocument/documentColor",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DocumentColorRequest||(t.DocumentColorRequest={})),function(e){e.type=new n.ProtocolRequestType("textDocument/colorPresentation")}(t.ColorPresentationRequest||(t.ColorPresentationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(t.FoldingRangeKind||(t.FoldingRangeKind={})),function(e){e.method="textDocument/foldingRange",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.FoldingRangeRequest||(t.FoldingRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.method="textDocument/declaration",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.DeclarationRequest||(t.DeclarationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.method="textDocument/selectionRange",e.type=new n.ProtocolRequestType(e.method),e.resultType=new s.ProgressType}(t.SelectionRangeRequest||(t.SelectionRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(20),n=i(15);!function(e){e.type=new s.ProgressType}(t.WorkDoneProgress||(t.WorkDoneProgress={})),function(e){e.type=new n.ProtocolRequestType("window/workDoneProgress/create")}(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})),function(e){e.type=new n.ProtocolNotificationType("window/workDoneProgress/cancel")}(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(15);!function(e){e.method="textDocument/prepareCallHierarchy",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})),function(e){e.method="callHierarchy/incomingCalls",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})),function(e){e.method="callHierarchy/outgoingCalls",e.type=new s.ProtocolRequestType(e.method)}(t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(15);!function(e){e.comment="comment",e.keyword="keyword",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.namespace="namespace",e.type="type",e.struct="struct",e.class="class",e.interface="interface",e.enum="enum",e.typeParameter="typeParameter",e.function="function",e.member="member",e.property="property",e.macro="macro",e.variable="variable",e.parameter="parameter",e.label="label"}(t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e.documentation="documentation",e.declaration="declaration",e.definition="definition",e.reference="reference",e.static="static",e.abstract="abstract",e.deprecated="deprecated",e.async="async",e.volatile="volatile",e.readonly="readonly"}(t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(t.SemanticTokens||(t.SemanticTokens={})),function(e){e.method="textDocument/semanticTokens",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensRequest||(t.SemanticTokensRequest={})),function(e){e.method="textDocument/semanticTokens/edits",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensEditsRequest||(t.SemanticTokensEditsRequest={})),function(e){e.method="textDocument/semanticTokens/range",e.type=new s.ProtocolRequestType(e.method)}(t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(35),o=i(88),a=i(89),c=i(90);t.createConverter=function(e){const t=e||(e=>e.toString());function i(e){return t(e)}function l(e){return{uri:t(e.uri)}}function u(e){return{uri:t(e.uri),version:e.version}}function d(e){switch(e){case s.TextDocumentSaveReason.Manual:return n.TextDocumentSaveReason.Manual;case s.TextDocumentSaveReason.AfterDelay:return n.TextDocumentSaveReason.AfterDelay;case s.TextDocumentSaveReason.FocusOut:return n.TextDocumentSaveReason.FocusOut}return n.TextDocumentSaveReason.Manual}function h(e){switch(e){case s.CompletionTriggerKind.TriggerCharacter:return n.CompletionTriggerKind.TriggerCharacter;case s.CompletionTriggerKind.TriggerForIncompleteCompletions:return n.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return n.CompletionTriggerKind.Invoked}}function p(e){switch(e){case s.SignatureHelpTriggerKind.Invoke:return n.SignatureHelpTriggerKind.Invoked;case s.SignatureHelpTriggerKind.TriggerCharacter:return n.SignatureHelpTriggerKind.TriggerCharacter;case s.SignatureHelpTriggerKind.ContentChange:return n.SignatureHelpTriggerKind.ContentChange}}function g(e){return{label:e.label}}function f(e){return{label:e.label,parameters:(t=e.parameters,t.map(g))};var t}function m(e){return{line:e.line,character:e.character}}function v(e){return null==e?e:{line:e.line,character:e.character}}function y(e){if(null==e)return e;if(function(e){const t=e;return t&&!!t.inserting&&!!t.replacing}(e))throw new Error("Receving unknown insert replace range.");return{start:v(e.start),end:v(e.end)}}function b(e){return null==e?e:n.Location.create(i(e.uri),y(e.range))}function w(e){switch(e){case s.DiagnosticSeverity.Error:return n.DiagnosticSeverity.Error;case s.DiagnosticSeverity.Warning:return n.DiagnosticSeverity.Warning;case s.DiagnosticSeverity.Information:return n.DiagnosticSeverity.Information;case s.DiagnosticSeverity.Hint:return n.DiagnosticSeverity.Hint}}function S(e){switch(e){case s.DiagnosticTag.Unnecessary:return n.DiagnosticTag.Unnecessary;case s.DiagnosticTag.Deprecated:return n.DiagnosticTag.Deprecated;default:return}}function C(e){return{message:e.message,location:b(e.location)}}function T(e){let t=n.Diagnostic.create(y(e.range),e.message);return r.number(e.severity)&&(t.severity=w(e.severity)),(r.number(e.code)||r.string(e.code))&&(t.code=e.code),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=S(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(C)),e.source&&(t.source=e.source),t}function E(e){return null==e?e:e.map(T)}function R(e){switch(e){case s.CompletionItemTag.Deprecated:return n.CompletionItemTag.Deprecated}}function P(e){return{range:y(e.range),newText:e.newText}}function D(e){return e}function _(e){let t=n.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}return{asUri:i,asTextDocumentIdentifier:l,asVersionedTextDocumentIdentifier:u,asOpenTextDocumentParams:function(e){return{textDocument:{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}},asChangeTextDocumentParams:function(e){if(function(e){let t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){let t=e;return!!t.document&&!!t.contentChanges}(e)){let i=e.document;return{textDocument:{uri:t(i.uri),version:i.version},contentChanges:e.contentChanges.map(e=>{let t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}})}}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:l(e)}},asSaveTextDocumentParams:function(e,t=!1){let i={textDocument:u(e)};return t&&(i.text=e.getText()),i},asWillSaveTextDocumentParams:function(e){return{textDocument:l(e.document),reason:d(e.reason)}},asTextDocumentPositionParams:function(e,t){return{textDocument:l(e),position:m(t)}},asCompletionParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{triggerKind:h(i.triggerKind),triggerCharacter:i.triggerCharacter}}},asSignatureHelpParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{isRetrigger:i.isRetrigger,triggerCharacter:i.triggerCharacter,triggerKind:p(i.triggerKind),activeSignatureHelp:(s=i.activeSignatureHelp,void 0===s?s:{signatures:(n=s.signatures,n.map(f)),activeSignature:s.activeSignature,activeParameter:s.activeParameter})}};var s,n},asWorkerPosition:m,asRange:y,asPosition:v,asPositions:function(e){let t=[];for(let i of e)t.push(v(i));return t},asLocation:b,asDiagnosticSeverity:w,asDiagnosticTag:S,asDiagnostic:T,asDiagnostics:E,asCompletionItem:function(e){let t={label:e.label},i=e instanceof o.default?e:void 0;var a,c;e.detail&&(t.detail=e.detail),e.documentation&&(i&&"$string"!==i.documentationFormat?t.documentation=function(e,t){switch(e){case"$string":return t;case n.MarkupKind.PlainText:return{kind:e,value:t};case n.MarkupKind.Markdown:return{kind:e,value:t.value};default:return"Unsupported Markup content received. Kind is: "+e}}(i.documentationFormat,e.documentation):t.documentation=e.documentation),e.filterText&&(t.filterText=e.filterText),function(e,t){let i=n.InsertTextFormat.PlainText,r=void 0,o=void 0;t.textEdit?(r=t.textEdit.newText,o=y(t.textEdit.range)):t.insertText instanceof s.SnippetString?(i=n.InsertTextFormat.Snippet,r=t.insertText.value):r=t.insertText;t.range&&(o=y(t.range));e.insertTextFormat=i,t.fromEdit&&void 0!==r&&void 0!==o?e.textEdit={newText:r,range:o}:e.insertText=r}(t,e),r.number(e.kind)&&(t.kind=(a=e.kind,void 0!==(c=i&&i.originalItemKind)?c:a+1)),e.sortText&&(t.sortText=e.sortText),e.additionalTextEdits&&(t.additionalTextEdits=function(e){if(null==e)return e;return e.map(P)}(e.additionalTextEdits)),e.commitCharacters&&(t.commitCharacters=e.commitCharacters.slice()),e.command&&(t.command=_(e.command)),!0!==e.preselect&&!1!==e.preselect||(t.preselect=e.preselect);const l=function(e){if(void 0===e)return e;const t=[];for(let i of e){const e=R(i);void 0!==e&&t.push(e)}return t}(e.tags);if(i&&(void 0!==i.data&&(t.data=i.data),!0===i.deprecated||!1===i.deprecated)){if(!0===i.deprecated&&void 0!==l&&l.length>0){const e=l.indexOf(s.CompletionItemTag.Deprecated);-1!==e&&l.splice(e,1)}t.deprecated=i.deprecated}return void 0!==l&&l.length>0&&(t.tags=l),t},asTextEdit:P,asSymbolKind:function(e){return e<=s.SymbolKind.TypeParameter?e+1:n.SymbolKind.Property},asSymbolTag:D,asSymbolTags:function(e){return e.map(D)},asReferenceParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{includeDeclaration:i.includeDeclaration}}},asCodeActionContext:function(e){if(null==e)return e;let t;return e.only&&r.string(e.only.value)&&(t=[e.only.value]),n.CodeActionContext.create(E(e.diagnostics),t)},asCommand:_,asCodeLens:function(e){let t=n.CodeLens.create(y(e.range));return e.command&&(t.command=_(e.command)),e instanceof a.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e){return{tabSize:e.tabSize,insertSpaces:e.insertSpaces}},asDocumentSymbolParams:function(e){return{textDocument:l(e)}},asCodeLensParams:function(e){return{textDocument:l(e)}},asDocumentLink:function(e){let t=n.DocumentLink.create(y(e.range));e.target&&(t.target=i(e.target)),void 0!==e.tooltip&&(t.tooltip=e.tooltip);let s=e instanceof c.default?e:void 0;return s&&s.data&&(t.data=s.data),t},asDocumentLinkParams:function(e){return{textDocument:l(e)}}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(35),o=i(88),a=i(89),c=i(90);var l;!function(e){e.is=function(e){let t=e;return t&&r.string(t.language)&&r.string(t.value)}}(l||(l={})),t.createConverter=function(e){const t=e||(e=>s.Uri.parse(e));function i(e){return t(e)}function u(e){return e.map(d)}function d(e){let t=new s.Diagnostic(f(e.range),e.message,m(e.severity));return(r.number(e.code)||r.string(e.code))&&(t.code=e.code),e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(h)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=p(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),t}function h(e){return new s.DiagnosticRelatedInformation(P(e.location),e.message)}function p(e){switch(e){case n.DiagnosticTag.Unnecessary:return s.DiagnosticTag.Unnecessary;case n.DiagnosticTag.Deprecated:return s.DiagnosticTag.Deprecated;default:return}}function g(e){if(e)return new s.Position(e.line,e.character)}function f(e){if(e)return new s.Range(g(e.start),g(e.end))}function m(e){if(null==e)return s.DiagnosticSeverity.Error;switch(e){case n.DiagnosticSeverity.Error:return s.DiagnosticSeverity.Error;case n.DiagnosticSeverity.Warning:return s.DiagnosticSeverity.Warning;case n.DiagnosticSeverity.Information:return s.DiagnosticSeverity.Information;case n.DiagnosticSeverity.Hint:return s.DiagnosticSeverity.Hint}return s.DiagnosticSeverity.Error}function v(e){if(r.string(e))return e;switch(e.kind){case n.MarkupKind.Markdown:return new s.MarkdownString(e.value);case n.MarkupKind.PlainText:return e.value;default:return"Unsupported Markup content received. Kind is: "+e.kind}}function y(e){switch(e){case n.CompletionItemTag.Deprecated:return s.CompletionItemTag.Deprecated}}function b(e){let t=function(e){if(null==e)return[];const t=[];for(let i of e){const e=y(i);void 0!==e&&t.push(e)}return t}(e.tags),i=new o.default(e.label);e.detail&&(i.detail=e.detail),e.documentation&&(i.documentation=v(e.documentation),i.documentationFormat=r.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(i.filterText=e.filterText);let a=function(e){return e.textEdit?e.insertTextFormat===n.InsertTextFormat.Snippet?{text:new s.SnippetString(e.textEdit.newText),range:f(e.textEdit.range),fromEdit:!0}:{text:e.textEdit.newText,range:f(e.textEdit.range),fromEdit:!0}:e.insertText?e.insertTextFormat===n.InsertTextFormat.Snippet?{text:new s.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0}(e);if(a&&(i.insertText=a.text,i.range=a.range,i.fromEdit=a.fromEdit),r.number(e.kind)){let[t,r]=(c=e.kind,n.CompletionItemKind.Text<=c&&c<=n.CompletionItemKind.TypeParameter?[c-1,void 0]:[s.CompletionItemKind.Text,c]);i.kind=t,r&&(i.originalItemKind=r)}var c;return e.sortText&&(i.sortText=e.sortText),e.additionalTextEdits&&(i.additionalTextEdits=S(e.additionalTextEdits)),r.stringArray(e.commitCharacters)&&(i.commitCharacters=e.commitCharacters.slice()),e.command&&(i.command=A(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(i.deprecated=e.deprecated,!0===e.deprecated&&t.push(s.CompletionItemTag.Deprecated)),!0!==e.preselect&&!1!==e.preselect||(i.preselect=e.preselect),void 0!==e.data&&(i.data=e.data),t.length>0&&(i.tags=t),i}function w(e){if(e)return new s.TextEdit(f(e.range),e.newText)}function S(e){if(e)return e.map(w)}function C(e){return e.map(T)}function T(e){let t=new s.SignatureInformation(e.label);return e.documentation&&(t.documentation=v(e.documentation)),e.parameters&&(t.parameters=E(e.parameters)),t}function E(e){return e.map(R)}function R(e){let t=new s.ParameterInformation(e.label);return e.documentation&&(t.documentation=v(e.documentation)),t}function P(e){if(e)return new s.Location(t(e.uri),f(e.range))}function D(e){if(!e)return;let i={targetUri:t(e.targetUri),targetRange:f(e.targetSelectionRange),originSelectionRange:f(e.originSelectionRange),targetSelectionRange:f(e.targetSelectionRange)};if(!i.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return i}function _(e){if(e){if(r.array(e)){if(0===e.length)return[];if(n.LocationLink.is(e[0])){return e.map(e=>D(e))}return e.map(e=>P(e))}return n.LocationLink.is(e)?[D(e)]:P(e)}}function k(e){let t=new s.DocumentHighlight(f(e.range));return r.number(e.kind)&&(t.kind=x(e.kind)),t}function x(e){switch(e){case n.DocumentHighlightKind.Text:return s.DocumentHighlightKind.Text;case n.DocumentHighlightKind.Read:return s.DocumentHighlightKind.Read;case n.DocumentHighlightKind.Write:return s.DocumentHighlightKind.Write}return s.DocumentHighlightKind.Text}function O(e){return e<=n.SymbolKind.TypeParameter?e-1:s.SymbolKind.Property}function F(e){return e}function I(e,i){let n=new s.SymbolInformation(e.name,O(e.kind),f(e.location.range),e.location.uri?t(e.location.uri):i);return e.containerName&&(n.containerName=e.containerName),n}function L(e){let t=new s.DocumentSymbol(e.name,e.detail||"",O(e.kind),f(e.range),f(e.selectionRange));if(void 0!==e.children&&e.children.length>0){let i=[];for(let t of e.children)i.push(L(t));t.children=i}return t}function A(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const N=new Map;function M(e){if(null==e)return;let t=N.get(e);if(t)return t;let i=e.split(".");t=s.CodeActionKind.Empty;for(let e of i)t=t.append(e);return t}function U(e){if(!e)return;let t=new a.default(f(e.range));return e.command&&(t.command=A(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}function q(e){if(!e)return;let i=new s.WorkspaceEdit;return e.documentChanges?e.documentChanges.forEach(e=>{n.CreateFile.is(e)?i.createFile(t(e.uri),e.options):n.RenameFile.is(e)?i.renameFile(t(e.oldUri),t(e.newUri),e.options):n.DeleteFile.is(e)?i.deleteFile(t(e.uri),e.options):n.TextDocumentEdit.is(e)?i.set(t(e.textDocument.uri),S(e.edits)):console.error("Unknown workspace edit change received:\n"+JSON.stringify(e,void 0,4))}):e.changes&&Object.keys(e.changes).forEach(s=>{i.set(t(s),S(e.changes[s]))}),i}function $(e){let t=f(e.range),s=e.target?i(e.target):void 0,n=new c.default(t,s);return void 0!==e.tooltip&&(n.tooltip=e.tooltip),void 0!==e.data&&null!==e.data&&(n.data=e.data),n}function j(e){return new s.Color(e.red,e.green,e.blue,e.alpha)}function W(e){return new s.ColorInformation(f(e.range),j(e.color))}function z(e){let t=new s.ColorPresentation(e.label);return t.additionalTextEdits=S(e.additionalTextEdits),e.textEdit&&(t.textEdit=w(e.textEdit)),t}function B(e){if(e)switch(e){case n.FoldingRangeKind.Comment:return s.FoldingRangeKind.Comment;case n.FoldingRangeKind.Imports:return s.FoldingRangeKind.Imports;case n.FoldingRangeKind.Region:return s.FoldingRangeKind.Region}}function G(e){return new s.FoldingRange(e.startLine,e.endLine,B(e.kind))}function V(e){return new s.SelectionRange(f(e.range),e.parent?V(e.parent):void 0)}return N.set(n.CodeActionKind.Empty,s.CodeActionKind.Empty),N.set(n.CodeActionKind.QuickFix,s.CodeActionKind.QuickFix),N.set(n.CodeActionKind.Refactor,s.CodeActionKind.Refactor),N.set(n.CodeActionKind.RefactorExtract,s.CodeActionKind.RefactorExtract),N.set(n.CodeActionKind.RefactorInline,s.CodeActionKind.RefactorInline),N.set(n.CodeActionKind.RefactorRewrite,s.CodeActionKind.RefactorRewrite),N.set(n.CodeActionKind.Source,s.CodeActionKind.Source),N.set(n.CodeActionKind.SourceOrganizeImports,s.CodeActionKind.SourceOrganizeImports),{asUri:i,asDiagnostics:u,asDiagnostic:d,asRange:f,asRanges:function(e){return e.map(e=>f(e))},asPosition:g,asDiagnosticSeverity:m,asDiagnosticTag:p,asHover:function(e){if(e)return new s.Hover(function(e){if(r.string(e))return new s.MarkdownString(e);if(l.is(e)){return(new s.MarkdownString).appendCodeblock(e.value,e.language)}if(Array.isArray(e)){let t=[];for(let i of e){let e=new s.MarkdownString;l.is(i)?e.appendCodeblock(i.value,i.language):e.appendMarkdown(i),t.push(e)}return t}{let t;switch(e.kind){case n.MarkupKind.Markdown:return new s.MarkdownString(e.value);case n.MarkupKind.PlainText:return t=new s.MarkdownString,t.appendText(e.value),t;default:return t=new s.MarkdownString,t.appendText("Unsupported Markup content received. Kind is: "+e.kind),t}}}(e.contents),f(e.range))},asCompletionResult:function(e){if(!e)return;if(Array.isArray(e)){return e.map(b)}let t=e;return new s.CompletionList(t.items.map(b),t.isIncomplete)},asCompletionItem:b,asTextEdit:w,asTextEdits:S,asSignatureHelp:function(e){if(!e)return;let t=new s.SignatureHelp;return r.number(e.activeSignature)?t.activeSignature=e.activeSignature:t.activeSignature=0,r.number(e.activeParameter)?t.activeParameter=e.activeParameter:t.activeParameter=0,e.signatures&&(t.signatures=C(e.signatures)),t},asSignatureInformations:C,asSignatureInformation:T,asParameterInformations:E,asParameterInformation:R,asDeclarationResult:function(e){if(e)return _(e)},asDefinitionResult:function(e){if(e)return _(e)},asLocation:P,asReferences:function(e){if(e)return e.map(e=>P(e))},asDocumentHighlights:function(e){if(e)return e.map(k)},asDocumentHighlight:k,asDocumentHighlightKind:x,asSymbolKind:O,asSymbolTag:F,asSymbolTags:function(e){if(null!=e)return e.map(F)},asSymbolInformations:function(e,t){if(e)return e.map(e=>I(e,t))},asSymbolInformation:I,asDocumentSymbols:function(e){if(null!=e)return e.map(L)},asDocumentSymbol:L,asCommand:A,asCommands:function(e){if(e)return e.map(A)},asCodeAction:function(e){if(null==e)return;let t=new s.CodeAction(e.title);return void 0!==e.kind&&(t.kind=M(e.kind)),e.diagnostics&&(t.diagnostics=u(e.diagnostics)),e.edit&&(t.edit=q(e.edit)),e.command&&(t.command=A(e.command)),void 0!==e.isPreferred&&(t.isPreferred=e.isPreferred),t},asCodeActionKind:M,asCodeActionKinds:function(e){if(null!=e)return e.map(e=>M(e))},asCodeLens:U,asCodeLenses:function(e){if(e)return e.map(e=>U(e))},asWorkspaceEdit:q,asDocumentLink:$,asDocumentLinks:function(e){if(e)return e.map($)},asFoldingRangeKind:B,asFoldingRange:G,asFoldingRanges:function(e){if(Array.isArray(e))return e.map(G)},asColor:j,asColorInformation:W,asColorInformations:function(e){if(Array.isArray(e))return e.map(W)},asColorPresentation:z,asColorPresentations:function(e){if(Array.isArray(e))return e.map(z)},asSelectionRange:V,asSelectionRanges:function(e){if(!Array.isArray(e))return[];let t=[];for(let i of e)t.push(V(i));return t}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(e=>{this.onSuccess=e}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e})),(t>=0||void 0===this.timeout)&&(this.timeout=setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.DocumentColorRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[i,s]=this.getRegistration(t,e.colorProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideColorPresentations:(e,t,i)=>{const s=this._client,r=(e,t,i)=>{const r={color:e,textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:s.code2ProtocolConverter.asRange(t.range)};return s.sendRequest(n.ColorPresentationRequest.type,r,i).then(this.asColorPresentations.bind(this),e=>(s.logFailedRequest(n.ColorPresentationRequest.type,e),Promise.resolve(null)))},o=s.clientOptions.middleware;return o.provideColorPresentations?o.provideColorPresentations(e,t,i,r):r(e,t,i)},provideDocumentColors:(e,t)=>{const i=this._client,s=(e,t)=>{const s={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(n.DocumentColorRequest.type,s,t).then(this.asColorInformations.bind(this),e=>(i.logFailedRequest(n.ColorPresentationRequest.type,e),Promise.resolve(null)))},r=i.clientOptions.middleware;return r.provideDocumentColors?r.provideDocumentColors(e,t,s):s(e,t)}};return[s.languages.registerColorProvider(e.documentSelector,t),t]}asColor(e){return new s.Color(e.red,e.green,e.blue,e.alpha)}asColorInformations(e){return Array.isArray(e)?e.map(e=>new s.ColorInformation(this._client.protocol2CodeConverter.asRange(e.range),this.asColor(e.color))):[]}asColorPresentations(e){return Array.isArray(e)?e.map(e=>{let t=new s.ColorPresentation(e.label);return t.additionalTextEdits=this._client.protocol2CodeConverter.asTextEdits(e.additionalTextEdits),t.textEdit=this._client.protocol2CodeConverter.asTextEdit(e.textEdit),t}):[]}}t.ColorProviderFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10);t.ConfigurationFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(n.ConfigurationRequest.type,(t,i)=>{let s=e=>{let t=[];for(let i of e.items){let e=void 0!==i.scopeUri&&null!==i.scopeUri?this._client.protocol2CodeConverter.asUri(i.scopeUri):void 0;t.push(this.getConfiguration(e,null!==i.section?i.section:void 0))}return t},n=e.clientOptions.middleware.workspace;return n&&n.configuration?n.configuration(t,i,s):s(t)})}getConfiguration(e,t){let i=null;if(t){let n=t.lastIndexOf(".");if(-1===n)i=s.workspace.getConfiguration(void 0,e).get(t);else{let r=s.workspace.getConfiguration(t.substr(0,n),e);r&&(i=r.get(t.substr(n+1)))}}else{let t=s.workspace.getConfiguration(void 0,e);i={};for(let e of Object.keys(t))t.has(e)&&(i[e]=t.get(e))}return i||null}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.ImplementationRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,s]=this.getRegistration(t,e.implementationProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideImplementation:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.ImplementationRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asDefinitionResult,e=>(s.logFailedRequest(n.ImplementationRequest.type,e),Promise.resolve(null))),o=s.clientOptions.middleware;return o.provideImplementation?o.provideImplementation(e,t,i,r):r(e,t,i)}};return[s.languages.registerImplementationProvider(e.documentSelector,t),t]}}t.ImplementationFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.TypeDefinitionRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=o(o(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,s]=this.getRegistration(t,e.typeDefinitionProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideTypeDefinition:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.TypeDefinitionRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asDefinitionResult,e=>(s.logFailedRequest(n.TypeDefinitionRequest.type,e),Promise.resolve(null))),o=s.clientOptions.middleware;return o.provideTypeDefinition?o.provideTypeDefinition(e,t,i,r):r(e,t,i)}};return[s.languages.registerTypeDefinitionProvider(e.documentSelector,t),t]}}t.TypeDefinitionFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(91),n=i(0),r=i(10);function o(e,t){if(void 0!==e)return e[t]}function a(e,t){return e.filter(e=>t.indexOf(e)<0)}t.arrayDiff=a;t.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}get messages(){return r.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=n.workspace.workspaceFolders;this.initializeWithFolders(t),e.workspaceFolders=void 0===t?null:t.map(e=>this.asProtocol(e))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(r.WorkspaceFoldersRequest.type,e=>{let i=()=>{let e=n.workspace.workspaceFolders;return void 0===e?null:e.map(e=>this.asProtocol(e))},s=t.clientOptions.middleware.workspace;return s&&s.workspaceFolders?s.workspaceFolders(e,i):i()});let i,a=o(o(o(e,"workspace"),"workspaceFolders"),"changeNotifications");"string"==typeof a?i=a:!0===a&&(i=s.generateUuid()),i&&this.register(this.messages,{id:i,registerOptions:void 0})}sendInitialEvent(e){if(this._initialFolders&&e){const t=a(this._initialFolders,e),i=a(e,this._initialFolders);(i.length>0||t.length>0)&&this.doSendEvent(i,t)}else this._initialFolders?this.doSendEvent([],this._initialFolders):e&&this.doSendEvent(e,[])}doSendEvent(e,t){let i={event:{added:e.map(e=>this.asProtocol(e)),removed:t.map(e=>this.asProtocol(e))}};this._client.sendNotification(r.DidChangeWorkspaceFoldersNotification.type,i)}register(e,t){let i=t.id,s=this._client,r=n.workspace.onDidChangeWorkspaceFolders(e=>{let t=e=>{this.doSendEvent(e.added,e.removed)},i=s.clientOptions.middleware.workspace;i&&i.didChangeWorkspaceFolders?i.didChangeWorkspaceFolders(e,t):t(e)});this._listeners.set(i,r),this.sendInitialEvent(n.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[i,s]=this.getRegistration(t,e.foldingRangeProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideFoldingRanges:(e,t,i)=>{const s=this._client,r=(e,t,i)=>{const r={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e)};return s.sendRequest(n.FoldingRangeRequest.type,r,i).then(this.asFoldingRanges.bind(this),e=>(s.logFailedRequest(n.FoldingRangeRequest.type,e),Promise.resolve(null)))},o=s.clientOptions.middleware;return o.provideFoldingRanges?o.provideFoldingRanges(e,t,i,r):r(e,0,i)}};return[s.languages.registerFoldingRangeProvider(e.documentSelector,t),t]}asFoldingRangeKind(e){if(e)switch(e){case n.FoldingRangeKind.Comment:return s.FoldingRangeKind.Comment;case n.FoldingRangeKind.Imports:return s.FoldingRangeKind.Imports;case n.FoldingRangeKind.Region:return s.FoldingRangeKind.Region}}asFoldingRanges(e){return Array.isArray(e)?e.map(e=>new s.FoldingRange(e.startLine,e.endLine,this.asFoldingRangeKind(e.kind))):[]}}t.FoldingRangeFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.DeclarationRequest.type)}fillClientCapabilities(e){const t=o(o(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[i,s]=this.getRegistration(t,e.declarationProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideDeclaration:(e,t,i)=>{const s=this._client,r=(e,t,i)=>s.sendRequest(n.DeclarationRequest.type,s.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(s.protocol2CodeConverter.asDeclarationResult,e=>(s.logFailedRequest(n.DeclarationRequest.type,e),Promise.resolve(null))),o=s.clientOptions.middleware;return o.provideDeclaration?o.provideDeclaration(e,t,i,r):r(e,t,i)}};return[s.languages.registerDeclarationProvider(e.documentSelector,t),t]}}t.DeclarationFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]=Object.create(null)),e[t]}class a extends r.TextDocumentFeature{constructor(e){super(e,n.SelectionRangeRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"selectionRange").dynamicRegistration=!0}initialize(e,t){let[i,s]=this.getRegistration(t,e.selectionRangeProvider);i&&s&&this.register(this.messages,{id:i,registerOptions:s})}registerLanguageProvider(e){const t={provideSelectionRanges:(e,t,i)=>{const s=this._client,r=(e,t,i)=>{const r={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),positions:s.code2ProtocolConverter.asPositions(t)};return s.sendRequest(n.SelectionRangeRequest.type,r,i).then(e=>s.protocol2CodeConverter.asSelectionRanges(e),e=>(s.logFailedRequest(n.SelectionRangeRequest.type,e),Promise.resolve(null)))},o=s.clientOptions.middleware;return o.provideSelectionRanges?o.provideSelectionRanges(e,t,i,r):r(e,t,i)}};return[s.languages.registerSelectionRangeProvider(e.documentSelector,t),t]}}t.SelectionRangeFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(10),n=i(92);t.ProgressFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){var t,i;(t=e,i="window",void 0===t[i]&&(t[i]=Object.create(null)),t[i]).workDoneProgress=!0}initialize(){this._client.onRequest(s.WorkDoneProgressCreateRequest.type,e=>{new n.ProgressPart(this._client,e.token)})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(10),r=i(19);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var a,c;!function(e){function t(e,t){if(null===t)return;let i=new s.CallHierarchyItem(e.asSymbolKind(t.kind),t.name,t.detail||"",e.asUri(t.uri),e.asRange(t.range),e.asRange(t.selectionRange));return void 0!==t.tags&&(i.tags=e.asSymbolTags(t.tags)),i}function i(e,i){return new s.CallHierarchyIncomingCall(t(e,i.from),e.asRanges(i.fromRanges))}function n(e,i){return new s.CallHierarchyOutgoingCall(t(e,i.to),e.asRanges(i.fromRanges))}e.asCallHierarchyItem=t,e.asCallHierarchyItems=function(e,i){if(null===i)return;return i.map(i=>t(e,i))[0]},e.asCallHierarchyIncomingCall=i,e.asCallHierarchyIncomingCalls=function(e,t){if(null!==t)return t.map(t=>i(e,t))},e.asCallHierarchyOutgoingCall=n,e.asCallHierarchyOutgoingCalls=function(e,t){if(null!==t)return t.map(t=>n(e,t))}}(a||(a={})),function(e){e.asCallHierarchyItem=function(e,t){const i={name:t.name,kind:e.asSymbolKind(t.kind),uri:e.asUri(t.uri),range:e.asRange(t.range),selectionRange:e.asRange(t.selectionRange)};return void 0!==t.detail&&t.detail.length>0&&(i.detail=t.detail),void 0!==t.tags&&(i.tags=e.asSymbolTags(t.tags)),i}}(c||(c={}));class l{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,i){const s=this.client,r=this.middleware,o=(e,t,i)=>{const r=s.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return s.sendRequest(n.Proposed.CallHierarchyPrepareRequest.type,r,i).then(e=>a.asCallHierarchyItems(this.client.protocol2CodeConverter,e),e=>(s.logFailedRequest(n.Proposed.CallHierarchyPrepareRequest.type,e),Promise.resolve(null)))};return r.prepareCallHierarchy?r.prepareCallHierarchy(e,t,i,o):o(e,t,i)}provideCallHierarchyIncomingCalls(e,t){const i=this.client,s=this.middleware,r=(e,t)=>{const s={item:c.asCallHierarchyItem(i.code2ProtocolConverter,e)};return i.sendRequest(n.Proposed.CallHierarchyIncomingCallsRequest.type,s,t).then(e=>a.asCallHierarchyIncomingCalls(i.protocol2CodeConverter,e),e=>(i.logFailedRequest(n.Proposed.CallHierarchyIncomingCallsRequest.type,e),Promise.resolve(null)))};return s.provideCallHierarchyIncomingCalls?s.provideCallHierarchyIncomingCalls(e,t,r):r(e,t)}provideCallHierarchyOutgoingCalls(e,t){const i=this.client,s=this.middleware,r=(e,t)=>{const s={item:c.asCallHierarchyItem(i.code2ProtocolConverter,e)};return i.sendRequest(n.Proposed.CallHierarchyOutgoingCallsRequest.type,s,t).then(e=>a.asCallHierarchyOutgoingCalls(i.protocol2CodeConverter,e),e=>(i.logFailedRequest(n.Proposed.CallHierarchyOutgoingCallsRequest.type,e),Promise.resolve(null)))};return s.provideCallHierarchyOutgingCalls?s.provideCallHierarchyOutgingCalls(e,t,r):r(e,t)}}class u extends r.TextDocumentFeature{constructor(e){super(e,n.Proposed.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"callHierarchy").dynamicRegistration=!0}initialize(e,t){const i=e,[s,n]=this.getRegistration(t,i.callHierarchyProvider);s&&n&&this.register(this.messages,{id:s,registerOptions:n})}registerLanguageProvider(e){const t=this._client,i=new l(t);return[s.languages.registerCallHierarchyProvider(e.documentSelector,i),i]}}t.CallHierarchyFeature=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(19),r=i(10);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var a;!function(e){function t(e){return new s.SemanticTokensEdit(e.start,e.deleteCount,void 0!==e.data?new Uint32Array(e.data):void 0)}e.asSemanticTokens=function(e){if(null!=e)return new s.SemanticTokens(new Uint32Array(e.data),e.resultId)},e.asSemanticTokensEdit=t,e.asSemanticTokensEdits=function(e){if(null!=e)return new s.SemanticTokensEdits(e.edits.map(t),e.resultId)},e.asLegend=function(e){return e}}(a||(a={}));class c extends n.TextDocumentFeature{constructor(e){super(e,r.Proposed.SemanticTokensRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[r.Proposed.SemanticTokenTypes.comment,r.Proposed.SemanticTokenTypes.keyword,r.Proposed.SemanticTokenTypes.number,r.Proposed.SemanticTokenTypes.regexp,r.Proposed.SemanticTokenTypes.operator,r.Proposed.SemanticTokenTypes.namespace,r.Proposed.SemanticTokenTypes.type,r.Proposed.SemanticTokenTypes.struct,r.Proposed.SemanticTokenTypes.class,r.Proposed.SemanticTokenTypes.interface,r.Proposed.SemanticTokenTypes.enum,r.Proposed.SemanticTokenTypes.typeParameter,r.Proposed.SemanticTokenTypes.function,r.Proposed.SemanticTokenTypes.member,r.Proposed.SemanticTokenTypes.macro,r.Proposed.SemanticTokenTypes.variable,r.Proposed.SemanticTokenTypes.parameter,r.Proposed.SemanticTokenTypes.property,r.Proposed.SemanticTokenTypes.label],t.tokenModifiers=[r.Proposed.SemanticTokenModifiers.declaration,r.Proposed.SemanticTokenModifiers.documentation,r.Proposed.SemanticTokenModifiers.static,r.Proposed.SemanticTokenModifiers.abstract,r.Proposed.SemanticTokenModifiers.deprecated,r.Proposed.SemanticTokenModifiers.async,r.Proposed.SemanticTokenModifiers.readonly]}initialize(e,t){const i=e;let[s,n]=this.getRegistration(t,i.semanticTokensProvider);s&&n&&this.register(this.messages,{id:s,registerOptions:n})}registerLanguageProvider(e){const t={provideDocumentSemanticTokens:(e,t)=>{const i=this._client,s=i.clientOptions.middleware,n=(e,t)=>{const s={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(r.Proposed.SemanticTokensRequest.type,s,t).then(e=>a.asSemanticTokens(e),e=>{i.logFailedRequest(r.Proposed.SemanticTokensRequest.type,e)})};return s.provideDocumentSemanticTokens?s.provideDocumentSemanticTokens(e,t,n):n(e,t)},provideDocumentSemanticTokensEdits:void 0!==e.documentProvider&&"boolean"!=typeof e.documentProvider&&!0===e.documentProvider.edits?(e,t,i)=>{const s=this._client,n=s.clientOptions.middleware,o=(e,t,i)=>{const n={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return s.sendRequest(r.Proposed.SemanticTokensEditsRequest.type,n,i).then(e=>r.Proposed.SemanticTokens.is(e)?a.asSemanticTokens(e):a.asSemanticTokensEdits(e),e=>{s.logFailedRequest(r.Proposed.SemanticTokensEditsRequest.type,e)})};return n.provideDocumentSemanticTokensEdits?n.provideDocumentSemanticTokensEdits(e,t,i,o):o(e,t,i)}:void 0},i=!0===e.rangeProvider?{provideDocumentRangeSemanticTokens:(e,t,i)=>{const s=this._client,n=s.clientOptions.middleware,o=(e,t,i)=>{const n={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),range:s.code2ProtocolConverter.asRange(t)};return s.sendRequest(r.Proposed.SemanticTokensRangeRequest.type,n,i).then(e=>a.asSemanticTokens(e),e=>{s.logFailedRequest(r.Proposed.SemanticTokensRangeRequest.type,e)})};return n.provideDocumentRangeSemanticTokens?n.provideDocumentRangeSemanticTokens(e,t,i,o):o(e,t,i)}}:void 0,n=[],o=a.asLegend(e.legend);return n.push(s.languages.registerDocumentSemanticTokensProvider(e.documentSelector,t,o)),void 0!==i&&n.push(s.languages.registerDocumentRangeSemanticTokensProvider(e.documentSelector,i,o)),[new s.Disposable(()=>n.forEach(e=>e.dispose())),{document:t,range:i}]}}t.SemanticTokensFeature=c},function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const s=i(61),n=i(2),r="win32"===process.platform,o="darwin"===process.platform,a="linux"===process.platform;t.terminate=function(t,i){if(r)try{let e={stdio:["pipe","pipe","ignore"]};return i&&(e.cwd=i),s.execFileSync("taskkill",["/T","/F","/PID",t.pid.toString()],e),!0}catch(e){return!1}else{if(!a&&!o)return t.kill("SIGKILL"),!0;try{var c=n.join(e,"terminateProcess.sh");return!s.spawnSync(c,[t.pid.toString()]).error}catch(e){return!1}}}}).call(this,"/")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(67),r=i(85),o=i(1),a=i(31),c=i(6);t.LspFileTracker=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.wsContext=i,this.disposables=[],this.outlines={},this.flutterOutlines={},this.pubRunTestSupport={},this.onOutlineEmitter=new r.EventEmitter,this.onOutline=this.onOutlineEmitter.event,this.onFlutterOutlineEmitter=new r.EventEmitter,this.onFlutterOutline=this.onFlutterOutlineEmitter.event,t.onReady().then(()=>{this.analyzer.onNotification(n.PublishOutlineNotification.type,e=>{const t=o.fsPath(s.Uri.parse(e.uri));this.outlines[t]=e.outline,this.onOutlineEmitter.fire(e)}),this.analyzer.onNotification(n.PublishFlutterOutlineNotification.type,e=>{const t=o.fsPath(s.Uri.parse(e.uri));this.flutterOutlines[t]=e.outline,this.onFlutterOutlineEmitter.fire(e)})})}getOutlineFor(e){return this.outlines[o.fsPath(e)]}getFlutterOutlineFor(e){return this.flutterOutlines[o.fsPath(e)]}supportsPubRunTest(e){const t=o.fsPath(e);if(!c.isPubRunnableTestFile(t))return!1;if(void 0===this.pubRunTestSupport[t]){const e=a.locateBestProjectRoot(t);this.pubRunTestSupport[t]=!(!e||!c.projectShouldUsePubForTests(e,this.wsContext.config))}return this.pubRunTestSupport[o.fsPath(e)]}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(8),r=i(3),o=i(14),a=i(9),c=i(6);let l=0;t.AnalyzerStatusReporter=class{constructor(e,t,i,s){this.logger=e,this.analyzer=t,this.workspaceContext=i,this.analytics=s,this.analysisInProgress=!1,t.registerForServerStatus(e=>this.handleServerStatus(e)),t.registerForServerError(e=>this.handleServerError(e)),t.registerForRequestError(e=>this.handleRequestError(e)),t.registerForServerTerminated(()=>this.handleServerTerminated())}handleServerStatus(e){e.analysis&&(this.analysisInProgress=e.analysis.isAnalyzing,this.analysisInProgress?setTimeout(()=>{this.analysisInProgress&&!this.analyzingPromise&&s.window.withProgress({location:s.ProgressLocation.Window,title:"Analyzing…"},e=>(this.analyzingPromise||(this.analyzingPromise=new r.PromiseCompleter),this.analyzingPromise.promise))},500):this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0))}handleServerTerminated(){this.analysisInProgress=!1,this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0)}handleRequestError(e){this.handleServerError({isFatal:!1,message:e.message,stackTrace:e.stackTrace||""},e.method)}handleServerError(e,t){if(this.logger.error(e.message,n.LogCategory.Analyzer),e.stackTrace&&this.logger.error(e.stackTrace,n.LogCategory.Analyzer),this.analytics.logError("Analyzer server error"+(t?` (${t})`:""),e.isFatal),l++,a.config.notifyAnalyzerErrors&&l<=3){const i="Show log";s.window.showErrorMessage("Exception from the Dart analysis server: "+e.message,i).then(s=>{s===i&&this.showErrorLog(e,t)})}}showErrorLog(e,t){const i=this.workspaceContext.sdks.dartVersion,n=this.workspaceContext.sdks.flutterVersion,r=this.analyzer.getAnalyzerLaunchArgs(),a=`\n${t?"### Request\n\nServer was responding to request: `"+t+"`\n":""}\n### Versions\n\n- ${s.env.appName} v${s.version}\n- Dart Code v${o.extensionVersion}\n- ${n?"Flutter SDK v"+n:"Dart SDK v"+i}\n\n### Analyzer Info\n\nThe analyzer was launched using the arguments:\n\n${r.map(e=>"- "+e).join("\n")}\n\n### Exception${e.isFatal?" (fatal)":""}\n\n${e.message}\n\n${e.stackTrace.trim()}\n`;c.openLogContents("md",a)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(1),r=i(9),o=i(6);t.FileChangeHandler=class{constructor(e){this.analyzer=e,this.disposables=[],this.filesWarnedAbout=new Set,this.disposables.push(s.workspace.onDidOpenTextDocument(e=>this.onDidOpenTextDocument(e)),s.workspace.onDidChangeTextDocument(e=>this.onDidChangeTextDocument(e)),s.workspace.onDidCloseTextDocument(e=>this.onDidCloseTextDocument(e))),s.workspace.textDocuments.forEach(e=>this.onDidOpenTextDocument(e))}onDidOpenTextDocument(e){if(!o.isAnalyzable(e))return;const t={};t[n.fsPath(e.uri)]={content:e.getText(),type:"add"},this.analyzer.analysisUpdateContent({files:t})}onDidChangeTextDocument(e){if(!o.isAnalyzable(e.document))return;if(0===e.contentChanges.length)return;const t=n.fsPath(e.document.uri);if(s.workspace.workspaceFolders&&s.workspace.workspaceFolders.length&&r.config.warnWhenEditingFilesOutsideWorkspace&&!this.filesWarnedAbout.has(t)&&!o.isWithinWorkspace(t)){const e="Don't Warn Me";s.window.showWarningMessage("You are modifying a file outside of your open folders",e).then(t=>{t===e&&r.config.setWarnWhenEditingFilesOutsideWorkspace(!1)}),this.filesWarnedAbout.add(t)}const i={};i[t]={edits:e.contentChanges.map(t=>this.convertChange(e.document,t)),type:"change"},this.analyzer.analysisUpdateContent({files:i})}onDidCloseTextDocument(e){if(!o.isAnalyzable(e))return;const t={};t[n.fsPath(e.uri)]={type:"remove"},this.analyzer.analysisUpdateContent({files:t})}convertChange(e,t){return{id:"",length:t.rangeLength,offset:t.rangeOffset,replacement:t.text}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(27),r=i(190),o=i(0),a=i(4),c=i(14),l=i(9),u="someValue.machineId"!==o.env.machineId?o.env.machineId:void 0;var d,h,p;!function(e){e[e.Extension=0]="Extension",e[e.Analyzer=1]="Analyzer",e[e.Debugger=2]="Debugger"}(d||(d={})),function(e){e[e.Activated=0]="Activated",e[e.SdkDetectionFailure=1]="SdkDetectionFailure",e[e.Deactivated=2]="Deactivated",e[e.Restart=3]="Restart",e[e.HotReload=4]="HotReload",e[e.OpenObservatory=5]="OpenObservatory",e[e.OpenTimeline=6]="OpenTimeline",e[e.OpenDevTools=7]="OpenDevTools"}(h||(h={})),function(e){e[e.Startup=0]="Startup",e[e.FirstAnalysis=1]="FirstAnalysis",e[e.SessionDuration=2]="SessionDuration"}(p||(p={}));t.Analytics=class{constructor(e,t){this.logger=e,this.workspaceContext=t,this.dummyDartFile=o.Uri.parse("untitled:foo.dart"),this.dartConfig=o.workspace.getConfiguration("",this.dummyDartFile).get("[dart]"),this.formatter=this.getFormatterSetting()}getFormatterSetting(){try{const e=this.getAppliedConfig("editor","defaultFormatter",!1);return e&&e!==a.dartCodeExtensionIdentifier?e:l.config.enableSdkFormatter?this.getAppliedConfig("editor","formatOnSave")?"Enabled on Save":"Enabled":"Disabled"}catch(e){return"Unknown"}}getAppliedConfig(e,t,i=!0){const s=this.dartConfig?this.dartConfig[`${e}.${t}`]:void 0;return null!=s?s:o.workspace.getConfiguration(e,i?this.dummyDartFile:void 0).get(t)}logExtensionStartup(e){this.event(d.Extension,h.Activated).catch(e=>this.logger.info(e)),this.time(d.Extension,p.Startup,e).catch(e=>this.logger.info(e))}logExtensionRestart(e){this.event(d.Extension,h.Restart).catch(e=>this.logger.info(e)),this.time(d.Extension,p.Startup,e).catch(e=>this.logger.info(e))}logExtensionShutdown(){return this.event(d.Extension,h.Deactivated)}logSdkDetectionFailure(){this.event(d.Extension,h.SdkDetectionFailure).catch(e=>this.logger.info(e))}logError(e,t){this.error(e,t).catch(e=>this.logger.info(e))}logAnalyzerStartupTime(e){this.time(d.Analyzer,p.Startup,e).catch(e=>this.logger.info(e))}logDebugSessionDuration(e,t){this.time(d.Debugger,p.SessionDuration,t,e).catch(e=>this.logger.info(e))}logAnalyzerFirstAnalysisTime(e){this.time(d.Analyzer,p.FirstAnalysis,e).catch(e=>this.logger.info(e))}logDebuggerStart(e,t,i){const s={cd15:t,cd16:i};this.event(d.Debugger,h.Activated,e,s).catch(e=>this.logger.info(e))}logDebuggerRestart(){this.event(d.Debugger,h.Restart).catch(e=>this.logger.info(e))}logDebuggerHotReload(){this.event(d.Debugger,h.HotReload).catch(e=>this.logger.info(e))}logDebuggerOpenObservatory(){this.event(d.Debugger,h.OpenObservatory).catch(e=>this.logger.info(e))}logDebuggerOpenTimeline(){this.event(d.Debugger,h.OpenTimeline).catch(e=>this.logger.info(e))}logDebuggerOpenDevTools(){this.event(d.Debugger,h.OpenDevTools).catch(e=>this.logger.info(e))}event(e,t,i,s){const n={ea:h[t],ec:d[e],t:"event"};return Object.assign(n,s),e===d.Extension&&t===h.Activated&&(n.sc="start"),e===d.Extension&&t===h.Deactivated&&(n.sc="end"),this.send(n,i)}time(e,t,i,s){const n={t:"timing",utc:d[e],utl:s,utt:Math.round(i),utv:p[t]};return this.logger.info(`${n.utc}:${n.utv} timing: ${Math.round(i)}ms ${s?`(${s})`:""}`),this.send(n)}error(e,t){const i={exd:e.trim(),exf:t?1:0,t:"exception"};return this.send(i)}send(e,t){return s(this,void 0,void 0,(function*(){if(!u||!l.config.allowAnalytics||process.env.DART_CODE_IS_TEST_RUN)return;const i={aip:1,an:"Dart Code",av:c.extensionVersion,cd1:c.isDevExtension,cd10:l.config.showTodos?"On":"Off",cd11:this.workspaceContext.hasAnyFlutterProjects?l.config.flutterOutline?"On":"Off":null,cd12:this.formatter,cd13:this.flutterSdkVersion,cd14:c.hasFlutterExtension?"Installed":"Not Installed",cd17:this.workspaceContext.hasAnyFlutterProjects?l.config.previewFlutterUiGuides?l.config.previewFlutterUiGuidesCustomTracking?"On + Custom Tracking":"On":"Off":null,cd18:this.workspaceContext.hasAnyFlutterProjects&&t?l.config.for(t).flutterStructuredErrors?"On":"Off":null,cd19:o.env.remoteName||"None",cd2:a.isChromeOS?process.platform+" (ChromeOS)":process.platform,cd20:o.env.appName||"Unknown",cd3:this.sdkVersion,cd4:this.analysisServerVersion,cd5:o.version,cd6:t?this.getDebuggerPreference():null,cd7:this.workspaceContext.workspaceTypeDescription,cd8:l.config.closingLabels?"On":"Off",cd9:this.workspaceContext.hasAnyFlutterProjects?l.config.flutterHotReloadOnSave?"On":"Off":null,cid:u,tid:"UA-2201586-19",ul:o.env.language,v:"1"};Object.assign(i,e);const s={headers:{"Content-Type":"application/x-www-form-urlencoded"},hostname:"www.google-analytics.com",method:"POST",path:"/collect",port:443};yield new Promise(e=>{try{const t=n.request(s,t=>{(!t||!t.statusCode||t.statusCode<200||t.statusCode>300)&&this.logger.info(`Failed to send analytics ${t&&t.statusCode}: ${t&&t.statusMessage}`),e()});t.write(r.stringify(i)),t.end()}catch(t){this.logger.error("Failed to send analytics: "+t),e()}})}))}getDebuggerPreference(){return l.config.debugSdkLibraries&&l.config.debugExternalLibraries?"All code":l.config.debugSdkLibraries?"My code + SDK":l.config.debugExternalLibraries?"My code + Libraries":"My code"}}},function(e,t){e.exports=require("querystring")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.DartExtensionApi=class{constructor(){this.version=1,this.flutterCreateSampleProject=()=>s.commands.executeCommand("_dart.flutter.createSampleProject")}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(1),a=i(68),c=i(5),l=new RegExp("\\{@tool\\s+dartpad");t.FlutterDartPadSamplesCodeLensProvider=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.sdks=i,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()})),this.disposables.push(r.commands.registerCommand("_dart.openDartPadSample",e=>s(this,void 0,void 0,(function*(){const t=`#${e.libraryName}.${e.className}.1`,i=`https://api.flutter.dev/flutter/${e.libraryName}/${e.className}-class.html${t}`;yield c.envUtils.openInBrowser(i)})))),this.flutterPackagesFolder=n.join(i.flutter,"packages/flutter/lib/src/").toLowerCase()}provideCodeLenses(e,t){const i=o.fsPath(e.uri);if(!i.toLowerCase().startsWith(this.flutterPackagesFolder))return;const s=this.analyzer.fileTracker.getOutlineFor(e.uri);if(!s||!s.children||!s.children.length)return;const n=i.substr(this.flutterPackagesFolder.length).replace("\\","/").split("/")[0],u=new a.ClassOutlineVisitor(this.logger);return u.visit(s),u.classes.filter(t=>{const i=e.getText(c.toRange(e,t.offset,t.codeOffset-t.offset));return l.test(i)}).map(e=>Object.assign(Object.assign({},e),{libraryName:n})).filter(e=>e.codeOffset&&e.codeLength).map(t=>new r.CodeLens(c.toRange(e,t.codeOffset,t.codeLength),{arguments:[t],command:"_dart.openDartPadSample",title:"Open online interactive samples for "+t.className}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(1),r=i(47),o=i(5),a=i(6);t.MainCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){var i;const c=this.analyzer.fileTracker.getOutlineFor(e.uri);if(!c||!c.children||!c.children.length)return;const l=a.isTestFile(n.fsPath(e.uri))?"test-file":"file",u=r.getTemplatedLaunchConfigs(e,l),d=null===(i=c.children)||void 0===i?void 0:i.find(e=>"main"===e.element.name);return d?[new s.CodeLens(o.toRange(e,d.offset,d.length),{arguments:[e.uri],command:"dart.startWithoutDebugging",title:"Run"}),new s.CodeLens(o.toRange(e,d.offset,d.length),{arguments:[e.uri],command:"dart.startDebugging",title:"Debug"})].concat(u.map(t=>new s.CodeLens(o.toRange(e,d.offset,d.length),{arguments:[e.uri,t],command:t.template==="run-"+l?"dart.startWithoutDebugging":"dart.startDebugging",title:t.name}))):void 0}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(1),r=i(47),o=i(5),a=i(6);t.LspMainCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.fileTracker.onOutline.listen(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){var i;const c=this.analyzer.fileTracker.getOutlineFor(e.uri);if(!c||!c.children||!c.children.length)return;const l=a.isTestFile(n.fsPath(e.uri))?"test-file":"file",u=r.getTemplatedLaunchConfigs(e,l),d=null===(i=c.children)||void 0===i?void 0:i.find(e=>"main"===e.element.name);return d?[new s.CodeLens(o.lspToRange(d.range),{arguments:[e.uri],command:"dart.startWithoutDebugging",title:"Run"}),new s.CodeLens(o.lspToRange(d.range),{arguments:[e.uri],command:"dart.startDebugging",title:"Debug"})].concat(u.map(t=>new s.CodeLens(o.lspToRange(d.range),{arguments:[e.uri,t],command:t.template==="run-"+l?"dart.startWithoutDebugging":"dart.startDebugging",title:t.name}))):void 0}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3),r=i(1),o=i(68),a=i(47),c=i(5),l=i(6);t.TestCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){const i=this.analyzer.fileTracker.getOutlineFor(e.uri);if(!i||!i.children||!i.children.length)return;if(!this.analyzer.fileTracker.supportsPubRunTest(e.uri))return;if(!l.isTestFile(r.fsPath(e.uri)))return;const u=a.getTemplatedLaunchConfigs(e,"test"),d=new o.TestOutlineVisitor(this.logger);return d.visit(i),n.flatMap(d.tests.filter(e=>e.offset&&e.length).map(t=>[new s.CodeLens(c.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startWithoutDebuggingTestFromOutline",title:"Run"}),new s.CodeLens(c.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startDebuggingTestFromOutline",title:"Debug"})].concat(u.map(i=>new s.CodeLens(c.toRange(e,t.offset,t.length),{arguments:[t,i],command:"run-test"===i.template?"_dart.startWithoutDebuggingTestFromOutline":"_dart.startDebuggingTestFromOutline",title:i.name})))),e=>e)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3),r=i(1),o=i(93),a=i(47),c=i(5),l=i(6);t.LspTestCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.fileTracker.onOutline.listen(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){const i=this.analyzer.fileTracker.getOutlineFor(e.uri);if(!i||!i.children||!i.children.length)return;if(!this.analyzer.fileTracker.supportsPubRunTest(e.uri))return;if(!l.isTestFile(r.fsPath(e.uri)))return;const u=a.getTemplatedLaunchConfigs(e,"test"),d=new o.LspTestOutlineVisitor(this.logger,r.fsPath(e.uri));return d.visit(i),n.flatMap(d.tests.filter(e=>e.range).map(e=>[new s.CodeLens(c.lspToRange(e.range),{arguments:[e],command:"_dart.startWithoutDebuggingTestFromOutline",title:"Run"}),new s.CodeLens(c.lspToRange(e.range),{arguments:[e],command:"_dart.startDebuggingTestFromOutline",title:"Debug"})].concat(u.map(t=>new s.CodeLens(c.lspToRange(e.range),{arguments:[e,t],command:"run-test"===t.template?"_dart.startWithoutDebuggingTestFromOutline":"_dart.startDebuggingTestFromOutline",title:t.name})))),e=>e)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(5);t.AnalyzerCommands=class{constructor(e,t){e.subscriptions.push(n.commands.registerCommand("dart.openAnalyzerDiagnostics",()=>s(this,void 0,void 0,(function*(){const e=yield t.getDiagnosticServerPort();yield r.envUtils.openInBrowser(`http://127.0.0.1:${e.port}/`)}))))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(4),o=i(8),a=i(22),c=i(70);t.IS_INSPECTING_WIDGET_CONTEXT="dart-code:flutter.isInspectingWidget";const l={[o.VmServiceExtension.PlatformOverride]:"value",[o.VmServiceExtension.DebugBanner]:"enabled",[o.VmServiceExtension.CheckElevations]:"enabled",[o.VmServiceExtension.DebugPaint]:"enabled",[o.VmServiceExtension.PaintBaselines]:"enabled",[o.VmServiceExtension.InspectorSelectMode]:"enabled",[o.VmServiceExtension.RepaintRainbow]:"enabled",[o.VmServiceExtension.PerformanceOverlay]:"enabled",[o.VmServiceExtension.SlowAnimations]:"timeDilation"};t.timeDilationNormal=1,t.timeDilationSlow=5;const u={[o.VmServiceExtension.PlatformOverride]:null,[o.VmServiceExtension.DebugBanner]:!0,[o.VmServiceExtension.CheckElevations]:!1,[o.VmServiceExtension.DebugPaint]:!1,[o.VmServiceExtension.PaintBaselines]:!1,[o.VmServiceExtension.InspectorSelectMode]:!1,[o.VmServiceExtension.RepaintRainbow]:!1,[o.VmServiceExtension.PerformanceOverlay]:!1,[o.VmServiceExtension.SlowAnimations]:t.timeDilationNormal};t.VmServiceExtensions=class{constructor(e,t){this.logger=e,this.registeredServices={},this.loadedServiceExtensions=[],this.currentExtensionState=Object.assign({},u),this.sendValueToVM=e=>{if(-1!==this.loadedServiceExtensions.indexOf(e)&&void 0!==l[e]){const i={[l[e]]:this.currentExtensionState[e]};t(e,{type:e,params:i}),this.syncInspectingWidgetContext(e)}}}handleDebugEvent(e){return s(this,void 0,void 0,(function*(){if("dart.serviceExtensionAdded"===e.event){this.handleServiceExtensionLoaded(e.body.id);try{if("ext.flutter.inspector.isWidgetCreationTracked"===e.body.id)yield e.session.customRequest("checkIsWidgetCreationTracked");else if(e.body.id===o.VmServiceExtension.PlatformOverride)yield e.session.customRequest("checkPlatformOverride");else if(e.body.id===o.VmServiceExtension.InspectorSetPubRootDirectories){e.session.configuration.debuggerType!==c.DebuggerType.Web&&(yield e.session.customRequest("serviceExtension",{params:{arg0:this.formatPathForPubRootDirectories(e.session.configuration.cwd),arg1:e.session.configuration.cwd,isolateId:e.body.isolateId},type:"ext.flutter.inspector.setPubRootDirectories"}))}}catch(e){this.logger.error(e)}}else if("dart.serviceRegistered"===e.event)this.handleServiceRegistered(e.body.service,e.body.method);else if("dart.flutter.firstFrame"===e.event)for(const e in o.VmServiceExtension)this.sendValueToVM(e);else"dart.flutter.updateIsWidgetCreationTracked"===e.event?n.commands.executeCommand("setContext",r.TRACK_WIDGET_CREATION_ENABLED,e.body.isWidgetCreationTracked):"dart.flutter.updatePlatformOverride"===e.event?this.currentExtensionState[o.VmServiceExtension.PlatformOverride]=e.body.platform:"dart.flutter.serviceExtensionStateChanged"===e.event&&this.handleRemoteValueUpdate(e.body.extension,e.body.value)}))}formatPathForPubRootDirectories(e){return r.isWin?e&&"file:///"+e.replace(/\\/g,"/"):e}toggle(e,t=!0,i=!1){this.currentExtensionState[e]=this.currentExtensionState[e]!==t?t:i,this.sendValueToVM(e)}syncInspectingWidgetContext(e){n.commands.executeCommand("setContext",t.IS_INSPECTING_WIDGET_CONTEXT,this.currentExtensionState[o.VmServiceExtension.InspectorSelectMode])}handleRemoteValueUpdate(e,t){if(void 0!==this.currentExtensionState[e]){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}this.currentExtensionState[e]=t,this.syncInspectingWidgetContext(e)}}resetToDefaults(){this.currentExtensionState=Object.assign({},u)}handleServiceRegistered(e,t){this.registeredServices[e]=t,n.commands.executeCommand("setContext",`${a.SERVICE_CONTEXT_PREFIX}${e}`,!0)}handleServiceExtensionLoaded(e){this.loadedServiceExtensions.push(e),n.commands.executeCommand("setContext",`${a.SERVICE_EXTENSION_CONTEXT_PREFIX}${e}`,!0)}markAllServicesUnloaded(){for(const e of Object.keys(this.registeredServices))n.commands.executeCommand("setContext",`${a.SERVICE_CONTEXT_PREFIX}${e}`,void 0);this.registeredServices={};for(const e of this.loadedServiceExtensions)n.commands.executeCommand("setContext",`${a.SERVICE_EXTENSION_CONTEXT_PREFIX}${e}`,void 0);this.loadedServiceExtensions.length=0,n.commands.executeCommand("setContext",r.TRACK_WIDGET_CREATION_ENABLED,!1)}serviceIsRegistered(e){return!!this.registeredServices[e]}getServiceMethodName(e){return this.registeredServices[e]}serviceExtensionIsLoaded(e){return!!this.loadedServiceExtensions.find(t=>t===e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(29),n=i(73);class r{get event(){return this._event||(this._event=(e,t)=>{let i;return this._listener=e,this._this=t,i={dispose:()=>{this._listener=void 0,this._this=void 0}},i}),this._event}fire(e){if(this._listener)try{this._listener.call(this._this,e)}catch(e){}}hasListener(){return!!this._listener}dispose(){this._listener=void 0,this._this=void 0}}class o extends s.EventEmitter{constructor(){super(),this._sendMessage=new r,this._pendingRequests=new Map,this.onDidSendMessage=this._sendMessage.event}dispose(){}handleMessage(e){if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,i=this._pendingRequests.get(t.request_seq);i&&(this._pendingRequests.delete(t.request_seq),i(t))}}_isRunningInline(){return this._sendMessage&&this._sendMessage.hasListener()}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=new Buffer(0),e.on("data",e=>this._handleData(e)),e.on("close",()=>{this._emitEvent(new n.Event("close"))}),e.on("error",e=>{this._emitEvent(new n.Event("error","inStream error: "+(e&&e.message)))}),t.on("error",e=>{this._emitEvent(new n.Event("error","outStream error: "+(e&&e.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error("attempt to send more than one response for command "+e.command):this._send("response",e)}sendRequest(e,t,i,s){const r={command:e};if(t&&Object.keys(t).length>0&&(r.arguments=t),this._send("request",r),s){this._pendingRequests.set(r.seq,s);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(r.seq);t&&(this._pendingRequests.delete(r.seq),t(new n.Response(r,"timeout")))},i)}}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}this._sendMessage.fire(t)}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);this.handleMessage(t)}catch(e){this._emitEvent(new n.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(o.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const i=t[e].split(/: +/);"Content-Length"==i[0]&&(this._contentLength=+i[1])}this._rawData=this._rawData.slice(e+o.TWO_CRLF.length);continue}}break}}}o.TWO_CRLF="\r\n\r\n",t.ProtocolServer=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(95),n=s.logger,r=i(72);class o extends r.DebugSession{constructor(e,t,i){super(t,i),this.obsolete_logFilePath=e,this.on("error",e=>{n.error(e.body)})}start(e,t){super.start(e,t),n.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){if(!(e instanceof s.LogOutputEvent)){let t=e;e instanceof r.OutputEvent&&e.body&&e.body.data&&e.body.data.doNotLogOutput&&(delete e.body.data.doNotLogOutput,t=Object.assign({},e),t.body=Object.assign({},e.body,{output:"<output not logged>"})),n.verbose("To client: "+JSON.stringify(t))}super.sendEvent(e)}sendRequest(e,t,i,s){n.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${i}`),super.sendRequest(e,t,i,s)}sendResponse(e){n.verbose("To client: "+JSON.stringify(e)),super.sendResponse(e)}dispatchRequest(e){n.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}t.LoggingDebugSession=o},function(e,t,i){var s=i(2),n=i(7),r=parseInt("0777",8);function o(e,t,i,a){"function"==typeof t?(i=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,l=t.fs||n;void 0===c&&(c=r),a||(a=null);var u=i||function(){};e=s.resolve(e),l.mkdir(e,c,(function(i){if(!i)return u(null,a=a||e);switch(i.code){case"ENOENT":if(s.dirname(e)===e)return u(i);o(s.dirname(e),t,(function(i,s){i?u(i,s):o(e,t,u,s)}));break;default:l.stat(e,(function(e,t){e||!t.isDirectory()?u(i,a):u(null,a)}))}}))}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,i,o){i&&"object"==typeof i||(i={mode:i});var a=i.mode,c=i.fs||n;void 0===a&&(a=r),o||(o=null),t=s.resolve(t);try{c.mkdirSync(t,a),o=o||t}catch(n){switch(n.code){case"ENOENT":o=e(s.dirname(t),i,o),e(t,i,o);break;default:var l;try{l=c.statSync(t)}catch(e){throw n}if(!l.isDirectory())throw n}}return o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);class n{constructor(e){this.version=e}static get empty(){return new n("0.0.0")}get hasInvoke(){return s.versionIsAtLeast(this.version,"3.10.0")}get hasLoggingStream(){return s.versionIsAtLeast(this.version,"3.17.0")}get serviceStreamIsPublic(){return s.versionIsAtLeast(this.version,"3.22.0")}}t.VmServiceCapabilities=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(205),n=i(3);class r{constructor(e){this.result=e}}var o;t.DebuggerResult=r,function(e){e[e.Coverage=0]="Coverage",e[e.PossibleBreakpoints=1]="PossibleBreakpoints"}(o=t.SourceReportKind||(t.SourceReportKind={}));class a{constructor(e,t,i){this.code=e,this.message=t,this.data=i}details(){return this.data?this.data.details:void 0}toString(){return`${this.code} ${this.message}`}}t.RPCError=a;t.ObservatoryConnection=class{constructor(e){this.completers={},this.eventListeners={},this.nextId=0,this.socket=new s(e),this.socket.on("message",e=>this.handleData(e.toString()))}onOpen(e){this.socket.on("open",e)}onLogging(e){this.logging=e}getVersion(){return this.callMethod("getVersion")}getVM(){return this.callMethod("getVM")}getIsolate(e){return this.callMethod("getIsolate",{isolateId:e})}on(e,t){return this.eventListeners[e]=t,this.streamListen(e)}streamListen(e){return this.callMethod("streamListen",{streamId:e})}addBreakpointWithScriptUri(e,t,i,s){let n;return n={isolateId:e,scriptUri:t,line:i},s&&(n.column=s),this.callMethod("addBreakpointWithScriptUri",n)}setExceptionPauseMode(e,t){return this.callMethod("setExceptionPauseMode",{isolateId:e,mode:t})}removeBreakpoint(e,t){return this.callMethod("removeBreakpoint",{isolateId:e,breakpointId:t})}pause(e){return this.callMethod("pause",{isolateId:e})}resume(e,t,i){return this.callMethod("resume",{isolateId:e,step:t,frameIndex:i})}getStack(e){return this.callMethod("getStack",{isolateId:e})}getSourceReport(e,t,i){return this.callMethod("getSourceReport",{isolateId:e.id,reports:t.map(e=>o[e]),scriptId:i.id})}getObject(e,t,i,s){let n;return n={isolateId:e,objectId:t},i&&(n.offset=i),s&&(n.count=s),this.callMethod("getObject",n)}evaluate(e,t,i,s){return this.callMethod("evaluate",{disableBreakpoints:s,expression:i,isolateId:e,targetId:t})}evaluateInFrame(e,t,i,s){return this.callMethod("evaluateInFrame",{disableBreakpoints:s,expression:i,frameIndex:t,isolateId:e})}invoke(e,t,i,s,n){return this.callMethod("invoke",{argumentIds:s,disableBreakpoints:n,isolateId:e,selector:i,targetId:t})}setLibraryDebuggable(e,t,i){return this.callMethod("setLibraryDebuggable",{isolateId:e,libraryId:t,isDebuggable:i})}callMethod(e,t){const i=""+this.nextId++,s=new n.PromiseCompleter;this.completers[i]=s;const r={id:i,jsonrpc:"2.0",method:e,params:t||{}},o=JSON.stringify(r);return this.logTraffic(`==> ${o}\n`),this.socket.send(o),s.promise}handleData(e){let t;this.logTraffic(`<== ${e}\n`),t=JSON.parse(e);const i=t.id,s=t.method,n=t.error,o=this.completers[i];if(o)delete this.completers[i],n?o.reject(new a(n.code,n.message,n.data)):o.resolve(new r(t.result));else if(s){const e=t.params,i=e.streamId,s=this.eventListeners[i];s&&setTimeout(s,0,e.event)}}onError(e){this.socket.on("error",e)}onClose(e){this.socket.on("close",e)}logTraffic(e){this.logging&&this.logging(e)}close(){this.socket.close()}}},function(e,t,i){"use strict";const s=i(97);s.createWebSocketStream=i(210),s.Server=i(211),s.Receiver=i(98),s.Sender=i(100),e.exports=s},function(e,t){e.exports=require("tls")},function(e,t){e.exports=require("zlib")},function(e,t,i){"use strict";const s=Symbol("kDone"),n=Symbol("kRun");e.exports=class{constructor(e){this[s]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[s])}}}},function(e,t,i){"use strict";class s{constructor(e,t){this.target=t,this.type=e}}class n extends s{constructor(e,t){super("message",t),this.data=e}}class r extends s{constructor(e,t,i){super("close",i),this.wasClean=i._closeFrameReceived&&i._closeFrameSent,this.reason=t,this.code=e}}class o extends s{constructor(e){super("open",e)}}class a extends s{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const c={addEventListener(e,t){function i(e){t.call(this,new n(e,this))}function s(e,i){t.call(this,new r(e,i,this))}function c(e){t.call(this,new a(e,this))}function l(){t.call(this,new o(this))}"function"==typeof t&&("message"===e?(i._listener=t,this.on(e,i)):"close"===e?(s._listener=t,this.on(e,s)):"error"===e?(c._listener=t,this.on(e,c)):"open"===e?(l._listener=t,this.on(e,l)):this.on(e,t))},removeEventListener(e,t){const i=this.listeners(e);for(let s=0;s<i.length;s++)i[s]!==t&&i[s]._listener!==t||this.removeListener(e,i[s])}};e.exports=c},function(e,t,i){"use strict";const{Duplex:s}=i(63);function n(e){e.emit("close")}function r(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let i=!0;function a(){i&&e._socket.resume()}e.readyState===e.CONNECTING?e.once("open",(function(){e._receiver.removeAllListeners("drain"),e._receiver.on("drain",a)})):(e._receiver.removeAllListeners("drain"),e._receiver.on("drain",a));const c=new s({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t){c.push(t)||(i=!1,e._socket.pause())})),e.once("error",(function(e){c.destroyed||c.destroy(e)})),e.once("close",(function(){c.destroyed||c.push(null)})),c._destroy=function(t,i){if(e.readyState===e.CLOSED)return i(t),void process.nextTick(n,c);let s=!1;e.once("error",(function(e){s=!0,i(e)})),e.once("close",(function(){s||i(t),process.nextTick(n,c)})),e.terminate()},c._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),c._readableState.endEmitted&&c.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){c._final(t)}))},c._read=function(){e.readyState!==e.OPEN||i||(i=!0,e._receiver._writableState.needDrain||e._socket.resume())},c._write=function(t,i,s){e.readyState!==e.CONNECTING?e.send(t,s):e.once("open",(function(){c._write(t,i,s)}))},c.on("end",r),c.on("error",o),c}},function(e,t,i){"use strict";const s=i(29),{createHash:n}=i(46),{createServer:r,STATUS_CODES:o}=i(60),a=i(48),c=i(97),{format:l,parse:u}=i(101),{GUID:d,kWebSocket:h}=i(26),p=/^[+/0-9A-Za-z]{22}==$/;function g(e){e.emit("close")}function f(){this.destroy()}function m(e,t,i,s){e.writable&&(i=i||o[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(i),...s},e.write(`HTTP/1.1 ${t} ${o[t]}\r\n`+Object.keys(s).map(e=>`${e}: ${s[e]}`).join("\r\n")+"\r\n\r\n"+i)),e.removeListener("error",f),e.destroy()}e.exports=class extends s{constructor(e,t){if(super(),null==(e={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');null!=e.port?(this._server=r((e,t)=>{const i=o[426];t.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),t.end(i)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const i of Object.keys(t))e.on(i,t[i]);return function(){for(const i of Object.keys(t))e.removeListener(i,t[i])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,i)=>{this.handleUpgrade(e,t,i,t=>{this.emit("connection",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close(()=>this.emit("close")):process.nextTick(g,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,i,s){t.on("error",f);const n=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),r=+e.headers["sec-websocket-version"],o={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!n||!p.test(n)||8!==r&&13!==r||!this.shouldHandle(e))return m(t,400);if(this.options.perMessageDeflate){const i=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=u(e.headers["sec-websocket-extensions"]);t[a.extensionName]&&(i.accept(t[a.extensionName]),o[a.extensionName]=i)}catch(e){return m(t,400)}}if(this.options.verifyClient){const a={origin:e.headers[""+(8===r?"sec-websocket-origin":"origin")],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,(r,a,c,l)=>{if(!r)return m(t,a||401,c,l);this.completeUpgrade(n,o,e,t,i,s)});if(!this.options.verifyClient(a))return m(t,401)}this.completeUpgrade(n,o,e,t,i,s)}completeUpgrade(e,t,i,s,r,o){if(!s.readable||!s.writable)return s.destroy();if(s[h])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");const u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+n("sha1").update(e+d).digest("base64")],p=new c(null);let g=i.headers["sec-websocket-protocol"];if(g&&(g=g.trim().split(/ *, */),g=this.options.handleProtocols?this.options.handleProtocols(g,i):g[0],g&&(u.push("Sec-WebSocket-Protocol: "+g),p.protocol=g)),t[a.extensionName]){const e=t[a.extensionName].params,i=l({[a.extensionName]:[e]});u.push("Sec-WebSocket-Extensions: "+i),p._extensions=t}this.emit("headers",u,i),s.write(u.concat("\r\n").join("\r\n")),s.removeListener("error",f),p.setSocket(s,r,this.options.maxPayload),this.clients&&(this.clients.add(p),p.on("close",()=>this.clients.delete(p))),o(p)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(36),r=i(8),o=i(3),a=i(213);t.ThreadManager=class{constructor(e,t){this.logger=e,this.debugSession=t,this.nextThreadId=0,this.threads=[],this.bps={},this.hasConfigurationDone=!1,this.exceptionMode="Unhandled",this.nextDataId=1,this.storedData={}}registerThread(e,t){return s(this,void 0,void 0,(function*(){let i=this.getThreadInfoFromRef(e);i||(i=new l(this,e,this.nextThreadId),this.nextThreadId++,this.threads.push(i),this.debugSession.sendEvent(new n.ThreadEvent("started",i.num)),this.hasConfigurationDone&&i.receivedConfigurationDone()),"IsolateRunnable"!==t||i.runnable||(i.runnable=!0,this.debugSession.observatory&&(yield Promise.all([this.debugSession.observatory.setExceptionPauseMode(i.ref.id,this.exceptionMode),this.setLibrariesDebuggable(i.ref),this.resetBreakpoints()]),i.setInitialBreakpoints()))}))}setLibrariesDuggableForAllIsolates(){return s(this,void 0,void 0,(function*(){yield Promise.all(this.threads.map(e=>this.setLibrariesDebuggable(e.ref)))}))}receivedConfigurationDone(){this.hasConfigurationDone=!0;for(const e of this.threads)e.receivedConfigurationDone()}getThreadInfoFromRef(e){for(const t of this.threads)if(t.ref.id===e.id)return t}getThreadInfoFromNumber(e){for(const t of this.threads)if(t.num===e)return t}getThreads(){return this.threads.map(e=>new n.Thread(e.num,e.ref.name))}setExceptionPauseMode(e){return s(this,void 0,void 0,(function*(){this.exceptionMode=e,this.debugSession.observatory&&(yield Promise.all(this.threads.map(t=>s(this,void 0,void 0,(function*(){if(!t.runnable||!this.debugSession.observatory)return;let i=e;"All"===e&&t.isInfrastructure&&(i="Unhandled"),yield this.debugSession.observatory.setExceptionPauseMode(t.ref.id,i)})))))}))}setLibrariesDebuggable(e){return s(this,void 0,void 0,(function*(){if(this.debugSession.noDebug||!this.debugSession.observatory)return;const t=(yield this.debugSession.observatory.getIsolate(e.id)).result,i=t.libraries.filter(e=>this.debugSession.isValidToDebug(e.uri));if(0===i.length)return;const s=this.debugSession;function n(e){if(!s.observatory)return Promise.resolve(!0);const i=!(s.isSdkLibrary(e.uri)&&!s.debugSdkLibraries||s.isExternalLibrary(e.uri)&&!s.debugExternalLibraries);return s.observatory.setLibraryDebuggable(t.id,e.id,i)}const r=i[0];try{yield n(r)}catch(e){return void this.logger.info(o.errorString(e))}yield Promise.all(i.map(n)).catch(e=>this.logger.info(o.errorString(e)))}))}resetBreakpoints(){return s(this,void 0,void 0,(function*(){const e=[];for(const t of Object.keys(this.bps))e.push(this.setBreakpoints(t,this.bps[t]));yield Promise.all(e)}))}setBreakpoints(e,t){let i;0===t.length?delete this.bps[e]:this.bps[e]=t;for(const s of this.threads)if(s.runnable){const n=s.setBreakpoints(this.logger,e,t);i||(i=n)}if(i)return i;const s=new o.PromiseCompleter;return s.resolve(t.map(e=>!0)),s.promise}storeData(e,t){const i=this.nextDataId;return this.nextDataId++,this.storedData[i]=new c(e,t),i}getStoredData(e){return this.storedData[e]}removeStoredData(e){for(const t of Object.keys(this.storedData).map(e=>parseInt(e,10)))this.storedData[t].thread.num===e.num&&delete this.storedData[t]}removeAllStoredData(){for(const e of Object.keys(this.storedData).map(e=>parseInt(e,10)))delete this.storedData[e]}handleIsolateExit(e){const t=this.getThreadInfoFromRef(e);t&&(this.debugSession.sendEvent(new n.ThreadEvent("exited",t.num)),this.threads.splice(this.threads.indexOf(t),1),this.removeStoredData(t))}};class c{constructor(e,t){this.thread=e,this.data=t}}class l{constructor(e,t,i){this.manager=e,this.ref=t,this.num=i,this.scriptCompleters={},this.runnable=!1,this.vmBps={},this.breakpoints={},this.atAsyncSuspension=!1,this.exceptionReference=0,this.paused=!1,this.gotPauseStart=!1,this.initialBreakpoints=!1,this.hasConfigurationDone=!1,this.hasPendingResume=!1}get isInfrastructure(){return!(!this.ref||!this.ref.name)&&a.isKnownInfrastructureThread(this.ref)}removeBreakpointsAtUri(e){const t=[],i=this.vmBps[e];if(i){if(this.manager.debugSession.observatory)for(const e of i)t.push(this.manager.debugSession.observatory.removeBreakpoint(this.ref.id,e.id));delete this.vmBps[e]}return Promise.all(t)}removeAllBreakpoints(){const e=[];for(const t of Object.keys(this.vmBps))e.push(this.removeBreakpointsAtUri(t));return Promise.all(e).then(e=>[].concat.apply([],e))}setBreakpoints(e,t,i){return s(this,void 0,void 0,(function*(){return yield this.removeBreakpointsAtUri(t),this.vmBps[t]=[],Promise.all(i.map(i=>s(this,void 0,void 0,(function*(){try{if(!this.manager.debugSession.observatory)return;const e=(yield this.manager.debugSession.observatory.addBreakpointWithScriptUri(this.ref.id,t,i.line,i.column)).result;return this.vmBps[t].push(e),this.breakpoints[e.id]=i,e}catch(t){return void e.error(t,r.LogCategory.Observatory)}}))))}))}receivedPauseStart(){this.gotPauseStart=!0,this.paused=!0,this.checkResume()}setInitialBreakpoints(){this.initialBreakpoints=!0,this.checkResume()}receivedConfigurationDone(){this.hasConfigurationDone=!0,this.checkResume()}checkResume(){this.paused&&this.gotPauseStart&&this.initialBreakpoints&&this.hasConfigurationDone&&this.resume()}handleResumed(){this.manager.removeStoredData(this),this.atAsyncSuspension=!1,this.exceptionReference=0,this.paused=!1}resume(e,t){return s(this,void 0,void 0,(function*(){if(this.paused&&!this.hasPendingResume&&this.manager.debugSession.observatory){this.hasPendingResume=!0;try{yield this.manager.debugSession.observatory.resume(this.ref.id,e,t),this.handleResumed()}finally{this.hasPendingResume=!1}}}))}getScript(e){const t=e.id;if(this.scriptCompleters[t]){return this.scriptCompleters[t].promise}{const i=new o.PromiseCompleter;return this.scriptCompleters[t]=i,this.manager.debugSession.observatory?this.manager.debugSession.observatory.getObject(this.ref.id,e.id).then(e=>{const t=e.result;i.resolve(t)}).catch(e=>{i.reject(e)}):i.reject("Observatory connection is no longer available"),i.promise}}storeData(e){return this.manager.storeData(this,e)}handlePaused(e,t){this.atAsyncSuspension=!0===e,t&&(t.evaluateName="$e",this.exceptionReference=this.storeData(t)),this.paused=!0}}t.ThreadInfo=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=["pub.dart.snapshot","test.dart.snapshot"];t.isKnownInfrastructureThread=function(e){return!!(e&&e.name&&s.find(t=>e.name.startsWith(t)))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(1);t.formatPathForVm=function(e){return(e=(e=(e=(e=s.forceWindowsDriveLetterToUppercase(e)).replace(/\\/g,"/")).replace(/^file:\/+/,"")).replace(/^\/+/,"")).startsWith("dart:")?e:"file:///"+encodeURI(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(32);class n extends s.StdIOService{constructor(e,t,i,s,n,r,o){super(r,o,!0,!0,n),this.unhandledMessageSubscriptions=[],this.testStartedProcessSubscriptions=[],this.allTestNotificationsSubscriptions=[],this.createProcess(t,e,i,s)}shouldHandleMessage(e){return e.startsWith("{")&&e.endsWith("}")||e.startsWith("[{")&&e.endsWith("}]")}isNotification(e){return!(!e.type&&!e.event)}isResponse(e){return!1}processUnhandledMessage(e){this.notify(this.unhandledMessageSubscriptions,e)}registerForUnhandledMessages(e){return this.subscribe(this.unhandledMessageSubscriptions,e)}handleNotification(e){switch(e.event){case"test.startedProcess":this.notify(this.testStartedProcessSubscriptions,e.params)}this.notify(this.allTestNotificationsSubscriptions,e)}registerForTestStartedProcess(e){return this.subscribe(this.testStartedProcessSubscriptions,e)}registerForAllTestNotifications(e){return this.subscribe(this.allTestNotificationsSubscriptions,e)}}t.TestRunner=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ErrorDescription="ErrorDescription",e.ErrorSpacer="ErrorSpacer",e.DiagnosticsStackTrace="DiagnosticsStackTrace"}(t.DiagnosticsNodeType||(t.DiagnosticsNodeType={})),function(e){e.Error="error",e.Summary="summary",e.Hint="hint"}(t.DiagnosticsNodeLevel||(t.DiagnosticsNodeLevel={})),function(e){e.Flat="flat",e.Shallow="shallow"}(t.DiagnosticsNodeStyle||(t.DiagnosticsNodeStyle={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(8),n=i(12),r=i(3),o=i(51);class a extends o.RunDaemonBase{constructor(e,t,i,a,c,l,u,d,h,p,g){super(e,d,new n.CategoryLogger(h,s.LogCategory.FlutterRun),p,g,!0,!0);const f=e===o.RunMode.Attach?"attach":"run",{binPath:m,binArgs:v}=r.usingCustomScript(t,[f,"--machine"],{customScript:e===o.RunMode.Run?i:void 0});this.createProcess(c,m,a.concat(v).concat(l),u)}}t.FlutterRun=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(8),n=i(3),r=i(74),o=i(50);class a extends r.DartTestDebugSession{spawnProcess(e){let t=[];this.shouldConnectDebugger&&t.push("--start-paused"),e.args&&(t=t.concat(e.args)),e.program&&t.push(this.sourceFileForArgs(e));const{binPath:i,binArgs:r}=n.usingCustomScript(e.flutterPath,["test","--machine"],{customScript:e.flutterCustomTestScript}),a=new o.DebugAdapterLogger(this,s.LogCategory.FlutterTest);return this.createRunner(i,e.cwd,e.program,(e.globalFlutterArgs||[]).concat(r).concat(t),e.env,e.flutterTestLogFile,a,e.maxLogLineLength)}}t.FlutterTestDebugSession=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(8),n=i(102),r=i(51),o=i(220);class a extends n.FlutterDebugSession{constructor(){super(),this.supportsObservatory=!1,this.logCategory=s.LogCategory.WebDaemon}spawnRunDaemon(e,t,i){let s=[];return t.args&&(s=s.concat(t.args)),new o.WebRun(e?r.RunMode.Attach:r.RunMode.Run,t.pubPath,t.cwd,s,{envOverrides:t.env,toolEnv:this.toolEnv},t.webDaemonLogFile,i,e=>this.exposeUrl(e),this.maxLogLineLength)}}t.WebDebugSession=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(51);class n extends s.RunDaemonBase{constructor(e,t,i,s,n,r,o,a,c){super(e,r,o,a,c,!0,!0),this.createProcess(i,t,["global","run","webdev","daemon"].concat(s),n)}}t.WebRun=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(74);class n extends s.DartTestDebugSession{spawnProcess(e){}}t.WebTestDebugSession=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WebDev=class{constructor(e){this.pubGlobal=e}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired("webdev","webdev",void 0,"2.5.4")}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(18),o=i(2),a=i(0),c=i(0),l=i(4),u=i(8),d=i(12),h=i(32),p=i(3),g=i(1),f=i(25),m=i(5),v=i(69),y=i(9),b=i(13);let w;t.DevToolsManager=class{constructor(e,t,i,s,n){var r;this.logger=e,this.workspaceContext=t,this.debugCommands=i,this.analytics=s,this.pubGlobal=n,this.disposables=[],this.devToolsStatusBarItem=a.window.createStatusBarItem(a.StatusBarAlignment.Right,100),this.disposables.push(this.devToolsStatusBarItem),(null===(r=t.config)||void 0===r?void 0:r.activateDevToolsEagerly)&&this.preActivate(!0).then(()=>{this.logger.info("Finished background activating DevTools")},e=>{this.logger.error("Failed to background activate DevTools"),this.logger.error(e),a.window.showErrorMessage("Failed to activate DevTools: "+e)})}get devToolsActivation(){return this.devToolsActivationPromise}preActivate(e){var t;return s(this,void 0,void 0,(function*(){this.devToolsActivationPromise=this.pubGlobal.backgroundActivate("Dart DevTools","devtools",e,null===(t=this.workspaceContext.config)||void 0===t?void 0:t.devtoolsActivateScript),yield this.devToolsActivationPromise}))}spawnForSession(e,t,i,l){var d,h;return s(this,void 0,void 0,(function*(){if(this.analytics.logDebuggerOpenDevTools(),yield this.devToolsActivationPromise,!this.devtoolsUrl){if(!(null===(d=this.workspaceContext.config)||void 0===d?void 0:d.activateDevToolsEagerly)){if(!(yield this.pubGlobal.promptToInstallIfRequired("Dart DevTools","devtools",void 0,"0.1.10",null===(h=this.workspaceContext.config)||void 0===h?void 0:h.devtoolsActivateScript,!0)))return}this.devtoolsUrl=a.window.withProgress({location:a.ProgressLocation.Notification,title:"Starting Dart DevTools..."},e=>s(this,void 0,void 0,(function*(){return this.startServer()})))}try{const d=yield this.devtoolsUrl;return yield a.window.withProgress({location:a.ProgressLocation.Notification,title:"Opening Dart DevTools..."},h=>s(this,void 0,void 0,(function*(){const s={hide:"debugger",ide:"VSCode",theme:y.config.useDevToolsDarkTheme?"dark":void 0};if(m.isRunningLocally&&!process.env.DART_CODE_IS_TEST_RUN&&(yield f.waitFor(()=>this.debugCommands.vmServices.serviceIsRegistered(u.VmService.LaunchDevTools),500)))try{return yield e.session.customRequest("service",{params:{notify:i,page:l,queryParams:s,reuseWindows:t},type:this.debugCommands.vmServices.getServiceMethodName(u.VmService.LaunchDevTools)}),!0}catch(e){this.logger.error("DevTools failed to launch Chrome, will launch default browser locally instead: "+e.message),a.window.showWarningMessage("Dart DevTools was unable to launch Chrome so your default browser was launched instead.","Show Full Error").then(t=>{if(t){const t=`bug-${g.getRandomInt(4096,65536).toString(16)}.txt`,i=o.join(r.tmpdir(),t);n.writeFileSync(i,e.message||e),c.workspace.openTextDocument(i).then(e=>{c.window.showTextDocument(e)})}})}const h=Object.keys(s).filter(e=>void 0!==s[e]).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(s[e])}`).join("&"),p=a.Uri.parse(e.vmServiceUri),v=yield m.envUtils.exposeUrl(p,this.logger),b=`${d}?${h}&uri=${encodeURIComponent(v)}`;yield m.envUtils.openInBrowser(b,this.logger)}))),this.devToolsStatusBarItem.text="Dart DevTools",this.devToolsStatusBarItem.tooltip="Dart DevTools is running at "+d,this.devToolsStatusBarItem.command="dart.openDevTools",this.devToolsStatusBarItem.show(),{url:d,dispose:()=>this.dispose()}}catch(e){this.devToolsStatusBarItem.hide(),this.logger.error(e),a.window.showErrorMessage(""+e)}}))}startServer(e=!1){return new Promise((t,i)=>{const n=new S(this.logger,this.workspaceContext);this.disposables.push(n),n.registerForServerStarted(e=>{this.disposables.push(this.debugCommands.onDebugSessionVmServiceAvailable(e=>{n.vmRegister({uri:e.vmServiceUri})}));for(const e of v.debugSessions)e.vmServiceUri&&n.vmRegister({uri:e.vmServiceUri});w=e.port,t(`http://${e.host}:${e.port}/`)}),n.process.on("close",n=>s(this,void 0,void 0,(function*(){var s;if(this.devtoolsUrl=void 0,this.devToolsStatusBarItem.hide(),n&&0!==n){w=0;const r=`Dart DevTools exited with code ${n}.`;if(this.logger.error(r),!e&&!(null===(s=this.workspaceContext.config)||void 0===s?void 0:s.devtoolsActivateScript)){if((yield a.window.showErrorMessage(r+" Would you like to try reactivating DevTools?",l.reactivateDevToolsAction,l.skipAction))===l.reactivateDevToolsAction){try{yield this.preActivate(!1),yield this.startServer(!0),t()}catch(e){i(e)}return}}i(r)}})))})}dispose(){this.disposables.forEach(e=>e.dispose())}};class S extends h.StdIOService{constructor(e,t){var i;super(new d.CategoryLogger(e,u.LogCategory.DevTools),y.config.maxLogLineLength),this.serverStartedSubscriptions=[];const{binPath:s,binArgs:n}=p.usingCustomScript(o.join(t.sdks.dart,l.pubPath),["global","run","devtools","--machine","--enable-notifications","--try-ports","10"],{customScript:null===(i=t.config)||void 0===i?void 0:i.devtoolsRunScript,customScriptReplacesNumArgs:3});w=y.config.devToolsPort||w||(l.isChromeOS&&y.config.useKnownChromeOSPorts?l.CHROME_OS_DEVTOOLS_PORT:void 0),w&&(n.push("--port"),n.push(w.toString())),this.registerForServerStarted(e=>this.additionalPidsToTerminate.push(e.pid)),this.createProcess(void 0,s,n,{toolEnv:b.getToolEnv()})}shouldHandleMessage(e){return e.startsWith("{")&&e.endsWith("}")}isNotification(e){return e.event||"server.started"===e.method}handleNotification(e){switch(e.method||e.event){case"server.started":this.notify(this.serverStartedSubscriptions,e.params)}}registerForServerStarted(e){return this.subscribe(this.serverStartedSubscriptions,e)}vmRegister(e){return this.sendRequest("vm.register",e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);t.DartDebugSessionInformation=class{constructor(e,t){this.session=e,this.debuggerType=t,this.launchProgressPromise=new s.PromiseCompleter,this.terminatingProgressPromise=new s.PromiseCompleter,this.sessionStart=new Date}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(4),o=i(5);t.EditCommands=class{constructor(){this.commands=[],this.commands.push(n.commands.registerCommand("_dart.jumpToLineColInUri",this.jumpToLineColInUri,this),n.commands.registerCommand("_dart.showCode",o.showCode,this),n.commands.registerCommand("dart.writeRecommendedSettings",this.writeRecommendedSettings,this))}jumpToLineColInUri(e,t,i){return s(this,void 0,void 0,(function*(){if(!e||"file"!==e.scheme)return;const s=yield n.workspace.openTextDocument(e),r=yield n.window.showTextDocument(s);if(t&&i){const e=s.lineAt(t>0?t-1:0),i=e.range.start.translate({characterDelta:e.firstNonWhitespaceCharacterIndex});o.showCode(r,e.range,e.range,new n.Range(i,i))}}))}writeRecommendedSettings(){return s(this,void 0,void 0,(function*(){const e=n.workspace.getConfiguration("",null),t=e.inspect("[dart]"),i=t?t.globalValue:void 0,s=Object.assign({},r.dartRecommendedConfig,i);yield e.update("[dart]",s,n.ConfigurationTarget.Global),(yield n.window.showInformationMessage("Recommended settings were written to the [dart] section of your global settings file",r.openSettingsAction))===r.openSettingsAction&&(yield n.commands.executeCommand("workbench.action.openSettingsJson"))}))}dispose(){for(const e of this.commands)e.dispose()}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(64);t.LspEditCommands=class{constructor(e){this.analyzer=e,this.commands=[],this.commands.push(n.commands.registerCommand("dart.sortMembers",()=>this.runCodeAction("source.sortMembers")))}runCodeAction(e){return s(this,void 0,void 0,(function*(){return n.commands.executeCommand("editor.action.codeAction",{kind:e,apply:"ifSingle"})}))}completeStatement(){return s(this,void 0,void 0,(function*(){const e=n.window.activeTextEditor;if(!e||!e.selection)return;const t=yield this.analyzer.completeStatement({position:this.analyzer.client.code2ProtocolConverter.asPosition(e.selection.start),textDocument:this.analyzer.client.code2ProtocolConverter.asVersionedTextDocumentIdentifier(e.document)});if(t)if(yield this.validDocumentVersionsStillMatch(t)){const e=this.analyzer.client.protocol2CodeConverter.asWorkspaceEdit(t);(yield n.workspace.applyEdit(e))||n.window.showErrorMessage("VS Code failed to apply edits")}else n.window.showErrorMessage("Documents have been modified so edits could not be applied")}))}validDocumentVersionsStillMatch(e){return s(this,void 0,void 0,(function*(){if(!e.documentChanges)return!0;const t=new Map;n.workspace.textDocuments.forEach(e=>t.set(e.uri.toString(),e));for(const i of e.documentChanges)if(r.TextDocumentEdit.is(i)&&i.textDocument.version&&i.textDocument.version>=0&&r.TextDocumentEdit.is(i)&&i.textDocument.version&&i.textDocument.version>=0){const e=t.get(i.textDocument.uri);if(e&&e.version!==i.textDocument.version)return!1}return!0}))}dispose(){for(const e of this.commands)e.dispose()}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(5),a=i(37),c=i(108);t.GoToSuperCommand=class{constructor(e){this.analyzer=e,this.disposables=[],this.disposables.push(n.commands.registerCommand("dart.goToSuper",this.goToSuper,this))}goToSuper(){return s(this,void 0,void 0,(function*(){const e=a.getActiveDartEditor();if(!e)return void n.window.showWarningMessage("No active Dart editor.");const t=e.document,i=e.selection.start,s=c.findNearestOutlineNode(this.analyzer.fileTracker,t,i),l=s&&s.element&&s.element.location?s.element.location.offset:t.offsetAt(i),u=yield this.analyzer.client.searchGetTypeHierarchy({file:r.fsPath(t.uri),offset:l,superOnly:!0});if(!u||!u.hierarchyItems||!u.hierarchyItems.length||1===u.hierarchyItems.length)return;const d=!u.hierarchyItems[0].memberElement,h=u.hierarchyItems.slice(1).find(e=>d?!!e.classElement:!!e.memberElement),p=d?h&&h.classElement:h&&h.memberElement;if(!p||!p.location)return;const g=yield n.workspace.openTextDocument(p.location.file),f=yield n.window.showTextDocument(g),m=o.toRangeOnLine(p.location);o.showCode(f,m,m,m)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(8),l=i(12),u=i(1),d=i(13);t.OpenInOtherEditorCommands=class{constructor(e,t){this.logger=e,this.sdks=t,this.disposables=[],this.disposables.push(o.commands.registerCommand("flutter.openInAndroidStudio",this.openInAndroidStudio,this),o.commands.registerCommand("flutter.openInXcode",this.openInXcode,this))}openInAndroidStudio(e){return s(this,void 0,void 0,(function*(){const t=u.fsPath(e);let i=yield this.getAndroidStudioDir(t);if(i){if(a.isMac&&i.endsWith("/Contents"))return i=i.substr(0,i.length-"/Contents".length),void d.safeToolSpawn(t,"open",["-a",i,t]);for(const e of a.androidStudioPaths){const s=r.join(i,e);if(n.existsSync(s))return void d.safeToolSpawn(t,s,[t])}o.window.showErrorMessage("Unable to locate Android Studio executable")}else o.window.showErrorMessage("Unable to find Android Studio")}))}openInXcode(e){return s(this,void 0,void 0,(function*(){const t=u.fsPath(e),i=n.readdirSync(t,{withFileTypes:!0}).filter(e=>e.isDirectory()).filter(e=>e.name.endsWith(".xcworkspace")||e.name.endsWith(".xcodeproj")).sort((e,t)=>e.name.endsWith(".xcworkspace")?-1:1);if(!i||!i.length)return void o.window.showErrorMessage("Unable to find an Xcode project in your 'ios' folder");const s=r.join(t,i[0].name);d.safeToolSpawn(t,"open",[s])}))}getAndroidStudioDir(e){return new Promise((t,i)=>{if(!this.sdks.flutter)return void i("Cannot find Android Studio without a Flutter SDK");const s=r.join(this.sdks.flutter,a.flutterPath),n=d.safeToolSpawn(e,s,["config","--machine"]);l.logProcess(this.logger,c.LogCategory.CommandProcesses,n);const o=[];n.stdout.on("data",e=>{o.push(e.toString())}),n.on("exit",()=>{try{if(o.length){const e=JSON.parse(o.join(""));return void t(e["android-studio-dir"])}}catch(e){this.logger.error(e)}i()})})}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(0),o=i(4),a=i(3),c=i(21),l=i(1),u=i(25),d=i(9),h=i(75),p={EXTRACT_LOCAL_VARIABLE:function(e){return s(this,void 0,void 0,(function*(){const t=e;return{name:t&&t.names&&t.names.length?t.names[0]:"x",extractAll:!1}}))},EXTRACT_METHOD:function(e){return s(this,void 0,void 0,(function*(){const t=e,i=t&&t.names&&t.names.length?t.names[0]:void 0,s=yield r.window.showInputBox({prompt:"Enter a name for the method",value:i});if(s)return{createGetter:!1,extractAll:!1,name:s,parameters:t&&t.parameters,returnType:t&&t.returnType}}))},EXTRACT_WIDGET:function(e){return s(this,void 0,void 0,(function*(){const e=yield r.window.showInputBox({prompt:"Enter a name for the widget"});return e?{name:e}:void 0}))}};t.RefactorCommands=class{constructor(e,t,i){this.logger=e,this.context=t,this.analyzer=i,this.subscriptions=[],this.isProcessingMoveEvent=!1,this.inProgressRefactor=u.resolvedPromise,this.subscriptions.push(r.commands.registerCommand("_dart.performRefactor",this.performRefactor,this)),i.capabilities.supportsMoveFile&&d.config.previewUpdateImportsOnRename&&this.subscriptions.push(r.workspace.onWillRenameFiles(e=>this.onWillRenameFiles(e)))}performRefactor(e,t,i){return s(this,void 0,void 0,(function*(){if(!e||e.isClosed)return;const s=e.version,n=yield this.getRefactor(e,i,t,!0);if(this.shouldAbortRefactor(n))return;let o;if(p[i]&&(o=yield p[i](n.feedback),!o))return;const a=yield this.getRefactor(e,i,t,!1,o);(yield this.shouldApplyEdits(a,e,s))&&(yield r.commands.executeCommand("_dart.applySourceChange",e,a.change))}))}getRefactor(e,t,i,n,r){return s(this,void 0,void 0,(function*(){let s=3;for(;;)try{return s--,yield this.analyzer.editGetRefactoring({file:l.fsPath(e.uri),kind:t,length:e.offsetAt(i.end)-e.offsetAt(i.start),offset:e.offsetAt(i.start),options:r,validateOnly:n})}catch(e){if(this.logger.error(e),s<=0||"REFACTORING_REQUEST_CANCELLED"!==e.code)throw e;this.logger.info(`getRefactor failed, will try ${s} more times...`)}}))}shouldAbortRefactor(e){const t=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems).filter(e=>"FATAL"===e.severity);return!!t.length&&(r.window.showErrorMessage(t[0].message),!0)}shouldApplyEdits(e,t,i){return s(this,void 0,void 0,(function*(){const s=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems),n=s.filter(e=>"FATAL"===e.severity),a=s.filter(e=>"ERROR"===e.severity||"WARNING"===e.severity),l=!!s.find(e=>"ERROR"===e.severity);if(n.length)return r.window.showErrorMessage(c.unique(n.map(e=>e.message)).join("\n\n")+"\n\nYour refactor was not applied."),!1;if(!e.change)return!1;let u=!0;if(a.length){const e=l?r.window.showErrorMessage:r.window.showWarningMessage;u=o.REFACTOR_ANYWAY===(yield e(c.unique(a.map(e=>e.message)).join("\n\n"),o.REFACTOR_ANYWAY))}return u&&t&&t.version!==i?(r.window.showErrorMessage(o.REFACTOR_FAILED_DOC_MODIFIED),!1):u}))}onWillRenameFiles(e){if(this.isProcessingMoveEvent)this.logger.info("Skipping rename event for some files because another is in progress");else{this.isProcessingMoveEvent=!0;try{const t=a.flatMap(e.files,e=>this.getFilesToRename({oldPath:l.fsPath(e.oldUri),newPath:l.fsPath(e.newUri)})),i=this.getRenameEdits(t);e.waitUntil(i.finally(()=>this.isProcessingMoveEvent=!1))}catch(e){this.isProcessingMoveEvent=!1}}}runSequentially(e){return s(this,void 0,void 0,(function*(){return this.inProgressRefactor=this.inProgressRefactor.then(()=>e()),this.inProgressRefactor}))}getRenameEdits(e){return s(this,void 0,void 0,(function*(){const t=new r.WorkspaceEdit;for(const i of e){const e=yield this.runSequentially(()=>this.analyzer.editGetRefactoring({file:i.oldPath,kind:"MOVE_FILE",length:0,offset:0,options:{newFile:i.newPath},validateOnly:!1}));if(e.change&&(yield this.shouldApplyEdits(e))){if(h.hasOverlappingEdits(e.change))return r.window.showErrorMessage("Unable to update references; edits contain ambigious positions."),void this.logger.error("Unable to apply MOVE_FILE edits due to ambigious edits:\n\n"+JSON.stringify(e.change,void 0,4));for(const i of e.change.edits)for(const e of i.edits){const s=r.Uri.file(i.file),n=yield r.workspace.openTextDocument(s);t.replace(r.Uri.file(i.file),new r.Range(n.positionAt(e.offset),n.positionAt(e.offset+e.length)),e.replacement)}}}return t}))}getFilesToRename(e){const t=[];return n.statSync(e.oldPath).isFile()&&t.push(e),t}dispose(){for(const e of this.subscriptions)e.dispose()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(0),o=i(1);t.isPubGetProbablyRequired=function(e){const t=o.fsPath(e),i=n.join(t,"pubspec.yaml"),r=n.join(t,".packages");return!(!t||!s.existsSync(i))&&(!!new RegExp("dependencies\\s*:","i").test(s.readFileSync(i).toString())&&(!s.existsSync(r)||s.statSync(i).mtime>s.statSync(r).mtime))},t.promptToRunPubGet=function(e){r.window.showInformationMessage("Some packages are missing or out of date, would you like to get them now?","Get packages").then(t=>{"Get packages"===t&&function(e){let t=r.commands.executeCommand("dart.getPackages",e[0]);for(let i=1;i<e.length;i++)t=t.then(t=>{if(0===t)return r.commands.executeCommand("dart.getPackages",e[i])})}(e)})}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(4),a=i(8),c=i(12),l=i(13);t.Stagehand=class{constructor(e,t,i){this.logger=e,this.sdks=t,this.pubGlobal=i}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired("Stagehand","stagehand",o.stagehandInstallationInstructionsUrl,"3.3.0")}getTemplates(){return s(this,void 0,void 0,(function*(){const e=yield this.getTemplateJson();return JSON.parse(e)}))}getTemplateJson(){return s(this,void 0,void 0,(function*(){return this.runCommandWithProgress("Fetching Stagehand templates...",["global","run","stagehand","--machine"])}))}runCommandWithProgress(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:e},e=>this.runCommand(t))}runCommand(e){const t=this.sdks.dart,i=n.join(t,o.pubPath);return new Promise((t,s)=>{const n=l.safeToolSpawn(void 0,i,e);c.logProcess(this.logger,a.LogCategory.CommandProcesses,n);const r=[],o=[];n.stdout.on("data",e=>r.push(e.toString())),n.stderr.on("data",e=>o.push(e.toString())),n.on("close",e=>{e?s(`Stagehand exited with code ${e}.\n\n${r.join("")}\n\n${o.join("")}`):t(r.join(""))})})}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(27),o=i(18),a=i(2),c=i(4),l=i(1),u=i(13);t.getFlutterSnippets=function(e,t,i){return i.supportsFlutterCreateListSamples?function(e,t){return s(this,void 0,void 0,(function*(){if(!t.flutter)throw new Error("Flutter SDK not available");const i=a.join(t.flutter,c.flutterPath),s=`flutter-samples-${l.getRandomInt(4096,65536).toString(16)}.txt`,r=a.join(o.tmpdir(),s);try{const t=yield u.runProcess(e,void 0,i,["create","--list-samples",r]);if(0!==t.exitCode)throw new Error(`Failed to get Flutter samples from SDK (${t.exitCode})\n\n${t.stderr}\n\n${t.stdout}`);const s=n.readFileSync(r,{encoding:"utf8"});return JSON.parse(s)}finally{l.tryDeleteFile(r)}}))}(e,t):new Promise((e,t)=>{r.request({hostname:"api.flutter.dev",method:"GET",path:"/snippets/index.json",port:443},i=>{if(!i||!i.statusCode||i.statusCode<200||i.statusCode>300)t({message:`Failed to get Flutter samples ${i&&i.statusCode}: ${i&&i.statusMessage}`});else{const t=[];i.on("data",e=>t.push(e.toString())),i.on("end",()=>{const i=t.join("");e(JSON.parse(i))})}}).end()})}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(3),l=i(1),u=i(9),d=i(6);class h{constructor(e,t){this.logger=e,this.sdks=t}changeSdk(){this.sdkPaths?this.searchForSdks(this.sdkPaths).catch(e=>console.error(e)):o.window.showWarningMessage("Set `${configName}` to enable fast SDK switching.")}searchForSdks(e){return s(this,void 0,void 0,(function*(){let t=[];for(const i of e.filter(n.existsSync))t.push(i),t=t.concat(yield l.getChildFolders(i));this.currentSdk&&-1===t.indexOf(this.currentSdk)&&t.push(this.currentSdk);const i=t.filter(e=>n.existsSync(r.join(e,this.executablePath))).map(e=>{const t=n.realpathSync(r.join(e,this.executablePath)),i=r.dirname(r.dirname(t)),s=d.getSdkVersion(this.logger,{sdkRoot:i});return{description:e===this.currentSdk&&this.configuredSdk?"Current setting":"",detail:e,folder:e,label:s?this.getLabel(s):"Unknown version",version:s}}).sort((e,t)=>c.versionIsAtLeast(e.version||"0.0.0",t.version||"0.0.0")?1:-1);if(0===i.length)return;const s=[{description:this.configuredSdk?"":"Current setting",detail:this.configuredSdk?void 0:"Found at "+this.currentSdk,folder:void 0,label:"Auto-detect SDK location",version:void 0}].concat(i);o.window.showQuickPick(s,{placeHolder:"Select an SDK to use"}).then(e=>{e&&this.setSdk(e.folder)})}))}}t.DartSdkManager=class extends h{get sdkPaths(){return u.config.sdkPaths}get currentSdk(){return this.sdks.dart}get configuredSdk(){return u.config.sdkPath}get configName(){return"dart.sdkPaths"}get executablePath(){return a.dartVMPath}getLabel(e){return"Dart SDK "+e}setSdk(e){u.config.setSdkPath(e)}};t.FlutterSdkManager=class extends h{get sdkPaths(){return u.config.flutterSdkPaths}get currentSdk(){return this.sdks.flutter}get configuredSdk(){return u.config.flutterSdkPath}get configName(){return"dart.flutterSdkPaths"}get executablePath(){return a.flutterPath}getLabel(e){return"Flutter SDK "+e}setSdk(e){u.config.setFlutterSdkPath(e)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(1),c=i(68),l=i(93),u=i(106),d=i(37),h=i(6);t.cursorIsInTest=!1,t.isInTestFile=!1,t.isInImplementationFile=!1;class p{constructor(e){this.logger=e,this.disposables=[],this.disposables.push(o.commands.registerCommand("dart.runTestAtCursor",()=>this.runTestAtCursor(!1),this),o.commands.registerCommand("dart.goToTestOrImplementationFile",()=>this.goToTestOrImplementationFile(),this),o.commands.registerCommand("dart.debugTestAtCursor",()=>this.runTestAtCursor(!0),this),o.window.onDidChangeTextEditorSelection(e=>this.updateSelectionContexts(e)),o.window.onDidChangeActiveTextEditor(e=>this.updateEditorContexts(e))),this.disposables.push(o.commands.registerCommand("_dart.startDebuggingTestFromOutline",(e,t)=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(o.Uri.file(e.file)),u.getLaunchConfig(!1,e.file,e.fullName,e.isGroup,t))})),this.disposables.push(o.commands.registerCommand("_dart.startWithoutDebuggingTestFromOutline",(e,t)=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(o.Uri.file(e.file)),u.getLaunchConfig(!0,e.file,e.fullName,e.isGroup,t))}))}runTestAtCursor(e){return s(this,void 0,void 0,(function*(){const t=o.window.activeTextEditor,i=t&&t.selection&&this.testForCursor(t);if(i){const t=e?"_dart.startDebuggingTestFromOutline":"_dart.startWithoutDebuggingTestFromOutline";o.commands.executeCommand(t,i)}else o.window.showWarningMessage("There is no test at the current location.")}))}goToTestOrImplementationFile(){return s(this,void 0,void 0,(function*(){const e=o.window.activeTextEditor;if(e&&e.document&&d.isDartDocument(e.document)){const t=a.fsPath(e.document.uri),i=h.isTestFile(t)?this.getImplementationFileForTest(t):this.getTestFileForImplementation(t);if(i){const e=yield o.workspace.openTextDocument(i);yield o.window.showTextDocument(e)}}}))}updateSelectionContexts(e){const i=!!(e.textEditor&&e.selections&&1===e.selections.length&&this.testForCursor(e.textEditor));o.commands.executeCommand("setContext","dart-code:cursorIsInTest",i),t.cursorIsInTest=i}updateEditorContexts(e){if(t.isInTestFile=!1,t.isInImplementationFile=!1,e&&e.document&&d.isDartDocument(e.document)){const i=a.fsPath(e.document.uri);h.isTestFile(i)?t.isInTestFile=!!this.getImplementationFileForTest(i):t.isInImplementationFile=!!this.getTestFileForImplementation(i)}o.commands.executeCommand("setContext","dart-code:canGoToTestOrImplementationFile",t.isInTestFile||t.isInImplementationFile)}getImplementationFileForTest(e){const t=e.split(r.sep),i=t.lastIndexOf("test");-1!==i&&(t[i]="lib"),t[t.length-1]=t[t.length-1].replace(/_test\.dart/,".dart");const s=t.join(r.sep);return n.existsSync(s)?s:void 0}getTestFileForImplementation(e){const t=e.split(r.sep),i=t.lastIndexOf("lib");-1!==i&&(t[i]="test"),t[t.length-1]=t[t.length-1].replace(/\.dart/,"_test.dart");const s=t.join(r.sep);return n.existsSync(s)?s:void 0}dispose(){for(const e of this.disposables)e.dispose()}}t.DasTestCommands=class extends p{constructor(e,t){super(e),this.fileTracker=t}testForCursor(e){const t=e.document,i=this.fileTracker.getOutlineFor(t.uri);if(!i||!i.children||!i.children.length)return;if(!this.fileTracker.supportsPubRunTest(t.uri))return;const s=new c.TestOutlineVisitor(this.logger);return s.visit(i),s.tests.reverse().find(i=>{let s=t.positionAt(i.offset),n=t.positionAt(i.offset+i.length);return s=t.lineAt(s.line).rangeIncludingLineBreak.start,n=t.lineAt(n.line).rangeIncludingLineBreak.end,new o.Range(s,n).contains(e.selection)})}};t.LspTestCommands=class extends p{constructor(e,t){super(e),this.fileTracker=t}testForCursor(e){const t=e.document,i=this.fileTracker.getOutlineFor(t.uri);if(!i||!i.children||!i.children.length)return;if(!this.fileTracker.supportsPubRunTest(t.uri))return;const s=new l.LspTestOutlineVisitor(this.logger,a.fsPath(t.uri));return s.visit(i),s.tests.reverse().find(i=>{let s=i.range.start,n=i.range.end;return s=t.lineAt(s.line).rangeIncludingLineBreak.start,n=t.lineAt(n.line).rangeIncludingLineBreak.end,new o.Range(s.line,s.character,n.line,n.character).contains(e.selection)})}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(5),a=i(37);function c(e,t){return e[t].classElement.name}t.TypeHierarchyCommand=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.disposables.push(n.commands.registerCommand("dart.showTypeHierarchy",this.showTypeHierarchy,this))}showTypeHierarchy(){return s(this,void 0,void 0,(function*(){const e=a.getActiveDartEditor();if(!e)return void n.window.showWarningMessage("No active Dart editor.");const t=e.document,i=e.selection,s=(yield this.analyzer.searchGetTypeHierarchy({file:r.fsPath(t.uri),offset:t.offsetAt(e.selection.active)})).hierarchyItems;if(!s)return void n.window.showInformationMessage("Type hierarchy not available.");const o={onDidSelectItem:e=>this.openLocation(e,!0),placeHolder:c(s,0)},l=[],u=s[0];l.push(u),function e(t,i,s){if(s.superclass){const n=t[s.superclass];"Object"!==n.classElement.name&&(i.unshift(n),e(t,i,n))}}(s,l,u),function e(t,i,s){for(const e of s.subclasses){const s=t[e];i.push(s)}for(const n of s.subclasses){const s=t[n];s.subclasses.length>0&&e(t,i,s)}}(s,l,u);const d=yield n.window.showQuickPick(l.map(e=>function(e,t){let i="";void 0!==e.superclass&&"Object"!==c(t,e.superclass)&&(i+="extends "+c(t,e.superclass));e.interfaces.length>0&&(i.length>0&&(i+=", "),i+="implements "+e.interfaces.map(e=>c(t,e)).join(", "));e.mixins.length>0&&(i.length>0&&(i+=", "),i+="with "+e.mixins.map(e=>c(t,e)).join(", "));return{description:i,label:e.classElement.name,location:e.classElement.location}}(e,s)),o);if(d&&d.location)yield this.openLocation(d);else{const s=yield n.window.showTextDocument(t);s.revealRange(e.selection,n.TextEditorRevealType.InCenterIfOutsideViewport),s.selection=i}}))}openLocation(e,t=!1){return s(this,void 0,void 0,(function*(){if(!e.location)return void this.logger.warn("Unable to open item with no location");const i=e.location,s=yield n.workspace.openTextDocument(i.file),r=yield n.window.showTextDocument(s,{preserveFocus:t,preview:t}),a=o.toRangeOnLine(i);o.showCode(r,a,a,a)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(7),n=i(2),r=i(0),o=i(1),a=i(237),c=i(6);t.FlutterColorDecorations=class{constructor(e,t){this.logger=e,this.imageStoragePath=t,this.subscriptions=[],this.decorationTypes={},this.computer=new a.ColorRangeComputer,this.subscriptions.push(r.workspace.onDidChangeTextDocument(e=>{this.activeEditor&&e.document===this.activeEditor.document&&(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),1e3))})),this.subscriptions.push(r.window.onDidChangeActiveTextEditor(e=>{this.setTrackingFile(e),this.update()})),r.window.activeTextEditor&&(this.setTrackingFile(r.window.activeTextEditor),this.update())}update(){if(!this.activeEditor)return;const e=this.computer.compute(this.activeEditor.document);for(const t of Object.keys(e)){const e=this.createImageFile(t);e&&!this.decorationTypes[t]&&(this.decorationTypes[t]=r.window.createTextEditorDecorationType({gutterIconPath:r.Uri.file(e),gutterIconSize:"50%"}))}for(const t of Object.keys(this.decorationTypes))this.activeEditor.setDecorations(this.decorationTypes[t],e[t]||[])}setTrackingFile(e){e&&c.isAnalyzable(e.document)?this.activeEditor=e:this.activeEditor=void 0}createImageFile(e){const t=n.join(this.imageStoragePath,"v1");o.mkDirRecursive(t);const i=n.join(t,e+".svg");if(s.existsSync(i))return i;try{const t=e.substr(2),n=parseInt(e.substr(0,2),16)/255,r=l.replace("{HEX-6}",t).replace("{OPACITY}",n.toString());return s.writeFileSync(i,r),i}catch(e){this.logger.warn(e)}}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}};const l='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n\t<rect fill="#{HEX-6}" x="0" y="0" width="16" height="16" fill-opacity="{OPACITY}" />\n</svg>\n'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(238),n=i(3),r=i(5);t.ColorRangeComputer=class{constructor(){this.namedColorPattern=new RegExp("Colors\\.([\\w_\\[\\]\\.]+)","g"),this.colorConstructorPattern=new RegExp(" Color\\(0x([\\w_]{8})\\)","g"),this.colorConstructorPattern2=new RegExp(" Color\\.fromRGBO\\(([\\w_]+), ([\\w_]+), ([\\w_]+), ([\\w_.]+)\\)","g"),this.colorConstructorPattern3=new RegExp(" Color\\.fromARGB\\(([\\w_]+), ([\\w_]+), ([\\w_]+), ([\\w_]+)\\)","g")}compute(e){const t=e.getText(),i={};let o;for(;o=this.namedColorPattern.exec(t);){const t=o[1].replace(/\.shade(\d+)/,"[$1]");if(!(t in s.flutterColors)&&!(t+".primary"in s.flutterColors)){console.log(t+" missing");continue}const n=(s.flutterColors[t]||s.flutterColors[t+".primary"]).toLowerCase();i[n]||(i[n]=[]),i[n].push(r.toRange(e,o.index,o[0].length))}for(;o=this.colorConstructorPattern.exec(t);){const t=o[1].toLowerCase();i[t]||(i[t]=[]),i[t].push(r.toRange(e,o.index+1,o[0].length-1))}for(;o=this.colorConstructorPattern2.exec(t);){const t=parseInt(o[1],10),s=parseInt(o[2],10),a=parseInt(o[3],10),c=parseFloat(o[4]);if(isNaN(t)||isNaN(s)||isNaN(a)||isNaN(c))continue;const l=n.asHexColor({r:t,g:s,b:a,a:255*c});i[l]||(i[l]=[]),i[l].push(r.toRange(e,o.index+1,o[0].length-1))}for(;o=this.colorConstructorPattern3.exec(t);){const t=parseInt(o[1],10),s=parseInt(o[2],10),a=parseInt(o[3],10),c=parseInt(o[4],10);if(isNaN(s)||isNaN(a)||isNaN(c)||isNaN(t))continue;const l=n.asHexColor({a:t,r:s,g:a,b:c});i[l]||(i[l]=[]),i[l].push(r.toRange(e,o.index+1,o[0].length-1))}return i}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flutterColors={transparent:"00000000",black:"ff000000",black87:"dd000000",black54:"8a000000",black38:"61000000",black45:"73000000",black26:"42000000",black12:"1f000000",white:"ffffffff",white70:"b3ffffff",white30:"4dffffff",white12:"1fffffff",white10:"1affffff","grey.primary":"ff9e9e9e","grey[50]":"fffafafa","grey[100]":"fff5f5f5","grey[200]":"ffeeeeee","grey[300]":"ffe0e0e0","grey[350]":"ffd6d6d6","grey[400]":"ffbdbdbd","grey[500]":"ff9e9e9e","grey[600]":"ff757575","grey[700]":"ff616161","grey[800]":"ff424242","grey[850]":"ff303030","grey[900]":"ff212121","red.primary":"fff44336","red[50]":"ffffebee","red[100]":"ffffcdd2","red[200]":"ffef9a9a","red[300]":"ffe57373","red[400]":"ffef5350","red[500]":"fff44336","red[600]":"ffe53935","red[700]":"ffd32f2f","red[800]":"ffc62828","red[900]":"ffb71c1c","pink.primary":"ffe91e63","pink[50]":"fffce4ec","pink[100]":"fff8bbd0","pink[200]":"fff48fb1","pink[300]":"fff06292","pink[400]":"ffec407a","pink[500]":"ffe91e63","pink[600]":"ffd81b60","pink[700]":"ffc2185b","pink[800]":"ffad1457","pink[900]":"ff880e4f","purple.primary":"ff9c27b0","purple[50]":"fff3e5f5","purple[100]":"ffe1bee7","purple[200]":"ffce93d8","purple[300]":"ffba68c8","purple[400]":"ffab47bc","purple[500]":"ff9c27b0","purple[600]":"ff8e24aa","purple[700]":"ff7b1fa2","purple[800]":"ff6a1b9a","purple[900]":"ff4a148c","deepPurple.primary":"ff673ab7","deepPurple[50]":"ffede7f6","deepPurple[100]":"ffd1c4e9","deepPurple[200]":"ffb39ddb","deepPurple[300]":"ff9575cd","deepPurple[400]":"ff7e57c2","deepPurple[500]":"ff673ab7","deepPurple[600]":"ff5e35b1","deepPurple[700]":"ff512da8","deepPurple[800]":"ff4527a0","deepPurple[900]":"ff311b92","indigo.primary":"ff3f51b5","indigo[50]":"ffe8eaf6","indigo[100]":"ffc5cae9","indigo[200]":"ff9fa8da","indigo[300]":"ff7986cb","indigo[400]":"ff5c6bc0","indigo[500]":"ff3f51b5","indigo[600]":"ff3949ab","indigo[700]":"ff303f9f","indigo[800]":"ff283593","indigo[900]":"ff1a237e","blue.primary":"ff2196f3","blue[50]":"ffe3f2fd","blue[100]":"ffbbdefb","blue[200]":"ff90caf9","blue[300]":"ff64b5f6","blue[400]":"ff42a5f5","blue[500]":"ff2196f3","blue[600]":"ff1e88e5","blue[700]":"ff1976d2","blue[800]":"ff1565c0","blue[900]":"ff0d47a1","lightBlue.primary":"ff03a9f4","lightBlue[50]":"ffe1f5fe","lightBlue[100]":"ffb3e5fc","lightBlue[200]":"ff81d4fa","lightBlue[300]":"ff4fc3f7","lightBlue[400]":"ff29b6f6","lightBlue[500]":"ff03a9f4","lightBlue[600]":"ff039be5","lightBlue[700]":"ff0288d1","lightBlue[800]":"ff0277bd","lightBlue[900]":"ff01579b","cyan.primary":"ff00bcd4","cyan[50]":"ffe0f7fa","cyan[100]":"ffb2ebf2","cyan[200]":"ff80deea","cyan[300]":"ff4dd0e1","cyan[400]":"ff26c6da","cyan[500]":"ff00bcd4","cyan[600]":"ff00acc1","cyan[700]":"ff0097a7","cyan[800]":"ff00838f","cyan[900]":"ff006064","teal.primary":"ff009688","teal[50]":"ffe0f2f1","teal[100]":"ffb2dfdb","teal[200]":"ff80cbc4","teal[300]":"ff4db6ac","teal[400]":"ff26a69a","teal[500]":"ff009688","teal[600]":"ff00897b","teal[700]":"ff00796b","teal[800]":"ff00695c","teal[900]":"ff004d40","green.primary":"ff4caf50","green[50]":"ffe8f5e9","green[100]":"ffc8e6c9","green[200]":"ffa5d6a7","green[300]":"ff81c784","green[400]":"ff66bb6a","green[500]":"ff4caf50","green[600]":"ff43a047","green[700]":"ff388e3c","green[800]":"ff2e7d32","green[900]":"ff1b5e20","lightGreen.primary":"ff8bc34a","lightGreen[50]":"fff1f8e9","lightGreen[100]":"ffdcedc8","lightGreen[200]":"ffc5e1a5","lightGreen[300]":"ffaed581","lightGreen[400]":"ff9ccc65","lightGreen[500]":"ff8bc34a","lightGreen[600]":"ff7cb342","lightGreen[700]":"ff689f38","lightGreen[800]":"ff558b2f","lightGreen[900]":"ff33691e","lime.primary":"ffcddc39","lime[50]":"fff9fbe7","lime[100]":"fff0f4c3","lime[200]":"ffe6ee9c","lime[300]":"ffdce775","lime[400]":"ffd4e157","lime[500]":"ffcddc39","lime[600]":"ffc0ca33","lime[700]":"ffafb42b","lime[800]":"ff9e9d24","lime[900]":"ff827717","yellow.primary":"ffffeb3b","yellow[50]":"fffffde7","yellow[100]":"fffff9c4","yellow[200]":"fffff59d","yellow[300]":"fffff176","yellow[400]":"ffffee58","yellow[500]":"ffffeb3b","yellow[600]":"fffdd835","yellow[700]":"fffbc02d","yellow[800]":"fff9a825","yellow[900]":"fff57f17","amber.primary":"ffffc107","amber[50]":"fffff8e1","amber[100]":"ffffecb3","amber[200]":"ffffe082","amber[300]":"ffffd54f","amber[400]":"ffffca28","amber[500]":"ffffc107","amber[600]":"ffffb300","amber[700]":"ffffa000","amber[800]":"ffff8f00","amber[900]":"ffff6f00","orange.primary":"ffff9800","orange[50]":"fffff3e0","orange[100]":"ffffe0b2","orange[200]":"ffffcc80","orange[300]":"ffffb74d","orange[400]":"ffffa726","orange[500]":"ffff9800","orange[600]":"fffb8c00","orange[700]":"fff57c00","orange[800]":"ffef6c00","orange[900]":"ffe65100","deepOrange.primary":"ffff5722","deepOrange[50]":"fffbe9e7","deepOrange[100]":"ffffccbc","deepOrange[200]":"ffffab91","deepOrange[300]":"ffff8a65","deepOrange[400]":"ffff7043","deepOrange[500]":"ffff5722","deepOrange[600]":"fff4511e","deepOrange[700]":"ffe64a19","deepOrange[800]":"ffd84315","deepOrange[900]":"ffbf360c","brown.primary":"ff795548","brown[50]":"ffefebe9","brown[100]":"ffd7ccc8","brown[200]":"ffbcaaa4","brown[300]":"ffa1887f","brown[400]":"ff8d6e63","brown[500]":"ff795548","brown[600]":"ff6d4c41","brown[700]":"ff5d4037","brown[800]":"ff4e342e","brown[900]":"ff3e2723","blueGrey.primary":"ff607d8b","blueGrey[50]":"ffeceff1","blueGrey[100]":"ffcfd8dc","blueGrey[200]":"ffb0bec5","blueGrey[300]":"ff90a4ae","blueGrey[400]":"ff78909c","blueGrey[500]":"ff607d8b","blueGrey[600]":"ff546e7a","blueGrey[700]":"ff455a64","blueGrey[800]":"ff37474f","blueGrey[900]":"ff263238","redAccent.primary":"ffff5252","redAccent[100]":"ffff8a80","redAccent[200]":"ffff5252","redAccent[400]":"ffff1744","redAccent[700]":"ffd50000","pinkAccent.primary":"ffff4081","pinkAccent[100]":"ffff80ab","pinkAccent[200]":"ffff4081","pinkAccent[400]":"fff50057","pinkAccent[700]":"ffc51162","purpleAccent.primary":"ffe040fb","purpleAccent[100]":"ffea80fc","purpleAccent[200]":"ffe040fb","purpleAccent[400]":"ffd500f9","purpleAccent[700]":"ffaa00ff","deepPurpleAccent.primary":"ff7c4dff","deepPurpleAccent[100]":"ffb388ff","deepPurpleAccent[200]":"ff7c4dff","deepPurpleAccent[400]":"ff651fff","deepPurpleAccent[700]":"ff6200ea","indigoAccent.primary":"ff536dfe","indigoAccent[100]":"ff8c9eff","indigoAccent[200]":"ff536dfe","indigoAccent[400]":"ff3d5afe","indigoAccent[700]":"ff304ffe","blueAccent.primary":"ff448aff","blueAccent[100]":"ff82b1ff","blueAccent[200]":"ff448aff","blueAccent[400]":"ff2979ff","blueAccent[700]":"ff2962ff","lightBlueAccent.primary":"ff40c4ff","lightBlueAccent[100]":"ff80d8ff","lightBlueAccent[200]":"ff40c4ff","lightBlueAccent[400]":"ff00b0ff","lightBlueAccent[700]":"ff0091ea","cyanAccent.primary":"ff18ffff","cyanAccent[100]":"ff84ffff","cyanAccent[200]":"ff18ffff","cyanAccent[400]":"ff00e5ff","cyanAccent[700]":"ff00b8d4","tealAccent.primary":"ff64ffda","tealAccent[100]":"ffa7ffeb","tealAccent[200]":"ff64ffda","tealAccent[400]":"ff1de9b6","tealAccent[700]":"ff00bfa5","greenAccent.primary":"ff69f0ae","greenAccent[100]":"ffb9f6ca","greenAccent[200]":"ff69f0ae","greenAccent[400]":"ff00e676","greenAccent[700]":"ff00c853","lightGreenAccent.primary":"ffb2ff59","lightGreenAccent[100]":"ffccff90","lightGreenAccent[200]":"ffb2ff59","lightGreenAccent[400]":"ff76ff03","lightGreenAccent[700]":"ff64dd17","limeAccent.primary":"ffeeff41","limeAccent[100]":"fff4ff81","limeAccent[200]":"ffeeff41","limeAccent[400]":"ffc6ff00","limeAccent[700]":"ffaeea00","yellowAccent.primary":"ffffff00","yellowAccent[100]":"ffffff8d","yellowAccent[200]":"ffffff00","yellowAccent[400]":"ffffea00","yellowAccent[700]":"ffffd600","amberAccent.primary":"ffffd740","amberAccent[100]":"ffffe57f","amberAccent[200]":"ffffd740","amberAccent[400]":"ffffc400","amberAccent[700]":"ffffab00","orangeAccent.primary":"ffffab40","orangeAccent[100]":"ffffd180","orangeAccent[200]":"ffffab40","orangeAccent[400]":"ffff9100","orangeAccent[700]":"ffff6d00","deepOrangeAccent.primary":"ffff6e40","deepOrangeAccent[100]":"ffff9e80","deepOrangeAccent[200]":"ffff6e40","deepOrangeAccent[400]":"ffff3d00","deepOrangeAccent[700]":"ffdd2c00"}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(1),r=i(112),o=i(113);class a extends o.FlutterIconDecorations{constructor(e,t){super(e),this.analyzer=t,this.computer=new r.IconRangeComputer(e),this.subscriptions.push(this.analyzer.client.registerForFlutterOutline(e=>s(this,void 0,void 0,(function*(){this.activeEditor&&n.fsPath(this.activeEditor.document.uri)===e.file&&this.update(e.outline)}))))}update(e){if(!this.activeEditor)return;if(e||(e=this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri)),!e)return;const t=this.computer.compute(this.activeEditor.document,e);this.render(t)}}t.FlutterIconDecorationsDas=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FlutterOutlineVisitor=class{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.kind){case"DART_ELEMENT":this.visitDartElement(e);break;case"GENERIC":this.visitGeneric(e);break;case"NEW_INSTANCE":this.visitNewInstance(e);break;case"INVOCATION":this.visitInvocation(e);break;case"VARIABLE":this.visitVariable(e);break;case"PLACEHOLDER":this.visitPlaceholder(e);break;default:this.logger.error("Unknown Flutter Outline item! "+(e&&e.kind))}if(e.attributes)for(const t of e.attributes)this.visitAttribute(t)}visitDartElement(e){this.visitChildren(e)}visitGeneric(e){this.visitChildren(e)}visitNewInstance(e){this.visitChildren(e)}visitInvocation(e){this.visitChildren(e)}visitVariable(e){this.visitChildren(e)}visitPlaceholder(e){this.visitChildren(e)}visitAttribute(e){}};t.FlutterOutlineVisitorLsp=class{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.kind){case"DART_ELEMENT":this.visitDartElement(e);break;case"GENERIC":this.visitGeneric(e);break;case"NEW_INSTANCE":this.visitNewInstance(e);break;case"INVOCATION":this.visitInvocation(e);break;case"VARIABLE":this.visitVariable(e);break;case"PLACEHOLDER":this.visitPlaceholder(e);break;default:this.logger.error("Unknown Flutter Outline item! "+(e&&e.kind))}if(e.attributes)for(const t of e.attributes)this.visitAttribute(t)}visitDartElement(e){this.visitChildren(e)}visitGeneric(e){this.visitChildren(e)}visitNewInstance(e){this.visitChildren(e)}visitInvocation(e){this.visitChildren(e)}visitVariable(e){this.visitChildren(e)}visitPlaceholder(e){this.visitChildren(e)}visitAttribute(e){}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(1),r=i(112),o=i(113);class a extends o.FlutterIconDecorations{constructor(e,t){super(e),this.analyzer=t,this.computer=new r.IconRangeComputerLsp(e),this.subscriptions.push(this.analyzer.fileTracker.onFlutterOutline.listen(e=>s(this,void 0,void 0,(function*(){this.activeEditor&&n.fsPath(this.activeEditor.document.uri)===n.fsPath(e.uri)&&this.update(e.outline)}))))}update(e){if(!this.activeEditor)return;if(e||(e=this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri)),!e)return;const t=this.computer.compute(e);this.render(t)}}t.FlutterIconDecorationsLsp=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3),r=i(1),o=i(114);class a extends o.FlutterUiGuideDecorations{constructor(e){super(),this.analyzer=e,this.disposables.push(this.analyzer.client.registerForFlutterOutline(e=>{const t=s.window.activeTextEditor;t&&t.document&&r.fsPath(t.document.uri)===e.file&&this.buildFromOutline(t,e.outline)}))}buildForTextEditor(e){e&&e.document&&this.buildFromOutline(e,this.analyzer.fileTracker.getFlutterOutlineFor(e.document.uri))}buildFromOutline(e,t){if(this.tracker&&this.tracker.clear(),!e||!e.document||!t)return;if(e.document.getText().length!==t.length)return;const i=this.extractGuides(e.document,t);this.tracker&&this.tracker.trackDoc(e.document,i),this.renderGuides(e,i,"#A3A3A3")}extractGuides(e,t){let i=[];if("NEW_INSTANCE"===t.kind){const s=e.positionAt(t.offset).line,n=t.children&&t.children.map(t=>e.positionAt(t.offset).line).filter(e=>e>s);if(n){const t=this.firstNonWhitespace(e,s);n.forEach((s,n)=>{const r=this.firstNonWhitespace(e,s);i.push(new o.WidgetGuide(t,r))})}}return t.children&&(i=i.concat(n.flatMap(t.children,t=>this.extractGuides(e,t)))),i}}t.FlutterUiGuideDecorationsDas=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.DocumentPositionTracker=class{constructor(){this.disposables=[],this.tracker=new n,this.positionMap=new Map,this.onPositionsChangedEmitter=new s.EventEmitter,this.onPositionsChanged=this.onPositionsChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onOffsetsChanged(([e,t])=>{const i=new Map;for(const s of this.positionMap.keys()){const n=this.positionMap.get(s),r=t.get(n);r?i.set(s,e.positionAt(r)):i.delete(s)}this.onPositionsChangedEmitter.fire([e,i])})}clear(){this.positionMap.clear(),this.tracker.clear()}trackDoc(e,t){this.positionMap.clear();for(const i of t)this.positionMap.set(i,e.offsetAt(i));this.tracker.trackDoc(e,[...this.positionMap.values()])}dispose(){this.disposables.forEach(e=>e.dispose())}};class n{constructor(){this.disposables=[],this.offsetMap=new Map,this.onOffsetsChangedEmitter=new s.EventEmitter,this.onOffsetsChanged=this.onOffsetsChangedEmitter.event,this.disposables.push(s.workspace.onDidChangeTextDocument(e=>this.handleUpdate(e)))}trackDoc(e,t){this.document=e,this.offsetMap.clear();for(const e of t)this.offsetMap.set(e,e)}clear(){this.document=void 0,this.offsetMap.clear()}handleUpdate(e){if(e.document===this.document){for(const t of[...this.offsetMap.keys()]){const i=this.offsetMap.get(t),s=this.updateOffset(i,e);s?this.offsetMap.set(t,s):this.offsetMap.delete(t)}this.onOffsetsChangedEmitter.fire([e.document,this.offsetMap])}}updateOffset(e,t){if(t.contentChanges.find(t=>t.rangeOffset<e&&t.rangeOffset+t.rangeLength>e))return;const i=t.contentChanges.filter(t=>t.rangeOffset+t.rangeLength<=e).map(e=>e.text.length-e.rangeLength).reduce((e,t)=>e+t,0);return e+i}dispose(){this.disposables.forEach(e=>e.dispose())}}t.DocumentOffsetTracker=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3),r=i(1),o=i(5),a=i(114);class c extends a.FlutterUiGuideDecorations{constructor(e){super(),this.analyzer=e,this.disposables.push(this.analyzer.fileTracker.onFlutterOutline.listen(e=>{const t=s.window.activeTextEditor;t&&t.document&&r.fsPath(t.document.uri)===r.fsPath(e.uri)&&this.buildFromOutline(t,e.outline)}))}buildForTextEditor(e){e&&e.document&&this.buildFromOutline(e,this.analyzer.fileTracker.getFlutterOutlineFor(e.document.uri))}buildFromOutline(e,t){if(this.tracker&&this.tracker.clear(),!e||!e.document||!t)return;const i=e.document.offsetAt(o.lspToPosition(t.range.end));if(e.document.getText().length!==i)return;const s=this.extractGuides(e.document,t);this.tracker&&this.tracker.trackDoc(e.document,s),this.renderGuides(e,s,"#A3A3A3")}extractGuides(e,t){let i=[];if("NEW_INSTANCE"===t.kind){const s=t.codeRange.start.line,n=t.children&&t.children.map(e=>e.codeRange.start.line).filter(e=>e>s);if(n){const t=this.firstNonWhitespace(e,s);n.forEach((s,n)=>{const r=this.firstNonWhitespace(e,s);i.push(new a.WidgetGuide(t,r))})}}return t.children&&(i=i.concat(n.flatMap(t.children,t=>this.extractGuides(e,t)))),i}}t.FlutterUiGuideDecorationsLsp=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(52);t.setUpDaemonMessageHandler=function(e,t,i){const r=n.createChannel("flutter daemon");t.subscriptions.push(i.registerForDaemonLog(e=>{r.appendLine(`${e.error?"[ERR] ":""}${e.log}`)})),t.subscriptions.push(i.registerForDaemonShowMessage(t=>{const i=`${t.title.trim().endsWith(".")?t.title.trim():t.title.trim()+"."} ${t.message}`.trim();switch(t.level){case"info":s.window.showInformationMessage(i);break;case"warning":s.window.showWarningMessage(i);break;case"error":s.window.showErrorMessage(i);break;default:e.warn("Unexpected daemon.showMessage type: "+t.level)}}))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(0),a=i(78),c=i(4),l=i(8),u=i(12),d=i(32),h=i(3),p=i(9),g=i(22),f=i(6),m=i(13);class v extends d.StdIOService{constructor(e,t){var i;super(new u.CategoryLogger(e,l.LogCategory.FlutterDaemon),p.config.maxLogLineLength,!0),this.hasStarted=!1,this.daemonStartedCompleter=new h.PromiseCompleter,this.capabilities=a.DaemonCapabilities.empty,this.hasShownStartupError=!1,this.daemonConnectedSubscriptions=[],this.deviceAddedSubscriptions=[],this.deviceRemovedSubscriptions=[],this.daemonLogMessageSubscriptions=[],this.daemonLogSubscriptions=[],this.daemonShowMessageSubscriptions=[];const s=t.sdks.flutter;this.registerForDaemonConnected(e=>{this.additionalPidsToTerminate.push(e.pid),this.capabilities.version=e.version,r.commands.executeCommand("setContext",g.FLUTTER_SUPPORTS_ATTACH,this.capabilities.canFlutterAttach),this.deviceEnable()});const{binPath:o,binArgs:d}=h.usingCustomScript(n.join(t.sdks.flutter,c.flutterPath),["daemon"],{customScript:null===(i=t.config)||void 0===i?void 0:i.flutterDaemonScript}),f=p.config.for(r.Uri.file(s)).flutterAdditionalArgs,v=m.getGlobalFlutterArgs().concat(f).concat(d);if(this.createProcess(s,o,v,{toolEnv:m.getToolEnv()}),c.isChromeOS&&p.config.flutterAdbConnectOnChromeOs){e.info("Running ADB Connect on Chrome OS");const t=m.safeToolSpawn(void 0,"adb",["connect","100.115.92.2:5555"]);u.logProcess(e,l.LogCategory.General,t)}}dispose(){super.dispose()}sendMessage(e){try{super.sendMessage(e)}catch(e){throw f.promptToReloadExtension("The Flutter Daemon has terminated.",void 0,!0),e}}shouldHandleMessage(e){return!(!e.startsWith("[{")||!e.endsWith("}]"))&&(this.hasStarted||(this.hasStarted=!0,this.daemonStartedCompleter.resolve()),!0)}processUnhandledMessage(e){return s(this,void 0,void 0,(function*(){let t;const i=v.outOfDateWarning.exec(e);if(i&&2===i.length?t=`Your installation of Flutter is ${i[1]} days old.`:-1!==e.indexOf(v.newVersionMessage)&&(t="A new version of Flutter is available"),!t)return!this.hasShownStartupError&&e.startsWith("Flutter requires")?(this.logger.error(e,l.LogCategory.FlutterDaemon),r.window.showErrorMessage(e),void(this.hasShownStartupError=!0)):void((e.startsWith("Building ")||e.startsWith("Downloading ")||e.startsWith("Starting ")||e.startsWith("Running "))&&!e.startsWith("Starting device daemon")&&(this.hasStarted||(this.startupReporter?this.startupReporter.report({message:e}):r.window.withProgress({location:o.ProgressLocation.Notification,title:"Flutter Setup"},t=>(this.startupReporter=t,this.startupReporter.report({message:e}),this.daemonStartedCompleter.promise)))));(yield r.window.showWarningMessage(t,"Upgrade Flutter"))&&r.commands.executeCommand("flutter.upgrade")}))}handleNotification(e){switch(e.event){case"daemon.connected":this.notify(this.daemonConnectedSubscriptions,e.params);break;case"device.added":this.notify(this.deviceAddedSubscriptions,e.params);break;case"device.removed":this.notify(this.deviceRemovedSubscriptions,e.params);break;case"daemon.logMessage":this.notify(this.daemonLogMessageSubscriptions,e.params);break;case"daemon.log":this.notify(this.daemonLogSubscriptions,e.params);break;case"daemon.showMessage":this.notify(this.daemonShowMessageSubscriptions,e.params)}}deviceEnable(){return this.sendRequest("device.enable")}getEmulators(){return this.sendRequest("emulator.getEmulators")}launchEmulator(e){return this.sendRequest("emulator.launch",{emulatorId:e})}createEmulator(e){return this.sendRequest("emulator.create",{name:e})}getSupportedPlatforms(e){return this.sendRequest("daemon.getSupportedPlatforms",{projectRoot:e})}registerForDaemonConnected(e){return this.subscribe(this.daemonConnectedSubscriptions,e)}registerForDeviceAdded(e){return this.subscribe(this.deviceAddedSubscriptions,e)}registerForDeviceRemoved(e){return this.subscribe(this.deviceRemovedSubscriptions,e)}registerForDaemonLogMessage(e){return this.subscribe(this.daemonLogMessageSubscriptions,e)}registerForDaemonLog(e){return this.subscribe(this.daemonLogSubscriptions,e)}registerForDaemonShowMessage(e){return this.subscribe(this.daemonShowMessageSubscriptions,e)}}t.FlutterDaemon=v,v.outOfDateWarning=new RegExp("WARNING: .* Flutter is (\\d+) days old"),v.newVersionMessage="A new version of Flutter is available"},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(12),a=i(1),c=i(14),l=i(248),u=i(5),d=i(30),h=i(107),p=i(6);class g{constructor(){this.subscriptions=[],this.treeNodesByLine=[],this.onDidChangeTreeDataEmitter=new r.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event}setTrackingFile(e){e&&p.isAnalyzable(e.document)?(this.activeEditor=e,this.loadExistingOutline()):e&&"file"===e.document.uri.scheme?(this.activeEditor=void 0,g.hideTree()):setTimeout(()=>{r.window.visibleTextEditors.filter(e=>p.isAnalyzable(e.document)).length||g.hideTree()},100)}setContexts(e){return s(this,void 0,void 0,(function*(){this.lastSelectedWidget&&(this.lastSelectedWidget.contextValue=void 0,this.refresh(this.lastSelectedWidget));for(const e of h.flutterOutlineCommands)r.commands.executeCommand("setContext","dart-code:widgetSupports:"+e,!1);if(this.activeEditor&&e&&1===e.length&&f(e[0].outline)){const t=(yield function(e,t){return s(this,void 0,void 0,(function*(){const i="range"in t?u.lspToPosition(t.range.start):e.document.positionAt(t.offset),s=new r.Range(i,i);return(yield r.commands.executeCommand("vscode.executeCodeActionProvider",e.document.uri,s))||[]}))}(this.activeEditor,e[0].outline)).filter(e=>e instanceof r.CodeAction).filter(e=>e.kind&&e.kind.value&&-1!==h.flutterOutlineCommands.indexOf(e.kind.value));e[0].fixes=t;for(const e of t)r.commands.executeCommand("setContext","dart-code:widgetSupports:"+(e.kind?e.kind.value:"NOKIND"),!0);e[0].contextValue="dart-code:isSelectedWidget",this.lastSelectedWidget=e[0],this.refresh(e[0])}}))}getNodeAt(e,t){if(!this.activeEditor||!this.flutterOutline||a.fsPath(this.activeEditor.document.uri)!==a.fsPath(e)||!this.treeNodesByLine[t.line])return;const i=this.treeNodesByLine[t.line];let s;for(const e of i){("range"in e.outline?u.lspToRange(e.outline.range):u.toRange(this.activeEditor.document,e.outline.offset,e.outline.length)).contains(t)&&(s=e)}return s!==this.rootNode?s:void 0}refresh(e){this.onDidChangeTreeDataEmitter.fire(e)}getTreeItem(e){return e}getChildren(e){return e?e.children:this.rootNode?this.rootNode.children:[]}getParent(e){return e.parent}static setTreeVisible(e){r.commands.executeCommand("setContext","dart-code:showFlutterOutline",e)}static showTree(){this.setTreeVisible(!0)}static hideTree(){this.setTreeVisible(!1)}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}t.FlutterOutlineProvider=g;t.DasFlutterOutlineProvider=class extends g{constructor(e){super(),this.analyzer=e,this.analyzer.client.registerForServerConnected(t=>{e.client.capabilities.supportsFlutterOutline&&(this.analyzer.client.registerForFlutterOutline(e=>{this.activeEditor&&e.file===a.fsPath(this.activeEditor.document.uri)&&(this.flutterOutline=e.outline,this.treeNodesByLine=[],this.updateTimeout&&clearTimeout(this.updateTimeout),this.rootNode?this.updateTimeout=setTimeout(()=>this.update(),200):this.update())}),this.subscriptions.push(r.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),r.window.activeTextEditor&&this.setTrackingFile(r.window.activeTextEditor))})}loadExistingOutline(){return s(this,void 0,void 0,(function*(){this.flutterOutline=this.activeEditor?this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri):void 0,this.flutterOutline?yield this.update():(this.rootNode=void 0,this.refresh()),this.activeEditor&&this.analyzer.client.forceNotificationsFor(a.fsPath(this.activeEditor.document.uri))}))}update(){return s(this,void 0,void 0,(function*(){this.flutterOutline?(this.rootNode=yield this.createTreeNode(void 0,this.flutterOutline,this.activeEditor),g.showTree()):(this.rootNode=void 0,g.hideTree()),this.refresh()}))}createTreeNode(e,t,i){return s(this,void 0,void 0,(function*(){if(i&&i.document&&!i.document.isClosed&&this.activeEditor===i){const s=new m(e,t,i),n=i.document.positionAt(t.offset).line,r=i.document.positionAt(t.offset+t.length).line;for(let e=n;e<=r;e++)this.treeNodesByLine[e]||(this.treeNodesByLine[e]=[]),this.treeNodesByLine[e].push(s);return t.children&&(s.children=(yield Promise.all(t.children.map(e=>this.createTreeNode(s,e,i)))).filter(e=>e).map(e=>e)),s}}))}};function f(e){return"DART_ELEMENT"!==e.kind}t.LspFlutterOutlineProvider=class extends g{constructor(e){super(),this.analyzer=e,this.analyzer.fileTracker.onFlutterOutline.listen(e=>{this.activeEditor&&a.fsPath(r.Uri.parse(e.uri))===a.fsPath(this.activeEditor.document.uri)&&(this.flutterOutline=e.outline,this.treeNodesByLine=[],this.updateTimeout&&clearTimeout(this.updateTimeout),this.rootNode?this.updateTimeout=setTimeout(()=>this.update(),200):this.update())}),this.subscriptions.push(r.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),r.window.activeTextEditor&&this.setTrackingFile(r.window.activeTextEditor)}loadExistingOutline(){return s(this,void 0,void 0,(function*(){this.flutterOutline=this.activeEditor?this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri):void 0,this.flutterOutline?yield this.update():(this.rootNode=void 0,this.refresh())}))}update(){return s(this,void 0,void 0,(function*(){this.flutterOutline?(this.rootNode=yield this.createTreeNode(void 0,this.flutterOutline,this.activeEditor),g.showTree()):(this.rootNode=void 0,g.hideTree()),this.refresh()}))}createTreeNode(e,t,i){return s(this,void 0,void 0,(function*(){if(i&&i.document&&!i.document.isClosed&&this.activeEditor===i){const s=new m(e,t,i),n=t.range.start.line,r=t.range.end.line;for(let e=n;e<=r;e++)this.treeNodesByLine[e]||(this.treeNodesByLine[e]=[]),this.treeNodesByLine[e].push(s);return t.children&&(s.children=(yield Promise.all(t.children.map(e=>this.createTreeNode(s,e,i)))).filter(e=>e).map(e=>e)),s}}))}};class m extends r.TreeItem{constructor(e,t,i){if(super(m.getLabel(t),t.children&&t.children.length?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.None),this.parent=e,this.outline=t,this.children=[],this.fixes=[],f(t))this.iconPath=r.Uri.file(n.join(c.extensionPath,"media/icons/flutter_widget.svg"));else if(t.dartElement){const e=l.getIconForSymbolKind(d.getSymbolKindForElementKind(o.nullLogger,t.dartElement.kind));this.iconPath={dark:r.Uri.file(n.join(c.extensionPath,`media/icons/vscode_symbols/${e}-dark.svg`)),light:r.Uri.file(n.join(c.extensionPath,`media/icons/vscode_symbols/${e}-light.svg`))}}const s="range"in t?t.range:new r.Range(i.document.positionAt(t.offset),i.document.positionAt(t.offset+t.length)),a="codeRange"in t?t.codeRange:new r.Range(i.document.positionAt(t.codeOffset),i.document.positionAt(t.codeOffset+t.codeLength)),h="range"in t?t.dartElement&&t.dartElement.range?u.lspToPosition(t.dartElement.range.start):u.lspToPosition(t.range.start):t.dartElement&&t.dartElement.location&&t.dartElement.location.offset?i.document.positionAt(t.dartElement.location.offset):i.document.positionAt(t.offset);this.command={arguments:[i,s,a,new r.Range(h,h)],command:"_dart.showCode",title:""},this.tooltip=this.label,t.attributes&&t.attributes.length&&(this.tooltip+="\n  "+t.attributes.map(e=>`${e.name}: ${e.label}`).join("\n   "))}static getLabel(e){let t="";return e.dartElement&&(t+=" "+e.dartElement.name,e.dartElement.typeParameters&&(t+=e.dartElement.typeParameters),e.dartElement.parameters&&(t+=e.dartElement.parameters),e.dartElement.returnType&&(t+=" → "+e.dartElement.returnType)),e.variableName&&(t+=" "+e.variableName),e.className&&(t+=" "+e.className),e.label&&(t+=" "+e.label),t.trim()}}t.FlutterWidgetItem=m},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n={[s.SymbolKind.Array]:"indexer",[s.SymbolKind.Boolean]:"boolean",[s.SymbolKind.Class]:"class",[s.SymbolKind.Constant]:"constant",[s.SymbolKind.Constructor]:"method",[s.SymbolKind.Enum]:"enumerator",[s.SymbolKind.EnumMember]:"enumerator-item",[s.SymbolKind.Event]:"event",[s.SymbolKind.Field]:"field",[s.SymbolKind.File]:"file",[s.SymbolKind.Function]:"method",[s.SymbolKind.Interface]:"interface",[s.SymbolKind.Key]:"string",[s.SymbolKind.Method]:"method",[s.SymbolKind.Module]:"namespace",[s.SymbolKind.Namespace]:"namespace",[s.SymbolKind.Null]:"boolean",[s.SymbolKind.Number]:"numeric",[s.SymbolKind.Object]:"namespace",[s.SymbolKind.Operator]:"operator",[s.SymbolKind.Package]:"namespace",[s.SymbolKind.Property]:"property",[s.SymbolKind.String]:"string",[s.SymbolKind.Struct]:"structure",[s.SymbolKind.TypeParameter]:"type-parameter",[s.SymbolKind.Variable]:"variable"};t.getIconForSymbolKind=function(e){return n[e]||"field"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(0),r=i(4),o=i(8),a=i(1),c=i(9),l=i(6);t.HotReloadOnSaveHandler=class{constructor(e){this.debugCommands=e,this.disposables=[],this.disposables.push(n.workspace.onDidSaveTextDocument(e=>{c.config.previewHotReloadOnSaveWatcher||this.triggerReload(e)}));const t=n.workspace.createFileSystemWatcher("**/*.dart");this.disposables.push(t),t.onDidChange(this.handleFileSystemChange,this),t.onDidCreate(this.handleFileSystemChange,this)}handleFileSystemChange(e){c.config.previewHotReloadOnSaveWatcher&&this.triggerReload({uri:e})}triggerReload(e){if(-1!==a.fsPath(e.uri).indexOf(`${s.sep}.dart_tool${s.sep}`))return;const t=this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotReload)&&c.config.flutterHotReloadOnSave,i=!this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotReload)&&this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotRestart)&&c.config.flutterHotRestartOnSave;if(!t&&!i)return;const u=t?"flutter.hotReload":"flutter.hotRestart";if(!l.isWithinWorkspace(a.fsPath(e.uri))||!l.shouldHotReloadFor(e))return;const d=n.languages.getDiagnostics(e.uri);d&&null!=d.find(e=>"dart"===e.source&&e.severity===n.DiagnosticSeverity.Error)||(this.hotReloadDelayTimer&&clearTimeout(this.hotReloadDelayTimer),this.hotReloadDelayTimer=setTimeout(()=>{this.hotReloadDelayTimer=void 0,n.commands.executeCommand(u,{reason:r.restartReasonSave})},200))}dispose(){this.hotReloadDelayTimer&&clearTimeout(this.hotReloadDelayTimer),this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(3);t.LspAnalyzerStatusReporter=class{constructor(e){this.analyzer=e,this.analysisInProgress=!1,e.onAnalysisStatusChange.listen(e=>this.handleServerStatus(e.isAnalyzing))}handleServerStatus(e){this.analysisInProgress=e,this.analysisInProgress?setTimeout(()=>{this.analysisInProgress&&!this.analyzingPromise&&s.window.withProgress({location:s.ProgressLocation.Window,title:"Analyzing…"},e=>(this.analyzingPromise||(this.analyzingPromise=new n.PromiseCompleter),this.analyzingPromise.promise))},100):this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(67),r=i(1),o=i(111);t.LspClosingLabelsDecorations=class{constructor(e){this.analyzer=e,this.subscriptions=[],this.closingLabels={},this.editors={},this.decorationType=s.window.createTextEditorDecorationType({after:{color:new s.ThemeColor("dart.closingLabels"),margin:"2px"},rangeBehavior:s.DecorationRangeBehavior.ClosedOpen}),e.onReady().then(()=>{this.analyzer.onNotification(n.PublishClosingLabelsNotification.type,e=>{const t=r.fsPath(s.Uri.parse(e.uri));this.closingLabels[t]=e,s.window.activeTextEditor&&s.window.activeTextEditor.document&&t===r.fsPath(s.window.activeTextEditor.document.uri)&&(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),500))})}),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>this.update())),this.subscriptions.push(s.workspace.onDidCloseTextDocument(e=>{const t=r.fsPath(e.uri);delete this.closingLabels[t]})),s.window.activeTextEditor&&this.update()}update(){const e=s.window.activeTextEditor;if(!e||!e.document)return;const t=r.fsPath(e.document.uri);if(!this.closingLabels[t])return;const i=[];for(const n of this.closingLabels[t].labels){const t=this.analyzer.protocol2CodeConverter.asRange(n.range),r=t.end;if(r.character<1)return;const a=new s.Range(r.translate({characterDelta:-1}),r),c=e.document.getText(a);if(-1===o.validLastCharacters.indexOf(c))return;const l=e.document.lineAt(r).range.end,u=i[l.line];if(u)u.renderOptions.after.contentText=" // "+n.label+" "+u.renderOptions.after.contentText;else{const e={range:new s.Range(t.start,l),renderOptions:{after:{contentText:" // "+n.label}}};i[l.line]=e}}this.editors[t]=e,e.setDecorations(this.decorationType,Object.keys(i).map(e=>parseInt(e,10)).map(e=>i[e]))}dispose(){for(const e of Object.values(this.editors))try{e.setDecorations(this.decorationType,[])}catch(e){}this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(5),o=i(37);t.LspGoToSuperCommand=class{constructor(e){this.analyzer=e,this.disposables=[],this.disposables.push(n.commands.registerCommand("dart.goToSuper",this.goToSuper,this))}goToSuper(){return s(this,void 0,void 0,(function*(){const e=o.getActiveDartEditor();if(!e)return void n.window.showWarningMessage("No active Dart editor.");const t=yield this.analyzer.getSuper({position:this.analyzer.client.code2ProtocolConverter.asPosition(e.selection.start),textDocument:this.analyzer.client.code2ProtocolConverter.asVersionedTextDocumentIdentifier(e.document)});if(!t)return;const i=this.analyzer.client.protocol2CodeConverter.asLocation(t),s=yield n.workspace.openTextDocument(i.uri),a=yield n.window.showTextDocument(s);r.showCode(a,i.range,i.range,i.range)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(6),a=i(76);t.AssistCodeActionProvider=class{constructor(e,t,i){this.logger=e,this.selector=t,this.analyzer=i,this.rank=10,this.metadata={providedCodeActionKinds:[n.CodeActionKind.Refactor]}}provideCodeActions(e,t,i,a){return s(this,void 0,void 0,(function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||n.CodeActionKind.Refactor.contains(i.only)))try{const s=(yield this.analyzer.editGetAssists({file:r.fsPath(e.uri),length:t.end.character-t.start.character,offset:e.offsetAt(t.start)})).assists.map(t=>this.convertResult(e,t));return i.only?s.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):s}catch(e){this.logger.error(e)}}))}convertResult(e,t){const i=t.message,s=a.getKindFor(t.id,n.CodeActionKind.Refactor),r=new n.CodeAction(i,s);return r.command={arguments:[e,t],command:"_dart.applySourceChange",title:i},r}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(0),a=i(3),c=i(1),l=i(25),u=i(14),d=i(75),h=i(9);t.DartCompletionItemProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.cachedCompletions={},this.existingImports={},this.disposables.push(t.registerForCompletionAvailableSuggestions(e=>this.storeCompletionSuggestions(e))),this.disposables.push(t.registerForCompletionExistingImports(e=>this.storeExistingImports(e)))}provideCompletionItems(e,t,i,n){return s(this,void 0,void 0,(function*(){const s=e.lineAt(t.line).text.slice(0,t.character),r=e.getText(new o.Range(t,t.translate({characterDelta:200}))).trim().substr(0,1),a=h.config.for(e.uri),u=a.enableCompletionCommitCharacters,d=!u&&a.insertArgumentPlaceholders&&this.shouldAllowArgPlaceholders(s);if(!this.shouldAllowCompletion(s,n))return;const p=e.offsetAt(t),g=yield this.analyzer.completionGetSuggestionsResults({file:c.fsPath(e.uri),offset:p});if(i&&i.isCancellationRequested)return;const f=g.results.map(t=>this.convertResult(e,p,r,u,d,g,t)),m=yield this.getCachedResults(e,i,r,u,d,e.offsetAt(t),g);if(yield l.resolvedPromise,i&&i.isCancellationRequested)return;const v=[...f,...m];return new o.CompletionList(v)}))}shouldAllowCompletion(e,t){if(e=e.trim(),t.triggerKind===o.CompletionTriggerKind.TriggerCharacter)switch(t.triggerCharacter){case"{":return e.endsWith("${");case"'":return e.endsWith("import '")||e.endsWith("export '");case'"':return e.endsWith('import "')||e.endsWith('export "');case"/":case"\\":return e.startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '")}return!0}shouldAllowArgPlaceholders(e){return!((e=e.trim()).startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '"))}storeCompletionSuggestions(e){if(e.changedLibraries)for(const t of e.changedLibraries)this.cachedCompletions[t.id]=t;if(e.removedLibraries)for(const t of e.removedLibraries)delete this.cachedCompletions[t]}storeExistingImports(e){const t=e.imports,i={};for(const e of t.imports)for(const s of e.elements){const n=t.elements.strings[t.elements.names[s]],r=t.elements.strings[t.elements.uris[s]],o=t.elements.strings[e.uri],a=`${n}/${r}`;i[a]||(i[a]={}),i[a][o]=!0}this.existingImports[e.file]=i}resolveCompletionItem(e,t){return s(this,void 0,void 0,(function*(){if(!e.suggestion)return!e.documentation&&e._documentation&&(e.documentation=e._documentation),e;const i=yield this.analyzer.completionGetSuggestionDetails({file:e.filePath,id:e.suggestionSetID,label:e.suggestion.label,offset:e.offset});return t&&t.isCancellationRequested?void 0:this.createCompletionItemFromSuggestion(e.document,e.offset,e.nextCharacter,e.enableCommitCharacters,e.insertArgumentPlaceholders,e.replacementOffset,e.replacementLength,e.autoImportUri,e.relevance,e.suggestion,i)}))}createCompletionItemFromSuggestion(e,t,i,s,n,r,o,a,c,l,u){const d=this.makeCompletion(e,t,i,s,n,{autoImportUri:a,completionText:u&&u.completion||l.label,defaultArgumentListString:l.defaultArgumentListString,defaultArgumentListTextRanges:l.defaultArgumentListTextRanges,displayText:l.label,elementKind:l.element?l.element.kind:void 0,isDeprecated:!1,kind:void 0,parameterNames:l.parameterNames,parameterType:void 0,parameters:l.element?l.element.parameters:void 0,relevance:c,replacementLength:o,replacementOffset:r,requiredParameterCount:l.requiredParameterCount,returnType:l.element?l.element.returnType:void 0,selectionLength:u&&u.change&&u.change.selection?0:void 0,selectionOffset:u&&u.change&&u.change.selection?u.change.selection.offset:void 0});return u&&u.change&&u.change.edits&&u.change.edits.length&&(this.appendAdditionalEdits(d,e,u.change),a&&(d.detail=`Auto import from '${a}'`+(d.detail?"\n\n"+d.detail:""))),u&&!d.documentation&&d._documentation&&(d.documentation=d._documentation),d}getCachedResults(e,t,i,n,r,o,a){return s(this,void 0,void 0,(function*(){if(!a.includedSuggestionSets||!a.includedElementKinds)return[];const s=a.libraryFile?this.existingImports[a.libraryFile]:void 0,u={};a.includedElementKinds.forEach(e=>u[e]=!0);const d={};a.includedSuggestionRelevanceTags&&a.includedSuggestionRelevanceTags.forEach(e=>d[e.tag]=e.relevanceBoost);const h=c.fsPath(e.uri),p=[],g={},f={};for(const c of a.includedSuggestionSets){if(g[c.id])continue;if(g[c.id]=!0,yield l.resolvedPromise,t&&t.isCancellationRequested)return[];const m=this.cachedCompletions[c.id];if(!m)return this.logger.warn(`Suggestion set ${c.id} was not available and therefore not included in the completion results`),[];const v=m.items.filter(e=>u[e.element.kind]).filter(e=>{const t=`${e.label.split(".")[0]}/${e.declaringLibraryUri}`,i=s&&s[t];if(!i)return!0;if(!i[m.uri])return!1;const n=`${e.label}/${e.element.kind}/${e.declaringLibraryUri}`,r=f[n];return f[n]=!0,!r}).map(t=>{let s=0;t.relevanceTags&&t.relevanceTags.forEach(e=>s=Math.max(s,d[e]||0));const l=this.createCompletionItemFromSuggestion(e,o,i,n,r,a.replacementOffset,a.replacementLength,void 0,c.relevance+s,t,void 0);return Object.assign({autoImportUri:c.displayUri||m.uri,document:e,enableCommitCharacters:n,filePath:h,insertArgumentPlaceholders:r,nextCharacter:i,offset:o,relevance:c.relevance+s,replacementLength:a.replacementLength,replacementOffset:a.replacementOffset,suggestion:t,suggestionSetID:c.id},l)});p.push(v)}return[].concat(...p)}))}convertResult(e,t,i,s,n,r,o){return this.makeCompletion(e,t,i,s,n,{completionText:o.completion,defaultArgumentListString:o.defaultArgumentListString,defaultArgumentListTextRanges:o.defaultArgumentListTextRanges,displayText:o.displayText,docComplete:o.docComplete,elementKind:o.element?o.element.kind:void 0,isDeprecated:o.isDeprecated,kind:o.kind,parameterNames:o.parameterNames,parameterType:o.parameterType,parameters:o.element?o.element.parameters:void 0,relevance:o.relevance,replacementLength:r.replacementLength,replacementOffset:r.replacementOffset,requiredParameterCount:o.requiredParameterCount,returnType:o.returnType||(o.element?o.element.returnType:void 0),selectionLength:o.selectionLength,selectionOffset:o.selectionOffset})}makeCompletion(e,t,i,s,n,a){const c=a.elementKind?this.getElementKind(a.elementKind):void 0;let l,d=a.displayText||a.completionText;const p=new o.SnippetString;let g=!1;const f="("===i;if(a.parameters&&c!==o.CompletionItemKind.Property&&"OVERRIDE"!==a.kind&&-1===d.indexOf("(")){d+=2===a.parameters.length?"()":"(…)",l=a.parameters;const e=a.parameterNames&&a.parameterNames.length>0||h.config.previewNewCompletionPlaceholders&&!!a.defaultArgumentListString;if(h.config.previewNewCompletionPlaceholders&&n&&e&&!f){if(p.appendText(a.completionText),p.appendText("("),a.defaultArgumentListString)for(const e of this.extractTabstopDataForNamedArgs(a.defaultArgumentListString,a.defaultArgumentListTextRanges||[])){const t=a.defaultArgumentListString.substring(e.start,e.end);e.tabStop?p.appendPlaceholder(t):p.appendText(t)}else p.appendTabstop();p.appendText(")")}else if(n&&e&&!f){p.appendText(a.completionText);const e=a.parameterNames.slice(0,a.requiredParameterCount);if(p.appendText("("),e.length){p.appendPlaceholder(e[0]);for(const t of e.slice(1))p.appendText(", "),p.appendPlaceholder(t)}else p.appendTabstop(0);p.appendText(")")}else n&&!f?(p.appendText(a.completionText),p.appendText("()")):p.appendText(a.completionText)}else if(a.selectionOffset){const e=a.completionText.slice(0,a.selectionOffset),t=a.completionText.slice(a.selectionOffset,a.selectionOffset+(a.selectionLength||0));t||" "!==a.completionText.slice(a.selectionOffset-1,a.selectionOffset)||(g=!0);const i=a.completionText.slice(a.selectionOffset+(a.selectionLength||0));p.appendText(e),t?p.appendPlaceholder(t):p.appendTabstop(0),p.appendText(i)}else p.appendText(a.completionText);c===o.CompletionItemKind.Property?l="GETTER"===a.elementKind?a.returnType:a.parameters?a.parameters.substring(1,a.parameters.lastIndexOf(" ")):"":a.returnType?l=l?l+" → "+a.returnType:a.returnType:a.parameterType&&(l=a.parameterType),d.endsWith(",")&&(d=d.substr(0,d.length-1).trim());const m=c||(a.kind?this.getSuggestionKind(a.kind,d):void 0),v=u.cleanDartdoc(a.docComplete),y=new o.CompletionItem(d,m);y.filterText=d.split("(")[0],a.isDeprecated&&(y.tags=[r.CompletionItemTag.Deprecated]),y.detail=l,y._documentation=v?new o.MarkdownString(v):void 0,y.insertText=p,y.keepWhitespace=!0,y.range={inserting:new o.Range(e.positionAt(a.replacementOffset),e.positionAt(Math.min(t,a.replacementOffset+a.replacementLength))),replacing:new o.Range(e.positionAt(a.replacementOffset),e.positionAt(a.replacementOffset+a.replacementLength))},s&&(y.commitCharacters=this.getCommitCharacters(a.kind));return-1!==["import '';"].indexOf(d)&&(g=!0),"IMPORT"===a.kind&&d.endsWith("/")&&(g=!0),g&&(y.command={command:"editor.action.triggerSuggest",title:"Suggest"}),y.sortText=(1e6-a.relevance).toString(),y}extractTabstopDataForNamedArgs(e,t){const i=[];let s=0;for(const e of this.extractOffsetLengthPairs(t))i.push({start:s,end:e[0],tabStop:!1}),i.push({start:e[0],end:e[1],tabStop:!0}),s=e[1];return s<e.length&&i.push({start:s,end:e.length,tabStop:!1}),i}extractOffsetLengthPairs(e){const t=[];for(let i=0;i<e.length-1;i+=2)t.push([e[i],e[i]+e[i+1]]);return t}getSuggestionKind(e,t){switch(e){case"ARGUMENT_LIST":return o.CompletionItemKind.Variable;case"IMPORT":return t.startsWith("dart:")?o.CompletionItemKind.Module:".dart"===n.extname(t.toLowerCase())?o.CompletionItemKind.File:o.CompletionItemKind.Folder;case"IDENTIFIER":return o.CompletionItemKind.Variable;case"INVOCATION":return o.CompletionItemKind.Method;case"KEYWORD":return o.CompletionItemKind.Keyword;case"NAMED_ARGUMENT":case"OPTIONAL_ARGUMENT":return o.CompletionItemKind.Variable;case"PARAMETER":return o.CompletionItemKind.Value}}getElementKind(e){switch(e){case"CLASS":case"CLASS_TYPE_ALIAS":return o.CompletionItemKind.Class;case"COMPILATION_UNIT":return o.CompletionItemKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return o.CompletionItemKind.Constructor;case"ENUM":return o.CompletionItemKind.Enum;case"ENUM_CONSTANT":return o.CompletionItemKind.EnumMember;case"FIELD":return o.CompletionItemKind.Field;case"FILE":return o.CompletionItemKind.File;case"FUNCTION":case"FUNCTION_TYPE_ALIAS":return o.CompletionItemKind.Function;case"GETTER":return o.CompletionItemKind.Property;case"LABEL":case"LIBRARY":return o.CompletionItemKind.Module;case"LOCAL_VARIABLE":return o.CompletionItemKind.Variable;case"METHOD":return o.CompletionItemKind.Method;case"PARAMETER":case"PREFIX":return o.CompletionItemKind.Variable;case"SETTER":return o.CompletionItemKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return o.CompletionItemKind.Variable;case"UNIT_TEST_GROUP":return o.CompletionItemKind.Module;case"UNIT_TEST_TEST":return o.CompletionItemKind.Method;case"UNKNOWN":return o.CompletionItemKind.Value}}getCommitCharacters(e){switch(e){case"IDENTIFIER":case"INVOCATION":return[".",",","(","["]}}appendAdditionalEdits(e,t,i){if(!i)return;if(d.hasOverlappingEdits(i))return this.logger.error("Unable to insert imports because of overlapping edits from the server."),void r.window.showErrorMessage("Unable to insert imports because of overlapping edits from the server");const s=c.fsPath(t.uri),n=i.edits.filter(e=>e.file===s),o=i.edits.filter(e=>e.file!==s);if(n.length&&(e.additionalTextEdits=a.flatMap(n,e=>e.edits.map(e=>{const i=new r.Range(t.positionAt(e.offset),t.positionAt(e.offset+e.length));return new r.TextEdit(i,e.replacement)}))),o.length){const s={edits:o,id:i.id,linkedEditGroups:[],message:i.message,selection:i.selection};e.command={arguments:[t,s],command:"_dart.applySourceChange",title:"Automatically add imports"}}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(25),o=i(5),a=i(30);t.DartDocumentSymbolProvider=class{constructor(e,t){this.logger=e,this.fileTracker=t}provideDocumentSymbols(e,t){return s(this,void 0,void 0,(function*(){const i=yield r.waitFor(()=>this.fileTracker.getOutlineFor(e.uri),500,6e4,t);if(!t.isCancellationRequested&&i&&i.children&&i.children.length)return i.children.map(t=>this.convertResult(e,t))}))}convertResult(e,t){const i=t.element.name?t.element.name:"EXTENSION"===t.element.kind?"<unnamed extension>":"<unnamed>",s=t.element.location||t,r=new n.DocumentSymbol(i,t.element.parameters||"",a.getSymbolKindForElementKind(this.logger,t.element.kind),this.getCodeOffset(e,t),o.toRange(e,s.offset,s.length));return 32&t.element.flags&&(r.tags=[n.SymbolTag.Deprecated]),t.children&&t.children.length&&(r.children=t.children.filter(this.shouldShow).map(t=>this.convertResult(e,t))),r}shouldShow(e){return"CONSTRUCTOR_INVOCATION"!==e.element.kind&&"FUNCTION_INVOCATION"!==e.element.kind}getCodeOffset(e,t){return o.toRange(e,t.codeOffset||t.offset,t.codeLength||t.length)}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);t.DartFoldingProvider=class{constructor(e){this.analyzer=e}provideFoldingRanges(e,t,i){return s(this,void 0,void 0,(function*(){if(yield this.analyzer.client.currentAnalysis,i&&i.isCancellationRequested)return;let t;for(let s=0;s<5&&(t=this.analyzer.fileTracker.getFoldingRegionsFor(e.uri),!t);s++)if(yield new Promise(e=>setTimeout(e,1e3*s).unref()),i&&i.isCancellationRequested)return;return!i.isCancellationRequested&&t?t.map(t=>new n.FoldingRange(e.positionAt(t.offset).line,e.positionAt(t.offset+t.length).line,this.getKind(t.kind))):void 0}))}getKind(e){switch(e){case"FILE_HEADER":case"DOCUMENTATION_COMMENT":return n.FoldingRangeKind.Comment;case"DIRECTIVES":return n.FoldingRangeKind.Imports}}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(258),r=i(0),o=i(1),a=i(9);t.DartFormattingEditProvider=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.context=i,this.registeredFormatters=[],this.formatterRegisterFuncs=[],r.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("dart.enableSdkFormatter")&&(a.config.enableSdkFormatter?this.registerAllFormatters():this.unregisterAllFormatters())})}registerDocumentFormatter(e){this.registerFormatter(()=>r.languages.registerDocumentFormattingEditProvider(e,this))}registerTypingFormatter(e,t,...i){this.registerFormatter(()=>r.languages.registerOnTypeFormattingEditProvider(e,this,t,...i))}registerFormatter(e){const t=()=>this.registeredFormatters.push(e());a.config.enableSdkFormatter&&t(),this.formatterRegisterFuncs.push(t)}registerAllFormatters(){for(const e of this.formatterRegisterFuncs)e()}unregisterAllFormatters(){this.registeredFormatters.forEach(e=>e.dispose()),this.registeredFormatters.length=0}provideDocumentFormattingEdits(e,t,i){return s(this,void 0,void 0,(function*(){try{return yield this.doFormat(e,!0)}catch(e){return void(this.context.hasWarnedAboutFormatterSyntaxLimitation||(this.context.hasWarnedAboutFormatterSyntaxLimitation=!0,r.window.showInformationMessage("The Dart formatter will not run if the file has syntax errors")))}}))}provideOnTypeFormattingEdits(e,t,i,n,r){return s(this,void 0,void 0,(function*(){try{return yield this.doFormat(e,!1)}catch(e){return}}))}doFormat(e,t=!0){return s(this,void 0,void 0,(function*(){if(this.shouldFormat(e))try{const t=yield this.analyzer.editFormat({file:o.fsPath(e.uri),lineLength:a.config.for(e.uri).lineLength,selectionLength:0,selectionOffset:0});return 0===t.edits.length?void 0:t.edits.map(t=>this.convertData(e,t))}catch(e){throw t&&this.logger.error(e),e}}))}shouldFormat(e){if(!e||!e.uri||"file"!==e.uri.scheme)return!1;const t=a.config.for(e.uri),i=o.fsPath(e.uri);return void 0===t.doNotFormat.find(e=>n(i,e,{dot:!0}))}convertData(e,t){return new r.TextEdit(new r.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)}dispose(){this.unregisterAllFormatters()}}},function(e,t,i){e.exports=u,u.Minimatch=d;var s={sep:"/"};try{s=i(2)}catch(e){}var n=u.GLOBSTAR=d.GLOBSTAR={},r=i(259),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var c=/\/+/;function l(e,t){e=e||{},t=t||{};var i={};return Object.keys(t).forEach((function(e){i[e]=t[e]})),Object.keys(e).forEach((function(t){i[t]=e[t]})),i}function u(e,t,i){if("string"!=typeof t)throw new TypeError("glob pattern string required");return i||(i={}),!(!i.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new d(t,i).match(e))}function d(e,t){if(!(this instanceof d))return new d(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==s.sep&&(e=e.split(s.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function h(e,t){if(t||(t=this instanceof d?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:r(e)}u.filter=function(e,t){return t=t||{},function(i,s,n){return u(i,e,t)}},u.defaults=function(e){if(!e||!Object.keys(e).length)return u;var t=u,i=function(i,s,n){return t.minimatch(i,s,l(e,n))};return i.Minimatch=function(i,s){return new t.Minimatch(i,l(e,s))},i},d.defaults=function(e){return e&&Object.keys(e).length?u.defaults(e).Minimatch:d},d.prototype.debug=function(){},d.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var i=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,i),i=this.globParts=i.map((function(e){return e.split(c)})),this.debug(this.pattern,i),i=i.map((function(e,t,i){return e.map(this.parse,this)}),this),this.debug(this.pattern,i),i=i.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,i),this.set=i},d.prototype.parseNegate=function(){var e=this.pattern,t=!1,i=this.options,s=0;if(i.nonegate)return;for(var n=0,r=e.length;n<r&&"!"===e.charAt(n);n++)t=!t,s++;s&&(this.pattern=e.substr(s));this.negate=t},u.braceExpand=function(e,t){return h(e,t)},d.prototype.braceExpand=h,d.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var i=this.options;if(!i.noglobstar&&"**"===e)return n;if(""===e)return"";var s,r="",c=!!i.nocase,l=!1,u=[],d=[],h=!1,g=-1,f=-1,m="."===e.charAt(0)?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function y(){if(s){switch(s){case"*":r+="[^/]*?",c=!0;break;case"?":r+="[^/]",c=!0;break;default:r+="\\"+s}v.debug("clearStateChar %j %j",s,r),s=!1}}for(var b,w=0,S=e.length;w<S&&(b=e.charAt(w));w++)if(this.debug("%s\t%s %s %j",e,w,r,b),l&&a[b])r+="\\"+b,l=!1;else switch(b){case"/":return!1;case"\\":y(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,w,r,b),h){this.debug("  in class"),"!"===b&&w===f+1&&(b="^"),r+=b;continue}v.debug("call clearStateChar %j",s),y(),s=b,i.noext&&y();continue;case"(":if(h){r+="(";continue}if(!s){r+="\\(";continue}u.push({type:s,start:w-1,reStart:r.length,open:o[s].open,close:o[s].close}),r+="!"===s?"(?:(?!(?:":"(?:",this.debug("plType %j %j",s,r),s=!1;continue;case")":if(h||!u.length){r+="\\)";continue}y(),c=!0;var C=u.pop();r+=C.close,"!"===C.type&&d.push(C),C.reEnd=r.length;continue;case"|":if(h||!u.length||l){r+="\\|",l=!1;continue}y(),r+="|";continue;case"[":if(y(),h){r+="\\"+b;continue}h=!0,f=w,g=r.length,r+=b;continue;case"]":if(w===f+1||!h){r+="\\"+b,l=!1;continue}if(h){var T=e.substring(f+1,w);try{RegExp("["+T+"]")}catch(e){var E=this.parse(T,p);r=r.substr(0,g)+"\\["+E[0]+"\\]",c=c||E[1],h=!1;continue}}c=!0,h=!1,r+=b;continue;default:y(),l?l=!1:!a[b]||"^"===b&&h||(r+="\\"),r+=b}h&&(T=e.substr(f+1),E=this.parse(T,p),r=r.substr(0,g)+"\\["+E[0],c=c||E[1]);for(C=u.pop();C;C=u.pop()){var R=r.slice(C.reStart+C.open.length);this.debug("setting tail",r,C),R=R.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,i){return i||(i="\\"),t+t+i+"|"})),this.debug("tail=%j\n   %s",R,R,C,r);var P="*"===C.type?"[^/]*?":"?"===C.type?"[^/]":"\\"+C.type;c=!0,r=r.slice(0,C.reStart)+P+"\\("+R}y(),l&&(r+="\\\\");var D=!1;switch(r.charAt(0)){case".":case"[":case"(":D=!0}for(var _=d.length-1;_>-1;_--){var k=d[_],x=r.slice(0,k.reStart),O=r.slice(k.reStart,k.reEnd-8),F=r.slice(k.reEnd-8,k.reEnd),I=r.slice(k.reEnd);F+=I;var L=x.split("(").length-1,A=I;for(w=0;w<L;w++)A=A.replace(/\)[+*?]?/,"");var N="";""===(I=A)&&t!==p&&(N="$"),r=x+O+I+N+F}""!==r&&c&&(r="(?=.)"+r);D&&(r=m+r);if(t===p)return[r,c];if(!c)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var M=i.nocase?"i":"";try{var U=new RegExp("^"+r+"$",M)}catch(e){return new RegExp("$.")}return U._glob=e,U._src=r,U};var p={};u.makeRe=function(e,t){return new d(e,t||{}).makeRe()},d.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,i=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",s=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===n?i:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,s)}catch(e){this.regexp=!1}return this.regexp},u.match=function(e,t,i){var s=new d(t,i=i||{});return e=e.filter((function(e){return s.match(e)})),s.options.nonull&&!e.length&&e.push(t),e},d.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var i=this.options;"/"!==s.sep&&(e=e.split(s.sep).join("/"));e=e.split(c),this.debug(this.pattern,"split",e);var n,r,o=this.set;for(this.debug(this.pattern,"set",o),r=e.length-1;r>=0&&!(n=e[r]);r--);for(r=0;r<o.length;r++){var a=o[r],l=e;if(i.matchBase&&1===a.length&&(l=[n]),this.matchOne(l,a,t))return!!i.flipNegate||!this.negate}return!i.flipNegate&&this.negate},d.prototype.matchOne=function(e,t,i){var s=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,o=0,a=e.length,c=t.length;r<a&&o<c;r++,o++){this.debug("matchOne loop");var l,u=t[o],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===n){this.debug("GLOBSTAR",[t,u,d]);var h=r,p=o+1;if(p===c){for(this.debug("** at the end");r<a;r++)if("."===e[r]||".."===e[r]||!s.dot&&"."===e[r].charAt(0))return!1;return!0}for(;h<a;){var g=e[h];if(this.debug("\nglobstar while",e,h,t,p,g),this.matchOne(e.slice(h),t.slice(p),i))return this.debug("globstar found match!",h,a,g),!0;if("."===g||".."===g||!s.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,h,t,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!i||(this.debug("\n>>> no match, partial?",e,h,t,p),h!==a))}if("string"==typeof u?(l=s.nocase?d.toLowerCase()===u.toLowerCase():d===u,this.debug("string match",u,d,l)):(l=d.match(u),this.debug("pattern match",u,d,l)),!l)return!1}if(r===a&&o===c)return!0;if(r===a)return i;if(o===c)return r===a-1&&""===e[r];throw new Error("wtf?")}},function(e,t,i){var s=i(260),n=i(261);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,i){var r=[],o=n("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var c,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),m=l||d,v=o.body.indexOf(",")>=0;if(!m&&!v)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+a+o.post,e(t)):[t];if(m)c=o.body.split(/\.\./);else{if(1===(c=function e(t){if(!t)return[""];var i=[],s=n("{","}",t);if(!s)return t.split(",");var r=s.pre,o=s.body,a=s.post,c=r.split(",");c[c.length-1]+="{"+o+"}";var l=e(a);a.length&&(c[c.length-1]+=l.shift(),c.push.apply(c,l));return i.push.apply(i,c),i}(o.body)).length)if(1===(c=e(c[0],!1).map(h)).length)return(w=o.post.length?e(o.post,!1):[""]).map((function(e){return o.pre+c[0]+e}))}var y,b=o.pre,w=o.post.length?e(o.post,!1):[""];if(m){var S=u(c[0]),C=u(c[1]),T=Math.max(c[0].length,c[1].length),E=3==c.length?Math.abs(u(c[2])):1,R=g;C<S&&(E*=-1,R=f);var P=c.some(p);y=[];for(var D=S;R(D,C);D+=E){var _;if(d)"\\"===(_=String.fromCharCode(D))&&(_="");else if(_=String(D),P){var k=T-_.length;if(k>0){var x=new Array(k+1).join("0");_=D<0?"-"+x+_.slice(1):x+_}}y.push(_)}}else y=s(c,(function(t){return e(t,!1)}));for(var O=0;O<y.length;O++)for(var F=0;F<w.length;F++){var I=b+y[O]+w[F];(!i||m||I)&&r.push(I)}return r}(function(e){return e.split("\\\\").join(r).split("\\{").join(o).split("\\}").join(a).split("\\,").join(c).split("\\.").join(l)}(e),!0).map(d)};var r="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(o).join("{").split(a).join("}").split(c).join(",").split(l).join(".")}function h(e){return"{"+e+"}"}function p(e){return/^-?0\d/.test(e)}function g(e,t){return e<=t}function f(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var s=[],n=0;n<e.length;n++){var r=t(e[n],n);i(r)?s.push.apply(s,r):s.push(r)}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,i){"use strict";function s(e,t,i){e instanceof RegExp&&(e=n(e,i)),t instanceof RegExp&&(t=n(t,i));var s=r(e,t,i);return s&&{start:s[0],end:s[1],pre:i.slice(0,s[0]),body:i.slice(s[0]+e.length,s[1]),post:i.slice(s[1]+t.length)}}function n(e,t){var i=t.match(e);return i?i[0]:null}function r(e,t,i){var s,n,r,o,a,c=i.indexOf(e),l=i.indexOf(t,c+1),u=c;if(c>=0&&l>0){for(s=[],r=i.length;u>=0&&!a;)u==c?(s.push(u),c=i.indexOf(e,u+1)):1==s.length?a=[s.pop(),l]:((n=s.pop())<r&&(r=n,o=l),l=i.indexOf(t,u+1)),u=c<l&&c>=0?c:l;s.length&&(a=[r,o])}return a}e.exports=s,s.range=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.DartDocumentHighlightProvider=class{constructor(e){this.fileTracker=e}provideDocumentHighlights(e,t,i){const n=e.offsetAt(t),r=this.fileTracker.getOccurrencesFor(e.uri);if(r)for(const t of r)if(t.offsets.find(e=>e<=n&&e+t.length>=n))return t.offsets.map(i=>new s.DocumentHighlight(new s.Range(e.positionAt(i),e.positionAt(i+t.length))))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),o=i(1),a=i(5),c=i(108);t.DartImplementationProvider=class{constructor(e){this.analyzer=e}provideImplementation(e,t,i){return s(this,void 0,void 0,(function*(){const s=c.findNearestOutlineNode(this.analyzer.fileTracker,e,t,!0),l=s&&s.element&&s.element.location?s.element.location.offset:e.offsetAt(t),u=yield this.analyzer.client.searchGetTypeHierarchy({file:o.fsPath(e.uri),offset:l});if(i.isCancellationRequested||!u||!u.hierarchyItems||!u.hierarchyItems.length||1===u.hierarchyItems.length)return;const d=u.hierarchyItems.find(e=>{const t=e.memberElement||e.classElement;return t.location&&t.location.offset<=l&&t.location.offset+t.location.length>=l})||u.hierarchyItems[0],h=!d.memberElement;const p=function e(t){return[...t.subclasses.map(e=>u.hierarchyItems[e]),...r.flatMap(t.subclasses,t=>e(u.hierarchyItems[t]))]}(d).map(e=>h?e.classElement:e.memberElement).filter(r.notUndefined),g=[];for(const e of p){if(!e.location)continue;const t=a.toRange(yield n.workspace.openTextDocument(e.location.file),e.location.offset,e.location.length);g.push(new n.Location(n.Uri.file(e.location.file),t))}return g}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0);t.DartLanguageConfiguration=class{constructor(){this.onEnterRules=[{action:{indentAction:s.IndentAction.None,appendText:"/// "},beforeText:/^\s*\/\/\/ /},{action:{indentAction:s.IndentAction.None,appendText:"///"},beforeText:/^\s*\/\/\//},{action:{indentAction:s.IndentAction.IndentOutdent,appendText:" * "},afterText:/^\s*\*\/$/,beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:s.IndentAction.None,appendText:" * "},beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:s.IndentAction.None,appendText:"* "},beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/},{action:{indentAction:s.IndentAction.None,removeText:1},beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/}]}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),o=i(1),a=i(5);t.DartReferenceProvider=class{constructor(e){this.analyzer=e}provideReferences(e,t,i,r){return s(this,void 0,void 0,(function*(){const s=i.includeDeclaration?yield this.provideDefinition(e,t,r):void 0,c=yield this.analyzer.searchFindElementReferencesResults({file:o.fsPath(e.uri),includePotential:!0,offset:e.offsetAt(t)});if(r&&r.isCancellationRequested)return;const l=c.results.map(e=>new n.Location(n.Uri.file(e.location.file),a.toRangeOnLine(e.location)));return s?l.concat(s.map(e=>new n.Location(e.targetUri,e.targetRange))):l}))}provideDefinition(e,t,i){return s(this,void 0,void 0,(function*(){const s=yield this.analyzer.analysisGetNavigation({file:o.fsPath(e.uri),length:0,offset:e.offsetAt(t)});if(!i||!i.isCancellationRequested)return r.flatMap(s.regions,t=>t.targets.map(i=>{const r=s.targets[i];return 0===r.startColumn&&(r.startColumn=1),{originSelectionRange:a.toRange(e,t.offset,t.length),targetRange:a.toRangeOnLine(r),targetUri:n.Uri.file(s.files[r.fileIndex])}}))}))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(5),a=i(52);t.DartRenameProvider=class{constructor(e){this.analyzer=e}provideRenameEdits(e,t,i,s){return this.doRename(e,t,i,s)}prepareRename(e,t,i){return this.getLocation(e,t,i)}doRename(e,t,i,o){return s(this,void 0,void 0,(function*(){const s=a.getChannel("Refactorings");s.appendLine("");const c=yield this.analyzer.editGetRefactoring({file:r.fsPath(e.uri),kind:"RENAME",length:1,offset:e.offsetAt(t),options:{newName:i},validateOnly:!1});if(o&&o.isCancellationRequested)return void s.appendLine("[INFO] Rename cancelled.");const l=new n.WorkspaceEdit;c.change&&c.change.message&&s.appendLine(`[INFO] ${c.change.message}…`),this.handleProblem(c.initialProblems.concat(c.optionsProblems).concat(c.finalProblems),s);const u=[];if(c.change&&c.change.edits.forEach(e=>{e.edits.forEach(t=>{const i=n.Uri.file(e.file),s=n.workspace.openTextDocument(i);u.push(s.then(e=>l.replace(i,new n.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)))})}),yield Promise.all(u),!o||!o.isCancellationRequested)return s.appendLine("[INFO] Rename successful."),l;s.appendLine("[INFO] Rename cancelled.")}))}handleProblem(e,t){e.forEach(e=>t.appendLine(`[${e.severity}] ${e.message}`));const i=e.filter(e=>"INFO"!==e.severity&&"WARNING"!==e.severity).sort((e,t)=>t.severity.localeCompare(e.severity));if(0!==i.length)throw t.appendLine("[INFO] Rename aborted."),i[0].message}getLocation(e,t,i){return s(this,void 0,void 0,(function*(){const s=yield this.analyzer.editGetRefactoring({file:r.fsPath(e.uri),kind:"RENAME",length:0,offset:e.offsetAt(t),validateOnly:!0});if(i&&i.isCancellationRequested)return;if(!s.feedback)throw new Error("You cannot rename this element.");const a=s.feedback,c=-1===a.offset?new n.Range(t,t):o.toRange(e,a.offset,a.length);if(a)return{placeholder:a.oldName,range:c};{const e=s.initialProblems.concat(s.optionsProblems).concat(s.finalProblems).filter(e=>"FATAL"===e.severity);throw e&&e.length?new Error(e[0].message):new Error("This rename is not supported.")}}))}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(14);t.DartSignatureHelpProvider=class{constructor(e){this.analyzer=e}provideSignatureHelp(e,t,i){return s(this,void 0,void 0,(function*(){try{const s=yield this.analyzer.analysisGetSignature({file:r.fsPath(e.uri),offset:e.offsetAt(t)});if(i&&i.isCancellationRequested)return;const a=new n.SignatureInformation(this.getSignatureLabel(s),new n.MarkdownString(o.cleanDartdoc(s.dartdoc)));a.parameters=s.parameters.map(e=>new n.ParameterInformation(this.getLabel(e)));const c=new n.SignatureHelp;return c.signatures=[a],c.activeSignature=0,c.activeParameter=-1,c}catch(e){return}}))}getSignatureLabel(e){const t=e.parameters.filter(e=>"REQUIRED"===e.kind),i=e.parameters.filter(e=>"OPTIONAL"===e.kind),s=e.parameters.filter(e=>"NAMED"===e.kind),n=[];return t.length&&n.push(t.map(this.getLabel).join(", ")),i.length&&n.push("["+i.map(this.getLabel).join(", ")+"]"),s.length&&n.push("{"+s.map(this.getLabel).join(", ")+"}"),`${e.name}(${n.join(", ")})`}getLabel(e){const t=e.defaultValue?" = "+e.defaultValue:"";return`${e.type} ${e.name}${t}`}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(5),o=i(30);t.DartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.badChars=new RegExp("[^0-9a-z-]","gi")}provideWorkspaceSymbols(e,t){return s(this,void 0,void 0,(function*(){if(0===e.length)return;const i=".*"+e.replace(this.badChars,"").split("").map(e=>`[${e.toUpperCase()}${e.toLowerCase()}]`).join(".*")+".*",s=yield this.analyzer.searchGetElementDeclarations({pattern:i,maxResults:500});return t&&t.isCancellationRequested?void 0:s.declarations.map(e=>this.convertWorkspaceResult(e,s.files[e.fileIndex]))}))}resolveWorkspaceSymbol(e,t){return s(this,void 0,void 0,(function*(){if(!(e instanceof a))return;const t=yield n.workspace.openTextDocument(n.Uri.file(e.locationData.file));return e.location=new n.Location(t.uri,r.toRange(t,e.locationData.offset,e.locationData.length)),e}))}convertWorkspaceResult(e,t){const i=e.parameters?"()"===e.parameters?"()":"(…)":"";return new a(e.name+i,o.getSymbolKindForElementKind(this.logger,e.kind),e.className||"",new n.Location(n.Uri.file(t),void 0),{file:t,length:e.codeLength,offset:e.codeOffset||e.offset})}};class a extends n.SymbolInformation{constructor(e,t,i,s,n){super(e,t,i,s),this.locationData=n}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(1),o=i(6),a=i(77),c=i(76);t.FixCodeActionProvider=class{constructor(e,t,i){this.logger=e,this.selector=t,this.analyzer=i,this.rank=1,this.metadata={providedCodeActionKinds:[n.CodeActionKind.QuickFix]}}provideCodeActions(e,t,i,a){return s(this,void 0,void 0,(function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||n.CodeActionKind.QuickFix.contains(i.only)))try{const s=yield this.analyzer.editGetFixes({file:r.fsPath(e.uri),offset:e.offsetAt(t.start)});if(a&&a.isCancellationRequested)return;const n={};for(const t of s.fixes)for(const i of t.fixes)n[JSON.stringify(i.edits)]=this.convertResult(e,i,t.error);const o=Object.keys(n).map(e=>n[e]);return i.only?o.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):o}catch(e){throw this.logger.error(e),e}}))}convertResult(e,t,i){const s=t.message,r=i?[a.DartDiagnosticProvider.createDiagnostic(i)]:void 0,o=c.getKindFor(t.id,n.CodeActionKind.QuickFix),l=new n.CodeAction(s,o);return l.command={arguments:[e,t],command:"_dart.applySourceChange",title:s},l.diagnostics=r,l}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(9),r=i(6),o=i(77);t.IgnoreLintCodeActionProvider=class{constructor(e){this.selector=e,this.rank=100,this.metadata={providedCodeActionKinds:[s.CodeActionKind.QuickFix]}}provideCodeActions(e,t,i,a){if(!r.isAnalyzableAndInWorkspace(e))return;if(i&&i.only&&!s.CodeActionKind.QuickFix.contains(i.only))return;if(!(n.config.showIgnoreQuickFixes&&i&&i.diagnostics&&i.diagnostics.length))return;const c=i.diagnostics.filter(e=>e instanceof o.DartDiagnostic&&("LINT"===e.type||"HINT"===e.type)||"dart"===e.source&&e.severity===s.DiagnosticSeverity.Information);return c.length?c.map(t=>this.convertResult(e,t)):void 0}convertResult(e,t){const i=t instanceof o.DartDiagnostic?t.type.toLowerCase()+" ":"",n=t.code||"",r="string"==typeof n?n:n.value,a=new s.WorkspaceEdit,c=e.lineAt(t.range.start.line);a.insert(e.uri,c.range.start,`${" ".repeat(c.firstNonWhitespaceCharacterIndex)}// ignore: ${r}\n`);const l=`Ignore ${i}'${r}' for this line`,u=new s.CodeAction(l,s.CodeActionKind.QuickFix);return u.edit=a,u}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(1),a=i(5),c=i(30),l=i(6);t.LegacyDartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t}provideWorkspaceSymbols(e,t){return s(this,void 0,void 0,(function*(){if(0===e.length)return;e=this.sanitizeUserQuery(e);const t=this.makeCaseInsensitiveFuzzyRegex(e),i=yield Promise.all([this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t}),this.analyzer.searchFindMemberDeclarationsResults({name:t})]);return this.combineResults(i)}))}combineResults(e){return e[0].results.concat(e[1].results).filter(e=>this.shouldIncludeResult(e)).map(e=>this.convertResult(e))}searchTopLevelSymbols(e){return s(this,void 0,void 0,(function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t})).results}))}searchMemberDeclarations(e){return s(this,void 0,void 0,(function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindMemberDeclarationsResults({name:t})).results}))}sanitizeUserQuery(e){let t=Array.from(e);return t=t.filter(e=>-1==="[](){}\\|./<>?+".indexOf(e)),t.join("")}makeCaseInsensitiveFuzzyRegex(e){let t=Array.from(e);return t=t.map(e=>e.toUpperCase()===e.toLowerCase()?e:`[${e.toUpperCase()}${e.toLowerCase()}]`),`.*${t.join(".*")}.*`}shouldIncludeResult(e){const t=e.path[0].name.startsWith("_")||e.path[1].name.startsWith("_");return l.isWithinWorkspace(e.location.file)||!t}convertResult(e){const t=this.createDisplayPath(e.location.file);let i=e.path.slice(0,e.path.length-2).reverse().map(e=>e.name).join(".");"SETTER"===e.path[0].kind&&(i+=" set"),"GETTER"===e.path[0].kind&&(i+=" get");const s=e.path[0].parameters&&"SETTER"!==e.path[0].kind?e.path[0].parameters:"";return new r.SymbolInformation(i+s,c.getSymbolKindForElementKind(this.logger,e.path[0].kind),t||"",new r.Location(r.Uri.file(e.location.file),a.toRangeOnLine(e.location)))}createDisplayPath(e){if(!e)return;const t="hosted"+n.sep+"pub.dartlang.org",i=e.indexOf(t);if(i>-1){const s=e.substring(i+t.length+1).split(n.sep);s[0]=s[0].split("-")[0],"lib"===s[1]&&s.splice(1,1),e=`package:${s[0]}/${s.slice(1).join("/")}`}else{const t=r.workspace.getWorkspaceFolder(r.Uri.file(e));e=t&&n.relative(o.fsPath(t.uri),e)}return e}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),o=i(1),a=i(6),c={CONVERT_METHOD_TO_GETTER:"Convert Method to Getter",EXTRACT_LOCAL_VARIABLE:"Extract Local Variable",EXTRACT_METHOD:"Extract Method",EXTRACT_WIDGET:"Extract Widget"};t.RefactorCodeActionProvider=class{constructor(e,t){this.selector=e,this.analyzer=t,this.rank=50,this.metadata={providedCodeActionKinds:[n.CodeActionKind.Refactor]}}provideCodeActions(e,t,i,c){return s(this,void 0,void 0,(function*(){if(a.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||n.CodeActionKind.Refactor.contains(i.only)))try{const s=yield this.analyzer.editGetAvailableRefactorings({file:o.fsPath(e.uri),length:e.offsetAt(t.end)-e.offsetAt(t.start),offset:e.offsetAt(t.start)});if(c&&c.isCancellationRequested)return;const n=s.kinds.map(i=>this.getSupportedRefactorForKind(e,t,i)).filter(r.notUndefined);return i.only?n.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):n}catch(e){return[]}}))}getSupportedRefactorForKind(e,t,i){if(!c[i])return;const s=c[i],r=new n.CodeAction(s,n.CodeActionKind.Refactor);return r.command={arguments:[e,t,i],command:"_dart.performRefactor",title:s},r}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(0),r=i(14);t.SnippetCompletionItemProvider=class{constructor(e,t){this.completions=new n.CompletionList,this.shouldRender=t;const i=r.readJson(s.join(r.extensionPath,e));for(const e of Object.keys(i))for(const t of Object.keys(i[e])){const s=i[e][t],r=new n.CompletionItem(t,n.CompletionItemKind.Snippet);r.filterText=s.prefix,r.insertText=new n.SnippetString(Array.isArray(s.body)?s.body.join("\n"):s.body),r.detail=s.description,r.documentation=(new n.MarkdownString).appendCodeblock(r.insertText.value),r.sortText="zzzzzzzzzzzzzzzzzzzzzz",this.completions.items.push(r)}}provideCompletionItems(e,t,i,s){const n=e.lineAt(t.line).text.slice(0,t.character);if(this.shouldAllowCompletion(n,s)&&this.shouldRender(e.uri))return this.completions}shouldAllowCompletion(e,t){return-1===(e=e.trim()).indexOf("//")}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(5),r=i(6);class o{provideCodeActions(e,t,i,o){if(!r.isAnalyzableAndInWorkspace(e))return;const a=[];return i&&i.only&&!i.only.contains(s.CodeActionKind.Source)&&!i.only.contains(s.CodeActionKind.SourceOrganizeImports)||a.push({command:{arguments:[e],command:"_dart.organizeImports",title:"Organize Imports"},kind:s.CodeActionKind.SourceOrganizeImports,title:"Organize Imports"}),i&&i.only&&!i.only.contains(s.CodeActionKind.Source)&&!i.only.contains(n.SourceSortMembersCodeActionKind)||a.push({command:{arguments:[e],command:"dart.sortMembers",title:"Sort Members"},kind:n.SourceSortMembersCodeActionKind,title:"Sort Members"}),a}}t.SourceCodeActionProvider=o,o.metadata={providedCodeActionKinds:[s.CodeActionKind.Source,s.CodeActionKind.SourceOrganizeImports,n.SourceSortMembersCodeActionKind]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(2),n=i(0),r=i(4),o=i(1),a=i(5),c=i(9),l=i(62),u=i(6),d=i(13);t.PubBuildRunnerTaskProvider=class{constructor(e){this.sdks=e}provideTasks(e){const t=a.getDartWorkspaceFolders(),i=[];return t.forEach(e=>{l.referencesBuildRunner(o.fsPath(e.uri))&&(i.push(this.createBuildRunnerCommandBackgroundTask(e,"watch",n.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"build",n.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"serve",n.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"test",n.TaskGroup.Test)))}),i}createBuildRunnerCommandBackgroundTask(e,t,i){const a=u.isFlutterWorkspaceFolder(e)&&this.sdks.flutter,l=a?"flutter":"pub",h=a?s.join(this.sdks.flutter,r.flutterPath):s.join(this.sdks.dart,r.pubPath),p=a?["pub","run","build_runner",t]:["run","build_runner",t];c.config.buildRunnerAdditionalArgs&&p.push(...c.config.buildRunnerAdditionalArgs);const g=new n.Task({command:t,type:l},e,"build_runner "+t,l,new n.ProcessExecution(h,p,{cwd:o.fsPath(e.uri),env:d.getToolEnv()}),"$dart-pub-build_runner");return g.group=i,g.isBackground=!0,g.name="build_runner "+t,g}resolveTask(e,t){}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(0),o=i(4),a=i(8),c=i(12),l=i(3),u=i(5),d=i(13);t.PubGlobal=class{constructor(e,t,i,s){this.logger=e,this.context=t,this.sdks=i,this.pubApi=s}promptToInstallIfRequired(e,t,i=o.pubGlobalDocsUrl,n,c,l=!1){return s(this,void 0,void 0,(function*(){const s=c?a.VersionStatus.UpdateRequired:yield this.getInstalledStatus(e,t,n);if(s===a.VersionStatus.Valid)return!0;c&&(l=!0);const o=s===a.VersionStatus.NotInstalled?"Activate "+e:"Update "+e,d=s===a.VersionStatus.NotInstalled?`${e} needs to be installed with 'pub global activate ${t}' to use this feature.`:s===a.VersionStatus.UpdateRequired?`${e} needs to be updated with 'pub global activate ${t}' to use this feature.`:`A new version of ${e} is available and can be installed with 'pub global activate ${t}'.`;let h=!l||s!==a.VersionStatus.UpdateRequired&&s!==a.VersionStatus.UpdateAvailable?yield r.window.showWarningMessage(d,o,"More Info"):o;if("More Info"===h)return yield u.envUtils.openInBrowser(i),!1;if(h===o){const n=s===a.VersionStatus.NotInstalled?"Activating "+e:"Updating "+e,o=["global","activate",t];return yield this.runCommandWithProgress(e,n+"...",o,c),(yield this.getInstalledStatus(e,t))===a.VersionStatus.Valid||(h=yield r.window.showErrorMessage(`${n} failed. Please try running 'pub global activate ${t}' manually.`,"More Info"),"More Info"===h&&(yield u.envUtils.openInBrowser(i)),!1)}return!1}))}backgroundActivate(e,t,i,n){return s(this,void 0,void 0,(function*(){const s="Activating "+e,r=["global","activate",t];i?yield this.runCommand(e,r,n):yield this.runCommandWithProgress(e,s+"...",r,n)}))}uninstall(e){return s(this,void 0,void 0,(function*(){const t=["global","deactivate",e];yield this.runCommand(e,t)}))}getInstalledStatus(e,t,i){return s(this,void 0,void 0,(function*(){const s=yield this.runCommand(e,["global","list"]),n=new RegExp(`^${t} (\\d+\\.\\d+\\.\\d+[\\w.\\-+]*)(?: |$)`,"m").exec(s);if(!n)return a.VersionStatus.NotInstalled;if(i&&!l.pubVersionIsAtLeast(n[1],i))return a.VersionStatus.UpdateRequired;const r=this.context.getPackageLastCheckedForUpdates(t);if(!r||r<=Date.now()-o.noRepeatPromptThreshold){this.context.setPackageLastCheckedForUpdates(t,Date.now());try{const e=yield this.pubApi.getPackage(t);if(!l.pubVersionIsAtLeast(n[1],e.latest.version))return a.VersionStatus.UpdateAvailable}catch(e){return this.logger.warn(`Failed to check for new version of ${t}: ${e}`,a.LogCategory.CommandProcesses),a.VersionStatus.Valid}}return a.VersionStatus.Valid}))}runCommandWithProgress(e,t,i,s){return r.window.withProgress({location:r.ProgressLocation.Notification,title:t},t=>this.runCommand(e,i,s))}runCommand(e,t,i){const{binPath:s,binArgs:r}=l.usingCustomScript(n.join(this.sdks.dart,o.pubPath),t,{customScript:i,customScriptReplacesNumArgs:3});return new Promise((t,i)=>{this.logger.info(`Spawning ${s} with args ${JSON.stringify(r)}`);const n=d.safeToolSpawn(void 0,s,r);c.logProcess(this.logger,a.LogCategory.CommandProcesses,n);const o=[],l=[];n.stdout.on("data",e=>o.push(e.toString())),n.stderr.on("data",e=>l.push(e.toString())),n.on("close",s=>{s?i(`${e} exited with code ${s}.\n\n${o.join("")}\n\n${l.join("")}`):t(o.join(""))})})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(3);class n{constructor(e){this.version=e}static get empty(){return new n("0.0.0")}get generatesCodeWithUnimplementedError(){return s.versionIsAtLeast(this.version,"2.8.0-dev.0.0")}get supportsDevTools(){return s.versionIsAtLeast(this.version,"2.1.0")}get includesSourceForSdkLibs(){return s.versionIsAtLeast(this.version,"2.2.1")}get handlesBreakpointsInPartFiles(){return s.versionIsAtLeast(this.version,"2.2.1-edge")}get hasDocumentationInCompletions(){return!s.versionIsAtLeast(this.version,"2.5.1")}get handlesPathsEverywhereForBreakpoints(){return s.versionIsAtLeast(this.version,"2.2.1-edge")}get supportsDisableServiceTokens(){return s.versionIsAtLeast(this.version,"2.2.1-dev.4.2")}get supportsWriteServiceInfo(){return s.versionIsAtLeast(this.version,"2.7.1")}get supportsDebugInternalLibraries(){return s.versionIsAtLeast(this.version,"2.9.0-a")}get supportsPubOutdated(){return s.versionIsAtLeast(this.version,"2.8.0-a")}get webSupportsEvaluation(){return!1}get webSupportsDebugging(){return!1}}t.DartCapabilities=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(9),r=i(6);t.StatusBarVersionTracker=class{constructor(e,t){this.subscriptions=[];const i=e.sdks.dartSdkIsFromFlutter,s=e.hasAnyFlutterProjects?n.config.flutterSdkPaths&&n.config.flutterSdkPaths.length>0?"dart.changeFlutterSdk":void 0:n.config.sdkPaths&&n.config.sdkPaths.length>0?"dart.changeSdk":void 0,r=e.hasAnyFlutterProjects?"Flutter":i?"Dart from Flutter":"Dart",o=e.hasAnyFlutterProjects||i?e.sdks.flutterVersion:e.sdks.dartVersion;o&&this.addStatusBarItem(r+": "+(o.length>20?o.substr(0,17)+"…":o),`${r} SDK (${t?"LSP":"DAS"}): ${o}`,s)}addStatusBarItem(e,t,i){const n=s.window.createStatusBarItem(s.StatusBarAlignment.Right,2);n.text=e,n.tooltip=t,n.command=i,this.subscriptions.push(n),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>{e&&e.document&&r.isAnalyzable(e.document)?n.show():n.hide()})),s.window.activeTextEditor&&s.window.activeTextEditor.document&&r.isAnalyzable(s.window.activeTextEditor.document)&&n.show()}dispose(){this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(4),o=i(3),a=i(5),c=i(9),l=i(6);t.checkForStandardDartSdkUpdates=function(e,t){return s(this,void 0,void 0,(function*(){if(!c.config.checkForSdkUpdates||t.config.disableSdkUpdateChecks)return;if(t.sdks.dartSdkIsFromFlutter)return;const i=t.sdks.dartVersion;try{const e=yield l.getLatestSdkVersion();if(!i||o.versionIsAtLeast(i,e))return;const t="Go to Dart Downloads",s="Disable Update Checks",u=`Version ${e} of the Dart SDK is available (you have ${i}). Some features of Dart Code may not work correctly with an old SDK.`,d=yield n.window.showWarningMessage(u,t,s);d===t?yield a.envUtils.openInBrowser(r.DART_DOWNLOAD_URL):d===s&&c.config.setCheckForSdkUpdates(!1)}catch(t){e.error(t)}}))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(8),l=i(1),u=i(14),d=i(94),h=i(5),p=i(109),g=i(6);function f(){return s(this,void 0,void 0,(function*(){return"Install Flutter Extension"===(yield o.window.showInformationMessage("The Flutter extension is required to work with Flutter projects.","Install Flutter Extension"))&&(yield o.window.withProgress({location:o.ProgressLocation.Notification},e=>(e.report({message:"Installing Flutter extension"}),new Promise(e=>{o.extensions.onDidChange(t=>e()),o.commands.executeCommand("workbench.extensions.installExtension",a.flutterExtensionIdentifier)}))),g.promptToReloadExtension()),!1}))}function m(e){o.window.showErrorMessage(e.message)}function v(e){n.existsSync(e)&&setTimeout(()=>{o.commands.executeCommand("vscode.open",o.Uri.file(e))},100)}t.showUserPrompts=function(e,t,i,g){return s(this,void 0,void 0,(function*(){if(function(e,t){s(this,void 0,void 0,(function*(){process.env.DART_CODE_IS_TEST_RUN&&(yield new Promise(e=>setTimeout(e,5e3))),h.getDartWorkspaceFolders().forEach(t=>{!function(e,t,i){s(this,void 0,void 0,(function*(){const a=r.join(l.fsPath(t.uri),i);if(n.existsSync(a)){const i=n.readFileSync(a).toString().trim();let u;try{u=JSON.parse(i)}catch(e){return void o.window.showErrorMessage("Failed to run Stagehand to create project")}n.unlinkSync(a),e.info("Creating Dart project for "+l.fsPath(t.uri),c.LogCategory.CommandProcesses);try{p.markProjectCreationStarted(),(yield function(e,t){return s(this,void 0,void 0,(function*(){return 0===(yield o.commands.executeCommand("_dart.create",e,t))}))}(l.fsPath(t.uri),u.name))?(e.info("Fetching packages for newly-created project",c.LogCategory.CommandProcesses),yield o.commands.executeCommand("dart.getPackages",t.uri),function(e,t){const i=l.fsPath(e.uri),s=r.basename(i);v(r.join(i,t.entrypoint.replace("__projectName__",s))),o.window.showInformationMessage(t.label+" project ready!")}(t,u),e.info("Finished creating new project!",c.LogCategory.CommandProcesses)):e.info("Failed to create new project",c.LogCategory.CommandProcesses)}finally{p.markProjectCreationEnded()}}}))}(e,t,a.DART_STAGEHAND_PROJECT_TRIGGER_FILE),function(e){s(this,void 0,void 0,(function*(){const t=r.join(l.fsPath(e.uri),a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE);if(n.existsSync(t)){let i=n.readFileSync(t).toString().trim();i=i||void 0,n.unlinkSync(t);try{p.markProjectCreationStarted(),(yield function(e,t){return s(this,void 0,void 0,(function*(){const i=t?"sample":void 0;return 0===(yield o.commands.executeCommand("_flutter.create",e,i,t))}))}(l.fsPath(e.uri),i))&&function(e,t){v(r.join(l.fsPath(e.uri),"lib/main.dart")),t?o.window.showInformationMessage(t+" sample ready! Connect a device and press F5 to run."):o.window.showInformationMessage("Your Flutter project is ready! Connect a device and press F5 to start running.")}(e,i)}finally{p.markProjectCreationEnded()}}}))}(t)})}))}(e),g.hasAnyFlutterProjects&&!u.hasFlutterExtension&&!function(e){const i=`${a.userPromptContextPrefix}${e}`;return!0===t.get(i)}(a.installFlutterExtensionPromptKey)&&(yield new Promise(e=>setTimeout(e,2e4)),!u.checkHasFlutterExtension()))return function(e,i){const s=`${a.userPromptContextPrefix}${e}`;i().then(e=>t.update(s,e),m)}(a.installFlutterExtensionPromptKey,f);if(g.hasAnyFlutterProjects&&g.sdks.flutter&&a.isWin){const t=[process.env.COMMONPROGRAMFILES,process.env["COMMONPROGRAMFILES(x86)"],process.env.CommonProgramW6432,process.env.PROGRAMFILES,process.env.ProgramW6432,process.env["PROGRAMFILES(X86)"]].find(e=>{var t;return e&&(null===(t=g.sdks.flutter)||void 0===t?void 0:t.toLowerCase().startsWith(e.toLowerCase()))});t&&(e.error("Flutter is installed in protected folder: "+t),o.window.showErrorMessage("The Flutter SDK is installed in a protected folder and may not function correctly. Please move the SDK to a location that is user-writable without Administration permissions and restart."))}const y=t.lastSeenVersion;if(y){if(!u.isDevExtension&&y!==u.extensionVersion){const e=u.extensionVersion.split(".").slice(0,2).join(".").replace(".","-");return void function(e,t){return s(this,void 0,void 0,(function*(){return(yield o.window.showInformationMessage("Dart Code has been updated to v"+e,"Show Release Notes"))&&(yield h.envUtils.openInBrowser(`https://dartcode.org/releases/v${t}/`)),!0}))}(u.extensionVersion,e).then(()=>t.lastSeenVersion=u.extensionVersion)}}else t.lastSeenVersion=u.extensionVersion;!g.hasAnyFlutterProjects||(yield d.showFlutterSurveyNotificationIfAppropriate(t,i,h.envUtils.openInBrowser,Date.now(),e))}))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),r=i(2),o=i(0),a=i(4),c=i(44),l=i(21),u=i(1),d=i(5);t.DartPackagesProvider=class{constructor(e){this.logger=e,this.onDidChangeTreeDataEmitter=new o.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.watcher=o.workspace.createFileSystemWatcher("**/.packages"),this.watcher.onDidChange(this.refresh,this),this.watcher.onDidCreate(this.refresh,this),this.watcher.onDidDelete(this.refresh,this)}refresh(){this.onDidChangeTreeDataEmitter.fire()}getTreeItem(e){return e}getChildren(e){return s(this,void 0,void 0,(function*(){if(e)return e instanceof f?this.getPackages(e):e instanceof m||e instanceof g?this.getFilesAndFolders(e):(e instanceof p||this.logger.warn(`Don't know how to show children of ${e.label}/${e.resourceUri}`),[]);{const e=d.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=(yield u.findProjectFolders(e,{requirePubspec:!0})).map(e=>new f(o.Uri.file(e)));return 1===t.length?this.getChildren(t[0]):t}}))}getPackages(e){const t=u.fsPath(e.resourceUri),i=r.join(t,".packages");if(!n.existsSync(i))return[];const s=new c.PackageMap(i).packages;return l.sortBy(Object.keys(s),e=>e.toLowerCase()).filter(e=>s[e]&&!u.areSameFolder(s[e],r.join(t,"lib"))).map(e=>{const t=s[e];return new m(""+e,o.Uri.file(t))})}getFilesAndFolders(e){const t=l.sortBy(n.readdirSync(u.fsPath(e.resourceUri),{withFileTypes:!0}),e=>e.name.toLowerCase()),i=[],s=[];if(!e.resourceUri)return[];const a=u.fsPath(e.resourceUri);return t.forEach(e=>{const t=r.join(a,e.name);e.isFile()?s.push(new p(o.Uri.file(t))):e.isDirectory()&&i.push(new g(o.Uri.file(t)))}),[...i,...s]}dispose(){this.watcher.dispose()}};class h extends o.TreeItem{constructor(e,t,i){e?(super(e,i),this.resourceUri=t):super(t,i)}}t.PackageDep=h;class p extends h{constructor(e){super(void 0,e,o.TreeItemCollapsibleState.None),this.contextValue=a.DART_DEP_FILE_NODE_CONTEXT,this.command={arguments:[e],command:"dart.package.openFile",title:"Open File"}}}t.PackageDepFile=p;class g extends h{constructor(e){super(void 0,e,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_FOLDER_NODE_CONTEXT}}t.PackageDepFolder=g;class f extends h{constructor(e){const t=u.fsPath(e);super(r.basename(t),e,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_PROJECT_NODE_CONTEXT;const i=o.workspace.getWorkspaceFolder(e);if(i){const e=u.fsPath(i.uri);this.description=r.relative(r.dirname(e),r.dirname(t))}}}t.PackageDepProject=f;class m extends h{constructor(e,t){super(e,t,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_PACKAGE_NODE_CONTEXT}}t.PackageDepPackage=m}]);
//# sourceMappingURL=extension.js.map